!------------------------------------------------------------------------------
! This file contains 4 modules
! 1 - RADCONS
! 2 - RADCALV
! 3 - SPECDATA
! 4 - MIEV
!------------------------------------------------------------------------------


MODULE RADCONS
!------------------------------------------------------------------------------
! Radiation Parameters

USE PRECISION_PARAMETERS
IMPLICIT NONE

REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: DLN
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: BBFRAC, WL_LOW, WL_HIGH
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: DLX, DLY, DLZ, DLB, RSA

INTEGER, ALLOCATABLE, DIMENSION(:,:) :: DLM
INTEGER, ALLOCATABLE, DIMENSION(:)   :: NRP

REAL(EB) :: RADTMP, PATH_LENGTH, RADIATIVE_FRACTION
REAL(EB) :: DGROUP_A, DGROUP_B, WEIGH_CYL
REAL(EB) :: DPHI0, FOUR_SIGMA, RPI_SIGMA, LTSTEP, RTMPMAX, RTMPMIN
REAL(EB) :: MIE_MINIMUM_DIAMETER,MIE_MAXIMUM_DIAMETER

INTEGER :: TIME_STEP_INCREMENT,NMIEANG
INTEGER :: NRDMIE, NLMBDMIE, MIE_NDG
INTEGER :: NRT,NCO,UIIDIM,NLAMBDAT,NKAPPAT,NKAPPAZ

LOGICAL :: WIDE_BAND_MODEL

INTEGER :: N_RADCAL_SPECIES,RADCAL_SPECIES_INDEX(11),N_KAPPA_T=44,N_KAPPA_Y=50
REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: Z2RADCAL_SPECIES
REAL(EB), ALLOCATABLE, DIMENSION(:,:,:,:) :: RADCAL_SPECIES2KAPPA
CHARACTER(30) :: RADCAL_SPECIES(11)='null'


!------------------------------------------------------------------------------
!
!     BBFRAC    Fraction of blackbody radiation
!     DLX       Mean X-component of the control angle ray vector
!     DLY       Mean Y-component of the control angle ray vector
!     DLZ       Mean Z-component of the control angle ray vector
!     DLB       Mean Bottom-component of rayn vector (cylindrical case)
!     DLM       Mirroring indexes
!     DLN       Wall normal matrix
!     DPHI0     Opening angle of the cylindrical domain
!     E_WALL    Wall emissivity
!     ILW       Radiation intensities on solid mirrors and mesh interfaces.
!               Intensity integrals (band specific or angle increment) for solid and open walls
!     INRAD_W   Incident radiative heat flux on a cell (QRADIN = E_WALL*INRAD_W)
!     R50       Array of PARTICLE radii corresponding to the median diameters 
!               of the distributions used in the generation of WQABS and WQSCA arrays.
!     MIE_NDG   Number of PARTICLE radii in WQABS and WQSCA arrays
!     NLMBDMIE  Number of wave lengths in Mie calculations
!     NMIEANG   Number of angle bins in forward scattering integration
!     NUMBER_RADIATION_ANGLES
!     NRA       Total number of radiation control angles
!     NRDMIE    Number of PARTICLE radii in Mie calculations
!     NRT       Number of radiation theta angles
!     NRP       Number of radiation phi angles on each theta band
!     NUMBER_SPECTRA_BANDS
!     NSB       Number of spectral bands (1=gray, 6=wide band, 9=wide band w. CH4)
!     OUTRAD_W  Emitted intensity from a wall (OUTRAD_W = QRADOUT/PI)
!     PHIUP     Upper limit of solid angle component PHI
!     PHILOW    Lower limit of solid angle component PHI
!     RADTMP    Radiation temperature for absorption properties (Mie)
!     QRADIN    Absorbed radiative heat flux into a surface cell (solid wall or open)
!     QRADOUT   Emitted radiative heat flux from a surface (solid wall or open) 
!     RSA       Array of solid angles
!     RTMPMAX   Maximum temperature for tabulation of radiative properties
!     RTMPMIN   Minimum temperature for tabulation of radiative properties
!     THETAUP   Upper limit of solid angle component THETA
!     THETALOW  Lower limit of solid angle component THETA
!     UII       Integrated intensity
!     UIID      Parts of UII  if WIDE_BAND_MODEL = TRUE, UIID contains the band specific intensity
!                             if WIDE_BAND_MODEL/= TRUE, UIID contains the ANGLE_INCREMENTs of intensity
!     WEIGH_CYL In cylindrical coordinates, all intensities represent two actual control angles
!     WL_LOW    Lower wavelength limit of the spectral bands
!     WL_HIGH   Upper wavelength limit of the spectral bands
!     WQABS     Absorption efficiency factor array 
!     WQSCA     Scattering efficiency factor array
!
!     PATH_LENGTH             Mean path length for the gray gas abs. coef.
!     ANGLE_INCREMENT         How many angles are skipped on each update
!     TIME_STEP_INCREMENT     How often is the radiation solver called
!
!------------------------------------------------------------------------------

END MODULE RADCONS



MODULE RADCALV

!------------------------------------------------------------------------------
! VARIABLES
! OMMIN : (REAL) MINIMUM WAVE NUMBER IN SPECTRUM, CM-1
! OMMAX : (REAL) MAXIMUM WAVE NUMBER IN SPECTRUM, CM-1
! NOM   : (INTEGER) NUMBER OF WAVELENGTH INTERVALS
! GC    : (REAL) COLLISION BROADENED HALF-WIDTH
! LAMBDA: (REAL) WAVELENGTH, IN MICROMETER 
!------------------------------------------------------------------------------
! Module wrapper for RadCal subroutine

USE PRECISION_PARAMETERS
USE GLOBAL_CONSTANTS, ONLY: AL2O3
IMPLICIT NONE

PRIVATE
CHARACTER(255), PARAMETER :: iradid='$Id$'
CHARACTER(255), PARAMETER :: iradrev='$Revision$'
CHARACTER(255), PARAMETER :: iraddate='$Date$'

! RADCAL MODULE PUBLIC VARIABLES
PUBLIC OMMAX, OMMIN, DD, SPECIE, SVF, P, RCT

! RADCAL MODULE PUBLIC PROCEDURES
PUBLIC RCALLOC, INIT_RADCAL, RADCAL, PLANCK, RCDEALLOC, GET_REV_irad

! RADCAL MODULE PUBLIC VARIABLES DEFINITION
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: SPECIE, P

REAL(EB) :: OMMIN, OMMAX, RCT, DD, SVF
!-------------------------------------------------

REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: GAMMA, SD15, SD, SD7, SD3,    &
                                         SD1_CH4, SD2_CH4, OM_BND_CH4  ! FOR METHANE NEW DATA 

INTEGER :: N_TEMP_C3H6,   N_BAND_C3H6
INTEGER :: N_TEMP_C3H8,   N_BAND_C3H8
INTEGER :: N_TEMP_C7H16,  N_BAND_C7H16
INTEGER :: N_TEMP_C7H8,   N_BAND_C7H8
INTEGER :: N_TEMP_CH4,    N_BAND_CH4
INTEGER :: N_TEMP_CH3OH,  N_BAND_CH3OH
INTEGER :: N_TEMP_C5H8O2, N_BAND_C5H8O2
INTEGER :: N_TEMP_C2H6,   N_BAND_C2H6
INTEGER :: N_TEMP_C2H4,   N_BAND_C2H4

INTEGER :: I_MODEL_C3H6   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C3H8   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C7H16  ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C7H8   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CH3OH  ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C5H8O2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C2H6   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C2H4   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

INTEGER :: I_MODEL_CO2   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_H2O   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CO    ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CH4   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C3H6_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C3H8_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C7H16_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C7H8_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_CH3OH_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C5H8O2_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C2H6_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C2H4_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_CH4_TEMP

REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C3H6
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C3H8
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C7H16
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C7H8
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_CH3OH
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C5H8O2
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C2H6
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C3H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C3H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C7H16

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD5_C7H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_CH3OH

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD5_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD6_C5H8O2

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C2H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C3H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C3H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C7H16

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD5_C7H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_CH3OH

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD5_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD6_C5H8O2

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C2H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C2H4

REAL(EB), DIMENSION(:,:), POINTER, PRIVATE :: KAPPA_D, GAMMA_D
REAL(EB), DIMENSION(:),   POINTER, PRIVATE :: BAND_OMEGA

REAL(EB), ALLOCATABLE, DIMENSION(:) :: QW, TTAU, XT, AB, LAMBDA, ATOT, BCNT, &
                                       OPTICAL_THICKNESS, GC, X

REAL(EB) :: TWALL

REAL(EB), PARAMETER :: SIGMA     = 5.670400E-8_EB

INTEGER :: NOM

CONTAINS

!==============================================================================
SUBROUTINE GET_REV_irad(MODULE_REV,MODULE_DATE)
!==============================================================================
! Variables passed in

 INTEGER, INTENT(INOUT) :: MODULE_REV
 CHARACTER(255),INTENT(INOUT) :: MODULE_DATE
!------------------------------------------------------------------------------

 WRITE(MODULE_DATE,'(A)') iradrev(INDEX(iradrev,':')+2:LEN_TRIM(iradrev)-2)
 READ (MODULE_DATE,'(I5)') MODULE_REV
 WRITE(MODULE_DATE,'(A)') iraddate

!------------------------------------------------------------------------------
END SUBROUTINE GET_REV_irad


!==============================================================================
SUBROUTINE INIT_RADCAL
!==============================================================================
! 
 USE RADCONS, ONLY: RADTMP
!------------------------------------------------------------------------------

 TWALL = RADTMP

 IF(OMMAX<1100._EB) THEN 
    NOM=INT((OMMAX-OMMIN)/5._EB)
 ELSEIF(OMMIN>5000._EB) THEN
    NOM=INT((OMMAX-OMMIN)/50._EB)
 ELSEIF(OMMIN<1100._EB.AND.OMMAX>5000._EB) THEN
    NOM=INT((1100._EB-OMMIN)/5._EB)+INT((5000._EB-1100._EB)/25._EB) +INT((OMMAX-5000._EB)/50._EB)
 ELSEIF(OMMIN<1100._EB) THEN
    NOM=INT((1100._EB-OMMIN)/5._EB)+INT((OMMAX-1100._EB)/25._EB)
 ELSEIF(OMMAX>5000._EB) THEN
    NOM=INT((5000._EB-OMMIN)/25._EB)+INT((OMMAX-5000._EB)/50._EB)
 ELSE
    NOM=INT((OMMAX-OMMIN)/25._EB)
 ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE INIT_RADCAL


!==============================================================================
SUBROUTINE RADCAL(AMEAN,AP0,RADCAL_ID)
!==============================================================================
!
! VARIABLES PASSED IN
!-------- 
! RADCAL_ID: CHARACTER(30): RADCAL FUEL PROPERTIES
!
! VARIABLES PASSED OUT
!-------
! AMEAN : (REAL) EFFECTIVE ABSORPTION COEFFICIENT IN UNIFORM MEDIUM
! AP0   : (REAL) PLANCK MEAN ABSORPTION COEFFCIENT IN UNIFORM MEDIUM
!
! LOCAL
!------
! A_COLLISION : (REAL) Collision broadened fine structure parameter
!               (line_half_width/line_spacing)
! A_DOPPLER :   (REAL) Doppler broadened fine structure parameter
!               (line_half_width/line_spacing)
! AZOTEMP   : (REAL) RATIO REFERENCE TEMPERATURE (273K) OVER LOCAL TEMPERATURE
! DOM   : (REAL) INCREMENT OF WAVENUMBER
! OMEGA : (REAL) WAVENUMBER
! OPTICAL_THICKNESS: (REAL) OPTICAL THICKNESS OF THE ith SPECIES,  UNITS: cmSTP
! PTOT  : (REAL) TOTAL PRESSURE IN ATM
! TEMP4 : (REAL) LOCAL TEMPERATURE RAISED TO THE POWER 4
! 
! X_COLLISION: (REAL) ! OPTICAL DEPTH FOR A PURE COLLISION CURVE OF GROWTH
! X_DOPPLER  : (REAL) ! OPTICAL DEPTH FOR A PURE DOPPLER CURVE OF GROWTH
! X_PARTICLE : (REAL) ! OPTICAL DEPTH FOR PARTICLE
! 
! SPECIES: CO2: 5 BANDS (4 Modeled, 1 Tabulated)
!          H2O: 5 BANDS (5 Tabulated)
!          CO: 1 BANDS (Modeled)
!          old CH4: 3 BANDS (1 Modeled, 2 Tabulated)
!          New CH4: 3 BANDS (1 Modeled, 2 Tabulated)
!          C3H8:    2 BANDS (2 Tabulated)
!          C3H6:    
!          C7H16:
!          C7H8:
!          MMA:
!          CH3OH:
!------------------------------------------------------------------------------
USE RADCONS, ONLY:RPI_SIGMA

! VARIABLES PASSED IN
CHARACTER(30),INTENT(IN):: RADCAL_ID

! VARIABLES PASSED OUT
REAL (EB), INTENT(OUT) :: AMEAN, AP0

! LOCALS

REAL(EB) :: AZORCT, RCT4, PTOT, TEMP

REAL(EB) :: X_PARTICLE, X_DOPPLER, X_COLLISION
 
REAL(EB) :: DOM, ABGAS, RSL, RSS,                  &
            OMEGA, WAVE_LENGTH, Q, LTERM,          & 
            DAMBDA, SDWEAK, A_COLLISION, A_DOPPLER

 REAL(EB) :: TAU, TAUS, XTOT, XSTAR
             
! REAL(EB) :: AIWALL

 INTEGER :: I_MODEL ! MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

 INTEGER :: I, II, KK, NM, KMAX, KMIN

! [NOTE: THE TOTAL INTENSITY CALCULATED IS THAT WHICH LEAVES INTERVAL J=1.
! P(I,J) IS PARTIAL PRESSURE, ATM, OF SPECIES I IN  INTERVAL J.
! I=1,2,3,4,5, OR 6 IMPLIES SPECIES IS CO2, H2O, FUEL, CO, O2, OR N2, RESP.]

AZORCT = 273._EB/RCT
RCT4   = RCT**4

! COMPUTE TOTAL PRESSURE
PTOT   = SUM(P(1:6))

!---------------------------------------------------------------------------------------
! COMPUTE SPECIES OPTICAL THICKNESS AND COLLISION BROADENING
! (CALCULATION PROCEEDS IN ACCORDANCE WITH THE SLG MODEL, TABLE 5-18, IN NASA SP-3080._EB)

DO I = 1, 4  ! LOOP OVER CO2(I=1), H2O(I=2), FUEL(I=3), CO(I=4) 
   OPTICAL_THICKNESS(I) = AZORCT*P(I)*100._EB*DD ! COMPUTE OPTICAL THICKNESS FOR THE ith SPECIES

! Compute collisional broadening half-width at half height, EQ 5-34 NASA REPORT SP-3080
   GC(I) = 0.0_EB

! INCLUDE NON-RESONANT FOREIGN AND SELF-BROADENING COLLISIONS
   DO II=1,6
      GC(I)=GC(I)+GAMMA(I,II)*P(II)*SQRT(AZORCT)
   ENDDO

! INCLUDE RESONANT SELF-BROADENING COLLISIONS
   GC(I)=GC(I)+GAMMA(I,7)*P(I)*AZORCT          
ENDDO

! LOOP SPECTRUM COMPUTES EACH SPECTRAL CONTRIBUTION, LOOP OVER EACH WAVE NUMBER INTERVALS
DOM    = 5.0_EB
OMEGA  = OMMIN-DOM
NM     = NOM-1

LSPECTRUM: DO KK = 1, NOM

   OMEGA=OMEGA+DOM
   IF(OMEGA>1100._EB) OMEGA = OMEGA+20._EB
   IF(OMEGA>5000._EB) OMEGA = OMEGA+25._EB

   LAMBDA(KK) = 10000._EB/OMEGA  ! COMPUTE LAMBDA (WAVELENGTH) IN microMETER
   ABGAS      = 0._EB
 
! LOOP SPECIES COMPUTES THE CONTRIBUTION OF EACH SPECIES TO TAU
! IF SPECIE(I) IS SET TO 0., THAT PARTICULAR RADIATING SPECIES IS NOT PRESENT.  THE SPECIES CONSIDERED ARE
!          I   SPECIES
!          1     CO2
!          2     H2O
!          3     FUEL (CH4, C3H8, C7H16, CH3OH, ...)
!          4     CO
!          5     PARTICULATES

   LSPECIES: DO I=1,4

      I_MODEL = 1 ! ENFORCE GOODY MODEL WHEN NOT SPECIFIED  

      IF(SPECIE(I) <= TWO_EPSILON_EB) THEN
         A_COLLISION = 1.0_EB
         A_DOPPLER   = 1.0_EB
         X(I)        = TWO_EPSILON_EB
         CYCLE LSPECIES
      ELSE
         TEMP  = RCT
         SELECT CASE (I)
            CASE (1)
               CALL CO2(OMEGA,TEMP,GC(1),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
            CASE (2)
               CALL H2O(OMEGA,TEMP,GC(2),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
            CASE (3)
               SELECT CASE(RADCAL_ID)
                  CASE('METHANE_OLD') ; CALL CH4_OLD(OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('METHANE')     ; CALL CH4(    OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('PROPANE')     ; CALL C3H8(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('N-HEPTANE')   ; CALL C7H16(  OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('METHANOL')    ; CALL CH3OH(  OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('TOLUENE')     ; CALL C7H8(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('PROPYLENE')   ; CALL C3H6(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('MMA')         ; CALL C5H8O2( OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('ETHANE')      ; CALL C2H6(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('ETHYLENE')    ; CALL C2H4(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE DEFAULT        ; CALL CH4(    OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
               END SELECT                 
            CASE (4)
               CALL CO(OMEGA,TEMP,GC(4),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
         END SELECT

         XSTAR = SDWEAK*OPTICAL_THICKNESS(I) ! OPTICAL DEPTH FOR THE WEAK LINE LIMIT.  SP-3080 EQ. 5-27
         ABGAS = XSTAR/DD+ABGAS

         IF (XSTAR >= 1.E-10_EB) THEN
!------------------------------------------------------------------------------
! COMPUTE THE OPTICAL DEPTH FOR THE Ith SPECIES USING RANDOM BAND MODEL
! COMPOSED OF LINES OF DOPPLER-LORENTZ SHAPE WITH:
! RANDOM DISTRIBUTION OF EITHER EQUAL STRENGTH LINES FOR DOPPLER OR DECAYING
! USE APPROPRIATE MODEL FOR LORENTZ LINE (ELSASSER,GOODY,MALKMUS)
! COMPUTE OPTICAL DEPTH FOR PURE DOPPLER CURVE OF GROWTH 

            X_DOPPLER = GROWTH_DOPPLER(XSTAR,A_DOPPLER,I_MODEL)
 
! LORENTZ OPTICAL DEPTH 
! COMPUTE OPTICAL DEPTH FOR PURE COLLISION CURVE OF GROWTH 
            SELECT CASE (I_MODEL)
                CASE(1)  ! GOODY MODEL
                    X_COLLISION = GOODY(XSTAR,A_COLLISION)
                CASE(2)  ! MALKMUS MODEL
                    X_COLLISION = MALKMUS(XSTAR,A_COLLISION)
                CASE(3)  ! ELSASSER MODEL
                    X_COLLISION = ELSASSER(XSTAR,A_COLLISION)
                CASE DEFAULT
                    X_COLLISION = GOODY(XSTAR,A_COLLISION)
            END SELECT

! COMPUTE OPTICAL DEPTH
            X(I) = COMBINED_LINES(X_COLLISION, X_DOPPLER, XSTAR)

         ELSE ! XSTAR < 1.E-10_EB very weak line
            X(I) = XSTAR
         ENDIF ! CONDITION (XSTAR >= 1.E-10_EB)

      ENDIF ! CONDITION (P(I)<=TWO_EPSILON_EB)

   END DO LSPECIES

! DETERMINE OPTICAL DEPTH OF SOOT

   IF (SPECIE(5)<=TWO_EPSILON_EB) THEN
      X_PARTICLE = 0._EB
   ELSE
      CALL POD(OMEGA, X_PARTICLE)
   ENDIF

   AB(KK) = ABGAS+X_PARTICLE/DD

! Evaluate the combined spectral transmissivity and radiance

   XTOT = SUM(X(1:4))+X_PARTICLE

   TAU  = EXP(-XTOT)
   
   XT(KK)  = XTOT
   TTAU(KK)= TAU
   QW(KK)  = (1.0_EB-TAU)*PLANCK(RCT,LAMBDA(KK))+TTAU(KK)*PLANCK(TWALL,LAMBDA(KK))

ENDDO LSPECTRUM
     
! INTEGRATE THE RADIANCE OVER THE SPECTRUM

Q = QW(1)*(LAMBDA(1)-LAMBDA(2))

DO KK = 2,NM
   Q = Q+QW(KK)*0.5_EB*(LAMBDA(KK-1)-LAMBDA(KK+1))
ENDDO

Q = Q+QW(NOM)*(LAMBDA(NOM-1)-LAMBDA(NOM))

!------------------------------------------------------------------------------
! SOOT CONTRIBUTION
! DETERMINE SOOT RADIANCE FOR SHORT AND LONG WAVELENGTHS.
     
RSL    = 0._EB
RSS    = 0._EB

IF(.NOT.(SPECIE(5)<=TWO_EPSILON_EB .AND. TWALL<=TWO_EPSILON_EB)) THEN

   KMAX = INT(OMMIN)
   KMIN = INT(OMMAX)

SHORT: DO KK = 5, KMAX, 5 ! LOOP OVER LONG WAVELENGTHS

      OMEGA       = REAL(KK,EB)
      WAVE_LENGTH = 10000._EB/OMEGA
      DAMBDA      = 10000._EB/(OMEGA-2.5_EB)-10000._EB/(OMEGA+2.5_EB)

      CALL POD(OMEGA,X_PARTICLE)  
      TAUS = EXP(-X_PARTICLE)
      RSL  = RSL + TAUS*PLANCK(TWALL,WAVE_LENGTH)*DAMBDA-(TAUS-1._EB)*PLANCK(RCT,WAVE_LENGTH)*DAMBDA

   ENDDO SHORT

LONG: DO KK = KMIN, 25000, 100 ! LOOP OVER SHORT WAVELENGTHS
      OMEGA       = REAL(KK,EB)
      WAVE_LENGTH = 10000._EB/OMEGA
      DAMBDA      = 10000._EB/(OMEGA-50._EB)-10000._EB/(OMEGA+50._EB)

      CALL POD(OMEGA,X_PARTICLE)
      TAUS = DEXP(-X_PARTICLE)
      RSS  = RSS + TAUS*PLANCK(TWALL,WAVE_LENGTH)*DAMBDA-(TAUS-1._EB)*PLANCK(RCT,WAVE_LENGTH)*DAMBDA
   ENDDO LONG

ENDIF

! ADD THE CONTRIBUTION OF SOOT OVER LARGER WAVE LENGTH DOMAIN
Q = Q + RSS + RSL

! COMPUTE AMEAN
IF(ABS(TWALL-RCT)<=SPACING(TWALL) .OR. TWALL<=TWO_EPSILON_EB) THEN
   LTERM  = MAX(1E-20_EB,(Q/RPI_SIGMA-RCT4)/(-RCT4))
ELSE
   LTERM  = MAX(1E-20_EB,(Q/RPI_SIGMA-RCT4)/(TWALL**4-RCT4))   
ENDIF

AMEAN  = -1._EB/DD*DLOG(LTERM)

! THE FOLLOWING SECTION COMPUTES THE MEAN ABSORPTION COEFFICIENTS IF THE SYSTEM IS HOMOGENEOUS (IE., NPT=1).
! INTEGRATE AP0*PLANCK OVER LAMBDA

AP0 = AB(1)*0.5_EB*(LAMBDA(1)-LAMBDA(2))*PLANCK(RCT,LAMBDA(1))

DO KK = 2, NM
   AP0 = AP0 + AB(KK)*0.5_EB*(LAMBDA(KK-1)-LAMBDA(KK+1))*PLANCK(RCT,LAMBDA(KK))
ENDDO

AP0 = AP0 + AB(NOM)*0.5_EB*(LAMBDA(NM)-LAMBDA(NOM))*PLANCK(RCT,LAMBDA(NOM))

! DIVIDE BY SIGMA*PI*TEMP**4 TO GET FINAL COEFFICIENT AP0 

AP0 = AP0/(RPI_SIGMA*RCT4)

!------------------------------------------------------------------------------
END SUBROUTINE RADCAL

!==============================================================================
FUNCTION GROWTH_DOPPLER(XSTAR,A_DOPPLER,I_MODEL) RESULT(X_DOPPLER)
!==============================================================================
! THIS FUNCTION COMPUTES THE DOPPLER CURVE OF GROWTH.
! TWO CASES
! 1) EQUALLY INTENSE, RANDOMLY SPACED DOPPLER LINE (I_MODEL =1 or 3)
! 2) GEOMETRICALLY DECAYING STRENGTH, RANDOMLY SPACED DOPPLER LINE (I_MODEL=2)
!
! VARIABLES IN:
! XSTAR: OPTICAL PATHLENGTH * LINE STRENGTH
! A_DOPPLER: DOPPLER FINE STRUCTURE PARAMETER
! I_MODEL: MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
!
! VARIABLE OUT
! X_DOPPLER

! VARIABLES IN:
REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_DOPPLER
INTEGER, INTENT(IN)  :: I_MODEL

! VARIABLE OUT
REAL :: X_DOPPLER

! SOURCE: ! SP-3080, CHAP 3.2.5 e and f. SEE page 105.

SELECT CASE(I_MODEL)
   CASE(1) ! GOODY MODEL: EQUALLY INTENSE, RANDOMLY SPACED DOPPLER LINE 
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
   CASE(2) ! MALKMUS: GEOMETRICALLY DECAYING STRENGTH, RANDOMLY SPACED DOPPLER LINE
       X_DOPPLER = 0.937_EB*A_DOPPLER*(DLOG(1.0_EB+(1.07_EB*XSTAR/A_DOPPLER)**(0.6666_EB)))* &
                                  SQRT(DLOG(1.0_EB+(1.07_EB*XSTAR/A_DOPPLER)**(0.6666_EB)))
   CASE(3)
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
   CASE DEFAULT
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
END SELECT
!------------------------------------------------------------------------------
END FUNCTION GROWTH_DOPPLER

!==============================================================================
FUNCTION COMBINED_LINES(X_COLLISION, X_DOPPLER, XSTAR) RESULT(OPTICAL_DEPTH)
!==============================================================================
! COMPUTE THE COMBINED COLLISION AND DOPPLER OPTICAL DEPTHS AND 
! THE OPTICAL DEPTH BASED ON EXPRESSION GIVEN IN SP-3080 EQ 5-26 (p220)
!
! VARIABLES IN:
! X_COLLISION : LORENZ CURVE OF GROWTH
! X_DOPPLER: DOPPLER CURVE OF GROWTH
! XSTAR: OPTICAL PATHLENGTH * LINE STRENGTH
!
! VARIABLE OUT
! OPTICAL_DEPTH

! VARIABLES PASSED IN
REAL(EB), INTENT(IN) :: X_COLLISION
REAL(EB), INTENT(IN) :: X_DOPPLER
REAL(EB), INTENT(IN) :: XSTAR

! VARIABLE PASSED OUTPUT
REAL(EB) :: OPTICAL_DEPTH

! LOCAL VARIABLES
REAL(EB) :: Y_DOPPLER, Y_COLLISION, Y_COMBINED

! COMPUTE THE COMBINED COLLISION AND DOPPLER OPTICAL DEPTHS Y_COMBINED

Y_DOPPLER   = 1._EB-(X_DOPPLER/XSTAR)**2
Y_COLLISION = 1._EB-(X_COLLISION/XSTAR)**2
 
! SP-3080 EQ. 5-26
Y_COMBINED = MAX(1._EB/Y_COLLISION**2+1._EB/Y_DOPPLER**2-1._EB,1._EB)

! FINALLY COMPUTE OPTICAL DEPTH
! SP-3080 EQ. 5-25
 OPTICAL_DEPTH = XSTAR*SQRT(1._EB-(Y_COMBINED**(-0.5_EB))) 

!------------------------------------------------------------------------------
END FUNCTION COMBINED_LINES

!==============================================================================
FUNCTION GOODY(XSTAR,A_COLLISION) RESULT(X_GOODY)
!==============================================================================

! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE GOODY STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_GOODY
  
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_GOODY

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_GOODY = XSTAR
ELSEIF(XSTAR>1.0E+5_EB) THEN ! STRONG LINE LIMIT
   X_GOODY = SQRT(4.0_EB*XSTAR*A_COLLISION)
ELSE             ! FORMULATION TO AVOID DIVISION BY ZERO
                 !X_GOODY = XSTAR/SQRT(1._EB+0.25_EB*XSTAR/A_COLLISION)
   X_GOODY = SQRT(A_COLLISION)*XSTAR/SQRT(A_COLLISION+0.25_EB*XSTAR)
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION GOODY

!==============================================================================
FUNCTION MALKMUS(XSTAR,A_COLLISION) RESULT(X_MALKMUS)
!==============================================================================
!
! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE MALKMUS STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_MALKMUS
  
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_MALKMUS

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_MALKMUS = XSTAR
ELSEIF(XSTAR>1.0E+5_EB) THEN ! STRONG LINE LIMIT
   X_MALKMUS = SQRT(4.0_EB*XSTAR*A_COLLISION)
ELSE             ! FORMULATION TO AVOID DIVISION BY ZERO
                 !X_GOODY = XSTAR/SQRT(1._EB+0.25_EB*XSTAR/A_COLLISION)
   X_MALKMUS = SQRT(4.0_EB*A_COLLISION**2+4.0_EB*A_COLLISION*XSTAR)-2.0_EB*A_COLLISION
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION MALKMUS

!==============================================================================
FUNCTION ELSASSER(XSTAR,A_COLLISION) RESULT(X_ELSASSER)
!==============================================================================
! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE ELSASSER STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_ELSASSER
!
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_ELSASSER

! LOCAL VARIABLES

REAL(EB) :: SPECTRAL_ABSORPTIVITY
REAL(EB) :: XX
REAL(EB) :: ENN
REAL(EB) :: ARG 
REAL(EB) :: ARGNEW
REAL(EB) :: X_COLLISION

INTEGER :: MM
INTEGER :: N
! THE FOLLOWING LOOP COMPUTES THE OPTICAL DEPTH, X_COLLISION, FOR METHANE USING 
! THE GODSON EQUATION AND AN APPROXIMATION TO THE LADENBERG-REICHE
! FUNCTION AS RECOMMENDED BY BROSMER AND TIEN (JQSRT 33,P 521), EQ. 2, PAGE 523 
! THIS ASSUMES THE ELSASSER MODEL
! THE ERROR FUNCTION IS FOUND FROM ITS SERIES EXPANSION.
! 

X_COLLISION = SQRT(4.0_EB*A_COLLISION)*XSTAR/SQRT(16.0_EB/PI*A_COLLISION+XSTAR)

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_ELSASSER = X_COLLISION
ELSE
    SPECTRAL_ABSORPTIVITY = X_COLLISION
    XX  = .5_EB*SQRTPI*X_COLLISION

    IF(XX<=3._EB) THEN
        ENN = 1._EB
        DO N = 1,30
            ENN = ENN*REAL(N,EB)  ! ENN = N!
            MM  = 2*N+1
            ARG = 1.128379_EB*(-1._EB)**N*((.88622693_EB*X_COLLISION)**MM)/(REAL(MM,EB)*ENN)
! THIS CORRESPONDS TO ERR(SQRT(PI)/2*X_COLLISION) = ERR(XX)
            ARGNEW=ARG+SPECTRAL_ABSORPTIVITY
! IF(ABS(ARG/ARGNEW)<.000001)N=30
            SPECTRAL_ABSORPTIVITY=ARGNEW
        ENDDO

    ELSE
        SPECTRAL_ABSORPTIVITY=1._EB-DEXP(-XX**2)/(SQRTPI*XX)
    ENDIF

    IF (SPECTRAL_ABSORPTIVITY>=1._EB) SPECTRAL_ABSORPTIVITY=.9999999_EB
! GET METHANE OPTICAL DEPTH
! BROSMER AND TIEN ASSUME SPECTRAL_ABSORPTIVITY = ERF(0.5*SQRTPI*X_STAR)
 
    X_ELSASSER=-DLOG(1.0_EB-SPECTRAL_ABSORPTIVITY)
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION ELSASSER

!==============================================================================
SUBROUTINE CO2(OMEGA,TEMP,GC1,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER I,J,K,L
REAL(EB) OMEGA,TEMP,GC1,SDWEAK,GDINV,GDDINV,AA,BB,CC,QQ,EE,FF,GG, &
         SMINUS,SPLUS,SDSTRG,GD,OM1,OM2,OM3,T0,Q2,BE,COM1, &
         COM2,COM3,X13,X23,X33,XBAR,OM12,ALPHA,OMPRIM,V3,GAM, &
         OMVV3,DELTA,V,OMVBAR,F1,F2,UNFLO1,UNFLO2,UNFLO3,TEST, &
         VBAR1,OMA,OMB,TTEMP,TT,T1,TW,WW,TEMP1,TEMP2,TEMP3,WM, &
         DINV,A,B,D,G,W1,DINV1,DINV2,DINV3,Q2OT,T0OT,Q2OT0

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CO2 

IF(OMEGA>5725._EB) THEN
   SDWEAK = 0._EB
   GDINV  = 1._EB
   GDDINV = 1._EB
ELSE
   WM = 44._EB
! COMPUTE DOPPLER BROADENING HALF-WIDTHS SP-3080 EQ: 5-35
   GD = 5.94E-6_EB*OMEGA*SQRT(TEMP/(273._EB*WM))

   IF(OMEGA>4550._EB) THEN
! CONTRIBUTION TO 2.0 MICRON BAND FROM:
! (000)-(041)
! (000)-(121),
! (000)-(201) TRANSITIONS.

      OM1 = 1354.91_EB ! (100)
      OM2 = 673.0_EB   ! (010)
      OM3 = 2396.49_EB ! (001)

! BAND CENTER 

      BCNT(1) = 4860.5_EB ! (000)-(041)
      BCNT(2) = 4983.5_EB ! (000)-(121)
      BCNT(3) = 5109.0_EB ! (000)-(201)

      T0   = 300._EB
      Q2   = 1.4388_EB
      T0OT = T0/TEMP
      Q2OT = -Q2/TEMP

      BE   = 0.391635_EB ! ROTATIONAL CONSTANT

! COMPUTE THE ASSOCIATED TRANSITION WAVENUMBERS

      COM1 = 4._EB*OM2+OM3      ! (000)-(041)
      COM2 = OM1+2._EB*OM2+OM3  ! (000)-(121)
      COM3 = 2._EB*OM1+OM3      ! (000)-(201)


! COMPUTE THE INTEGRATED INTENSITY OF THE BAND
! 0.272: INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(1) = 4860.5_EB ((041)-(000)) AT T=300K
! 1.01 : INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(2) = 4983.5_EB ((121)-(000)) AT T=300K
! 0.426: INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(3) = 5109  _EB ((201)-(000)) AT T=300K
! VALUES FROM PENNER AND VARANASI JQSRT VOL 4 pp 799-806


      ATOT(1) = 0.272_EB*T0OT*(1._EB-EXP(Q2OT*COM1))/(1._EB-EXP(Q2OT*OM2))**4/(1._EB-EXP(Q2OT*OM3))
!  NOTE: [(1._EB-EXP(Q2OT*OM2))**4*(1._EB-EXP(Q2OT*OM3))] IS THE ROVIBRATIONAL PARTITION FUNCTION
!  EQ 2 IN PENNER AND VARANASI JQSRT VOL 4 pp 799-806

      ATOT(2) = 1.01_EB*T0OT*(1._EB-EXP(Q2OT*COM2))/(1._EB-EXP(Q2OT*OM1))/(1._EB-EXP(Q2OT*OM2))**2/ &
              (1._EB-EXP(Q2OT*OM3))

      ATOT(3) = 0.426_EB*T0OT*(1._EB-EXP(Q2OT*COM3))/(1._EB-EXP(Q2OT*OM1))**2/(1._EB-EXP(Q2OT*OM3))

      SDWEAK  = 0.0_EB

! COMPUTE THE LINE STRENGTH USING EQ 11-44 FROM PENNER IN QUANTITATIVE MOLECULAR SPECTROMETRY, 1955
! SDWEAK = SUM(ATOT*PROPABILITY) 
! JUST OVERLAPPING SPECTRAL LINE
      DO K=1,3
         SDWEAK = SDWEAK+ATOT(K)*(-Q2OT)/(4._EB*BE)*ABS(OMEGA-BCNT(K))*EXP(Q2OT/(4._EB*BE)*(OMEGA-BCNT(K))**2)
      ENDDO

      DINV   = 1._EB/(4._EB*BE)
      GDINV  = GC1*DINV
      GDDINV = GD*DINV
!***EXPRESS S/D AT STP, AS IS IN NASA SP-3080
      SDWEAK=SDWEAK*TEMP/273._EB
   ELSEIF((OMEGA<=4550._EB).AND.(OMEGA>3800._EB)) THEN
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
   ELSEIF((OMEGA<=3800._EB).AND.(OMEGA>3050._EB)) THEN
      B=.391635_EB
      A=.0030875_EB
      X13=-19.37_EB
      X23=-12.53_EB
      X33=-12.63_EB
      OM1=1354.91_EB
      OM2=673._EB
      OM3=2396.49_EB
      T0=300._EB
      T0OT = T0/TEMP
      Q2=1.4388_EB
      Q2OT = -Q2/TEMP
      Q2OT0 = -Q2/T0
      XBAR=.5_EB*(.5_EB*X13+X23)
      OM12=.5_EB*(.5_EB*OM1+OM2)
      SDWEAK=0._EB
      SDSTRG=0._EB
      IF(OMEGA<=2395._EB) THEN
         ALPHA=2700._EB
         OMPRIM=OM3
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(OM3*Q2OT0))*(1._EB-EXP(OM12*Q2OT0))**3*(1._EB+EXP(OM12*Q2OT0))*(1._EB-EXP(OMPRIM*Q2OT0)))
         BB=(1._EB-EXP(Q2OT*OMEGA))*(1._EB-EXP(Q2OT*OM3))*(1._EB-EXP(OM12*Q2OT))**3*(1._EB+EXP(OM12*Q2OT)) &
           *(1._EB-EXP(Q2OT*OMPRIM))
         CC=AA*BB*OMEGA*T0/TEMP**2
         L202: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            L201: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1._EB)*G*EXP(-(V3*OM3+V*OM12)*Q2OT)
               GAM=B-A*(V3+1._EB)
               OMVV3=OM3+.5_EB*X13+X23+2._EB*X33+XBAR*V+2._EB*X33*V3
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L202
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2OT))
               F1=GAM-D/2
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78.) CYCLE L202
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78.) CYCLE L202
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78.) THEN
                  SPLUS=0.
               ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
               ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001) CYCLE L202
               SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L201
         ENDDO L202
         IF(SDWEAK<=TWO_EPSILON_EB) THEN
            SDWEAK=0._EB
            GDINV=1._EB
            GDDINV=1._EB
         ELSE
            DINV=SDSTRG*SDSTRG/SDWEAK
            GDINV=GC1*DINV
            GDDINV=GD*DINV
!***  EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
            SDWEAK=SDWEAK*TEMP/273.
         ENDIF
      ELSE
!CALCULATE ABSORPTION COEF. AND LINE SPACING PARAMETER FOR 2.7 MICRON BAND
         L=1
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(021) AND (010)-(031) TRANS.
         ALPHA=28.5_EB
         OMPRIM=2._EB*OM2+OM3
         L120: DO
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(OM3*Q2OT0))*(1._EB-EXP(OM12*Q2OT0))**3*(1._EB+EXP(OM12*Q2OT0))*(1._EB-EXP(OMPRIM*Q2OT0)))
         BB=(1._EB-EXP(Q2OT*OMEGA))*(1._EB-EXP(Q2OT*OM3))* (1._EB-EXP(OM12*Q2OT))**3*(1._EB+EXP(OM12*Q2OT)) &
           *(1._EB-EXP(Q2OT*OMPRIM))
         CC=AA*BB*OMEGA*T0/TEMP**2
         L102: DO J=1,20
         V=FLOAT(J-1)
         IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
         IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
         VBAR1=-1._EB+(V+3._EB)*(V+4._EB)/(V+2.)/6._EB
         IF(J/2*2==J)VBAR1=-1._EB+(V+5._EB)/6._EB
         L101: DO K=1,10
         V3=FLOAT(K-1)
         QQ=(V3+1)*G*EXP((V3*OM3+V*OM12)*Q2OT)*(VBAR1+1._EB)
         GAM=B-A*(V3+1._EB)
         IF(L==2) THEN
            OMVV3=3728._EB-5._EB*V-47._EB*V3
            IF(V<=TWO_EPSILON_EB) OMVV3=3715._EB-47._EB*V3
         ELSE
            OMVV3=3598._EB-18._EB*V-47._EB*V3
            IF(V<=TWO_EPSILON_EB) OMVV3=3613._EB-47._EB*V3
         ENDIF
         DELTA=A*(OMEGA-OMVV3)
         IF(GAM*GAM<=DELTA) CYCLE L102
         D=2._EB*SQRT(GAM*GAM-DELTA)
         OMVBAR=OMVV3*(1._EB-EXP(OMVV3*Q2OT))
         F1=GAM-D/2._EB
         F2=GAM+D/2._EB
         EE=Q2*GAM/(A*A*TEMP)
         UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
         IF(UNFLO1<=-78._EB) CYCLE L102
         UNFLO2=EE*2._EB*GAM*F1
         IF(UNFLO2>=78._EB) CYCLE L102
         FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
         SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
         UNFLO3=EE*2._EB*GAM*F2
         IF(UNFLO3>=78._EB) THEN
            SPLUS=0._EB
         ELSE
            SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
         ENDIF
         GG=SDWEAK
         SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
         TEST=(SDWEAK-GG)/SDWEAK
         IF(TEST<.0001_EB) CYCLE L102
         SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
         ENDDO L101
         ENDDO L102
         IF(L==2) EXIT L120
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(101) AND (010)-(111) TRANS.
         ALPHA=42.3_EB
         OMPRIM=OM1+OM3
         L=2
      ENDDO L120
!CALCULATE ABSORPTION COEF AND LINE SPACING PARAMETER FOR 4.3 MICRON BAND
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
      ELSE
         DINV=SDSTRG*SDSTRG/SDWEAK
         GDINV=GC1*DINV
         GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
         SDWEAK=SDWEAK*TEMP/273.
      ENDIF
   ENDIF
ELSEIF((OMEGA<=3050._EB).AND.(OMEGA>2474.)) THEN
   SDWEAK=0._EB
   GDINV=1._EB
   GDDINV=1._EB
ELSEIF((OMEGA<=2474.).AND.(OMEGA>1975.)) THEN
   B=.391635_EB
   A=.0030875_EB
   X13=-19.37_EB
   X23=-12.53_EB
   X33=-12.63_EB
   OM1=1354.91_EB
   OM2=673._EB
   OM3=2396.49_EB
   T0=300._EB
   Q2=1.4388_EB
   XBAR=.5_EB*(.5_EB*X13+X23)
   OM12=.5_EB*(.5_EB*OM1+OM2)
   SDWEAK=0._EB
   SDSTRG=0._EB
   IF(OMEGA<=2395._EB) THEN
         ALPHA=2700._EB
         OMPRIM=OM3
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(-OM3*Q2/T0))*(1._EB-EXP(-OM12*Q2 /T0))**3*(1._EB+EXP(-OM12*Q2/T0))*(1._EB-EXP(-OMPRIM*Q2/T0)))
         BB=(1._EB-EXP(-Q2*OMEGA/TEMP))*(1._EB-EXP(-Q2*OM3/TEMP))*(1._EB-EXP(-OM12*Q2/TEMP))**3*(1._EB+EXP(-OM12*Q2/TEMP)) &
           *(1._EB-EXP(-Q2*OMPRIM/TEMP))
         CC=AA*BB*OMEGA/TEMP*T0/TEMP
         L202A: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            L201A: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1._EB)*G*EXP(-(V3*OM3+V*OM12)*Q2/TEMP)
               GAM=B-A*(V3+1._EB)
               OMVV3=OM3+.5_EB*X13+X23+2._EB*X33+XBAR*V+2._EB*X33*V3
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L202A
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2/TEMP))
               F1=GAM-D/2._EB
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78.) CYCLE L202A
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78.) CYCLE L202A
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78._EB) THEN
                  SPLUS=0._EB
                  ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
                  ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001_EB) CYCLE L202A
               SDSTRG=SQRT(0.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L201A
         ENDDO L202A
         IF(SDWEAK<=TWO_EPSILON_EB) THEN
            SDWEAK=0._EB
            GDINV=1._EB
            GDDINV=1._EB
         ELSE
            DINV=SDSTRG*SDSTRG/SDWEAK
            GDINV=GC1*DINV
            GDDINV=GD*DINV
!***  EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
            SDWEAK=SDWEAK*TEMP/273._EB
         ENDIF
      ELSE
!CALCULATE ABSORPTION COEF. AND LINE SPACING PARAMETER FOR 2.7 MICRON BAND
         L=1
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(021) AND (010)-(031) TRANS.
         ALPHA=28.5_EB
         OMPRIM=2._EB*OM2+OM3
         L120A: DO
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(-OM3*Q2/T0))*(1._EB-EXP(-OM12*Q2 /T0))**3*(1._EB+EXP(-OM12*Q2/T0))*(1._EB-EXP(-OMPRIM*Q2/T0)))
         BB=(1._EB-EXP(-Q2*OMEGA/TEMP))*(1._EB-EXP(-Q2*OM3/TEMP))* (1._EB-EXP(-OM12*Q2/TEMP))**3*(1._EB+EXP(-OM12*Q2/TEMP)) &
           *(1._EB-EXP(-Q2*OMPRIM/TEMP))
         CC=AA*BB*OMEGA/TEMP*T0/TEMP
         L102A: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            VBAR1=-1._EB+(V+3._EB)*(V+4._EB)/(V+2._EB)/6._EB
            IF(J/2*2==J)VBAR1=-1._EB+(V+5._EB)/6._EB
            L101A: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1)*G*EXP(-(V3*OM3+V*OM12)*Q2/TEMP)*(VBAR1+1._EB)
               GAM=B-A*(V3+1._EB)
               IF(L==2) THEN
                  OMVV3=3728._EB-5._EB*V-47._EB*V3
                  IF(V<=TWO_EPSILON_EB)OMVV3=3715._EB-47._EB*V3
                  ELSE
                  OMVV3=3598._EB-18._EB*V-47._EB*V3
                  IF(V<=TWO_EPSILON_EB)OMVV3=3613._EB-47._EB*V3
               ENDIF
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L102A
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2/TEMP))
               F1=GAM-D/2._EB
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78._EB) CYCLE L102A
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78._EB) CYCLE L102A
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78._EB) THEN
                  SPLUS=0._EB
                  ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
               ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001) CYCLE L102A
               SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L101A
         ENDDO L102A
         IF(L==2) EXIT L120A
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(101) AND (010)-(111) TRANS.
         ALPHA=42.3_EB
         OMPRIM=OM1+OM3
         L=2
      ENDDO L120A
!CALCULATE ABSORPTION COEF AND LINE SPACING PARAMETER FOR 4.3 MICRON BAND
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
         ELSE
         DINV=SDSTRG*SDSTRG/SDWEAK
         GDINV=GC1*DINV
         GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
         SDWEAK=SDWEAK*TEMP/273._EB
         ENDIF
      ENDIF
   ELSEIF((OMEGA<=1975._EB).AND.(OMEGA>1100._EB)) THEN
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
   ELSEIF((OMEGA<=1100._EB).AND.(OMEGA>880._EB)) THEN
!CONTRIBUTION TO 10.0 MICRON BAND FROM (100)-(001) AND (020)-(001) TRANS.
      OM1=1354.91_EB
      OM2=673._EB
      OM3=2396.49_EB
      Q2=1.4388_EB
      BCNT(1)=960.8_EB
      BCNT(2)=1063.6_EB
      OMA=OM3
      OMB=(OM1+2._EB*OM2)/2._EB
      T0=300._EB
      ATOT(1)=0.0219_EB
      ATOT(2)=0.0532_EB
      BE=0.391635_EB
      DO K=1,2
         ATOT(K)=T0/TEMP*ATOT(K)*EXP(Q2*OMB*(1._EB/T0-1._EB/TEMP)) *(1._EB-EXP(-Q2*(OMA-OMB)/TEMP))/(1._EB-EXP(-Q2*OMA/TEMP)) &
                   /(1._EB-EXP(-OMB*Q2/TEMP))
      ENDDO
      SDWEAK=0._EB
      DO I=1,2
         SDWEAK=SDWEAK+ATOT(I)*Q2/(4._EB*BE*TEMP)*ABS(OMEGA-BCNT(I))  *EXP(-Q2/(4._EB*BE*TEMP)*(OMEGA-BCNT(I))**2)
      ENDDO
      DINV=1._EB/4._EB/BE
      GDINV=GC1*DINV
      GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS IN NASA SP-3080
      SDWEAK=SDWEAK*TEMP/273.
   ELSEIF((OMEGA<=880._EB).AND.(OMEGA>500._EB))  THEN
!CONTRIBUTION TO 15.0 MICRON BAND FROM (000)-(010) TRANS.
      TTEMP=TEMP
      J=(OMEGA-495._EB)/5._EB
      W1=495._EB+5._EB*REAL(J,EB)
      WW=(OMEGA-W1)/5
      IF(TEMP>=2400._EB) TEMP = 2399.99_EB
      IF(TEMP < 300._EB) TEMP =  300.00_EB
      I = TEMP/300._EB
      SELECT CASE(I)
         CASE(3)
            I=2
            TT=(TEMP-600._EB)/600._EB
         CASE(6:7) 
            I=5
            TT=(TEMP-1800._EB)/600._EB
         CASE DEFAULT
            T1=REAL(I,EB)*300._EB
            TT=(TEMP-T1)/300._EB
            IF (I>=4) I=I-1     
      END SELECT
      TW=TT*WW
      SDWEAK=SD15(I,J)*(1._EB-TT-WW+TW)+SD15(I+1,J)*(TT-TW)  +SD15(I,J+1)*(WW-TW)+SD15(I+1,J+1)*TW
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
         ELSE
!CALCULATE LINE SPACING PARAMETER FOR 15.0 MICRON BAND
         DINV1=1.2_EB
         DINV2=8.0_EB
         DINV3=30.0_EB
         TEMP1=300.0_EB
         TEMP2=550.0_EB
         TEMP3=830.0_EB
         DINV=DINV1*(TEMP-TEMP2)*(TEMP-TEMP3)/(TEMP1-TEMP2)  /(TEMP1-TEMP3)+DINV2*(TEMP-TEMP1)*(TEMP-TEMP3)&
                  /(TEMP2-TEMP1)/(TEMP2-TEMP3)+DINV3*(TEMP-TEMP1)  *(TEMP-TEMP2)/(TEMP3-TEMP1)/(TEMP3-TEMP2)
         GDINV=GC1*DINV
         GDDINV=GD*DINV
         ENDIF
         TEMP = TTEMP  ! Line added by Jason Floyd, Aug 30, 2002
   ELSE
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
      ENDIF
   ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CO2

!==============================================================================
SUBROUTINE H2O(OMEGA,TEMP,GC2,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER, INTENT(OUT) :: I_MODEL

INTEGER I,J
REAL(EB) OMEGA,TEMP,GC2,SDWEAK,GDINV,GDDINV,WM,W1,WW,T1,TT,TW, D,B,DINV,TTEMP,GD

I_MODEL = I_MODEL_H2O

IF (OMEGA>=9300..OR.OMEGA<50._EB) THEN
   SDWEAK=0._EB
   GDINV=1._EB
   GDDINV=1._EB
ELSE
   WM   = 18._EB
   GD   = 5.94E-6_EB*OMEGA*SQRT(TEMP/(273._EB*WM))
   J    = (OMEGA-25._EB)/25._EB
   TTEMP= TEMP

   IF(TEMP>=2500._EB) TEMP = 2499.99_EB
   IF(TEMP<300._EB)   TEMP = 300._EB

   I = TEMP/500._EB +1

   IF(I==2.AND.TEMP<600._EB) I=1

   W1 = 25._EB+25._EB*FLOAT(J)
   WW = (OMEGA-W1)/25._EB

   IF(I>2) THEN
      T1=FLOAT(I-1)*500._EB
      TT=(TEMP-T1)/500._EB
   ELSE
      IF(I==1) TT=(TEMP-300._EB)/300._EB
      IF(I==2) TT=(TEMP-600._EB)/400._EB
   ENDIF

   TW     = TT*WW
   SDWEAK = SD(I,J)*(1._EB-TT-WW+TW)+SD(I+1,J)*(TT-TW)+SD(I,J+1) *(WW-TW)+SD(I+1,J+1)*TW
   D      = -2.294_EB+.3004E-02_EB*TEMP-.366E-06_EB*TEMP**2
   B      = SIN(.0036_EB*OMEGA-8.043_EB)
   DINV   = EXP(.7941_EB*B+D)
!     DINV=EXP(0.00106*TEMP-1.21)
   GDINV  = GC2*DINV
   GDDINV = GD*DINV
   TEMP   = TTEMP
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE H2O


!==============================================================================
SUBROUTINE CO(OMEGA,TEMP,GC4,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER J
REAL(EB) OMEGA,TEMP,GC4,SDWEAK,GDINV,GDDINV,AA,BB,CC,QQ,EE,FF,GG, &
         SMINUS,SPLUS,SDSTRG,B,ALPHA,A,OME,WX,WY,OMPRIM,T0, &
         Q2,WM,GD,V,GAM,OMV,DELTA,D,OMVBAR,F1,F2,TEST,DINV,Q2OT,TOAZ

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CO

IF(OMEGA<1600._EB .OR. OMEGA>2400._EB) THEN
   SDWEAK = 0._EB
   GDINV  = 1._EB
   GDDINV = 1._EB
ELSE
   B     = 1.93139_EB
   ALPHA = 260._EB
   A     = .017485_EB
   OME   = 2170.21_EB
   WX    = 13.461_EB
   WY    = .0308_EB
   OMPRIM= OME-2._EB*WX+3.25_EB*WY

   T0 = 300._EB
   Q2 = 1.4388_EB

   TOAZ = TEMP/273._EB
   Q2OT = Q2/TEMP

   WM     = 28._EB
! DOPPLER BROADENING HALF-WIDTH
   GD     = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM)
   SDWEAK = 1.E-99_EB
   SDSTRG = 1.E-99_EB

   AA = ALPHA*B*Q2/(A*(1._EB-EXP(-OMPRIM*Q2/T0))**2)
   BB = (1._EB-EXP(-OMEGA*Q2OT))*(1._EB-EXP(-OMPRIM*Q2OT))**2
   CC = AA*BB*OMEGA*T0/TEMP**2

   L101: DO J=1,20
      V    = FLOAT(J-1)
      QQ   = (V+1._EB)*EXP(-V*OME*Q2OT)
      GAM  = B-A*(V+1._EB)
      OMV  = OME-2._EB*(V+1._EB)*WX+(3._EB*(V+1._EB)*(V+1._EB)+.25_EB)*WY
      DELTA= A*(OMEGA-OMV)

      IF(GAM**2<=DELTA) EXIT L101

      D      = 2._EB*SQRT(GAM*GAM-DELTA)
      OMVBAR = OMV*(1._EB-EXP(-OMV*Q2OT))
      F1     = GAM-0.5_EB*D
      F2     = GAM+0.5_EB*D
      EE     = Q2*GAM/(A*A*TEMP)
      
      FF     = EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
      SMINUS = CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
      SPLUS  = CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
      GG     = SDWEAK
      SDWEAK = (SMINUS+SPLUS)/D+SDWEAK
      TEST   = (SDWEAK-GG)/SDWEAK
      
      IF(TEST<.0001_EB) EXIT L101

      SDSTRG=(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
   ENDDO L101

   DINV   = SDSTRG*SDSTRG/SDWEAK
   GDINV  = GC4*DINV
   GDDINV = GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CO


!==============================================================================
SUBROUTINE POD(OMEGA,X_PARTICLE)
!==============================================================================
! POD CALCULATES PARTICLE OPTICAL DEPTH, X_PARTICLE, OF THE VOLUME FRACTION OF 
! SOOT PARTICLES IN GAS CLOUD.  
! RIN AND RIK ARE THE REAL AND IMAGINARY PARTS OF THE INDEX OF REFRACTION.
! THE PARTICLES ARE ASSUMED TO BE IN THE RAYLEIGH LIMIT.
! VARIABLES PASSED IN:

REAL(EB), INTENT(IN) :: OMEGA

! VARIBLES PASSED OUT: X_PARTICLE: PARTICLE OPTICAL DEPTH

REAL(EB), INTENT(OUT) :: X_PARTICLE

! LOCALS

REAL(EB) ABCO,FF_FAC,FF,LAMBDA!,RIN,RIK

LAMBDA=10000._EB/OMEGA
 
! ABSORPTION COEF. IS BASED UPON MEASUREMENTS OF WIDMANN AND MULHOLLAND

IF (AL2O3) THEN
   IF (RCT > 2570._EB) THEN
      FF_FAC = 0.017_EB
   ELSEIF (RCT < 500._EB) THEN
      FF_FAC = 5.E-6_EB
   ELSE
      FF_FAC = 0.00073_EB     
   ENDIF
ELSE
   FF_FAC = 8.9_EB
ENDIF

FF         = FF_FAC/LAMBDA
ABCO       = FF*SVF*1.E6_EB
X_PARTICLE = ABCO*DD
!------------------------------------------------------------------------------
END SUBROUTINE POD


!==============================================================================
SUBROUTINE CH4_OLD(OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
INTEGER I,J
REAL(EB) OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,BE,Q2, &
      WM,GD,OM1,OM2,OM3,OM4,COM1,COM2,COM3,COM4,DINV,PE,W1,SDB, &
      SDA,SDC,Q2OT,AZOT,TOAZ

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CH4

IF(OMEGA>5000._EB .OR. OMEGA<1125._EB) THEN

   SDWEAK=0.0_EB
   GDINV=1._EB
   GDDINV=1._EB

ELSE

   BE=5.2412_EB
   Q2=1.4388_EB
   WM=16._EB
   Q2OT = -Q2/TEMP
   AZOT = 273._EB/TEMP
   TOAZ = TEMP/273._EB

   GD=5.94E-6_EB*OMEGA*SQRT(TOAZ)/4._EB

   IF(OMEGA>=3400._EB) THEN

! CONTRIBUTION TO 2.4 MICRON BAND FROM (0000)-(0110), (0000)-(0011),
! (0000)-(1001), AND (0000)-(0102) TRANS.  THE INTEGRATED BAND INTENSITIES
! OF VINCENT-GEISSE (ANNALES DE PHYSIQUE SER.12, V. 10, 1955) HAVE
! BEEN MULTIPLIED BY A FACTOR OF 4 AND THE LINE SPACING IS THAT
! OF V4 FROM GRAY AND PENNER (JQSRT V. 5, 1965).

      OM1=2914.2_EB
      OM2=1526.0_EB
      OM3=3020.3_EB
      OM4=1306.2_EB

      BCNT(1)=4123.0_EB
      BCNT(2)=4216.3_EB
      BCNT(3)=4313.2_EB
      BCNT(4)=4546.0_EB

      COM1=OM2+2._EB*OM4
      COM2=OM1+OM4
      COM3=OM3+OM4
      COM4=OM2+OM3

      ATOT(1)=0.64_EB*AZOT*(1._EB-EXP(Q2OT*COM1))/((1._EB-EXP(Q2OT*OM2))*(1._EB-EXP(Q2OT*OM4))**2)
      ATOT(2)=17.6_EB*AZOT*(1._EB-EXP(Q2OT*COM2))/((1._EB-EXP(Q2OT*OM1))*(1._EB-EXP(Q2OT*OM4)))
      ATOT(3)=14.8_EB*AZOT*(1._EB-EXP(Q2OT*COM3))/((1._EB-EXP(Q2OT*OM3))*(1._EB-EXP(Q2OT*OM4)))
      ATOT(4)=5.04_EB*AZOT*(1._EB-EXP(Q2OT*COM4))/((1._EB-EXP(Q2OT*OM2))*(1._EB-EXP(Q2OT*OM3)))

      DINV=1._EB/5.74_EB
      GDINV=GC3*DINV
      GDDINV=GD*DINV
      SDWEAK=0.0_EB

      DO I=1,4
         SDWEAK=SDWEAK+2._EB*(OMEGA-BCNT(I))**2*(-Q2OT*BE)*SQRT(-Q2OT*BE)*ATOT(I)/SQRTPI*DINV**3*EXP(Q2OT*BE*DINV**2 &
         *(OMEGA-BCNT(I))**2)
      ENDDO
      SDWEAK=SDWEAK*TOAZ
   ELSE
      PE=PTOT+.3_EB*PCH4

      IF(OMEGA>=2625._EB) THEN
! CONTRIBUTION TO 3.3 MICRON BAND FROM (0000)-(0010) TRANS.
! REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521

         GDINV  = .00734_EB*PE*SQRT(AZOT)*EXP(1.02_EB*(TOAZ-1._EB))
         GDDINV = GD/9.4_EB

         J  = (OMEGA-2600._EB)/25._EB
         W1 = 2600._EB+25._EB*FLOAT(J)
         SDB= SD3(2,J)+(OMEGA-W1)/25._EB*(SD3(2,J+1)-SD3(2,J))

         IF(TEMP>600._EB) THEN
            SDC=SD3(3,J)+(OMEGA-W1)/25._EB*(SD3(3,J+1)-SD3(3,J))
            SDWEAK=SDB+(TEMP-600._EB)/250._EB*(SDC-SDB)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ELSE
            SDA=SD3(1,J)+(OMEGA-W1)/25._EB*(SD3(1,J+1)-SD3(1,J))
            SDWEAK=SDA+(TEMP-290._EB)/310._EB*(SDB-SDA)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ENDIF

      ELSEIF(OMEGA>1450._EB) THEN

         SDWEAK=0.0_EB
         GDINV=1._EB
         GDDINV=1._EB

      ELSE
! CONTRIBUTION TO 7.7 MICRON BAND FROM (0000)-(0001) TRANS.
! REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521.
         GDINV  = .0243_EB*PE*(TOAZ)**.8_EB
         GDDINV = GD/5.1_EB

         J   = (OMEGA-1100._EB)/25._EB
         W1  = 1100._EB+25._EB*FLOAT(J)
         SDB = SD7(2,J)+(OMEGA-W1)/25._EB*(SD7(2,J+1)-SD7(2,J))

         IF(TEMP>600._EB) THEN
            SDC = SD7(3,J)+(OMEGA-W1)/25._EB*(SD7(3,J+1)-SD7(3,J))
            SDWEAK = SDB+(TEMP-600._EB)/250._EB*(SDC-SDB)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ELSE
            SDA = SD7(1,J)+(OMEGA-W1)/25._EB*(SD7(1,J+1)-SD7(1,J))
            SDWEAK = SDA+(TEMP-290._EB)/310._EB*(SDB-SDA)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ENDIF
      ENDIF
   ENDIF
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CH4_OLD


!==============================================================================
SUBROUTINE CH4(OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE METHANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
!
! BAND #1: 1150 cm-1 - 1600 cm-1 
! BAND #2: 2700 cm-1 - 3250 cm-1 
! BAND #3: 3400 cm-1 - 5000 cm-1
! 
! VARIABLES PASSED IN
! OMEGA: (REAL) WAVENUMBER IN CM-1
! TEMP : (REAL) TEMPERATURE IN K
! PCH4 : (REAL) PARTIAL PRESSURE OF METHANE IN ATM
! PTOT : (REAL) TOTAL PRESSURE IN ATM
! GC3  : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! BE_CH4             : (REAL) ROTATIONAL CONSTANT FOR CH4 [CM^-1]
! DINV_CH4           : INVERSE LINE SPACING [CM]

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PCH4, PTOT, GC3
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT)  :: I_MODEL

REAL(EB) :: GD, PRESSURE_EFFECTIVE, Q2OT, AZOT, TOAZ, FACT1
REAL(EB) :: DINV_CH4

REAL(EB), PARAMETER :: Q2     = 1.4388_EB ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_CH4 = 16.0425_EB

!LINE SPACING D2_CH4=5.74 CM^-1 FOR THE V4 FUNDAMENTAL OF METHANE GRAY & PENNER,612
!FOOTNOTE AT BOTTOM
REAL(EB), PARAMETER :: BE_CH4 = 5.248_EB   ! ROTATIONAL CONSTANTS [CM^-1]

REAL(EB), DIMENSION(4), PARAMETER :: &
                 OM_CH4  = (/2914.2_EB, 1526.0_EB, 3020.3_EB, 1306.2_EB/),                                               &
                 COM_CH4 = (/1526.0_EB+2._EB*1306.2_EB, 2914.2_EB+1306.2_EB, 3020.3_EB+1306.2_EB, 1526.0_EB+3020.3_EB/), &
                 S2_CH4  = (/0.64_EB,17.6_EB,14.8_EB,5.04_EB/)

INTEGER I

I_MODEL = I_MODEL_CH4

! INITIALIZE OUTPUT

SDWEAK = 0.0_EB  !SPECTRAL ABSORPTION COEFFICIENT. 
GDINV  = 1._EB   !LINE WIDTH TO LINE SPACING RATIO: FINE STRUCTURE PARAMETER
GDDINV = 1._EB   !LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING FINE STRUCTURE PARAMETER

! INITIALIZE SOME COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPLLER HALF-WIDTH. EQ 5-35
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_CH4) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE EFFECTIVE PRESSURE. BROSMER & TIEN,524 EQ. 7 (SPECIFIC TO METHANE)
PRESSURE_EFFECTIVE = PTOT+.3_EB*PCH4

!------------------------------------------------------------------------------
! COMPUTED PROPERTIES 2.4 MICRON BAND, BAND #3: 3400 cm-1 - 5000 cm-1
IF((OM_BND_CH4(N_BAND_CH4,1)<=OMEGA).AND.(OMEGA<=OM_BND_CH4(N_BAND_CH4,2))) THEN

! CONTRIBUTION OF THE V1+V4 COMBINAISON BAND (2.4 MICRON)
! CONTRIBUTION TO 2.4 MICRON BAND FROM
! (0000)-(0102)
! (0000)-(1001)
! (0000)-(0011)
! (0000)-(0110) TRANSITIONS
! THE INTEGRATED BAND INTENSITIES (S2_CH4)
! OF VINCENT-GEISSE (ANNALES DE PHYSIQUE SER.12, V. 10, 1955) HAVE
! BEEN MULTIPLIED BY A FACTOR OF 4 
! THE LINE SPACING (1/DINV_CH4) IS THAT
! OF V4 FROM GRAY AND PENNER (JQSRT V. 5, 1965).                 

   ATOT(1) = S2_CH4(1)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(1)))/((1._EB-EXP(Q2OT*OM_CH4(2)))*(1._EB-EXP(Q2OT*OM_CH4(4)))**2)
   ATOT(2) = S2_CH4(2)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(2)))/((1._EB-EXP(Q2OT*OM_CH4(1)))*(1._EB-EXP(Q2OT*OM_CH4(4))))
   ATOT(3) = S2_CH4(3)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(3)))/((1._EB-EXP(Q2OT*OM_CH4(3)))*(1._EB-EXP(Q2OT*OM_CH4(4))))
   ATOT(4) = S2_CH4(4)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(4)))/((1._EB-EXP(Q2OT*OM_CH4(2)))*(1._EB-EXP(Q2OT*OM_CH4(3))))

   DINV_CH4 = 1._EB/5.74_EB
   FACT1  = Q2OT*BE_CH4*DINV_CH4**2

   DO I=1,4
      SDWEAK = SDWEAK+(OMEGA-COM_CH4(I))**2*ATOT(I)*EXP(FACT1*(OMEGA-COM_CH4(I))**2)
   ENDDO

! EQ 6 IN GRAY AND PENNER JQSRT, VOL 5, PAGE 611-620, 1965
   SDWEAK=SDWEAK*2._EB*(-Q2OT*BE_CH4)*SQRT(-Q2OT*BE_CH4)/SQRTPI*DINV_CH4**3

!***EXPRESS S/D AT STANDARD TEMPERATURE AND PRESSURE, AS IS IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
   GDINV  = GC3*DINV_CH4
   GDDINV = GD*DINV_CH4 

!------------------------------------------------------------------------------
! TABULATED PROPERTIES
ELSE IF((OM_BND_CH4(2,1)<=OMEGA).AND.(OMEGA<OM_BND_CH4(2,2))) THEN
      
!------------------------------------------------------------------------------
! CONTRIBUTION TO 3.3 MICRON BAND, BAND #2: 2700 cm-1 - 3250 cm-1
! (0000)-(0010) TRANSITION (V3 FUNDAMENTAL)
! 9.4 IS THE AVERAGE LINE POSITION FOR THE 3.3 MICRON BAND (CM^-1)
! SOURCE: BROSMER & TIEN, JQSRT V. 33, P. 525 (SPECIFIC TO METHANE)

   DINV_CH4 = 1._EB/9.4_EB

   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH4_TEMP,OM_BND_CH4(2,:),SD2_CH4)
! LINE SHAPE PARAMETER BROSMER & TIEN, JQSRT V. 33, P. 525 EQ. 10 (SPECIFIC TO METHANE)
   GDINV  = .00734_EB*PRESSURE_EFFECTIVE*SQRT(AZOT)*EXP(1.02_EB*(TOAZ-1._EB)) 
   GDDINV = GD*DINV_CH4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ 
ELSE IF((OM_BND_CH4(1,1)<=OMEGA).AND.(OMEGA<OM_BND_CH4(1,2))) THEN
!------------------------------------------------------------------------------
! CONTRIBUTION TO 7.7 MICRON BAND, BAND #1: 1150 cm-1 - 1600 cm-1 
! (0000)-(0001) TRANSITION (V4 FUNDAMENTAL)
! 5.1 (CM-1) IS THE AVERAGE LINE POSITION FOR THE 7.7 MICRON BAND 
! SOURCE: BROSMER & TIEN, JQSRT V. 33, P. 525 (SPECIFIC TO METHANE)

   DINV_CH4 = 1._EB/5.1_EB

   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH4_TEMP,OM_BND_CH4(1,:),SD1_CH4)
! LINE SHAPE PARAMETER BROSMER & TIEN, JQSRT V. 33, 525 EQ. 11 (SPECIFIC TO METHANE)
   GDINV  = .0243_EB*PRESSURE_EFFECTIVE*(TOAZ)**.8_EB
   GDDINV = GD*DINV_CH4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ 
ENDIF 

!------------------------------------------------------------------------------
END SUBROUTINE CH4

!==============================================================================
SUBROUTINE C3H6(OMEGA,TEMP,PC3H6,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE PROPYLENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 3 BANDS FOR Propylene
!
! BAND #1: 1250 cm-1 - 1950 cm-1 
! BAND #2: 2700 cm-1 - 3200 cm-1 
! BAND #3: 700 cm-1 - 1150 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC3H6 : (REAL) PARTIAL PRESSURE OF PROPYLENE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C3H6         : INVERSE LINE SPACING [CM] FOR PROPYLENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC3H6, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C3H6 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C3H6  = 42.0797_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C3H6
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C3H6) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! MODEL PROPYLENE AS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! PROPYLENE BELONGS TO GROUP Cs
DINV_C3H6 = 1._EB/(2._EB*0.312_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! PROPYLENE HAS THREE BANDS
! BAND #1: 775 cm-1 - 1150 cm-1 
! BAND #2: 1225 cm-1 - 1975 cm-1 
! BAND #3: 2650 cm-1 - 3275 cm-1  

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C3H6
   IF ((OM_BND_C3H6(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C3H6(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C3H6(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 775 cm-1 - 1150 cm-1 
   KAPPA_D => SD1_C3H6
   GAMMA_D => GAMMAD1_C3H6
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1225 cm-1 - 1975 cm-1 
   KAPPA_D => SD2_C3H6
   GAMMA_D => GAMMAD2_C3H6
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2650 cm-1 - 3275 cm-1 
   KAPPA_D => SD3_C3H6
   GAMMA_D => GAMMAD3_C3H6
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C3H6(I_BAND)-1.0_EB)*PC3H6 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H6_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H6_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C3H6
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C3H6

!==============================================================================
SUBROUTINE C3H8(OMEGA,TEMP,PC3H8,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE PROPANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 2 BANDS FOR Propane

! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC3H8 : (REAL) PARTIAL PRESSURE OF PROPANE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C3H8         : INVERSE LINE SPACING [CM] FOR PROPANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC3H8, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C3H8 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C3H8  = 44.0956_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C3H8
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C3H8) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! PROPANE IS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! PROPANE BELONGS TO GROUP C2v
DINV_C3H8 = 1._EB/(2._EB*0.28173_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! PROPANE HAS THREE BANDS
! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C3H8
   IF ((OM_BND_C3H8(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C3H8(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C3H8(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 1175 cm-1 - 1675 cm-1 
   KAPPA_D => SD1_C3H8
   GAMMA_D => GAMMAD1_C3H8
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 2550 cm-1 - 3375 cm-1 
   KAPPA_D => SD2_C3H8
   GAMMA_D => GAMMAD2_C3H8
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C3H8(I_BAND)-1.0_EB)*PC3H8 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H8_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H8_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C3H8
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C3H8

!==============================================================================
SUBROUTINE C7H16(OMEGA,TEMP,PC7H16,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE HEPTANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 2 BANDS FOR HEPTANE

! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC7H16 : (REAL) PARTIAL PRESSURE OF HEPTANE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C7H16         : INVERSE LINE SPACING [CM] FOR HEPTANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC7H16, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C7H16 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C7H16 = 100.2019_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C7H16
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C7H16) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! n_HEPTANE IS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! n-Heptane BELONGS TO GROUP C2v
DINV_C7H16=1._EB/(2.0_EB*0.024_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! HEPTANE HAS THREE BANDS
! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C7H16
   IF ((OM_BND_C7H16(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C7H16(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C7H16(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 1175 cm-1 - 1675 cm-1 
   KAPPA_D => SD1_C7H16
   GAMMA_D => GAMMAD1_C7H16
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 2550 cm-1 - 3375 cm-1 
   KAPPA_D => SD2_C7H16
   GAMMA_D => GAMMAD2_C7H16
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C7H16(I_BAND)-1.0_EB)*PC7H16 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H16_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H16_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C7H16
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C7H16

!==============================================================================
SUBROUTINE C7H8(OMEGA,TEMP,PC7H8,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE TOLUENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 5 BANDS FOR TOLUENE

! BAND #1: 700 cm-1 - 825 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC7H8 : (REAL) PARTIAL PRESSURE OF TOLUENE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C7H8         : INVERSE LINE SPACING [CM] FOR TOLUENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC7H8, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C7H8 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C7H8  = 92.1384_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C7H8
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C7H8) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! TOLUENE BELONGS TO GROUP CS 
! TOLUENE IS MODEL AS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE.  USING EXPERIMENTAL VALUES  

DINV_C7H8=1._EB/(2.0_EB*0.084_EB)


! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! TOLUENE HAS 5 BANDS
! BAND #1: 700 cm-1 - 825 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C7H8
   IF ((OM_BND_C7H8(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C7H8(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C7H8(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 700 cm-1 - 825 cm-1 
   KAPPA_D => SD1_C7H8
   GAMMA_D => GAMMAD1_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 975 cm-1 - 1175 cm-1 
   KAPPA_D => SD2_C7H8
   GAMMA_D => GAMMAD2_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1275 cm-1 - 1675 cm-1 
   KAPPA_D => SD3_C7H8
   GAMMA_D => GAMMAD3_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 1650 cm-1 - 2075 cm-1 
   KAPPA_D => SD4_C7H8
   GAMMA_D => GAMMAD4_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==5)) THEN ! BAND #5: 2675 cm-1 - 3225 cm-1 
   KAPPA_D => SD5_C7H8
   GAMMA_D => GAMMAD5_C7H8
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C7H8(I_BAND)-1.0_EB)*PC7H8 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H8_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H8_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C7H8
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C7H8


!==============================================================================
SUBROUTINE CH3OH(OMEGA,TEMP,PCH3OH,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE Methanol OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 4 BANDS FOR Methanol

! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PCH3OH : (REAL) PARTIAL PRESSURE OF Methanol
! PTOT   : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_CH3OH         : INVERSE LINE SPACING [CM] FOR Methanol

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PCH3OH, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_CH3OH 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_CH3OH = 32.0419_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_CH3OH
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_CH3OH) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! Methanol Belongs to point group Cs. For now THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B SINCE ROTATIONAL_CONSTANT B ~ ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
DINV_CH3OH=1._EB/(2.0_EB*0.82338_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! Methanol HAS 4 BANDS
! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_CH3OH
   IF ((OM_BND_CH3OH(I,1)<=OMEGA).AND.(OMEGA<OM_BND_CH3OH(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_CH3OH(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 825 cm-1 - 1150 cm-1 
   KAPPA_D => SD1_CH3OH
   GAMMA_D => GAMMAD1_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1125 cm-1 - 1700 cm-1 
   KAPPA_D => SD2_CH3OH
   GAMMA_D => GAMMAD2_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2600 cm-1 - 3225 cm-1 
   KAPPA_D => SD3_CH3OH
   GAMMA_D => GAMMAD3_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 3525 cm-1 - 3850 cm-1 
   KAPPA_D => SD4_CH3OH
   GAMMA_D => GAMMAD4_CH3OH
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_CH3OH(I_BAND)-1.0_EB)*PCH3OH 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH3OH_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH3OH_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_CH3OH
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE CH3OH

!==============================================================================
SUBROUTINE C5H8O2(OMEGA,TEMP,PC5H8O2,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE MMA OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 6 BANDS FOR MMA
! BAND #1: 750 cm-1 - 900 cm-1 
! BAND #2: 875 cm-1 - 1075 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1
!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC5H8O2 : (REAL) PARTIAL PRESSURE OF MMA
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C5H8O2         : INVERSE LINE SPACING [CM] FOR MMA

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC5H8O2, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C5H8O2 

REAL(EB), PARAMETER :: Q2        = 1.4388_EB   ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C5H8O2 = 100.1158_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C5H8O2
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C5H8O2) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! MMA Belongs to point group ? FOR NOW USING DATA FROM Acetylacetone (C5H8O2)
DINV_C5H8O2=1._EB/(2.0_EB*0.067_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 6 BANDS FOR MMA
! BAND #1: 750 cm-1 - 900 cm-1 
! BAND #2: 875 cm-1 - 1075 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C5H8O2
   IF ((OM_BND_C5H8O2(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C5H8O2(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C5H8O2(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1: 750 cm-1 - 900 cm-1
   KAPPA_D => SD1_C5H8O2
   GAMMA_D => GAMMAD1_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 875 cm-1 - 1075 cm-1
   KAPPA_D => SD2_C5H8O2
   GAMMA_D => GAMMAD2_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1050 cm-1 - 1275 cm-1
   KAPPA_D => SD3_C5H8O2
   GAMMA_D => GAMMAD3_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 1250 cm-1 - 1575 cm-1 
   KAPPA_D => SD4_C5H8O2
   GAMMA_D => GAMMAD4_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==5)) THEN ! BAND #5: 1550 cm-1 - 1975 cm-1 
   KAPPA_D => SD5_C5H8O2
   GAMMA_D => GAMMAD5_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==6)) THEN ! BAND #6: 2650 cm-1 - 3275 cm-1 
   KAPPA_D => SD6_C5H8O2
   GAMMA_D => GAMMAD6_C5H8O2
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C5H8O2(I_BAND)-1.0_EB)*PC5H8O2 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C5H8O2_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C5H8O2_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C5H8O2
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C5H8O2

!==============================================================================
SUBROUTINE C2H6(OMEGA,TEMP,PC2H6,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE ETHANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 3 BANDS FOR Ethane
! BAND #1: 750 cm-1 - 1100 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC2H6   : (REAL) PARTIAL PRESSURE OF ETHANE
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C2H6         : INVERSE LINE SPACING [CM] FOR ETHANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC2H6, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C2H6 

REAL(EB), PARAMETER :: Q2      = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C2H6 = 30.0690_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C2H6
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C2H6) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! ETHANE Belongs to point group D3d with Rotational Constant A = 2.51967 cm-1
! B = 0.68341 cm-1, and C = 0.68341 cm-1.
DINV_C2H6=1._EB/(2.0_EB*0.68341_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 3 BANDS FOR Ethane
! BAND #1: 750 cm-1 - 1100 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C2H6
   IF ((OM_BND_C2H6(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C2H6(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C2H6(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1:  750 cm-1 - 1100 cm-1
   KAPPA_D => SD1_C2H6
   GAMMA_D => GAMMAD1_C2H6
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1250 cm-1 - 1700 cm-1 
   KAPPA_D => SD2_C2H6
   GAMMA_D => GAMMAD2_C2H6
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2550 cm-1 - 3375 cm-1
   KAPPA_D => SD3_C2H6
   GAMMA_D => GAMMAD3_C2H6
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C2H6(I_BAND)-1.0_EB)*PC2H6 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H6_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H6_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C2H6
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C2H6

!==============================================================================
SUBROUTINE C2H4(OMEGA,TEMP,PC2H4,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE ETHYLENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 4 BANDS FOR Ethylene
! BAND #1: 800 cm-1  - 1250 cm-1 
! BAND #2: 1325 cm-1 - 1575 cm-1 
! BAND #3: 1775 cm-1 - 2050 cm-1 
! BAND #4: 2825 cm-1 - 3350 cm-1 
!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC2H4 : (REAL) PARTIAL PRESSURE OF ETHYLENE
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C2H4          : INVERSE LINE SPACING [CM] FOR ETHYLENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC2H4, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C2H4 

REAL(EB), PARAMETER :: Q2      = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C2H4 = 28.0532_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C2H4
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C2H4) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! ETHYLENE Belongs to point group D2h with Rotational Constant A = 4.828 cm-1
! B = 1.0012 cm-1, and C = 0.8282 cm-1. We make the assumption B ~ C
DINV_C2H4 = 1._EB/(2.0_EB*1.0012_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 4 BANDS FOR Ethylene
! BAND #1: 800 cm-1  - 1250 cm-1 
! BAND #2: 1325 cm-1 - 1575 cm-1 
! BAND #3: 1775 cm-1 - 2050 cm-1 
! BAND #4: 2825 cm-1 - 3350 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C2H4
   IF ((OM_BND_C2H4(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C2H4(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C2H4(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1: 800 cm-1  - 1250 cm-1 
   KAPPA_D => SD1_C2H4
   GAMMA_D => GAMMAD1_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1325 cm-1 - 1575 cm-1 
   KAPPA_D => SD2_C2H4
   GAMMA_D => GAMMAD2_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1775 cm-1 - 2050 cm-1
   KAPPA_D => SD3_C2H4
   GAMMA_D => GAMMAD3_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 2825 cm-1 - 3350 cm-1
   KAPPA_D => SD4_C2H4
   GAMMA_D => GAMMAD4_C2H4
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C2H4(I_BAND)-1.0_EB)*PC2H4 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H4_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H4_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C2H4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C2H4

!==============================================================================
REAL(EB) FUNCTION GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_TEMP,BOUNDS,ABSORPTION_DATA)
!==============================================================================
! RETURNS INTERPOLATED VALUES OF SPECTRAL ABSORPTION
! NOTE ASSUMED SHAPE
!
! Input:
! OMEGA  : WAVENUMBER, UNIT = 1/cm
! TEMP   : GAS TEMPERATURE, UNIT = KELVIN
! SD_TEMP: VECTOR OF TEMPERATURE MEASUREMENTS, DIMENSION(*) UNIT = KELVIN
! BOUNDS : VECTOR OF WAVENUMBER BOUNDS AND SPACING FOR A GIVEN BAND, DIMENSIONS(3)
! ABSORPTION_DATA: ARRAY OF SPECIES SPECTRAL MEASUREMENTS, DIMENSIONS(*,*)
!                 NOTE = FIRST DIMENSION EQUALS TO DIMENSION OF SD_TEMP
!
! ACTION PERFORMED: BILINEAR INTERPOLATION OF ABSORPTION_DATA
!------------------------------------------------------------------------------
! Variables passed in

 REAL(EB), INTENT(IN) :: OMEGA
 REAL(EB), INTENT(IN) :: TEMP
 REAL(EB), DIMENSION(:), INTENT(IN)   :: SD_TEMP, BOUNDS
 REAL(EB), DIMENSION(:,:), INTENT(IN) :: ABSORPTION_DATA 

 REAL(EB) :: DELTA_T
 REAL(EB) :: DELTA_W
 REAL(EB) :: W1
 REAL(EB) :: OMEGA_MIN, OMEGA_MAX, DELTA_OMEGA
 REAL(EB) :: TTEMP
 REAL(EB) :: INTERPOLATED_VALUE

 INTEGER :: N_TEMP, N_BOUNDS, N_ABS_DATA1, N_ABS_DATA2
 INTEGER :: I_OMEGA, I_TEMP, I_OMEGA1, I_OMEGA2

 LOGICAL :: CROSS

 CROSS = .FALSE.

! CVL NEED TO LINK MODULE THAT DEFINES ERRMSG
! PART OF THE CODE COMMENTED FOR NOW
!  CHARACTER(255) MESSAG
!  LOGICAL FATAL

 N_TEMP      = UBOUND(SD_TEMP,1)  ! GET NUMBER OF TEMPERATURE MEASUREMENTS
 N_BOUNDS    = UBOUND(BOUNDS,1)   ! GET NUMBER OF ELEMENTS IN BOUNDS. SHOULD BE 3
 N_ABS_DATA1 = UBOUND(ABSORPTION_DATA,1) ! GET NUMBER OF TEMPERATURE DATA
 N_ABS_DATA2 = UBOUND(ABSORPTION_DATA,2) ! GET NUMBER OF WAVENUMBER DATA


! ! CVL NEED TO LINK MODULE THAT DEFINES ERRMSG
! ! PART OF THE CODE COMMENTED FOR NOW
! !-----------------------------TEST DIMENSIONS OF BOUNDS AND ABSORPTION_DATA----
! ! N_BOUNDS SHOULD BE 3
! 
!  IF (N_BOUNDS/=3) THEN 
!     MESSAG='ERROR IN RADCAL. N_BOUNDS SHOULD BE EQUAL TO 3'
!     FATAL = .TRUE.
!     CALL ERRMSG( trim(MESSAG), FATAL )
!  ENDIF
! 
! ! N_ABS_DATA1 SHOULD BE EQUAL TO N_TEMP
! 
!  IF (N_ABS_DATA1/=N_TEMP) THEN 
!     MESSAG='ERROR IN RADCAL. FIRST DIMENSION OF ABSORPTION_DATA SHOULD BE EQUAL TO N_TEMP'
!     FATAL = .TRUE.
!     CALL ERRMSG( trim(MESSAG), FATAL )
!  ENDIF

!------------------------------------------------------------------------------
 OMEGA_MIN   = BOUNDS(1)
 OMEGA_MAX   = BOUNDS(2)
 DELTA_OMEGA = BOUNDS(3)
 
! TREAT SPECIAL CASE WHEN BAND CROSSES THE 1100 CM-1 MARK.
! CHANGES OF STRIDE
! BELOW 1100 CM-1, DELTA_OMEGA = 5 CM-1
! ABOVE 1100 CM-1, DELTA_OMEGA = 25 CM-1

 IF ((OMEGA_MIN<=1100.0_EB).and.(OMEGA_MAX>1100.0_EB)) THEN
   CROSS = .TRUE.
   IF (OMEGA>1100._EB) DELTA_OMEGA = 25.0_EB
 ENDIF

! BOUNDS TTEMP SO THAT MIN(SD_TEMP) <= TTEMP <= MAX(SD_TEMP)
! IF TTEMP < MIN(SD_TEMP) THEN TTEMP := MIN(SD_TEMP)
! IF MAX(SD_TEMP) < TTEMP THEN TTEMP := MAX(SD_TEMP)
 TTEMP       = MIN(MAXVAL(SD_TEMP),MAX(TEMP,MINVAL(SD_TEMP)))  

 IF (TTEMP <= MINVAL(SD_TEMP)) THEN
    I_TEMP  = 1
    DELTA_T = 0._EB
 ELSE IF (TTEMP >= MAXVAL(SD_TEMP)) THEN
    I_TEMP  = N_TEMP-1
    DELTA_T = 1.0_EB
 ELSE
! FIND INDEX I_TEMP SUCH THAT SD_TEMP(I_TEMP)<TTEMP<=SD_TEMP(I_TEMP+1)
    DO I_TEMP = 1, N_TEMP-1
       IF ((SD_TEMP(I_TEMP)<TTEMP).AND.(TTEMP<=SD_TEMP(I_TEMP+1))) EXIT
    ENDDO

    DELTA_T = (TTEMP-SD_TEMP(I_TEMP))/(SD_TEMP(I_TEMP+1)-SD_TEMP(I_TEMP))
 ENDIF

 IF ((OMEGA_MIN<=OMEGA).AND.(OMEGA<=OMEGA_MAX)) THEN 

    IF(.NOT.(CROSS)) THEN ! THE BAND IS ON EITHER SIDE OF THE 1100 CM-1 MARK

       IF(OMEGA<OMEGA_MAX) THEN
! FIND I_OMEGA SUCH THAT OMEGA(I_OMEGA)<=OMEGA<OMEGA(I_OMEGA+1)
          I_OMEGA = FLOOR((OMEGA-OMEGA_MIN)/DELTA_OMEGA)+1
          I_OMEGA = MIN(I_OMEGA,N_ABS_DATA2-1)
          W1      = OMEGA_MIN+DELTA_OMEGA*(REAL(I_OMEGA-1,EB))
          DELTA_W = (OMEGA-W1)/DELTA_OMEGA
       ELSE
! CASE I_OMEGA = OMEGA_MAX => ASSUME THEN THAT I_OMEGA = N_ABS_DATA2 -1 
          I_OMEGA = N_ABS_DATA2 - 1
          W1      = OMEGA_MIN+DELTA_OMEGA*(REAL(I_OMEGA-1,EB))
          DELTA_W = (OMEGA-W1)/DELTA_OMEGA
       ENDIF

    ELSE ! THE BAND IS ON BOTH SIDE OF 1100 CM-1
         ! TEST IF OMEGA <= 1100
       IF(OMEGA<=1100) THEN
! FIND I_OMEGA SUCH THAT OMEGA(I_OMEGA)<=OMEGA<OMEGA(I_OMEGA+1)
          I_OMEGA = FLOOR((OMEGA-OMEGA_MIN)/DELTA_OMEGA)+1
          I_OMEGA = MIN(I_OMEGA,N_ABS_DATA2-1)
          W1      = OMEGA_MIN+DELTA_OMEGA*(REAL(I_OMEGA-1,EB))
          DELTA_W = (OMEGA-W1)/DELTA_OMEGA
       ELSE
! CASE OMEGA > 1100 CM-1
          I_OMEGA1 = FLOOR((1100-OMEGA_MIN)/5.0_EB)+1
          I_OMEGA2 = FLOOR((OMEGA-1100)/DELTA_OMEGA)
          I_OMEGA  = MIN(I_OMEGA1+I_OMEGA2-1,N_ABS_DATA2-1)
          W1      = OMEGA_MIN+5.0_EB*(REAL(I_OMEGA1,EB))+DELTA_OMEGA*(REAL(I_OMEGA2-1,EB))
          DELTA_W = (OMEGA-W1)/DELTA_OMEGA
       ENDIF

    ENDIF

! PERFORM BILINEAR INTERPOLATION TO OBTAIN VALUES OF SDWEAK
    INTERPOLATED_VALUE = (1._EB-DELTA_W)*((1._EB-DELTA_T)*ABSORPTION_DATA(I_TEMP,I_OMEGA)+ & 
                         ABSORPTION_DATA(I_TEMP+1,I_OMEGA)*DELTA_T) +                      &
                         DELTA_W*(ABSORPTION_DATA(I_TEMP,I_OMEGA+1)*(1._EB-DELTA_T)+       &
                         ABSORPTION_DATA(I_TEMP+1,I_OMEGA+1)*DELTA_T)

 ELSE
    INTERPOLATED_VALUE = 0._EB
 ENDIF

! ENSURE POSITIVITY
 GET_SPECTRAL_ABSORPTION = MAX(0._EB,INTERPOLATED_VALUE)
!------------------------------------------------------------------------------
 END FUNCTION GET_SPECTRAL_ABSORPTION

!==============================================================================
REAL(EB) FUNCTION PLANCK(TEMP,LAMBDA)
!==============================================================================
! COMPUTES BLACKBODY FUNCTION IN UNITS OF W/M-2/MICRON/SR
! Input:
! TEMP: TEMPERATURE, UNIT = KELVIN
! LAMBDA: WAVELENGTH, UNIT = MicroMETERS
!------------------------------------------------------------------------------
! Variables passed in
 REAL (EB), INTENT(IN):: TEMP, LAMBDA

! local variables
 REAL (EB), PARAMETER :: Q1 = 1.19088E8_EB ! Q1 = 2*SPEED_OF_LIGHT^2*PLANCK_CNST
 REAL (EB), PARAMETER :: Q2 = 14388._EB    ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
 REAL (EB) :: C   ! C = LAMBDA * TEMP

 IF(ABS(TEMP)<TWO_EPSILON_EB) THEN
    PLANCK = 0._EB
 ELSE
    C = TEMP * LAMBDA
    IF (Q2/C > 38._EB) THEN
       PLANCK = 0._EB
    ELSE
       PLANCK=Q1*(LAMBDA**(-5))/(EXP(Q2/C)-1._EB)
   END IF
 ENDIF
!------------------------------------------------------------------------------
END FUNCTION PLANCK

!==============================================================================
SUBROUTINE RCALLOC
!==============================================================================

ALLOCATE(P(6))
ALLOCATE(SPECIE(5))
ALLOCATE(QW(600))
ALLOCATE(TTAU(600))
ALLOCATE(XT(600))
ALLOCATE(X(4))
ALLOCATE(GC(4))
ALLOCATE(LAMBDA(600))
ALLOCATE(OPTICAL_THICKNESS(4))
ALLOCATE(AB(600))
ALLOCATE(ATOT(4))
ALLOCATE(BCNT(4))
ALLOCATE(GAMMA(4,7))
ALLOCATE(SD15(6,80))
ALLOCATE(SD(6,376))
ALLOCATE(SD7(3,16))
ALLOCATE(SD3(3,32))


I_MODEL_CO2 = 1 ! GOODY MODEL
I_MODEL_CO  = 1 ! GOODY MODEL
I_MODEL_H2O = 1 ! GOODY MODEL

!-------------------------Methane DATA-------------------


! THERE ARE 2 BANDS FOR Methane

! BAND #1: 1150 cm-1 - 1600 cm-1 
! BAND #2: 2700 cm-1 - 3250 cm-1 
! BAND #3: 3400 cm-1 - 5000 cm-1

N_TEMP_CH4 = 23
N_BAND_CH4 = 3

I_MODEL_CH4 = 3 ! ELSASSER MODEL

ALLOCATE(SD_CH4_TEMP(N_TEMP_CH4)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Methane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., THEN THE BAND IS CALCULATED AND NOT TABULATED.

ALLOCATE(OM_BND_CH4(N_BAND_CH4,3)) 

OM_BND_CH4 = RESHAPE((/ &
    1150._EB, 2700._EB, 3400._EB,&
    1600._EB, 3250._EB, 5000._EB,&
      25._EB,   25._EB,    0._EB/),(/N_BAND_CH4,3/)) 

SD_CH4_TEMP = (/ &
    300._EB, 350._EB, 400._EB, 450._EB, 500._EB, 550._EB,&
    600._EB, 650._EB, 700._EB, 750._EB, 800._EB, 850._EB,&
    900._EB, 950._EB, 1000._EB, 1050._EB, 1100._EB, 1150._EB,&
    1200._EB, 1250._EB, 1300._EB, 1350._EB, 1400._EB/)

ALLOCATE(SD1_CH4(N_TEMP_CH4,19)) 

! BAND #1: 1150 cm-1 - 1600 cm-1 

SD1_CH4(1:23,1:8) = RESHAPE((/ &  ! 1150-1325 cm-1
    2.674955E-03_EB, 4.122616E-03_EB, 6.116504E-03_EB, 8.394889E-03_EB, 1.066588E-02_EB, 1.270929E-02_EB, &
    1.431368E-02_EB, 1.543500E-02_EB, 1.607798E-02_EB, 1.623394E-02_EB, 1.594103E-02_EB, 1.537005E-02_EB, &
    1.456109E-02_EB, 1.356591E-02_EB, 1.253062E-02_EB, 1.145338E-02_EB, 1.037156E-02_EB, 9.319748E-03_EB, &
    8.296535E-03_EB, 7.359273E-03_EB, 6.512254E-03_EB, 5.764075E-03_EB, 5.034367E-03_EB,  &
    1.056047E-02_EB, 1.689522E-02_EB, 2.382293E-02_EB, 3.013931E-02_EB, 3.518013E-02_EB, 3.873081E-02_EB, &
    4.056505E-02_EB, 4.099451E-02_EB, 4.031689E-02_EB, 3.867720E-02_EB, 3.630281E-02_EB, 3.360423E-02_EB, &
    3.072697E-02_EB, 2.769650E-02_EB, 2.480529E-02_EB, 2.203561E-02_EB, 1.945492E-02_EB, 1.710571E-02_EB, &
    1.490918E-02_EB, 1.297063E-02_EB, 1.127359E-02_EB, 9.806206E-03_EB, 8.433200E-03_EB,  &
    6.535368E-02_EB, 8.634735E-02_EB, 1.035285E-01_EB, 1.149338E-01_EB, 1.211259E-01_EB, 1.231160E-01_EB, &
    1.212403E-01_EB, 1.167139E-01_EB, 1.104665E-01_EB, 1.027695E-01_EB, 9.409726E-02_EB, 8.537322E-02_EB, &
    7.679556E-02_EB, 6.836183E-02_EB, 6.060003E-02_EB, 5.339354E-02_EB, 4.679438E-02_EB, 4.089038E-02_EB, &
    3.545789E-02_EB, 3.072468E-02_EB, 2.660506E-02_EB, 2.306236E-02_EB, 1.979016E-02_EB,  &
    2.797310E-01_EB, 2.878774E-01_EB, 2.844637E-01_EB, 2.718418E-01_EB, 2.544158E-01_EB, 2.351542E-01_EB, &
    2.144282E-01_EB, 1.940107E-01_EB, 1.744123E-01_EB, 1.554283E-01_EB, 1.374171E-01_EB, 1.210226E-01_EB, &
    1.060935E-01_EB, 9.238361E-02_EB, 8.033186E-02_EB, 6.960028E-02_EB, 6.015950E-02_EB, 5.186871E-02_EB, &
    4.448682E-02_EB, 3.815557E-02_EB, 3.272683E-02_EB, 2.816055E-02_EB, 2.399102E-02_EB,  &
    6.055294E-01_EB, 5.085203E-01_EB, 4.314546E-01_EB, 3.661128E-01_EB, 3.120083E-01_EB, 2.675996E-01_EB, &
    2.295433E-01_EB, 1.976798E-01_EB, 1.706085E-01_EB, 1.470613E-01_EB, 1.263463E-01_EB, 1.086762E-01_EB, &
    9.339644E-02_EB, 7.991483E-02_EB, 6.850499E-02_EB, 5.859531E-02_EB, 5.007218E-02_EB, 4.275497E-02_EB, &
    3.636644E-02_EB, 3.094626E-02_EB, 2.637845E-02_EB, 2.255529E-02_EB, 1.911152E-02_EB,  &
    7.291248E-01_EB, 6.247580E-01_EB, 5.567927E-01_EB, 5.047634E-01_EB, 4.622435E-01_EB, 4.253591E-01_EB, &
    3.901550E-01_EB, 3.566718E-01_EB, 3.248608E-01_EB, 2.936112E-01_EB, 2.628808E-01_EB, 2.344160E-01_EB, &
    2.078641E-01_EB, 1.829068E-01_EB, 1.606407E-01_EB, 1.403181E-01_EB, 1.221762E-01_EB, 1.060864E-01_EB, &
    9.154534E-02_EB, 7.892764E-02_EB, 6.808643E-02_EB, 5.882322E-02_EB, 5.031768E-02_EB,  &
    1.503577E+00_EB, 1.216438E+00_EB, 1.009787E+00_EB, 8.445781E-01_EB, 7.110515E-01_EB, 6.021463E-01_EB, &
    5.099874E-01_EB, 4.327438E-01_EB, 3.680691E-01_EB, 3.125303E-01_EB, 2.644163E-01_EB, 2.242054E-01_EB, &
    1.897708E-01_EB, 1.602130E-01_EB, 1.354708E-01_EB, 1.143770E-01_EB, 9.654761E-02_EB, 8.152145E-02_EB, &
    6.854917E-02_EB, 5.774320E-02_EB, 4.875464E-02_EB, 4.129146E-02_EB, 3.467888E-02_EB,  &
    1.113787E+00_EB, 8.666106E-01_EB, 6.937600E-01_EB, 5.636603E-01_EB, 4.651973E-01_EB, 3.899245E-01_EB, &
    3.293625E-01_EB, 2.804438E-01_EB, 2.403481E-01_EB, 2.062563E-01_EB, 1.767199E-01_EB, 1.518103E-01_EB, &
    1.304026E-01_EB, 1.116263E-01_EB, 9.571162E-02_EB, 8.192030E-02_EB, 7.003835E-02_EB, 5.986022E-02_EB, &
    5.092725E-02_EB, 4.337782E-02_EB, 3.700459E-02_EB, 3.164349E-02_EB, 2.682395E-02_EB/),(/23,8/))

SD1_CH4(1:23,9:16) = RESHAPE((/ &  ! 1350-1525 cm-1
    5.859637E-01_EB, 5.741640E-01_EB, 5.446284E-01_EB, 5.016955E-01_EB, 4.533548E-01_EB, 4.052375E-01_EB, &
    3.578427E-01_EB, 3.138042E-01_EB, 2.741405E-01_EB, 2.379703E-01_EB, 2.050667E-01_EB, 1.765003E-01_EB, &
    1.515652E-01_EB, 1.294551E-01_EB, 1.106049E-01_EB, 9.430003E-02_EB, 8.028460E-02_EB, 6.831086E-02_EB, &
    5.788843E-02_EB, 4.905327E-02_EB, 4.167658E-02_EB, 3.549325E-02_EB, 2.997796E-02_EB,  &
    5.143640E-02_EB, 7.394302E-02_EB, 9.480931E-02_EB, 1.108135E-01_EB, 1.211319E-01_EB, 1.262273E-01_EB, &
    1.262909E-01_EB, 1.227527E-01_EB, 1.167145E-01_EB, 1.087709E-01_EB, 9.943737E-02_EB, 9.002538E-02_EB, &
    8.060527E-02_EB, 7.137067E-02_EB, 6.299760E-02_EB, 5.512164E-02_EB, 4.801455E-02_EB, 4.169764E-02_EB, &
    3.593587E-02_EB, 3.095498E-02_EB, 2.664278E-02_EB, 2.295572E-02_EB, 1.959682E-02_EB,  &
    7.616134E-03_EB, 9.957002E-03_EB, 1.281279E-02_EB, 1.589717E-02_EB, 1.894916E-02_EB, 2.174268E-02_EB, &
    2.395920E-02_EB, 2.555557E-02_EB, 2.648904E-02_EB, 2.671274E-02_EB, 2.629477E-02_EB, 2.540283E-02_EB, &
    2.418621E-02_EB, 2.265546E-02_EB, 2.101542E-02_EB, 1.928221E-02_EB, 1.752831E-02_EB, 1.582992E-02_EB, &
    1.416926E-02_EB, 1.261250E-02_EB, 1.121041E-02_EB, 9.951538E-03_EB, 8.728757E-03_EB,  &
    1.277402E-02_EB, 1.327177E-02_EB, 1.322108E-02_EB, 1.267471E-02_EB, 1.186190E-02_EB, 1.093562E-02_EB, &
    9.920972E-03_EB, 8.920419E-03_EB, 7.971129E-03_EB, 7.057028E-03_EB, 6.197372E-03_EB, 5.429023E-03_EB, &
    4.732635E-03_EB, 4.092017E-03_EB, 3.548360E-03_EB, 3.062048E-03_EB, 2.633809E-03_EB, 2.263255E-03_EB, &
    1.935254E-03_EB, 1.656795E-03_EB, 1.416023E-03_EB, 1.215289E-03_EB, 1.031774E-03_EB,  &
    8.014464E-03_EB, 7.194752E-03_EB, 6.553713E-03_EB, 6.000398E-03_EB, 5.531684E-03_EB, 5.121393E-03_EB, &
    4.722456E-03_EB, 4.343916E-03_EB, 3.983544E-03_EB, 3.621247E-03_EB, 3.268422E-03_EB, 2.936068E-03_EB, &
    2.617151E-03_EB, 2.322363E-03_EB, 2.051315E-03_EB, 1.804840E-03_EB, 1.578471E-03_EB, 1.378963E-03_EB, &
    1.197596E-03_EB, 1.036958E-03_EB, 9.007021E-04_EB, 7.820103E-04_EB, 6.693842E-04_EB,  &
    2.792665E-03_EB, 2.575454E-03_EB, 2.537125E-03_EB, 2.578233E-03_EB, 2.648059E-03_EB, 2.713453E-03_EB, &
    2.741224E-03_EB, 2.722787E-03_EB, 2.662395E-03_EB, 2.559402E-03_EB, 2.415338E-03_EB, 2.254521E-03_EB, &
    2.077537E-03_EB, 1.891657E-03_EB, 1.708933E-03_EB, 1.533948E-03_EB, 1.367874E-03_EB, 1.212162E-03_EB, &
    1.064882E-03_EB, 9.339250E-04_EB, 8.169687E-04_EB, 7.180516E-04_EB, 6.220503E-04_EB,  &
    8.239408E-04_EB, 8.207289E-04_EB, 8.769232E-04_EB, 9.471812E-04_EB, 1.013068E-03_EB, 1.072041E-03_EB, &
    1.109555E-03_EB, 1.125480E-03_EB, 1.120373E-03_EB, 1.094883E-03_EB, 1.043855E-03_EB, 9.887558E-04_EB, &
    9.221581E-04_EB, 8.517148E-04_EB, 7.786200E-04_EB, 7.086512E-04_EB, 6.363394E-04_EB, 5.709486E-04_EB, &
    5.037963E-04_EB, 4.478632E-04_EB, 3.933607E-04_EB, 3.461225E-04_EB, 3.036065E-04_EB,  &
    1.787674E-02_EB, 1.651301E-02_EB, 1.538618E-02_EB, 1.427021E-02_EB, 1.321135E-02_EB, 1.220556E-02_EB, &
    1.120017E-02_EB, 1.022271E-02_EB, 9.293408E-03_EB, 8.381487E-03_EB, 7.491250E-03_EB, 6.673691E-03_EB, &
    5.914957E-03_EB, 5.201979E-03_EB, 4.566356E-03_EB, 3.988961E-03_EB, 3.472458E-03_EB, 3.017625E-03_EB, &
    2.605493E-03_EB, 2.248445E-03_EB, 1.941774E-03_EB, 1.676885E-03_EB, 1.438512E-03_EB/),(/23,8/))

SD1_CH4(1:23,17:19) = RESHAPE((/ &  ! 1550-1600 cm-1
    3.842192E-03_EB, 4.909077E-03_EB, 5.876585E-03_EB, 6.637230E-03_EB, 7.159498E-03_EB, 7.449619E-03_EB, &
    7.502474E-03_EB, 7.374704E-03_EB, 7.105819E-03_EB, 6.720456E-03_EB, 6.241450E-03_EB, 5.729337E-03_EB, &
    5.213056E-03_EB, 4.685851E-03_EB, 4.183214E-03_EB, 3.714659E-03_EB, 3.276286E-03_EB, 2.879051E-03_EB, &
    2.508044E-03_EB, 2.182116E-03_EB, 1.899894E-03_EB, 1.653926E-03_EB, 1.423668E-03_EB,  &
    1.587677E-03_EB, 1.446538E-03_EB, 1.552901E-03_EB, 1.804439E-03_EB, 2.128742E-03_EB, 2.458565E-03_EB, &
    2.743898E-03_EB, 2.955974E-03_EB, 3.088835E-03_EB, 3.134690E-03_EB, 3.095698E-03_EB, 3.002805E-03_EB, &
    2.862955E-03_EB, 2.683299E-03_EB, 2.486550E-03_EB, 2.282038E-03_EB, 2.073847E-03_EB, 1.873143E-03_EB, &
    1.674361E-03_EB, 1.489429E-03_EB, 1.321804E-03_EB, 1.173554E-03_EB, 1.026702E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB/),(/23,3/))

ALLOCATE(SD2_CH4(N_TEMP_CH4,23)) 

! BAND #2: 2700 cm-1 - 3250 cm-1 

SD2_CH4(1:23,1:8) = RESHAPE((/ &  ! 2700-2875 cm-1
    1.217530E-02_EB, 1.117112E-02_EB, 1.018335E-02_EB, 9.113159E-03_EB, 8.069237E-03_EB, 7.089143E-03_EB, &
    6.164984E-03_EB, 5.339743E-03_EB, 4.605161E-03_EB, 3.952813E-03_EB, 3.369126E-03_EB, 2.873535E-03_EB, &
    2.442004E-03_EB, 2.069306E-03_EB, 1.752468E-03_EB, 1.483929E-03_EB, 1.255931E-03_EB, 1.056565E-03_EB, &
    8.920522E-04_EB, 7.508758E-04_EB, 6.317838E-04_EB, 5.352971E-04_EB, 4.530464E-04_EB,  &
    2.513916E-02_EB, 2.114376E-02_EB, 1.780513E-02_EB, 1.491293E-02_EB, 1.247243E-02_EB, 1.043356E-02_EB, &
    8.698933E-03_EB, 7.256269E-03_EB, 6.066735E-03_EB, 5.057876E-03_EB, 4.209670E-03_EB, 3.508303E-03_EB, &
    2.922322E-03_EB, 2.428483E-03_EB, 2.028794E-03_EB, 1.689558E-03_EB, 1.409261E-03_EB, 1.176715E-03_EB, &
    9.788265E-04_EB, 8.167162E-04_EB, 6.823326E-04_EB, 5.730157E-04_EB, 4.786727E-04_EB,  &
    2.557782E-02_EB, 2.133345E-02_EB, 1.832454E-02_EB, 1.586992E-02_EB, 1.378920E-02_EB, 1.202910E-02_EB, &
    1.045539E-02_EB, 9.073223E-03_EB, 7.878108E-03_EB, 6.813401E-03_EB, 5.858711E-03_EB, 5.036798E-03_EB, &
    4.322566E-03_EB, 3.689893E-03_EB, 3.157259E-03_EB, 2.690401E-03_EB, 2.292743E-03_EB, 1.951361E-03_EB, &
    1.658405E-03_EB, 1.405787E-03_EB, 1.195120E-03_EB, 1.018165E-03_EB, 8.624014E-04_EB,  &
    3.267234E-02_EB, 2.794974E-02_EB, 2.414894E-02_EB, 2.075791E-02_EB, 1.780983E-02_EB, 1.531517E-02_EB, &
    1.312860E-02_EB, 1.127375E-02_EB, 9.704346E-03_EB, 8.352011E-03_EB, 7.159191E-03_EB, 6.165400E-03_EB, &
    5.304681E-03_EB, 4.552437E-03_EB, 3.918329E-03_EB, 3.371374E-03_EB, 2.897155E-03_EB, 2.490584E-03_EB, &
    2.139129E-03_EB, 1.834560E-03_EB, 1.579448E-03_EB, 1.362473E-03_EB, 1.164728E-03_EB,  &
    4.729257E-02_EB, 4.020146E-02_EB, 3.655117E-02_EB, 3.486375E-02_EB, 3.451183E-02_EB, 3.486976E-02_EB, &
    3.526911E-02_EB, 3.549943E-02_EB, 3.539419E-02_EB, 3.477334E-02_EB, 3.359574E-02_EB, 3.209631E-02_EB, &
    3.033091E-02_EB, 2.826035E-02_EB, 2.617425E-02_EB, 2.398793E-02_EB, 2.182750E-02_EB, 1.975692E-02_EB, &
    1.770980E-02_EB, 1.581216E-02_EB, 1.409330E-02_EB, 1.256203E-02_EB, 1.106706E-02_EB,  &
    3.967221E-02_EB, 3.764359E-02_EB, 3.949747E-02_EB, 4.277841E-02_EB, 4.623172E-02_EB, 4.903094E-02_EB, &
    5.058120E-02_EB, 5.097742E-02_EB, 5.029388E-02_EB, 4.863988E-02_EB, 4.605751E-02_EB, 4.308689E-02_EB, &
    3.983596E-02_EB, 3.638363E-02_EB, 3.298206E-02_EB, 2.967115E-02_EB, 2.650179E-02_EB, 2.356866E-02_EB, &
    2.077236E-02_EB, 1.827032E-02_EB, 1.605444E-02_EB, 1.411180E-02_EB, 1.226114E-02_EB,  &
    7.223868E-02_EB, 8.544183E-02_EB, 9.962661E-02_EB, 1.104863E-01_EB, 1.171420E-01_EB, 1.196787E-01_EB, &
    1.182118E-01_EB, 1.139658E-01_EB, 1.078438E-01_EB, 1.002471E-01_EB, 9.161471E-02_EB, 8.298437E-02_EB, &
    7.452297E-02_EB, 6.622584E-02_EB, 5.857678E-02_EB, 5.147962E-02_EB, 4.505849E-02_EB, 3.932179E-02_EB, &
    3.408714E-02_EB, 2.948172E-02_EB, 2.551286E-02_EB, 2.211846E-02_EB, 1.897647E-02_EB,  &
    1.759866E-01_EB, 2.015363E-01_EB, 2.180490E-01_EB, 2.232613E-01_EB, 2.203020E-01_EB, 2.118597E-01_EB, &
    1.990075E-01_EB, 1.841205E-01_EB, 1.683887E-01_EB, 1.521963E-01_EB, 1.360646E-01_EB, 1.209307E-01_EB, &
    1.069128E-01_EB, 9.382435E-02_EB, 8.206146E-02_EB, 7.155641E-02_EB, 6.219310E-02_EB, 5.392479E-02_EB, &
    4.648837E-02_EB, 4.008493E-02_EB, 3.458414E-02_EB, 2.988156E-02_EB, 2.558176E-02_EB/),(/23,8/))

SD2_CH4(1:23,9:16) = RESHAPE((/ &  ! 2900-3075 cm-1
    3.311709E-01_EB, 3.344762E-01_EB, 3.267663E-01_EB, 3.099531E-01_EB, 2.886161E-01_EB, 2.659881E-01_EB, &
    2.423456E-01_EB, 2.191913E-01_EB, 1.973904E-01_EB, 1.764196E-01_EB, 1.564157E-01_EB, 1.382986E-01_EB, &
    1.218590E-01_EB, 1.067421E-01_EB, 9.331013E-02_EB, 8.132822E-02_EB, 7.068471E-02_EB, 6.139407E-02_EB, &
    5.297295E-02_EB, 4.571219E-02_EB, 3.948284E-02_EB, 3.416733E-02_EB, 2.931231E-02_EB,  &
    8.235613E-01_EB, 7.238968E-01_EB, 6.324968E-01_EB, 5.466365E-01_EB, 4.712117E-01_EB, 4.058971E-01_EB, &
    3.486088E-01_EB, 2.993153E-01_EB, 2.575278E-01_EB, 2.209771E-01_EB, 1.890168E-01_EB, 1.618217E-01_EB, &
    1.384064E-01_EB, 1.180022E-01_EB, 1.008139E-01_EB, 8.601549E-02_EB, 7.332027E-02_EB, 6.253544E-02_EB, &
    5.308446E-02_EB, 4.515135E-02_EB, 3.847721E-02_EB, 3.288247E-02_EB, 2.786602E-02_EB,  &
    6.821008E-01_EB, 5.401363E-01_EB, 4.353503E-01_EB, 3.533680E-01_EB, 2.892836E-01_EB, 2.389427E-01_EB, &
    1.981961E-01_EB, 1.653239E-01_EB, 1.387030E-01_EB, 1.163771E-01_EB, 9.777404E-02_EB, 8.236369E-02_EB, &
    6.949908E-02_EB, 5.853014E-02_EB, 4.942064E-02_EB, 4.176497E-02_EB, 3.531768E-02_EB, 2.985698E-02_EB, &
    2.516886E-02_EB, 2.128060E-02_EB, 1.802439E-02_EB, 1.532867E-02_EB, 1.292454E-02_EB,  &
    5.823907E-01_EB, 4.331161E-01_EB, 3.353248E-01_EB, 2.655224E-01_EB, 2.144294E-01_EB, 1.761169E-01_EB, &
    1.472744E-01_EB, 1.241615E-01_EB, 1.057407E-01_EB, 9.045740E-02_EB, 7.745806E-02_EB, 6.667193E-02_EB, &
    5.744892E-02_EB, 4.942743E-02_EB, 4.263289E-02_EB, 3.676096E-02_EB, 3.166692E-02_EB, 2.731256E-02_EB, &
    2.343114E-02_EB, 2.014747E-02_EB, 1.734533E-02_EB, 1.497211E-02_EB, 1.281431E-02_EB,  &
    3.210821E+00_EB, 2.793045E+00_EB, 2.475891E+00_EB, 2.198508E+00_EB, 1.954455E+00_EB, 1.740419E+00_EB, &
    1.543274E+00_EB, 1.366589E+00_EB, 1.208668E+00_EB, 1.063917E+00_EB, 9.309610E-01_EB, 8.135837E-01_EB, &
    7.091172E-01_EB, 6.150707E-01_EB, 5.334009E-01_EB, 4.611724E-01_EB, 3.980142E-01_EB, 3.431784E-01_EB, &
    2.944666E-01_EB, 2.526486E-01_EB, 2.171496E-01_EB, 1.870189E-01_EB, 1.596229E-01_EB,  &
    3.517151E-01_EB, 2.541996E-01_EB, 1.936159E-01_EB, 1.517283E-01_EB, 1.221750E-01_EB, 1.004308E-01_EB, &
    8.351777E-02_EB, 7.016371E-02_EB, 5.949379E-02_EB, 5.053966E-02_EB, 4.298934E-02_EB, 3.667062E-02_EB, &
    3.130112E-02_EB, 2.669085E-02_EB, 2.279490E-02_EB, 1.946235E-02_EB, 1.660600E-02_EB, 1.417075E-02_EB, &
    1.204697E-02_EB, 1.025668E-02_EB, 8.756988E-03_EB, 7.490243E-03_EB, 6.351877E-03_EB,  &
    7.921358E-01_EB, 6.055366E-01_EB, 4.798618E-01_EB, 3.867414E-01_EB, 3.174199E-01_EB, 2.642038E-01_EB, &
    2.216893E-01_EB, 1.874171E-01_EB, 1.594862E-01_EB, 1.359448E-01_EB, 1.159382E-01_EB, 9.908354E-02_EB, &
    8.473452E-02_EB, 7.233655E-02_EB, 6.187191E-02_EB, 5.286391E-02_EB, 4.518233E-02_EB, 3.863453E-02_EB, &
    3.288079E-02_EB, 2.803528E-02_EB, 2.394608E-02_EB, 2.051761E-02_EB, 1.743587E-02_EB,  &
    1.334409E+00_EB, 1.095178E+00_EB, 9.120448E-01_EB, 7.631562E-01_EB, 6.425576E-01_EB, 5.444728E-01_EB, &
    4.621443E-01_EB, 3.938260E-01_EB, 3.368579E-01_EB, 2.880892E-01_EB, 2.459378E-01_EB, 2.104005E-01_EB, &
    1.799327E-01_EB, 1.535802E-01_EB, 1.314063E-01_EB, 1.121907E-01_EB, 9.581696E-02_EB, 8.185813E-02_EB, &
    6.964125E-02_EB, 5.934825E-02_EB, 5.067442E-02_EB, 4.339843E-02_EB, 3.686411E-02_EB/),(/23,8/))

SD2_CH4(1:23,17:23) = RESHAPE((/ &  ! 3100-3250 cm-1
    9.674073E-01_EB, 9.013091E-01_EB, 8.256467E-01_EB, 7.423397E-01_EB, 6.619262E-01_EB, 5.879801E-01_EB, &
    5.191373E-01_EB, 4.573467E-01_EB, 4.022801E-01_EB, 3.523929E-01_EB, 3.072101E-01_EB, 2.674592E-01_EB, &
    2.326179E-01_EB, 2.012004E-01_EB, 1.742107E-01_EB, 1.505433E-01_EB, 1.298551E-01_EB, 1.119451E-01_EB, &
    9.604141E-02_EB, 8.242372E-02_EB, 7.089244E-02_EB, 6.110245E-02_EB, 5.221546E-02_EB,  &
    3.658653E-01_EB, 4.184364E-01_EB, 4.441884E-01_EB, 4.457809E-01_EB, 4.319013E-01_EB, 4.088715E-01_EB, &
    3.793819E-01_EB, 3.474065E-01_EB, 3.151904E-01_EB, 2.830904E-01_EB, 2.516607E-01_EB, 2.228145E-01_EB, &
    1.964195E-01_EB, 1.718178E-01_EB, 1.502324E-01_EB, 1.307846E-01_EB, 1.135071E-01_EB, 9.842138E-02_EB, &
    8.481592E-02_EB, 7.309981E-02_EB, 6.307130E-02_EB, 5.451710E-02_EB, 4.669207E-02_EB,  &
    8.373191E-02_EB, 1.229238E-01_EB, 1.573970E-01_EB, 1.825905E-01_EB, 1.975753E-01_EB, 2.040052E-01_EB, &
    2.024706E-01_EB, 1.957505E-01_EB, 1.855755E-01_EB, 1.726368E-01_EB, 1.580202E-01_EB, 1.433211E-01_EB, &
    1.287520E-01_EB, 1.144879E-01_EB, 1.013973E-01_EB, 8.925648E-02_EB, 7.818868E-02_EB, 6.826146E-02_EB, &
    5.920229E-02_EB, 5.129713E-02_EB, 4.441206E-02_EB, 3.851923E-02_EB, 3.306979E-02_EB,  &
    1.457007E-02_EB, 2.736439E-02_EB, 4.340085E-02_EB, 6.002981E-02_EB, 7.506875E-02_EB, 8.727601E-02_EB, &
    9.581284E-02_EB, 1.007875E-01_EB, 1.027285E-01_EB, 1.017913E-01_EB, 9.839048E-02_EB, 9.365514E-02_EB, &
    8.789001E-02_EB, 8.123320E-02_EB, 7.449732E-02_EB, 6.766345E-02_EB, 6.100922E-02_EB, 5.470686E-02_EB, &
    4.865358E-02_EB, 4.309088E-02_EB, 3.810993E-02_EB, 3.369467E-02_EB, 2.945916E-02_EB,  &
    1.191095E-03_EB, 1.552045E-03_EB, 2.059789E-03_EB, 2.649547E-03_EB, 3.236595E-03_EB, 3.762561E-03_EB, &
    4.165025E-03_EB, 4.448429E-03_EB, 4.600555E-03_EB, 4.628224E-03_EB, 4.534948E-03_EB, 4.374710E-03_EB, &
    4.151710E-03_EB, 3.880527E-03_EB, 3.599880E-03_EB, 3.300161E-03_EB, 2.998249E-03_EB, 2.715486E-03_EB, &
    2.425276E-03_EB, 2.164309E-03_EB, 1.929373E-03_EB, 1.713087E-03_EB, 1.506010E-03_EB,  &
    4.538291E-04_EB, 4.599393E-04_EB, 4.587246E-04_EB, 4.526653E-04_EB, 4.375098E-04_EB, 4.167315E-04_EB, &
    3.918634E-04_EB, 3.644121E-04_EB, 3.335314E-04_EB, 3.072189E-04_EB, 2.753771E-04_EB, 2.453914E-04_EB, &
    2.183408E-04_EB, 1.968316E-04_EB, 1.704817E-04_EB, 1.507858E-04_EB, 1.319531E-04_EB, 1.134243E-04_EB, &
    9.801919E-05_EB, 8.900765E-05_EB, 7.481087E-05_EB, 6.511635E-05_EB, 5.390619E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB/),(/23,7/))

!-------------------------Ethane DATA-------------------


! THERE ARE 3 BANDS FOR Ethane

! BAND #1: 730 cm-1 - 1095 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

N_TEMP_C2H6 = 7
N_BAND_C2H6 = 3
I_MODEL_C2H6 = 3 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C2H6_TEMP(N_TEMP_C2H6)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Ethane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C2H6(N_BAND_C2H6,3)) 
ALLOCATE(Be_C2H6(N_BAND_C2H6)) 

OM_BND_C2H6 = RESHAPE((/ &
    730._EB, 1250._EB, 2550._EB, &
    1095._EB, 1700._EB, 3375._EB, &
     5._EB, 25._EB, 25._EB/),(/N_BAND_C2H6,3/)) 

SD_C2H6_TEMP = (/ &
    296._EB, 400._EB, 450._EB, 500._EB, 600._EB, 800._EB,&
    1000._EB/)

Be_C2H6 = (/ &
    1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C2H6(N_TEMP_C2H6,74)) 

! BAND #1: 730 cm-1 - 1095 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 0.64336 % 

SD1_C2H6(1:7,1:8) = RESHAPE((/ &  ! 730-765 cm-1
    5.319833E-04_EB, 5.524270E-04_EB, 5.561577E-04_EB, 5.296775E-04_EB, 5.132282E-04_EB, 5.718893E-04_EB, &
    6.010457E-04_EB, &
    6.171494E-04_EB, 5.540205E-04_EB, 6.390563E-04_EB, 6.025128E-04_EB, 6.046230E-04_EB, 6.130432E-04_EB, &
    5.849173E-04_EB, &
    6.282343E-04_EB, 6.234860E-04_EB, 6.212319E-04_EB, 3.614254E-03_EB, 5.957890E-04_EB, 6.133817E-04_EB, &
    6.010768E-04_EB, &
    8.795690E-04_EB, 5.857270E-04_EB, 3.763069E-03_EB, 9.942508E-03_EB, 2.666025E-03_EB, 6.185041E-03_EB, &
    5.598960E-04_EB, &
    1.202162E-02_EB, 5.687777E-04_EB, 5.698906E-03_EB, 1.152163E-02_EB, 3.962219E-01_EB, 1.572434E-02_EB, &
    5.795495E-04_EB, &
    1.420080E-02_EB, 5.994648E-04_EB, 1.083825E-02_EB, 7.458630E-03_EB, 4.160288E-01_EB, 1.475139E-02_EB, &
    5.443872E-04_EB, &
    3.551298E-02_EB, 6.548404E-04_EB, 1.095785E-01_EB, 2.657551E-02_EB, 3.608872E-01_EB, 5.693510E-03_EB, &
    6.441772E-04_EB, &
    4.549972E-02_EB, 3.578113E-03_EB, 3.095685E-02_EB, 2.380737E-02_EB, 2.193371E-01_EB, 1.156986E-02_EB, &
    6.052612E-04_EB/),(/7,8/))

SD1_C2H6(1:7,9:16) = RESHAPE((/ &  ! 770-805 cm-1
    6.171765E-02_EB, 3.922959E-02_EB, 3.545034E-02_EB, 5.296246E-02_EB, 8.951859E-02_EB, 1.898175E-02_EB, &
    5.650821E-04_EB, &
    9.823560E-02_EB, 2.946855E-02_EB, 1.350283E-01_EB, 5.866060E-02_EB, 1.325778E-01_EB, 3.185471E-02_EB, &
    5.662273E-04_EB, &
    1.065964E-01_EB, 1.605440E-01_EB, 1.183346E-01_EB, 5.788968E-02_EB, 3.425310E-01_EB, 3.202639E-01_EB, &
    5.934977E-04_EB, &
    1.481100E-01_EB, 1.342694E-01_EB, 1.196904E-01_EB, 3.372994E-01_EB, 1.453745E+00_EB, 2.821845E-01_EB, &
    5.520024E-04_EB, &
    1.662929E-01_EB, 3.361723E-01_EB, 8.779113E-02_EB, 9.018922E-02_EB, 1.164875E+00_EB, 4.276325E-01_EB, &
    6.295005E-04_EB, &
    2.046754E-01_EB, 2.548918E-01_EB, 1.239851E-01_EB, 2.037337E-01_EB, 5.164023E-01_EB, 3.471646E-01_EB, &
    6.359141E-04_EB, &
    2.449159E-01_EB, 2.517359E-01_EB, 1.357618E-01_EB, 2.008523E-01_EB, 4.792980E-01_EB, 5.713775E-01_EB, &
    5.983028E-04_EB, &
    2.924815E-01_EB, 2.401628E-01_EB, 1.358390E-01_EB, 1.279982E-01_EB, 3.201976E-01_EB, 8.184323E-01_EB, &
    5.917868E-04_EB/),(/7,8/))

SD1_C2H6(1:7,17:24) = RESHAPE((/ &  ! 810-845 cm-1
    3.173410E-01_EB, 2.693151E-01_EB, 1.884264E-01_EB, 1.891123E-01_EB, 1.945594E-01_EB, 7.448775E-01_EB, &
    6.340674E-04_EB, &
    3.553568E-01_EB, 2.412262E-01_EB, 1.899983E-01_EB, 2.195643E-01_EB, 4.179722E-01_EB, 8.583966E-01_EB, &
    5.735696E-04_EB, &
    3.453595E-01_EB, 2.276013E-01_EB, 1.862231E-01_EB, 2.879227E-01_EB, 3.982856E-01_EB, 1.671700E-01_EB, &
    5.897709E-04_EB, &
    3.720678E-01_EB, 2.304722E-01_EB, 2.026237E-01_EB, 1.631514E-01_EB, 5.101839E-01_EB, 6.698259E-02_EB, &
    5.985207E-04_EB, &
    3.528590E-01_EB, 2.669341E-01_EB, 2.013443E-01_EB, 1.964266E-01_EB, 4.694253E-01_EB, 6.041982E-02_EB, &
    5.838403E-04_EB, &
    3.343870E-01_EB, 2.342383E-01_EB, 2.344769E-01_EB, 2.185627E-01_EB, 1.388486E-01_EB, 6.719809E-02_EB, &
    5.408822E-04_EB, &
    3.063170E-01_EB, 2.200670E-01_EB, 1.828050E-01_EB, 2.008038E-01_EB, 3.045402E-01_EB, 7.835795E-02_EB, &
    3.562297E-03_EB, &
    2.812280E-01_EB, 2.289402E-01_EB, 1.997630E-01_EB, 1.791041E-01_EB, 3.363038E-01_EB, 1.008254E-01_EB, &
    1.293736E-02_EB/),(/7,8/))

SD1_C2H6(1:7,25:32) = RESHAPE((/ &  ! 850-885 cm-1
    2.687106E-01_EB, 2.264784E-01_EB, 1.683403E-01_EB, 1.401847E-01_EB, 2.005502E-01_EB, 1.271458E-01_EB, &
    2.173495E-02_EB, &
    2.581132E-01_EB, 2.374174E-01_EB, 1.679686E-01_EB, 1.547840E-01_EB, 1.243172E-01_EB, 1.077690E-01_EB, &
    4.536273E-02_EB, &
    2.144653E-01_EB, 1.721268E-01_EB, 1.514047E-01_EB, 1.306781E-01_EB, 1.314296E-01_EB, 1.339296E-01_EB, &
    3.552789E-02_EB, &
    1.917514E-01_EB, 1.387818E-01_EB, 2.034830E-01_EB, 1.515406E-01_EB, 1.066841E-01_EB, 7.662416E-02_EB, &
    2.133219E-02_EB, &
    1.782454E-01_EB, 1.306427E-01_EB, 1.520394E-01_EB, 2.390702E-01_EB, 2.481847E-01_EB, 6.844551E-02_EB, &
    2.418700E-02_EB, &
    1.322811E-01_EB, 1.207419E-01_EB, 1.466211E-01_EB, 1.319462E-01_EB, 1.939948E-01_EB, 6.030128E-02_EB, &
    5.442659E-02_EB, &
    1.021649E-01_EB, 9.558043E-02_EB, 1.447107E-01_EB, 1.003881E-01_EB, 2.851953E-01_EB, 5.587387E-02_EB, &
    7.616255E-02_EB, &
    7.374191E-02_EB, 9.820006E-02_EB, 8.581426E-02_EB, 8.911912E-02_EB, 7.307138E-02_EB, 7.078009E-02_EB, &
    1.050887E-01_EB/),(/7,8/))

SD1_C2H6(1:7,33:40) = RESHAPE((/ &  ! 890-925 cm-1
    6.223545E-02_EB, 1.186228E-01_EB, 6.756543E-02_EB, 1.345128E-01_EB, 9.761671E-02_EB, 2.189558E-01_EB, &
    1.799222E-01_EB, &
    3.554481E-02_EB, 6.673277E-02_EB, 4.525255E-02_EB, 9.370209E-02_EB, 1.295935E-01_EB, 2.511817E-01_EB, &
    6.888169E-02_EB, &
    3.124601E-02_EB, 1.124927E-01_EB, 3.565474E-02_EB, 2.187292E-01_EB, 9.112041E-02_EB, 2.228029E-01_EB, &
    1.718372E-01_EB, &
    2.914416E-02_EB, 1.378759E-02_EB, 2.647511E-02_EB, 3.448989E-02_EB, 3.381094E-02_EB, 3.019710E-01_EB, &
    1.723772E-01_EB, &
    1.841287E-02_EB, 2.569587E-03_EB, 1.982945E-02_EB, 2.027052E-02_EB, 2.718229E-01_EB, 3.654593E-01_EB, &
    1.667247E-01_EB, &
    1.660634E-02_EB, 5.077481E-04_EB, 1.272418E-02_EB, 9.173964E-03_EB, 2.365171E-02_EB, 3.827072E-01_EB, &
    3.145632E-01_EB, &
    1.157587E-02_EB, 4.761761E-04_EB, 4.793425E-03_EB, 4.710794E-02_EB, 3.493316E-02_EB, 3.471312E-01_EB, &
    8.809550E-02_EB, &
    9.363775E-03_EB, 5.856366E-04_EB, 2.317166E-03_EB, 6.779664E-03_EB, 1.754510E-02_EB, 2.575806E-01_EB, &
    9.941753E-02_EB/),(/7,8/))

SD1_C2H6(1:7,41:48) = RESHAPE((/ &  ! 930-965 cm-1
    2.703421E-03_EB, 6.011707E-04_EB, 2.550427E-03_EB, 1.612241E-03_EB, 1.169821E-02_EB, 2.415979E-01_EB, &
    1.249651E-01_EB, &
    2.651084E-03_EB, 5.917545E-04_EB, 5.042010E-04_EB, 2.199438E-02_EB, 3.565980E-03_EB, 2.365838E-01_EB, &
    5.184717E-02_EB, &
    7.296492E-04_EB, 6.179157E-04_EB, 4.743617E-04_EB, 3.812040E-03_EB, 8.725047E-04_EB, 2.078430E-01_EB, &
    8.530157E-02_EB, &
    5.480666E-04_EB, 6.114444E-04_EB, 5.217829E-04_EB, 1.862243E-03_EB, 4.761592E-04_EB, 2.588919E-01_EB, &
    1.103370E-01_EB, &
    6.292630E-04_EB, 6.056321E-04_EB, 6.189602E-04_EB, 5.406959E-04_EB, 5.073793E-04_EB, 1.776039E-01_EB, &
    1.162293E-01_EB, &
    6.147534E-04_EB, 6.316755E-04_EB, 6.494943E-04_EB, 6.349597E-04_EB, 1.021949E-03_EB, 1.706159E-01_EB, &
    1.253603E-01_EB, &
    5.295787E-04_EB, 6.155257E-04_EB, 5.738537E-04_EB, 5.889213E-04_EB, 6.123715E-04_EB, 8.076437E-02_EB, &
    1.333291E-01_EB, &
    5.939687E-04_EB, 5.705938E-04_EB, 5.433798E-04_EB, 5.595604E-04_EB, 6.032303E-04_EB, 1.440339E-02_EB, &
    1.209042E-01_EB/),(/7,8/))

SD1_C2H6(1:7,49:56) = RESHAPE((/ &  ! 970-1005 cm-1
    6.076011E-04_EB, 6.247931E-04_EB, 6.210977E-04_EB, 5.906424E-04_EB, 5.605877E-04_EB, 1.304106E-03_EB, &
    1.038211E-01_EB, &
    5.568001E-04_EB, 5.631578E-04_EB, 5.690637E-04_EB, 6.286270E-04_EB, 5.560269E-04_EB, 5.674964E-04_EB, &
    1.490422E-01_EB, &
    6.031718E-04_EB, 5.835255E-04_EB, 6.224477E-04_EB, 6.512348E-04_EB, 6.893931E-04_EB, 5.545678E-04_EB, &
    1.044452E-01_EB, &
    5.859556E-04_EB, 6.208885E-04_EB, 6.427015E-04_EB, 5.953784E-04_EB, 5.954965E-04_EB, 5.721422E-04_EB, &
    1.803091E-01_EB, &
    5.771365E-04_EB, 6.769549E-04_EB, 5.350124E-04_EB, 5.845623E-04_EB, 5.988053E-04_EB, 5.655932E-04_EB, &
    6.973313E-02_EB, &
    6.104291E-04_EB, 5.940867E-04_EB, 5.570016E-04_EB, 6.296483E-04_EB, 5.528823E-04_EB, 6.260908E-04_EB, &
    3.248840E-02_EB, &
    5.477759E-04_EB, 5.588435E-04_EB, 6.238415E-04_EB, 6.122790E-04_EB, 5.561536E-04_EB, 5.397771E-04_EB, &
    3.043585E-02_EB, &
    5.758325E-04_EB, 5.599324E-04_EB, 6.440217E-04_EB, 5.600414E-04_EB, 6.094887E-04_EB, 6.090445E-04_EB, &
    3.697414E-02_EB/),(/7,8/))

SD1_C2H6(1:7,57:64) = RESHAPE((/ &  ! 1010-1045 cm-1
    5.771611E-04_EB, 5.952499E-04_EB, 6.684843E-04_EB, 5.895284E-04_EB, 6.224352E-04_EB, 5.923383E-04_EB, &
    6.153913E-02_EB, &
    5.655646E-04_EB, 6.192065E-04_EB, 5.611474E-04_EB, 5.556904E-04_EB, 6.309032E-04_EB, 5.633688E-04_EB, &
    6.148906E-02_EB, &
    5.903213E-04_EB, 6.245301E-04_EB, 5.706255E-04_EB, 6.325202E-04_EB, 5.806419E-04_EB, 5.449552E-04_EB, &
    1.495286E-01_EB, &
    5.775728E-04_EB, 5.941511E-04_EB, 5.429387E-04_EB, 6.363537E-04_EB, 5.814826E-04_EB, 5.741843E-04_EB, &
    2.111578E-01_EB, &
    5.712454E-04_EB, 6.798137E-04_EB, 5.690925E-04_EB, 5.862564E-04_EB, 5.746134E-04_EB, 5.743120E-04_EB, &
    3.659751E-01_EB, &
    6.791103E-04_EB, 5.661152E-04_EB, 6.833618E-04_EB, 6.120201E-04_EB, 6.017759E-04_EB, 5.523163E-04_EB, &
    2.764061E-01_EB, &
    6.082420E-04_EB, 5.853773E-04_EB, 5.892656E-04_EB, 5.504792E-04_EB, 6.030549E-04_EB, 5.571454E-04_EB, &
    1.055773E-01_EB, &
    5.821916E-04_EB, 5.998309E-04_EB, 6.027881E-04_EB, 5.686535E-04_EB, 5.419230E-04_EB, 5.645053E-04_EB, &
    1.120062E-01_EB/),(/7,8/))

SD1_C2H6(1:7,65:72) = RESHAPE((/ &  ! 1050-1085 cm-1
    5.742524E-04_EB, 5.758224E-04_EB, 6.015966E-04_EB, 5.880442E-04_EB, 6.156445E-04_EB, 6.154221E-04_EB, &
    2.166512E-01_EB, &
    5.757372E-04_EB, 5.818479E-04_EB, 5.422953E-04_EB, 5.422969E-04_EB, 5.828935E-04_EB, 5.464803E-04_EB, &
    1.169102E-01_EB, &
    5.885987E-04_EB, 6.011767E-04_EB, 5.696307E-04_EB, 5.653754E-04_EB, 5.622029E-04_EB, 5.857177E-04_EB, &
    2.348611E-02_EB, &
    5.661538E-04_EB, 6.266748E-04_EB, 5.331363E-04_EB, 5.609109E-04_EB, 5.397012E-04_EB, 6.112279E-04_EB, &
    1.688024E-02_EB, &
    6.048814E-04_EB, 5.831322E-04_EB, 6.001442E-04_EB, 5.838624E-04_EB, 5.770951E-04_EB, 5.708753E-04_EB, &
    8.412044E-03_EB, &
    6.198694E-04_EB, 5.521161E-04_EB, 6.267105E-04_EB, 5.503612E-04_EB, 5.156425E-04_EB, 5.273586E-04_EB, &
    2.679004E-03_EB, &
    6.039607E-04_EB, 5.510536E-04_EB, 5.928776E-04_EB, 5.739141E-04_EB, 6.310402E-04_EB, 5.784724E-04_EB, &
    5.654607E-04_EB, &
    5.707152E-04_EB, 6.004682E-04_EB, 5.594182E-04_EB, 5.721055E-04_EB, 6.433943E-04_EB, 5.879097E-04_EB, &
    5.665859E-04_EB/),(/7,8/))

SD1_C2H6(1:7,73:74) = RESHAPE((/ &  ! 1090-1095 cm-1
    5.239685E-04_EB, 5.064051E-04_EB, 5.629911E-04_EB, 5.157217E-04_EB, 5.480959E-04_EB, 5.994907E-04_EB, &
    5.216709E-04_EB, &
    4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, &
    4.743617E-04_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C2H6(N_TEMP_C2H6,74)) 

! BAND #1: 730 cm-1 - 1095 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 0.64336 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C2H6(1:7,1:8) = RESHAPE((/ &  ! 730-765 cm-1
    4.065575E-04_EB, 4.355558E-04_EB, 4.228863E-04_EB, 4.106255E-04_EB, 3.942893E-04_EB, 4.671604E-04_EB, &
    4.827316E-04_EB, &
    4.364459E-04_EB, 4.213089E-04_EB, 5.168558E-04_EB, 4.553271E-04_EB, 4.329784E-04_EB, 4.523539E-04_EB, &
    4.545475E-04_EB, &
    4.823483E-04_EB, 5.132247E-04_EB, 3.766468E-04_EB, 6.201220E-03_EB, 4.302422E-04_EB, 4.876724E-04_EB, &
    4.254955E-04_EB, &
    4.999074E-04_EB, 4.316368E-04_EB, 1.101103E-03_EB, 3.106174E-02_EB, 9.593911E-04_EB, 1.262551E-02_EB, &
    3.931345E-04_EB, &
    4.742162E-03_EB, 4.518823E-04_EB, 1.044055E-03_EB, 1.949221E-02_EB, 5.988492E-05_EB, 1.136777E-01_EB, &
    4.083926E-04_EB, &
    8.543059E-03_EB, 4.694681E-04_EB, 2.243946E-03_EB, 5.109109E-02_EB, 7.926472E-05_EB, 9.577946E-02_EB, &
    3.816743E-04_EB, &
    6.667501E-03_EB, 4.476922E-04_EB, 1.379459E-04_EB, 2.388976E-02_EB, 1.153491E-04_EB, 9.057109E-02_EB, &
    4.714226E-04_EB, &
    2.589991E-02_EB, 2.701020E-04_EB, 4.725373E-03_EB, 1.558914E-02_EB, 1.786304E-04_EB, 1.441625E-01_EB, &
    4.554240E-04_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,9:16) = RESHAPE((/ &  ! 770-805 cm-1
    2.856124E-02_EB, 1.318576E-04_EB, 5.053706E-03_EB, 1.016653E-01_EB, 8.551605E-04_EB, 2.306278E-02_EB, &
    4.187159E-04_EB, &
    1.740593E-02_EB, 2.114282E-03_EB, 9.990637E-04_EB, 1.999957E-02_EB, 8.639734E-04_EB, 5.078021E-03_EB, &
    3.992225E-04_EB, &
    6.882291E-02_EB, 5.398417E-04_EB, 2.156292E-03_EB, 1.516361E-01_EB, 5.448851E-04_EB, 2.375035E-04_EB, &
    4.666743E-04_EB, &
    3.748741E-02_EB, 1.347061E-03_EB, 4.561516E-03_EB, 1.403395E-03_EB, 3.228862E-04_EB, 2.408338E-04_EB, &
    3.844600E-04_EB, &
    4.589468E-02_EB, 1.075882E-03_EB, 5.317133E-02_EB, 5.251399E-02_EB, 4.526403E-04_EB, 3.428031E-04_EB, &
    4.655344E-04_EB, &
    3.987347E-02_EB, 1.983889E-03_EB, 1.413881E-02_EB, 3.979607E-03_EB, 1.005338E-03_EB, 5.463778E-04_EB, &
    4.469478E-04_EB, &
    4.177949E-02_EB, 3.152471E-03_EB, 1.650987E-02_EB, 6.102480E-03_EB, 1.392942E-03_EB, 4.454008E-04_EB, &
    4.308386E-04_EB, &
    3.974218E-02_EB, 5.220746E-03_EB, 4.658894E-02_EB, 2.153448E-02_EB, 1.812465E-03_EB, 3.731443E-04_EB, &
    4.043599E-04_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,17:24) = RESHAPE((/ &  ! 810-845 cm-1
    4.076737E-02_EB, 5.759155E-03_EB, 1.183766E-02_EB, 9.112279E-03_EB, 4.089621E-03_EB, 3.592726E-04_EB, &
    4.776292E-04_EB, &
    4.485933E-02_EB, 9.946384E-03_EB, 1.548699E-02_EB, 8.770862E-03_EB, 1.899643E-03_EB, 2.885768E-04_EB, &
    4.275469E-04_EB, &
    5.041022E-02_EB, 1.095930E-02_EB, 1.866814E-02_EB, 6.000103E-03_EB, 1.860806E-03_EB, 1.779764E-03_EB, &
    4.504013E-04_EB, &
    7.308433E-02_EB, 2.279485E-02_EB, 2.844745E-02_EB, 1.187097E-01_EB, 1.828189E-03_EB, 2.668424E-01_EB, &
    4.708647E-04_EB, &
    8.338976E-02_EB, 1.425949E-02_EB, 2.832640E-02_EB, 2.272038E-02_EB, 2.506043E-03_EB, 2.538443E-01_EB, &
    4.411002E-04_EB, &
    8.428290E-02_EB, 1.876864E-02_EB, 1.628061E-02_EB, 1.279179E-02_EB, 1.707471E-02_EB, 2.853855E-01_EB, &
    3.802594E-04_EB, &
    1.333288E-01_EB, 1.994788E-02_EB, 4.071684E-02_EB, 1.492538E-02_EB, 3.505731E-03_EB, 1.564566E-01_EB, &
    4.759925E-03_EB, &
    1.391878E-01_EB, 1.507363E-02_EB, 2.196387E-02_EB, 2.409600E-02_EB, 2.902077E-03_EB, 1.354516E-02_EB, &
    1.079194E-01_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,25:32) = RESHAPE((/ &  ! 850-885 cm-1
    7.528749E-02_EB, 1.217793E-02_EB, 3.889715E-02_EB, 5.772348E-02_EB, 6.215872E-03_EB, 6.967528E-03_EB, &
    1.483152E-01_EB, &
    3.591791E-02_EB, 8.092085E-03_EB, 2.143969E-02_EB, 1.518013E-02_EB, 3.151289E-02_EB, 1.416365E-02_EB, &
    1.025578E+00_EB, &
    4.422868E-02_EB, 1.057217E-02_EB, 1.656500E-02_EB, 2.706264E-02_EB, 1.465974E-02_EB, 4.788098E-03_EB, &
    1.300530E-01_EB, &
    3.312658E-02_EB, 1.415742E-02_EB, 6.469016E-03_EB, 8.592658E-03_EB, 2.441114E-02_EB, 5.916498E-02_EB, &
    3.082106E-01_EB, &
    1.614554E-02_EB, 7.520189E-03_EB, 6.276428E-03_EB, 3.509355E-03_EB, 2.726573E-03_EB, 2.346823E-01_EB, &
    1.513687E-02_EB, &
    1.621958E-02_EB, 5.911032E-03_EB, 4.265330E-03_EB, 5.334278E-03_EB, 2.855891E-03_EB, 3.055740E-01_EB, &
    4.443058E-03_EB, &
    1.606695E-02_EB, 5.394283E-03_EB, 2.837413E-03_EB, 1.030847E-02_EB, 1.656611E-03_EB, 3.211414E-01_EB, &
    1.224770E-02_EB, &
    1.825113E-02_EB, 2.685010E-03_EB, 5.680955E-03_EB, 1.001663E-02_EB, 1.844295E-02_EB, 7.051788E-03_EB, &
    6.573867E-03_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,33:40) = RESHAPE((/ &  ! 890-925 cm-1
    7.404341E-03_EB, 1.028350E-03_EB, 6.748338E-03_EB, 2.216039E-03_EB, 3.783286E-03_EB, 8.400736E-04_EB, &
    2.755981E-03_EB, &
    1.203785E-02_EB, 1.131203E-03_EB, 2.460014E-02_EB, 2.348161E-03_EB, 1.220089E-03_EB, 5.505897E-04_EB, &
    1.980155E-02_EB, &
    6.056935E-03_EB, 3.201097E-04_EB, 1.868968E-02_EB, 5.609370E-04_EB, 1.538518E-03_EB, 4.038749E-04_EB, &
    1.835181E-03_EB, &
    2.568612E-03_EB, 2.396294E-03_EB, 1.376406E-02_EB, 2.621325E-03_EB, 1.322831E-02_EB, 2.282331E-04_EB, &
    1.452851E-03_EB, &
    6.462906E-03_EB, 1.566999E-03_EB, 8.873733E-03_EB, 6.470563E-03_EB, 2.579524E-04_EB, 1.862423E-04_EB, &
    1.540511E-03_EB, &
    3.039269E-03_EB, 3.761014E-04_EB, 2.265789E-03_EB, 2.575640E-03_EB, 8.630786E-03_EB, 1.836066E-04_EB, &
    9.394442E-04_EB, &
    4.193605E-03_EB, 3.785135E-04_EB, 2.729951E-03_EB, 9.845533E-05_EB, 2.185055E-03_EB, 1.849371E-04_EB, &
    2.188939E-03_EB, &
    5.364879E-03_EB, 4.284782E-04_EB, 1.400545E-03_EB, 6.405858E-04_EB, 7.240081E-03_EB, 1.581594E-04_EB, &
    2.672593E-03_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,41:48) = RESHAPE((/ &  ! 930-965 cm-1
    1.722587E-03_EB, 4.542534E-04_EB, 2.259724E-03_EB, 4.073858E-04_EB, 3.039512E-03_EB, 8.716326E-05_EB, &
    2.965197E-03_EB, &
    1.945004E-03_EB, 4.426679E-04_EB, 4.090160E-04_EB, 3.691019E-05_EB, 1.713772E-03_EB, 8.238204E-05_EB, &
    9.669855E-02_EB, &
    6.386875E-04_EB, 4.741196E-04_EB, 3.773490E-04_EB, 3.341163E-04_EB, 4.625415E-04_EB, 1.169249E-04_EB, &
    8.471653E-02_EB, &
    4.152211E-04_EB, 4.649281E-04_EB, 4.090191E-04_EB, 6.981832E-04_EB, 3.769026E-04_EB, 9.763637E-05_EB, &
    1.048370E+00_EB, &
    4.595069E-04_EB, 4.719666E-04_EB, 4.661009E-04_EB, 4.246292E-04_EB, 4.062256E-04_EB, 1.205473E-04_EB, &
    1.111446E+00_EB, &
    4.261372E-04_EB, 4.801092E-04_EB, 4.875336E-04_EB, 4.966089E-04_EB, 7.913657E-04_EB, 1.144280E-04_EB, &
    1.402395E-01_EB, &
    4.042500E-04_EB, 4.674334E-04_EB, 4.195668E-04_EB, 4.578474E-04_EB, 4.297564E-04_EB, 8.942797E-05_EB, &
    1.506895E-02_EB, &
    4.655065E-04_EB, 4.440281E-04_EB, 4.040655E-04_EB, 4.192518E-04_EB, 4.229453E-04_EB, 1.500183E-04_EB, &
    3.802567E-03_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,49:56) = RESHAPE((/ &  ! 970-1005 cm-1
    4.428162E-04_EB, 4.702223E-04_EB, 4.811994E-04_EB, 4.570333E-04_EB, 4.305955E-04_EB, 2.858868E-04_EB, &
    2.287959E-03_EB, &
    4.207792E-04_EB, 4.139409E-04_EB, 4.331308E-04_EB, 4.742665E-04_EB, 4.114105E-04_EB, 4.248428E-04_EB, &
    9.734912E-04_EB, &
    4.269730E-04_EB, 4.650857E-04_EB, 4.379320E-04_EB, 4.877286E-04_EB, 4.818705E-04_EB, 4.211942E-04_EB, &
    1.182784E-03_EB, &
    4.381611E-04_EB, 4.684275E-04_EB, 5.103428E-04_EB, 4.585259E-04_EB, 4.292931E-04_EB, 4.069094E-04_EB, &
    5.130052E-04_EB, &
    4.315161E-04_EB, 5.007011E-04_EB, 4.146885E-04_EB, 4.295870E-04_EB, 4.308357E-04_EB, 4.315919E-04_EB, &
    7.393255E-04_EB, &
    4.734151E-04_EB, 4.350865E-04_EB, 4.350654E-04_EB, 4.630863E-04_EB, 4.155547E-04_EB, 4.471774E-04_EB, &
    3.779056E-03_EB, &
    4.185621E-04_EB, 4.223976E-04_EB, 4.935876E-04_EB, 4.507534E-04_EB, 4.301265E-04_EB, 4.302431E-04_EB, &
    4.147488E-03_EB, &
    4.309314E-04_EB, 4.140175E-04_EB, 4.370239E-04_EB, 4.340690E-04_EB, 4.619978E-04_EB, 4.700917E-04_EB, &
    1.831102E-02_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,57:64) = RESHAPE((/ &  ! 1010-1045 cm-1
    4.247732E-04_EB, 4.745267E-04_EB, 4.780062E-04_EB, 4.240080E-04_EB, 4.500584E-04_EB, 4.376887E-04_EB, &
    2.567885E-03_EB, &
    4.203798E-04_EB, 4.864561E-04_EB, 4.297637E-04_EB, 4.010516E-04_EB, 4.883058E-04_EB, 4.055410E-04_EB, &
    4.217873E-03_EB, &
    4.672317E-04_EB, 4.751018E-04_EB, 4.522128E-04_EB, 4.760784E-04_EB, 4.344004E-04_EB, 3.971270E-04_EB, &
    1.176762E-03_EB, &
    4.298698E-04_EB, 4.471510E-04_EB, 4.163814E-04_EB, 4.771232E-04_EB, 4.417736E-04_EB, 4.268879E-04_EB, &
    7.321252E-04_EB, &
    4.457782E-04_EB, 5.315365E-04_EB, 4.355246E-04_EB, 4.365137E-04_EB, 4.385816E-04_EB, 4.105184E-04_EB, &
    4.753067E-04_EB, &
    4.748123E-04_EB, 4.174766E-04_EB, 5.116190E-04_EB, 4.461869E-04_EB, 4.473408E-04_EB, 4.164358E-04_EB, &
    5.363681E-04_EB, &
    4.663594E-04_EB, 4.481892E-04_EB, 4.677916E-04_EB, 4.300452E-04_EB, 4.572812E-04_EB, 4.221320E-04_EB, &
    1.020616E-03_EB, &
    4.273961E-04_EB, 4.448011E-04_EB, 4.677969E-04_EB, 4.334582E-04_EB, 4.038217E-04_EB, 4.286692E-04_EB, &
    1.009687E-03_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,65:72) = RESHAPE((/ &  ! 1050-1085 cm-1
    4.133460E-04_EB, 4.264153E-04_EB, 4.706217E-04_EB, 4.153495E-04_EB, 4.282576E-04_EB, 4.435459E-04_EB, &
    3.049954E-04_EB, &
    4.392871E-04_EB, 4.286852E-04_EB, 4.064771E-04_EB, 4.206134E-04_EB, 4.267351E-04_EB, 4.131956E-04_EB, &
    4.077901E-04_EB, &
    4.341453E-04_EB, 4.754603E-04_EB, 4.045311E-04_EB, 4.122859E-04_EB, 4.039747E-04_EB, 4.140579E-04_EB, &
    1.967494E-03_EB, &
    4.321753E-04_EB, 4.693335E-04_EB, 4.171935E-04_EB, 4.104922E-04_EB, 3.849807E-04_EB, 4.618845E-04_EB, &
    3.180481E-04_EB, &
    4.352910E-04_EB, 4.446729E-04_EB, 4.776830E-04_EB, 4.227150E-04_EB, 4.255088E-04_EB, 4.426307E-04_EB, &
    4.026746E-03_EB, &
    4.532445E-04_EB, 4.337078E-04_EB, 4.730406E-04_EB, 4.133673E-04_EB, 3.929524E-04_EB, 3.856039E-04_EB, &
    1.683698E-03_EB, &
    4.475384E-04_EB, 4.197029E-04_EB, 4.465486E-04_EB, 4.412465E-04_EB, 4.551924E-04_EB, 4.223691E-04_EB, &
    4.126406E-04_EB, &
    4.263874E-04_EB, 4.606209E-04_EB, 4.054779E-04_EB, 4.062386E-04_EB, 4.437677E-04_EB, 4.345062E-04_EB, &
    4.061153E-04_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,73:74) = RESHAPE((/ &  ! 1090-1095 cm-1
    3.915790E-04_EB, 3.972229E-04_EB, 4.391904E-04_EB, 3.993964E-04_EB, 4.100616E-04_EB, 4.704976E-04_EB, &
    4.210897E-04_EB, &
    3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, &
    3.773490E-04_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C2H6(N_TEMP_C2H6,19)) 

! BAND #2: 1250 cm-1 - 1700 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 1.4079 % 

SD2_C2H6(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    5.406154E-04_EB, 5.359836E-04_EB, 5.068710E-04_EB, 5.290541E-04_EB, 5.846661E-04_EB, 9.790007E-04_EB, &
    1.033382E-03_EB, &
    5.635285E-04_EB, 5.931464E-04_EB, 5.996161E-04_EB, 5.919406E-04_EB, 3.215772E-03_EB, 8.001527E-02_EB, &
    1.689879E-02_EB, &
    7.597373E-03_EB, 6.220529E-04_EB, 5.855704E-04_EB, 5.776749E-04_EB, 9.769176E-03_EB, 2.147420E-02_EB, &
    2.051290E-01_EB, &
    5.665394E-03_EB, 2.871094E-03_EB, 3.058827E-03_EB, 6.243937E-03_EB, 2.148619E-02_EB, 3.795392E-02_EB, &
    1.403007E-01_EB, &
    2.718010E-02_EB, 3.781331E-02_EB, 3.673178E-02_EB, 4.065980E-02_EB, 5.300384E-02_EB, 6.975728E-02_EB, &
    4.497725E-02_EB, &
    1.104006E-01_EB, 1.168480E-01_EB, 1.043664E-01_EB, 1.115175E-01_EB, 9.487101E-02_EB, 9.180434E-02_EB, &
    6.476559E-02_EB, &
    2.357004E-01_EB, 2.177341E-01_EB, 1.911829E-01_EB, 1.640602E-01_EB, 1.432644E-01_EB, 1.622884E-01_EB, &
    1.042990E-01_EB, &
    2.962360E-01_EB, 2.585360E-01_EB, 2.245752E-01_EB, 1.816093E-01_EB, 1.653938E-01_EB, 1.384864E-01_EB, &
    9.054463E-02_EB/),(/7,8/))

SD2_C2H6(1:7,9:16) = RESHAPE((/ &  ! 1450-1625 cm-1
    4.455755E-01_EB, 3.620878E-01_EB, 2.864854E-01_EB, 2.366804E-01_EB, 1.967883E-01_EB, 1.587402E-01_EB, &
    1.649379E-01_EB, &
    5.007041E-01_EB, 3.788713E-01_EB, 3.024415E-01_EB, 2.441476E-01_EB, 1.965719E-01_EB, 1.379278E-01_EB, &
    2.764153E-01_EB, &
    4.002584E-01_EB, 3.171792E-01_EB, 2.770663E-01_EB, 1.849208E-01_EB, 1.758798E-01_EB, 1.383502E-01_EB, &
    9.984220E-02_EB, &
    2.662911E-01_EB, 2.579530E-01_EB, 2.244504E-01_EB, 1.485266E-01_EB, 1.386995E-01_EB, 1.152807E-01_EB, &
    7.406491E-02_EB, &
    1.095962E-01_EB, 1.529279E-01_EB, 1.604770E-01_EB, 8.431699E-02_EB, 1.015281E-01_EB, 9.741162E-02_EB, &
    6.113480E-02_EB, &
    3.530781E-02_EB, 8.873062E-02_EB, 5.636380E-02_EB, 7.095729E-02_EB, 5.541741E-02_EB, 6.446964E-02_EB, &
    5.682161E-02_EB, &
    4.853975E-03_EB, 9.449521E-03_EB, 1.369312E-02_EB, 1.786119E-01_EB, 2.919823E-02_EB, 5.009505E-02_EB, &
    3.633541E-02_EB, &
    5.911553E-04_EB, 5.554787E-04_EB, 8.076306E-04_EB, 5.662847E-03_EB, 1.074946E-02_EB, 2.631678E-02_EB, &
    1.461045E-02_EB/),(/7,8/))

SD2_C2H6(1:7,17:19) = RESHAPE((/ &  ! 1650-1700 cm-1
    5.861991E-04_EB, 5.902278E-04_EB, 5.730461E-04_EB, 5.782324E-04_EB, 1.516772E-03_EB, 2.256041E-02_EB, &
    1.925866E-02_EB, &
    5.206242E-04_EB, 5.536321E-04_EB, 5.368849E-04_EB, 5.204248E-04_EB, 5.609159E-04_EB, 2.859073E-03_EB, &
    6.484770E-03_EB, &
    4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, &
    4.743617E-04_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C2H6(N_TEMP_C2H6,19)) 

! BAND #2: 1250 cm-1 - 1700 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 1.4079 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C2H6(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    4.168686E-04_EB, 4.193011E-04_EB, 3.973225E-04_EB, 4.080912E-04_EB, 4.602965E-04_EB, 6.755249E-04_EB, &
    6.105086E-04_EB, &
    4.255656E-04_EB, 4.664546E-04_EB, 4.505149E-04_EB, 4.365847E-04_EB, 2.825570E-03_EB, 8.950031E-05_EB, &
    5.621501E-03_EB, &
    1.175000E-02_EB, 4.753084E-04_EB, 4.360673E-04_EB, 4.337838E-04_EB, 1.015752E-02_EB, 1.801456E-03_EB, &
    1.629120E-04_EB, &
    1.319318E-02_EB, 1.975533E-03_EB, 3.099937E-03_EB, 1.191199E-03_EB, 4.143252E-02_EB, 3.540688E-03_EB, &
    5.712190E-04_EB, &
    1.882424E-01_EB, 7.238728E-03_EB, 1.503563E-02_EB, 2.044939E-02_EB, 1.202757E-01_EB, 7.734500E-03_EB, &
    8.373198E-02_EB, &
    4.947535E-01_EB, 2.816282E-02_EB, 6.125682E-02_EB, 1.847091E-02_EB, 1.295650E-01_EB, 1.222813E-02_EB, &
    1.176239E-01_EB, &
    2.215115E+00_EB, 4.610771E-02_EB, 4.515215E-02_EB, 8.434374E-02_EB, 1.460741E-01_EB, 7.869235E-03_EB, &
    9.018339E-02_EB, &
    3.020966E+00_EB, 4.951337E-02_EB, 5.062744E-02_EB, 1.703253E-01_EB, 8.812923E-02_EB, 2.055588E-02_EB, &
    5.461461E-02_EB/),(/7,8/))

GAMMAD2_C2H6(1:7,9:16) = RESHAPE((/ &  ! 1450-1625 cm-1
    3.763581E+00_EB, 4.719559E-02_EB, 6.925556E-02_EB, 8.350589E-02_EB, 8.135235E-02_EB, 1.584768E-02_EB, &
    5.945540E-03_EB, &
    4.890614E-01_EB, 5.402605E-02_EB, 6.600501E-02_EB, 8.285687E-02_EB, 8.014067E-02_EB, 2.426052E-02_EB, &
    2.045892E-03_EB, &
    4.999904E+00_EB, 4.971126E-02_EB, 4.141819E-02_EB, 1.621852E+00_EB, 5.311885E-02_EB, 1.264323E-02_EB, &
    1.598556E-02_EB, &
    4.999992E+00_EB, 2.835277E-02_EB, 2.748536E-02_EB, 1.777896E+00_EB, 9.313783E-02_EB, 1.486528E-02_EB, &
    2.147066E-02_EB, &
    2.954394E+00_EB, 1.560508E-02_EB, 1.464228E-02_EB, 3.035885E+00_EB, 6.012919E-02_EB, 1.056863E-02_EB, &
    3.429682E-02_EB, &
    2.582778E-01_EB, 2.470741E-03_EB, 3.160532E-02_EB, 7.760927E-03_EB, 3.744577E-01_EB, 7.210304E-03_EB, &
    6.394452E-03_EB, &
    6.347568E-03_EB, 5.009947E-03_EB, 2.436328E-02_EB, 3.662700E-04_EB, 1.085137E-01_EB, 2.913259E-03_EB, &
    1.781443E-02_EB, &
    4.411139E-04_EB, 4.165601E-04_EB, 6.313412E-04_EB, 1.761540E-03_EB, 2.148896E-01_EB, 1.915213E-03_EB, &
    9.605494E-03_EB/),(/7,8/))

GAMMAD2_C2H6(1:7,17:19) = RESHAPE((/ &  ! 1650-1700 cm-1
    4.512156E-04_EB, 4.374742E-04_EB, 4.370735E-04_EB, 4.393807E-04_EB, 1.199839E-03_EB, 4.305244E-04_EB, &
    1.649998E-03_EB, &
    4.031956E-04_EB, 4.224620E-04_EB, 4.171755E-04_EB, 3.973632E-04_EB, 4.242091E-04_EB, 1.323277E-03_EB, &
    2.599087E-03_EB, &
    3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, &
    3.773490E-04_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C2H6(N_TEMP_C2H6,34)) 

! BAND #3: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 1.2792 % 

SD3_C2H6(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    1.278631E-03_EB, 5.346182E-04_EB, 5.430166E-04_EB, 5.267664E-04_EB, 5.706555E-04_EB, 1.503218E-03_EB, &
    6.626536E-03_EB, &
    6.867023E-03_EB, 2.645379E-03_EB, 8.200217E-04_EB, 1.441211E-03_EB, 2.412511E-03_EB, 5.641695E-03_EB, &
    6.028765E-02_EB, &
    1.330293E-02_EB, 7.028078E-03_EB, 6.202133E-03_EB, 6.880801E-03_EB, 7.400560E-03_EB, 9.037836E-03_EB, &
    1.583349E-02_EB, &
    2.677183E-02_EB, 1.730813E-02_EB, 1.434674E-02_EB, 1.294128E-02_EB, 1.090652E-02_EB, 1.207559E-02_EB, &
    2.213233E-02_EB, &
    3.987599E-02_EB, 2.287674E-02_EB, 1.754802E-02_EB, 1.194543E-02_EB, 1.298163E-02_EB, 1.469952E-02_EB, &
    1.024135E-02_EB, &
    4.232113E-02_EB, 2.857075E-02_EB, 2.259893E-02_EB, 1.573626E-02_EB, 1.714592E-02_EB, 2.033346E-02_EB, &
    2.256246E-02_EB, &
    3.589681E-02_EB, 2.858390E-02_EB, 2.566367E-02_EB, 2.177878E-02_EB, 2.343653E-02_EB, 2.950501E-02_EB, &
    3.346439E-02_EB, &
    5.485484E-02_EB, 4.663213E-02_EB, 4.245721E-02_EB, 4.090042E-02_EB, 3.781863E-02_EB, 4.791877E-02_EB, &
    5.133626E-02_EB/),(/7,8/))

SD3_C2H6(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    8.916930E-02_EB, 7.433571E-02_EB, 6.405993E-02_EB, 6.479051E-02_EB, 6.033745E-02_EB, 7.495031E-02_EB, &
    8.995821E-02_EB, &
    1.412477E-01_EB, 1.057995E-01_EB, 9.517684E-02_EB, 9.989220E-02_EB, 8.583366E-02_EB, 1.000089E-01_EB, &
    1.267526E-01_EB, &
    9.064747E-02_EB, 8.717246E-02_EB, 8.559792E-02_EB, 1.015725E-01_EB, 9.826976E-02_EB, 1.477215E-01_EB, &
    2.124189E-01_EB, &
    1.737614E-01_EB, 1.555318E-01_EB, 1.650781E-01_EB, 1.829590E-01_EB, 1.982934E-01_EB, 2.777126E-01_EB, &
    3.317495E-01_EB, &
    4.521292E-01_EB, 4.726512E-01_EB, 5.006276E-01_EB, 5.180828E-01_EB, 5.264906E-01_EB, 5.587770E-01_EB, &
    5.221364E-01_EB, &
    1.960417E+00_EB, 1.488009E+00_EB, 1.325819E+00_EB, 1.193948E+00_EB, 1.023142E+00_EB, 8.706423E-01_EB, &
    7.614067E-01_EB, &
    2.619829E+00_EB, 1.938962E+00_EB, 1.736941E+00_EB, 1.598513E+00_EB, 1.380086E+00_EB, 1.156576E+00_EB, &
    9.358645E-01_EB, &
    4.387797E+00_EB, 3.345549E+00_EB, 2.910776E+00_EB, 2.586735E+00_EB, 2.087763E+00_EB, 1.532386E+00_EB, &
    1.133749E+00_EB/),(/7,8/))

SD3_C2H6(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    4.760136E+00_EB, 3.502455E+00_EB, 3.015336E+00_EB, 2.673966E+00_EB, 2.167642E+00_EB, 1.592935E+00_EB, &
    1.171784E+00_EB, &
    5.991591E+00_EB, 4.160592E+00_EB, 3.491255E+00_EB, 3.023591E+00_EB, 2.402963E+00_EB, 1.700855E+00_EB, &
    1.248091E+00_EB, &
    5.189753E+00_EB, 3.545092E+00_EB, 2.959661E+00_EB, 2.560262E+00_EB, 2.030599E+00_EB, 1.436739E+00_EB, &
    1.057780E+00_EB, &
    3.399205E+00_EB, 2.458139E+00_EB, 2.085537E+00_EB, 1.800846E+00_EB, 1.459347E+00_EB, 1.044487E+00_EB, &
    8.043099E-01_EB, &
    1.304899E+00_EB, 1.261802E+00_EB, 1.164708E+00_EB, 1.050827E+00_EB, 9.350992E-01_EB, 7.458636E-01_EB, &
    5.809439E-01_EB, &
    2.848068E-01_EB, 4.496074E-01_EB, 4.816560E-01_EB, 4.686610E-01_EB, 5.016620E-01_EB, 4.682443E-01_EB, &
    4.005416E-01_EB, &
    5.440868E-02_EB, 1.209876E-01_EB, 1.568322E-01_EB, 1.667785E-01_EB, 2.195699E-01_EB, 2.620493E-01_EB, &
    2.381302E-01_EB, &
    3.295548E-02_EB, 4.721377E-02_EB, 6.241951E-02_EB, 6.540635E-02_EB, 1.063108E-01_EB, 1.394730E-01_EB, &
    1.543657E-01_EB/),(/7,8/))

SD3_C2H6(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    3.092152E-02_EB, 8.184958E-02_EB, 3.505012E-02_EB, 3.624909E-02_EB, 6.834664E-02_EB, 8.734229E-02_EB, &
    1.216039E-01_EB, &
    3.775074E-02_EB, 1.357337E-01_EB, 3.735317E-02_EB, 3.269957E-02_EB, 9.913746E-02_EB, 9.035808E-02_EB, &
    2.845517E-01_EB, &
    9.286505E-02_EB, 2.482742E-01_EB, 3.859544E-02_EB, 3.157177E-02_EB, 1.764883E-01_EB, 3.788249E-02_EB, &
    5.090983E-01_EB, &
    4.762418E-02_EB, 2.189367E-01_EB, 7.767972E-02_EB, 3.289977E-02_EB, 2.088517E-01_EB, 3.141762E-02_EB, &
    3.194004E-01_EB, &
    5.466099E-02_EB, 3.299725E-01_EB, 4.598537E-02_EB, 2.883009E-02_EB, 2.465241E-01_EB, 2.674555E-02_EB, &
    5.702925E-02_EB, &
    3.859932E-02_EB, 1.747511E-01_EB, 3.500425E-02_EB, 1.547130E-02_EB, 1.888657E-01_EB, 3.819709E-02_EB, &
    1.532549E-02_EB, &
    1.828067E-02_EB, 2.645383E-02_EB, 1.789789E-02_EB, 9.149377E-03_EB, 6.920950E-02_EB, 9.335489E-03_EB, &
    8.913597E-03_EB, &
    2.876205E-03_EB, 2.983736E-02_EB, 7.391573E-03_EB, 1.332503E-03_EB, 3.196601E-02_EB, 7.041496E-03_EB, &
    1.103675E-03_EB/),(/7,8/))

SD3_C2H6(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    5.193269E-04_EB, 3.806620E-03_EB, 2.745974E-03_EB, 5.563600E-04_EB, 3.720380E-03_EB, 1.198592E-03_EB, &
    5.465900E-04_EB, &
    4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, 4.743617E-04_EB, &
    4.743617E-04_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C2H6(N_TEMP_C2H6,34)) 

! BAND #3: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH ELSASSER MODEL 

! ERROR ASSOCIATED WITH ELSASSER FIT: 
! On Transmissivity: 1.2792 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C2H6(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    8.987123E-04_EB, 4.156271E-04_EB, 4.185431E-04_EB, 4.125143E-04_EB, 4.629171E-04_EB, 8.429269E-04_EB, &
    5.093847E-04_EB, &
    1.636167E-03_EB, 2.288425E-03_EB, 6.056796E-04_EB, 1.006410E-03_EB, 2.496917E-03_EB, 1.665380E-03_EB, &
    1.667081E-04_EB, &
    5.947699E-03_EB, 3.938343E-02_EB, 4.587519E-03_EB, 2.909699E-03_EB, 2.283257E-02_EB, 5.648316E-03_EB, &
    1.385594E-03_EB, &
    2.075328E-02_EB, 1.657261E-02_EB, 1.636629E-02_EB, 5.934638E-03_EB, 1.694260E-02_EB, 5.454026E-03_EB, &
    1.967477E-03_EB, &
    2.729024E-02_EB, 1.221631E-02_EB, 1.403428E-02_EB, 6.205497E-03_EB, 1.637883E-02_EB, 6.042106E-03_EB, &
    1.220761E-02_EB, &
    2.678922E-02_EB, 9.857640E-03_EB, 1.190676E-02_EB, 6.885989E-03_EB, 1.939217E-02_EB, 1.029156E-02_EB, &
    4.134482E-02_EB, &
    2.490657E-02_EB, 1.092657E-02_EB, 1.140549E-02_EB, 1.199349E-02_EB, 2.988502E-02_EB, 3.382431E-02_EB, &
    4.632037E-02_EB, &
    3.399308E-02_EB, 2.395784E-02_EB, 1.982461E-02_EB, 2.314924E-02_EB, 8.248086E-02_EB, 2.932734E-02_EB, &
    9.850899E-02_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    5.834996E-02_EB, 2.187817E-02_EB, 4.966391E-02_EB, 2.042000E-02_EB, 5.551388E-02_EB, 1.985863E-02_EB, &
    9.547659E-03_EB, &
    4.393761E-02_EB, 6.419055E-02_EB, 5.857240E-02_EB, 1.684324E-02_EB, 6.115140E-02_EB, 6.390415E-02_EB, &
    1.611348E-02_EB, &
    5.408265E-02_EB, 4.939645E-02_EB, 4.310356E-02_EB, 1.600602E-02_EB, 9.209742E-02_EB, 5.121932E-02_EB, &
    1.818012E-02_EB, &
    4.138901E-02_EB, 8.840999E-02_EB, 5.881691E-02_EB, 4.688817E-02_EB, 1.302829E-01_EB, 7.118456E-02_EB, &
    4.189509E-02_EB, &
    7.496009E-02_EB, 1.000755E-01_EB, 8.518565E-02_EB, 8.569542E-02_EB, 1.068026E-01_EB, 9.299683E-02_EB, &
    8.280234E-02_EB, &
    1.266170E-01_EB, 1.308858E-01_EB, 1.289707E-01_EB, 1.277401E-01_EB, 1.348358E-01_EB, 1.115338E-01_EB, &
    9.063402E-02_EB, &
    1.379772E-01_EB, 1.376555E-01_EB, 1.371133E-01_EB, 1.358079E-01_EB, 1.410473E-01_EB, 1.241029E-01_EB, &
    1.152637E-01_EB, &
    1.732567E-01_EB, 1.624515E-01_EB, 1.622765E-01_EB, 1.566939E-01_EB, 1.580995E-01_EB, 1.325756E-01_EB, &
    1.190296E-01_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.629801E-01_EB, 1.572228E-01_EB, 1.607573E-01_EB, 1.602147E-01_EB, 1.597308E-01_EB, 1.366177E-01_EB, &
    1.239638E-01_EB, &
    1.218347E-01_EB, 1.206940E-01_EB, 1.292850E-01_EB, 1.359550E-01_EB, 1.436259E-01_EB, 1.346691E-01_EB, &
    1.189694E-01_EB, &
    1.113544E-01_EB, 1.150246E-01_EB, 1.252190E-01_EB, 1.310165E-01_EB, 1.388671E-01_EB, 1.283522E-01_EB, &
    1.115651E-01_EB, &
    1.415286E-01_EB, 1.358904E-01_EB, 1.421489E-01_EB, 1.470904E-01_EB, 1.408633E-01_EB, 1.254801E-01_EB, &
    9.382854E-02_EB, &
    1.159798E-01_EB, 1.137767E-01_EB, 1.224513E-01_EB, 1.400724E-01_EB, 1.302837E-01_EB, 1.107673E-01_EB, &
    9.703324E-02_EB, &
    7.026348E-02_EB, 7.360412E-02_EB, 8.535299E-02_EB, 1.407620E-01_EB, 1.041217E-01_EB, 1.061057E-01_EB, &
    9.713410E-02_EB, &
    2.473346E-02_EB, 5.408856E-02_EB, 5.255453E-02_EB, 1.619457E-01_EB, 7.898190E-02_EB, 8.049525E-02_EB, &
    1.319821E-01_EB, &
    9.561800E-03_EB, 2.204258E-02_EB, 2.505458E-02_EB, 5.085320E-02_EB, 1.886887E-02_EB, 4.106895E-02_EB, &
    8.506675E-02_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    6.199429E-03_EB, 7.700301E-04_EB, 1.304441E-02_EB, 1.165089E-02_EB, 6.121760E-03_EB, 7.723699E-03_EB, &
    9.247247E-03_EB, &
    5.512754E-03_EB, 4.348947E-04_EB, 5.061116E-03_EB, 2.872862E-03_EB, 9.799525E-04_EB, 1.261306E-03_EB, &
    6.167608E-04_EB, &
    1.315285E-03_EB, 3.102725E-04_EB, 4.531921E-03_EB, 4.540719E-03_EB, 3.410968E-04_EB, 3.719216E-03_EB, &
    1.977959E-04_EB, &
    2.308578E-02_EB, 4.062146E-04_EB, 9.853401E-04_EB, 2.324190E-03_EB, 3.590737E-04_EB, 3.375483E-03_EB, &
    1.342035E-04_EB, &
    5.862407E-03_EB, 2.425860E-04_EB, 2.261722E-03_EB, 1.865524E-03_EB, 2.261636E-04_EB, 1.695130E-03_EB, &
    1.916471E-04_EB, &
    6.366272E-03_EB, 2.388410E-04_EB, 2.017685E-03_EB, 5.781345E-03_EB, 1.767858E-04_EB, 2.162570E-04_EB, &
    4.946303E-03_EB, &
    5.806760E-03_EB, 1.582040E-03_EB, 2.077387E-03_EB, 1.995684E-03_EB, 2.141755E-04_EB, 2.371606E-03_EB, &
    1.976485E-03_EB, &
    1.430859E-03_EB, 2.212544E-04_EB, 1.485309E-03_EB, 7.258822E-04_EB, 2.027707E-04_EB, 2.759567E-03_EB, &
    1.142740E-03_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    4.030704E-04_EB, 1.572503E-03_EB, 1.634529E-03_EB, 4.324501E-04_EB, 1.481407E-03_EB, 6.590681E-04_EB, &
    4.173498E-04_EB, &
    3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, 3.773490E-04_EB, &
    3.773490E-04_EB/),(/7,2/))

!-------------------------Ethylene DATA-------------------


! THERE ARE 4 BANDS FOR Ethylene

! BAND #1: 780 cm-1 - 1250 cm-1 
! BAND #2: 1300 cm-1 - 1600 cm-1 
! BAND #3: 1750 cm-1 - 2075 cm-1 
! BAND #4: 2800 cm-1 - 3400 cm-1 

N_TEMP_C2H4 = 6
N_BAND_C2H4 = 4
I_MODEL_C2H4 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C2H4_TEMP(N_TEMP_C2H4)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Ethylene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C2H4(N_BAND_C2H4,3)) 
ALLOCATE(Be_C2H4(N_BAND_C2H4)) 

OM_BND_C2H4 = RESHAPE((/ &
    780._EB, 1300._EB, 1750._EB, 2800._EB, &
    1250._EB, 1600._EB, 2075._EB, 3400._EB, &
     5._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C2H4,3/)) 

SD_C2H4_TEMP = (/ &
    296._EB, 400._EB, 450._EB, 500._EB, 601._EB, 801._EB/)

Be_C2H4 = (/ &
    1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C2H4(N_TEMP_C2H4,71)) 

! BAND #1: 780 cm-1 - 1250 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.2676 % 

SD1_C2H4(1:6,1:8) = RESHAPE((/ &  ! 780-815 cm-1
    9.081397E-04_EB, 9.294745E-04_EB, 9.263855E-04_EB, 9.303465E-04_EB, 2.489601E-03_EB, 3.096436E-02_EB, &
    1.021622E-03_EB, 9.383125E-04_EB, 9.778017E-04_EB, 1.032672E-03_EB, 9.730522E-03_EB, 4.105429E-01_EB, &
    9.647763E-04_EB, 9.726821E-04_EB, 2.919888E-03_EB, 2.276596E-03_EB, 1.007896E-01_EB, 9.364302E-01_EB, &
    9.307193E-04_EB, 2.710576E-03_EB, 1.332585E-01_EB, 6.020185E-03_EB, 1.692835E-01_EB, 9.700237E-01_EB, &
    1.079222E-03_EB, 8.794916E-03_EB, 1.605082E-02_EB, 1.495929E-02_EB, 2.086100E-01_EB, 9.955457E-01_EB, &
    1.013353E-03_EB, 1.590194E-02_EB, 9.497457E-03_EB, 2.209908E-02_EB, 1.744247E-01_EB, 6.405481E-02_EB, &
    1.689300E-03_EB, 3.205549E-02_EB, 1.446142E-02_EB, 2.850301E-02_EB, 7.466983E-02_EB, 4.515018E-02_EB, &
    3.308019E-02_EB, 3.104853E-02_EB, 3.303361E-02_EB, 4.823456E-02_EB, 1.567817E-01_EB, 1.331768E-01_EB/),(/6,8/))

SD1_C2H4(1:6,9:16) = RESHAPE((/ &  ! 820-855 cm-1
    2.713869E-02_EB, 4.138280E-02_EB, 5.507994E-02_EB, 1.784996E-01_EB, 1.160585E-01_EB, 1.241207E+00_EB, &
    2.687836E-02_EB, 7.104927E-02_EB, 8.133647E-02_EB, 1.082138E-01_EB, 1.325524E-01_EB, 2.355525E-01_EB, &
    7.593733E-02_EB, 1.217589E-01_EB, 1.085256E-01_EB, 1.734007E-01_EB, 1.439789E-01_EB, 1.811115E-01_EB, &
    8.210985E-02_EB, 1.685703E-01_EB, 1.683916E-01_EB, 1.871888E-01_EB, 1.760504E-01_EB, 2.331361E-01_EB, &
    1.371072E-01_EB, 2.143576E-01_EB, 2.134052E-01_EB, 2.481057E-01_EB, 2.148015E-01_EB, 2.794853E-01_EB, &
    1.956334E-01_EB, 2.667818E-01_EB, 2.634399E-01_EB, 3.846976E-01_EB, 3.214448E-01_EB, 3.020669E-01_EB, &
    2.918050E-01_EB, 3.385805E-01_EB, 3.562974E-01_EB, 3.787789E-01_EB, 4.056414E-01_EB, 3.394445E-01_EB, &
    3.849871E-01_EB, 4.212268E-01_EB, 4.065791E-01_EB, 4.217874E-01_EB, 5.160131E-01_EB, 5.019707E-01_EB/),(/6,8/))

SD1_C2H4(1:6,17:24) = RESHAPE((/ &  ! 860-895 cm-1
    4.634382E-01_EB, 4.635243E-01_EB, 4.888543E-01_EB, 5.388030E-01_EB, 5.190807E-01_EB, 3.928065E-01_EB, &
    6.013120E-01_EB, 5.987909E-01_EB, 5.584424E-01_EB, 6.177917E-01_EB, 6.278992E-01_EB, 4.476505E-01_EB, &
    7.031073E-01_EB, 6.615380E-01_EB, 6.251273E-01_EB, 6.355987E-01_EB, 6.100862E-01_EB, 5.487234E-01_EB, &
    8.711894E-01_EB, 7.942263E-01_EB, 7.584193E-01_EB, 7.554499E-01_EB, 6.297300E-01_EB, 5.263466E-01_EB, &
    1.074915E+00_EB, 9.465021E-01_EB, 8.601755E-01_EB, 8.798344E-01_EB, 7.139527E-01_EB, 6.364076E-01_EB, &
    1.147363E+00_EB, 9.156059E-01_EB, 8.396757E-01_EB, 7.798749E-01_EB, 7.328137E-01_EB, 4.892931E-01_EB, &
    1.283269E+00_EB, 1.000781E+00_EB, 9.084331E-01_EB, 8.644973E-01_EB, 7.060873E-01_EB, 5.761302E-01_EB, &
    1.651841E+00_EB, 1.241598E+00_EB, 1.129451E+00_EB, 1.003677E+00_EB, 8.561921E-01_EB, 6.692158E-01_EB/),(/6,8/))

SD1_C2H4(1:6,25:32) = RESHAPE((/ &  ! 900-935 cm-1
    1.506997E+00_EB, 1.061346E+00_EB, 9.511259E-01_EB, 8.607393E-01_EB, 7.328887E-01_EB, 5.623156E-01_EB, &
    1.499127E+00_EB, 1.044651E+00_EB, 9.246873E-01_EB, 8.210147E-01_EB, 7.208529E-01_EB, 4.943186E-01_EB, &
    2.116718E+00_EB, 1.434322E+00_EB, 1.259118E+00_EB, 1.127278E+00_EB, 8.623463E-01_EB, 5.975001E-01_EB, &
    1.916461E+00_EB, 1.285983E+00_EB, 1.113217E+00_EB, 9.936391E-01_EB, 7.938319E-01_EB, 6.776147E-01_EB, &
    1.834026E+00_EB, 1.149206E+00_EB, 9.813661E-01_EB, 9.140666E-01_EB, 6.990761E-01_EB, 5.850342E-01_EB, &
    1.812867E+00_EB, 1.162976E+00_EB, 1.004963E+00_EB, 9.261925E-01_EB, 7.867516E-01_EB, 5.233223E-01_EB, &
    1.755238E+00_EB, 1.134957E+00_EB, 9.842444E-01_EB, 9.015184E-01_EB, 7.075624E-01_EB, 6.153110E-01_EB, &
    1.473409E+00_EB, 1.022807E+00_EB, 9.325511E-01_EB, 8.765379E-01_EB, 8.108575E-01_EB, 6.620778E-01_EB/),(/6,8/))

SD1_C2H4(1:6,33:40) = RESHAPE((/ &  ! 940-975 cm-1
    2.286209E+00_EB, 1.605524E+00_EB, 1.438314E+00_EB, 1.344957E+00_EB, 1.236417E+00_EB, 1.037909E+00_EB, &
    3.663536E+00_EB, 2.408096E+00_EB, 2.133479E+00_EB, 1.957412E+00_EB, 1.741177E+00_EB, 1.494317E+00_EB, &
    9.505953E+00_EB, 7.202869E+00_EB, 6.507080E+00_EB, 5.920821E+00_EB, 4.767461E+00_EB, 3.226504E+00_EB, &
    2.741593E+00_EB, 2.180021E+00_EB, 2.103918E+00_EB, 2.095984E+00_EB, 1.963123E+00_EB, 1.882054E+00_EB, &
    1.875240E+00_EB, 1.337190E+00_EB, 1.208299E+00_EB, 1.178251E+00_EB, 1.062700E+00_EB, 1.040810E+00_EB, &
    1.842931E+00_EB, 1.231681E+00_EB, 1.077116E+00_EB, 1.008715E+00_EB, 7.893430E-01_EB, 7.196698E-01_EB, &
    2.129020E+00_EB, 1.272329E+00_EB, 1.071162E+00_EB, 9.558836E-01_EB, 7.270824E-01_EB, 5.987513E-01_EB, &
    1.595364E+00_EB, 1.039071E+00_EB, 9.051195E-01_EB, 8.448724E-01_EB, 6.654965E-01_EB, 5.564605E-01_EB/),(/6,8/))

SD1_C2H4(1:6,41:48) = RESHAPE((/ &  ! 980-1015 cm-1
    2.088728E+00_EB, 1.297716E+00_EB, 1.109158E+00_EB, 9.829116E-01_EB, 7.742439E-01_EB, 5.708989E-01_EB, &
    2.247430E+00_EB, 1.450558E+00_EB, 1.240021E+00_EB, 1.091117E+00_EB, 8.304258E-01_EB, 6.721174E-01_EB, &
    2.057826E+00_EB, 1.259647E+00_EB, 1.073551E+00_EB, 9.576748E-01_EB, 7.477572E-01_EB, 5.873691E-01_EB, &
    1.955972E+00_EB, 1.321577E+00_EB, 1.146044E+00_EB, 1.027902E+00_EB, 8.277006E-01_EB, 6.024195E-01_EB, &
    1.697282E+00_EB, 1.134500E+00_EB, 1.026408E+00_EB, 9.360421E-01_EB, 7.693571E-01_EB, 6.389523E-01_EB, &
    2.093169E+00_EB, 1.477797E+00_EB, 1.277591E+00_EB, 1.148558E+00_EB, 8.958392E-01_EB, 6.142225E-01_EB, &
    1.526812E+00_EB, 1.070373E+00_EB, 9.571589E-01_EB, 8.727550E-01_EB, 7.405111E-01_EB, 5.491446E-01_EB, &
    1.447630E+00_EB, 1.129075E+00_EB, 1.009346E+00_EB, 9.304204E-01_EB, 8.034822E-01_EB, 5.763927E-01_EB/),(/6,8/))

SD1_C2H4(1:6,49:56) = RESHAPE((/ &  ! 1020-1055 cm-1
    1.357903E+00_EB, 1.046490E+00_EB, 9.471644E-01_EB, 8.861470E-01_EB, 7.576271E-01_EB, 6.195161E-01_EB, &
    1.213027E+00_EB, 9.544952E-01_EB, 8.665314E-01_EB, 8.200370E-01_EB, 6.761676E-01_EB, 5.328910E-01_EB, &
    1.131909E+00_EB, 9.461339E-01_EB, 8.747069E-01_EB, 8.179827E-01_EB, 7.077055E-01_EB, 5.735536E-01_EB, &
    8.933950E-01_EB, 7.761882E-01_EB, 7.247479E-01_EB, 7.233341E-01_EB, 6.203758E-01_EB, 5.628734E-01_EB, &
    6.836812E-01_EB, 6.487627E-01_EB, 6.223903E-01_EB, 6.215930E-01_EB, 5.387480E-01_EB, 4.970792E-01_EB, &
    7.539583E-01_EB, 7.039909E-01_EB, 6.720419E-01_EB, 6.588724E-01_EB, 5.885222E-01_EB, 5.398632E-01_EB, &
    6.278837E-01_EB, 6.063466E-01_EB, 6.005371E-01_EB, 5.768196E-01_EB, 5.325246E-01_EB, 4.745537E-01_EB, &
    4.735592E-01_EB, 4.625928E-01_EB, 4.798031E-01_EB, 4.863119E-01_EB, 4.588044E-01_EB, 3.898180E-01_EB/),(/6,8/))

SD1_C2H4(1:6,57:64) = RESHAPE((/ &  ! 1060-1095 cm-1
    4.238331E-01_EB, 4.441920E-01_EB, 4.518744E-01_EB, 4.518290E-01_EB, 4.520872E-01_EB, 3.766904E-01_EB, &
    2.901678E-01_EB, 3.549697E-01_EB, 3.601021E-01_EB, 3.799372E-01_EB, 4.059633E-01_EB, 4.100620E-01_EB, &
    3.632655E-01_EB, 4.082100E-01_EB, 4.095498E-01_EB, 4.073670E-01_EB, 4.331533E-01_EB, 3.656300E-01_EB, &
    2.283134E-01_EB, 2.713832E-01_EB, 2.837361E-01_EB, 3.073153E-01_EB, 3.411520E-01_EB, 2.865416E-01_EB, &
    2.065442E-01_EB, 2.507574E-01_EB, 2.690658E-01_EB, 3.056553E-01_EB, 3.123214E-01_EB, 3.272049E-01_EB, &
    1.491536E-01_EB, 1.992898E-01_EB, 2.160777E-01_EB, 2.352851E-01_EB, 2.663945E-01_EB, 2.686283E-01_EB, &
    1.178182E-01_EB, 1.736286E-01_EB, 2.025423E-01_EB, 2.257922E-01_EB, 2.403188E-01_EB, 2.812438E-01_EB, &
    1.207280E-01_EB, 1.635425E-01_EB, 1.886065E-01_EB, 1.981471E-01_EB, 2.144610E-01_EB, 2.477632E-01_EB/),(/6,8/))

SD1_C2H4(1:6,65:71) = RESHAPE((/ &  ! 1100-1250 cm-1
    8.736792E-02_EB, 1.303813E-01_EB, 1.559106E-01_EB, 1.727829E-01_EB, 2.019083E-01_EB, 2.216068E-01_EB, &
    2.691504E-02_EB, 4.702015E-02_EB, 6.479204E-02_EB, 7.921719E-02_EB, 1.007445E-01_EB, 1.349298E-01_EB, &
    6.724736E-03_EB, 8.087484E-03_EB, 2.538650E-02_EB, 3.184813E-02_EB, 4.000375E-02_EB, 6.656667E-02_EB, &
    9.712817E-04_EB, 9.920275E-04_EB, 5.370016E-03_EB, 8.835828E-03_EB, 1.441383E-02_EB, 3.389820E-02_EB, &
    1.002657E-03_EB, 1.018574E-03_EB, 1.092714E-03_EB, 9.894464E-04_EB, 1.441511E-03_EB, 8.988051E-03_EB, &
    9.256368E-04_EB, 9.121904E-04_EB, 9.088852E-04_EB, 9.248692E-04_EB, 9.218354E-04_EB, 1.052470E-03_EB, &
    8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB/),(/6,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C2H4(N_TEMP_C2H4,71)) 

! BAND #1: 780 cm-1 - 1250 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.2676 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C2H4(1:6,1:8) = RESHAPE((/ &  ! 780-815 cm-1
    7.062403E-04_EB, 7.263537E-04_EB, 7.141706E-04_EB, 6.946657E-04_EB, 2.117436E-03_EB, 2.673936E-03_EB, &
    7.829822E-04_EB, 6.968520E-04_EB, 7.762935E-04_EB, 7.889788E-04_EB, 3.773739E-03_EB, 3.072659E-04_EB, &
    7.126389E-04_EB, 7.380503E-04_EB, 1.770544E-03_EB, 1.719706E-03_EB, 2.031603E-04_EB, 3.639554E-04_EB, &
    7.032328E-04_EB, 1.869845E-03_EB, 1.498960E-04_EB, 5.325394E-02_EB, 2.960889E-04_EB, 4.748853E-04_EB, &
    8.344212E-04_EB, 5.098264E-03_EB, 2.145029E-02_EB, 7.216909E-02_EB, 4.840206E-04_EB, 6.620958E-04_EB, &
    7.559428E-04_EB, 3.756929E-03_EB, 9.943127E-02_EB, 1.680608E-02_EB, 1.037315E-03_EB, 3.817557E-01_EB, &
    1.555427E-03_EB, 1.763383E-03_EB, 6.153972E-01_EB, 1.832317E-01_EB, 9.857844E-03_EB, 9.068103E-01_EB, &
    3.238503E-04_EB, 9.940762E-03_EB, 1.394320E-01_EB, 4.226877E-01_EB, 5.718989E-03_EB, 5.239927E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,9:16) = RESHAPE((/ &  ! 820-855 cm-1
    1.894976E-03_EB, 5.533689E-02_EB, 3.352730E-01_EB, 4.156049E-03_EB, 1.268044E-02_EB, 1.440936E-03_EB, &
    3.989260E-02_EB, 6.123628E-02_EB, 1.748288E-01_EB, 1.136762E-01_EB, 7.566101E-02_EB, 1.578217E-02_EB, &
    3.748686E-03_EB, 2.063795E-02_EB, 6.395232E-01_EB, 2.161032E-02_EB, 1.539493E+00_EB, 1.870803E+00_EB, &
    1.731991E-01_EB, 3.606573E-02_EB, 1.711801E-01_EB, 1.182287E-01_EB, 2.156522E+00_EB, 7.297318E-02_EB, &
    3.718925E-02_EB, 5.802284E-02_EB, 2.385187E-01_EB, 1.163380E-01_EB, 3.508874E+00_EB, 3.028175E+00_EB, &
    1.250535E-01_EB, 1.555201E-01_EB, 1.353272E+00_EB, 4.653273E-02_EB, 9.757819E-02_EB, 1.945752E+00_EB, &
    1.073707E-01_EB, 3.064466E-01_EB, 3.033844E-01_EB, 1.832711E-01_EB, 7.193977E-02_EB, 2.580269E-01_EB, &
    1.403899E-01_EB, 2.970624E-01_EB, 3.173063E+00_EB, 1.036765E+00_EB, 6.928431E-02_EB, 5.163464E-02_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,17:24) = RESHAPE((/ &  ! 860-895 cm-1
    1.700209E-01_EB, 6.005349E-01_EB, 3.355907E-01_EB, 1.391500E-01_EB, 9.866157E-02_EB, 3.526835E-01_EB, &
    3.114422E-01_EB, 5.536291E-01_EB, 1.536790E+00_EB, 2.262736E-01_EB, 1.125813E-01_EB, 2.715292E+00_EB, &
    3.531868E-01_EB, 4.682108E-01_EB, 5.586927E-01_EB, 3.630199E-01_EB, 3.052033E-01_EB, 4.215026E-01_EB, &
    3.792054E-01_EB, 4.869108E-01_EB, 3.686363E-01_EB, 2.804414E-01_EB, 2.147201E+00_EB, 3.034741E+00_EB, &
    5.485905E-01_EB, 4.024693E-01_EB, 4.482705E-01_EB, 2.706961E-01_EB, 4.123206E-01_EB, 1.571677E-01_EB, &
    5.203928E-01_EB, 5.763570E-01_EB, 4.014208E-01_EB, 4.025810E-01_EB, 1.798309E-01_EB, 1.215076E+00_EB, &
    6.313988E-01_EB, 5.645700E-01_EB, 3.931925E-01_EB, 3.216380E-01_EB, 4.733183E-01_EB, 1.939021E-01_EB, &
    5.299200E-01_EB, 5.367177E-01_EB, 3.609363E-01_EB, 4.993058E-01_EB, 4.268917E-01_EB, 2.147109E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,25:32) = RESHAPE((/ &  ! 900-935 cm-1
    4.164019E-01_EB, 4.155156E-01_EB, 3.088547E-01_EB, 3.370571E-01_EB, 3.115683E-01_EB, 2.364094E-01_EB, &
    4.852264E-01_EB, 4.702245E-01_EB, 3.710357E-01_EB, 5.757705E-01_EB, 3.709130E-01_EB, 3.012928E+00_EB, &
    3.296288E-01_EB, 3.222475E-01_EB, 2.817825E-01_EB, 2.739514E-01_EB, 4.622214E-01_EB, 1.797155E+00_EB, &
    2.666494E-01_EB, 2.989870E-01_EB, 2.884852E-01_EB, 3.307280E-01_EB, 4.836295E-01_EB, 1.067013E-01_EB, &
    2.611043E-01_EB, 3.231005E-01_EB, 3.188877E-01_EB, 2.302749E-01_EB, 4.571463E-01_EB, 1.236148E-01_EB, &
    3.741347E-01_EB, 4.086729E-01_EB, 3.307067E-01_EB, 2.710804E-01_EB, 2.064931E-01_EB, 3.038071E+00_EB, &
    8.296697E-01_EB, 7.811136E-01_EB, 5.368860E-01_EB, 4.169795E-01_EB, 1.163365E+00_EB, 2.239407E-01_EB, &
    9.576878E-01_EB, 7.825809E-01_EB, 5.067524E-01_EB, 4.014722E-01_EB, 2.836955E-01_EB, 9.777381E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,33:40) = RESHAPE((/ &  ! 940-975 cm-1
    1.236444E+00_EB, 7.716515E-01_EB, 6.212984E-01_EB, 5.587597E-01_EB, 4.412419E-01_EB, 8.131811E-01_EB, &
    7.575712E-01_EB, 5.576862E-01_EB, 4.744233E-01_EB, 5.068279E-01_EB, 4.632095E-01_EB, 6.117277E-01_EB, &
    6.674555E-01_EB, 4.904283E-01_EB, 4.448525E-01_EB, 4.579310E-01_EB, 5.310072E-01_EB, 8.412202E-01_EB, &
    1.029197E+00_EB, 7.724724E-01_EB, 5.997770E-01_EB, 5.638372E-01_EB, 7.135595E-01_EB, 6.212118E-01_EB, &
    8.513704E-01_EB, 6.301684E-01_EB, 5.809610E-01_EB, 4.669093E-01_EB, 6.014768E-01_EB, 3.696563E-01_EB, &
    7.372271E-01_EB, 6.703787E-01_EB, 5.734891E-01_EB, 3.907031E-01_EB, 3.376349E+00_EB, 2.414251E-01_EB, &
    6.444788E-01_EB, 6.105449E-01_EB, 5.069273E-01_EB, 4.206551E-01_EB, 2.885879E+00_EB, 3.572059E-01_EB, &
    6.611267E-01_EB, 7.002017E-01_EB, 6.074161E-01_EB, 3.895216E-01_EB, 3.116630E+00_EB, 4.269833E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,41:48) = RESHAPE((/ &  ! 980-1015 cm-1
    3.903231E-01_EB, 4.242010E-01_EB, 3.960915E-01_EB, 3.804742E-01_EB, 7.642768E-01_EB, 4.458324E-01_EB, &
    4.439846E-01_EB, 4.570568E-01_EB, 4.145909E-01_EB, 3.910664E-01_EB, 8.589025E-01_EB, 1.727536E-01_EB, &
    2.962497E-01_EB, 3.512410E-01_EB, 3.314379E-01_EB, 3.130824E-01_EB, 7.342311E-01_EB, 2.137822E-01_EB, &
    4.244665E-01_EB, 4.356641E-01_EB, 4.041886E-01_EB, 3.517882E-01_EB, 4.487084E-01_EB, 6.516853E-01_EB, &
    4.460149E-01_EB, 4.969807E-01_EB, 3.690169E-01_EB, 3.580932E-01_EB, 7.328633E-01_EB, 2.515972E-01_EB, &
    6.807508E-01_EB, 6.284289E-01_EB, 5.552235E-01_EB, 4.763301E-01_EB, 6.514922E-01_EB, 3.033034E+00_EB, &
    4.380945E-01_EB, 4.589720E-01_EB, 4.172781E-01_EB, 4.060941E-01_EB, 5.406652E-01_EB, 2.939433E+00_EB, &
    7.147951E-01_EB, 5.677334E-01_EB, 5.406667E-01_EB, 5.396952E-01_EB, 4.328888E-01_EB, 2.112509E+00_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,49:56) = RESHAPE((/ &  ! 1020-1055 cm-1
    4.532844E-01_EB, 4.475268E-01_EB, 4.445984E-01_EB, 4.020068E-01_EB, 4.858181E-01_EB, 1.603249E-01_EB, &
    4.959578E-01_EB, 4.538826E-01_EB, 4.049977E-01_EB, 3.105613E-01_EB, 7.521067E-01_EB, 4.018211E-01_EB, &
    4.590588E-01_EB, 4.707185E-01_EB, 4.102188E-01_EB, 3.497129E-01_EB, 3.549335E-01_EB, 1.506293E-01_EB, &
    3.912242E-01_EB, 4.190358E-01_EB, 5.166711E-01_EB, 2.831777E-01_EB, 9.036223E-01_EB, 1.537971E-01_EB, &
    4.064895E-01_EB, 3.817382E-01_EB, 4.519899E-01_EB, 3.094252E-01_EB, 3.094293E+00_EB, 4.371191E-01_EB, &
    2.911889E-01_EB, 3.286802E-01_EB, 3.856792E-01_EB, 2.932473E-01_EB, 4.861265E-01_EB, 1.734921E-01_EB, &
    2.726799E-01_EB, 3.432745E-01_EB, 3.088589E-01_EB, 4.118285E-01_EB, 4.282344E-01_EB, 3.337220E-01_EB, &
    1.942269E-01_EB, 4.402853E-01_EB, 2.726554E-01_EB, 2.648462E-01_EB, 2.951458E-01_EB, 9.532120E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,57:64) = RESHAPE((/ &  ! 1060-1095 cm-1
    2.445925E-01_EB, 3.635560E-01_EB, 3.549222E-01_EB, 3.136583E-01_EB, 1.957082E-01_EB, 8.829384E-01_EB, &
    1.709271E-01_EB, 1.656483E-01_EB, 5.388146E-01_EB, 3.430729E-01_EB, 1.873446E-01_EB, 1.452306E-01_EB, &
    1.500161E-01_EB, 1.990900E-01_EB, 2.784229E-01_EB, 3.014937E-01_EB, 1.383912E-01_EB, 2.338286E+00_EB, &
    1.764343E-01_EB, 2.243447E-01_EB, 5.326273E-01_EB, 2.175158E-01_EB, 8.899940E-02_EB, 3.033742E+00_EB, &
    7.309827E-02_EB, 2.261722E-01_EB, 5.697571E-01_EB, 1.252185E-01_EB, 1.509198E-01_EB, 2.274981E-01_EB, &
    1.349498E-01_EB, 1.523886E-01_EB, 4.601865E-01_EB, 2.780082E-01_EB, 1.695873E-01_EB, 3.037100E+00_EB, &
    5.912413E-02_EB, 1.274394E-01_EB, 1.862443E-01_EB, 1.358552E-01_EB, 4.670319E-01_EB, 1.340571E-01_EB, &
    8.869365E-02_EB, 1.601770E-01_EB, 1.850212E-01_EB, 1.906310E-01_EB, 3.210075E-01_EB, 2.139164E-01_EB/),(/6,8/))

GAMMAD1_C2H4(1:6,65:71) = RESHAPE((/ &  ! 1100-1250 cm-1
    5.067213E-02_EB, 1.079354E-01_EB, 2.246982E-01_EB, 2.183319E-01_EB, 1.322625E-01_EB, 2.149497E-01_EB, &
    1.551811E-02_EB, 4.555635E-02_EB, 1.806742E-01_EB, 1.437815E-01_EB, 8.484912E-02_EB, 1.273987E-01_EB, &
    3.728632E-03_EB, 7.700617E-03_EB, 1.875163E-02_EB, 3.155935E-02_EB, 2.481050E-01_EB, 6.204931E-02_EB, &
    7.406237E-04_EB, 7.390717E-04_EB, 5.438991E-03_EB, 4.881870E-03_EB, 1.750757E-02_EB, 1.529768E-02_EB, &
    7.575049E-04_EB, 7.645573E-04_EB, 8.297787E-04_EB, 7.480000E-04_EB, 1.143039E-03_EB, 4.345575E-03_EB, &
    7.083170E-04_EB, 7.101645E-04_EB, 7.015211E-04_EB, 7.171853E-04_EB, 7.100724E-04_EB, 8.221738E-04_EB, &
    6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB/),(/6,7/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C2H4(N_TEMP_C2H4,13)) 

! BAND #2: 1300 cm-1 - 1600 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.12869 % 

SD2_C2H4(1:6,1:8) = RESHAPE((/ &  ! 1300-1475 cm-1
    9.279132E-04_EB, 9.273153E-04_EB, 9.244215E-04_EB, 9.229850E-04_EB, 9.261249E-04_EB, 9.299717E-04_EB, &
    9.890082E-04_EB, 9.683979E-04_EB, 9.860091E-04_EB, 9.911061E-04_EB, 1.013284E-03_EB, 1.137667E-03_EB, &
    1.004697E-03_EB, 1.001927E-03_EB, 4.032751E-03_EB, 2.894454E-03_EB, 9.684741E-03_EB, 1.870185E-02_EB, &
    1.290541E-02_EB, 2.689333E-02_EB, 4.626629E-02_EB, 5.603366E-02_EB, 7.507327E-02_EB, 1.084342E-01_EB, &
    2.571078E-01_EB, 2.609724E-01_EB, 2.727583E-01_EB, 2.566965E-01_EB, 2.520705E-01_EB, 2.202201E-01_EB, &
    5.162268E-01_EB, 3.186527E-01_EB, 2.710843E-01_EB, 2.246839E-01_EB, 1.761416E-01_EB, 1.146317E-01_EB, &
    4.604216E-01_EB, 3.011969E-01_EB, 2.667829E-01_EB, 2.381242E-01_EB, 2.016474E-01_EB, 1.710949E-01_EB, &
    3.853358E-01_EB, 2.647966E-01_EB, 2.373879E-01_EB, 2.121097E-01_EB, 1.779084E-01_EB, 1.275462E-01_EB/),(/6,8/))

SD2_C2H4(1:6,9:13) = RESHAPE((/ &  ! 1500-1600 cm-1
    6.040274E-02_EB, 7.375084E-02_EB, 8.039317E-02_EB, 7.955780E-02_EB, 9.080910E-02_EB, 8.251395E-02_EB, &
    1.602308E-03_EB, 2.473928E-03_EB, 6.878076E-03_EB, 7.290972E-03_EB, 1.847984E-02_EB, 2.574535E-02_EB, &
    1.011920E-03_EB, 9.881040E-04_EB, 1.003247E-03_EB, 1.005131E-03_EB, 9.998191E-04_EB, 1.412467E-03_EB, &
    9.644050E-04_EB, 9.391514E-04_EB, 9.104046E-04_EB, 9.369362E-04_EB, 9.196709E-04_EB, 9.392138E-04_EB, &
    8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C2H4(N_TEMP_C2H4,13)) 

! BAND #2: 1300 cm-1 - 1600 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.12869 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C2H4(1:6,1:8) = RESHAPE((/ &  ! 1300-1475 cm-1
    7.204600E-04_EB, 7.235461E-04_EB, 7.136643E-04_EB, 7.089708E-04_EB, 7.084399E-04_EB, 7.165571E-04_EB, &
    7.594734E-04_EB, 7.434589E-04_EB, 7.424998E-04_EB, 7.481608E-04_EB, 7.756310E-04_EB, 8.687294E-04_EB, &
    7.660533E-04_EB, 7.659200E-04_EB, 1.831062E-03_EB, 2.268359E-03_EB, 3.449460E-03_EB, 1.248015E-02_EB, &
    1.396120E-02_EB, 2.815807E-02_EB, 2.750300E-02_EB, 2.848507E-02_EB, 6.454111E-02_EB, 1.085965E-01_EB, &
    2.389312E-01_EB, 2.937900E-01_EB, 1.441234E-01_EB, 2.541463E-01_EB, 1.720353E-01_EB, 1.812790E-01_EB, &
    4.755596E-01_EB, 2.973970E-01_EB, 1.624394E-01_EB, 2.634443E-01_EB, 1.673237E-01_EB, 2.004237E-01_EB, &
    2.558697E-01_EB, 2.383813E-01_EB, 1.646664E-01_EB, 1.688364E-01_EB, 1.826411E-01_EB, 6.308910E-02_EB, &
    2.898946E-01_EB, 2.760012E-01_EB, 1.576121E-01_EB, 1.331925E-01_EB, 1.084082E-01_EB, 1.791748E-01_EB/),(/6,8/))

GAMMAD2_C2H4(1:6,9:13) = RESHAPE((/ &  ! 1500-1600 cm-1
    6.475277E-02_EB, 1.203005E-01_EB, 6.422857E-02_EB, 1.447939E-01_EB, 5.098841E-02_EB, 5.248047E-02_EB, &
    1.346456E-03_EB, 2.405781E-03_EB, 2.193237E-03_EB, 1.155254E-02_EB, 9.161078E-03_EB, 8.719563E-03_EB, &
    7.593505E-04_EB, 7.515284E-04_EB, 7.580799E-04_EB, 7.524118E-04_EB, 7.642180E-04_EB, 9.105729E-04_EB, &
    7.372788E-04_EB, 7.240530E-04_EB, 7.075171E-04_EB, 7.259431E-04_EB, 7.130592E-04_EB, 7.287962E-04_EB, &
    6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C2H4(N_TEMP_C2H4,14)) 

! BAND #3: 1750 cm-1 - 2075 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.058286 % 

SD3_C2H4(1:6,1:8) = RESHAPE((/ &  ! 1750-1925 cm-1
    9.219960E-04_EB, 9.442990E-04_EB, 9.380623E-04_EB, 8.954726E-04_EB, 9.610973E-04_EB, 9.223484E-04_EB, &
    9.837058E-04_EB, 9.785945E-04_EB, 9.961935E-04_EB, 9.737754E-04_EB, 1.163611E-03_EB, 3.225953E-03_EB, &
    9.931049E-04_EB, 9.789213E-04_EB, 1.138709E-03_EB, 1.314482E-03_EB, 7.743642E-03_EB, 1.602555E-02_EB, &
    1.496375E-02_EB, 1.436467E-02_EB, 2.520063E-02_EB, 2.681706E-02_EB, 3.791051E-02_EB, 4.370876E-02_EB, &
    1.371582E-01_EB, 1.038223E-01_EB, 1.047024E-01_EB, 9.504272E-02_EB, 9.197623E-02_EB, 7.279284E-02_EB, &
    1.857426E-01_EB, 1.045369E-01_EB, 9.744940E-02_EB, 8.375678E-02_EB, 7.099587E-02_EB, 5.559665E-02_EB, &
    2.497841E-01_EB, 1.428721E-01_EB, 1.267706E-01_EB, 1.089405E-01_EB, 9.015803E-02_EB, 7.435155E-02_EB, &
    1.934042E-01_EB, 1.541005E-01_EB, 1.474939E-01_EB, 1.342866E-01_EB, 1.207719E-01_EB, 9.801867E-02_EB/),(/6,8/))

SD3_C2H4(1:6,9:14) = RESHAPE((/ &  ! 1950-2075 cm-1
    1.521335E-02_EB, 2.148825E-02_EB, 3.024248E-02_EB, 3.219083E-02_EB, 4.108111E-02_EB, 5.266575E-02_EB, &
    1.015830E-03_EB, 9.761270E-04_EB, 1.077989E-03_EB, 1.053420E-03_EB, 2.407919E-03_EB, 6.421848E-03_EB, &
    1.000840E-03_EB, 1.006056E-03_EB, 9.594673E-04_EB, 9.921120E-04_EB, 9.835180E-04_EB, 9.797444E-04_EB, &
    1.004178E-03_EB, 9.832405E-04_EB, 9.867926E-04_EB, 1.004442E-03_EB, 9.858709E-04_EB, 9.653783E-04_EB, &
    9.092695E-04_EB, 9.271931E-04_EB, 9.357547E-04_EB, 9.281649E-04_EB, 9.390760E-04_EB, 9.317025E-04_EB, &
    8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C2H4(N_TEMP_C2H4,14)) 

! BAND #3: 1750 cm-1 - 2075 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.058286 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C2H4(1:6,1:8) = RESHAPE((/ &  ! 1750-1925 cm-1
    7.121480E-04_EB, 7.262154E-04_EB, 7.180518E-04_EB, 6.992712E-04_EB, 7.298344E-04_EB, 7.065556E-04_EB, &
    7.543992E-04_EB, 7.365769E-04_EB, 7.588834E-04_EB, 7.421876E-04_EB, 8.730687E-04_EB, 1.801460E-03_EB, &
    7.554629E-04_EB, 7.507014E-04_EB, 8.738316E-04_EB, 1.033889E-03_EB, 3.499036E-03_EB, 8.677167E-03_EB, &
    8.227847E-03_EB, 3.531288E-02_EB, 1.877540E-02_EB, 2.917302E-02_EB, 2.282468E-02_EB, 9.710123E-02_EB, &
    1.027164E-01_EB, 1.902058E-01_EB, 7.584584E-02_EB, 9.673877E-02_EB, 5.677529E-02_EB, 1.313532E-01_EB, &
    1.251371E-01_EB, 1.568075E-01_EB, 5.748433E-02_EB, 5.799735E-02_EB, 6.575178E-02_EB, 1.892414E-01_EB, &
    1.258243E-01_EB, 1.610282E-01_EB, 8.120469E-02_EB, 7.951463E-02_EB, 8.183984E-02_EB, 7.575063E-02_EB, &
    1.363982E-01_EB, 1.407116E-01_EB, 8.836505E-02_EB, 1.085263E-01_EB, 9.636277E-02_EB, 1.386479E-01_EB/),(/6,8/))

GAMMAD3_C2H4(1:6,9:14) = RESHAPE((/ &  ! 1950-2075 cm-1
    1.329009E-02_EB, 1.386426E-02_EB, 1.989346E-02_EB, 3.607434E-02_EB, 3.430325E-02_EB, 3.299565E-02_EB, &
    7.715392E-04_EB, 7.434870E-04_EB, 8.273537E-04_EB, 8.232965E-04_EB, 1.841268E-03_EB, 1.811223E-03_EB, &
    7.550436E-04_EB, 7.663353E-04_EB, 7.318042E-04_EB, 7.340964E-04_EB, 7.502689E-04_EB, 7.422655E-04_EB, &
    7.624676E-04_EB, 7.532816E-04_EB, 7.559871E-04_EB, 7.577967E-04_EB, 7.561721E-04_EB, 7.415111E-04_EB, &
    7.039615E-04_EB, 7.130211E-04_EB, 7.227245E-04_EB, 7.131451E-04_EB, 7.254599E-04_EB, 7.219594E-04_EB, &
    6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C2H4(N_TEMP_C2H4,25)) 

! BAND #4: 2800 cm-1 - 3400 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.18751 % 

SD4_C2H4(1:6,1:8) = RESHAPE((/ &  ! 2800-2975 cm-1
    9.196477E-04_EB, 9.205852E-04_EB, 9.415609E-04_EB, 9.339349E-04_EB, 9.377939E-04_EB, 9.253138E-04_EB, &
    1.948939E-03_EB, 9.820598E-04_EB, 9.878370E-04_EB, 9.931514E-04_EB, 1.015483E-03_EB, 9.936779E-04_EB, &
    4.225155E-03_EB, 9.979423E-04_EB, 1.429399E-03_EB, 1.101717E-03_EB, 3.387675E-03_EB, 3.848119E-03_EB, &
    1.541922E-02_EB, 1.018209E-03_EB, 9.828165E-03_EB, 4.197580E-03_EB, 1.098259E-02_EB, 1.506187E-02_EB, &
    1.839106E-02_EB, 7.931326E-03_EB, 2.112251E-02_EB, 1.685292E-02_EB, 3.591308E-02_EB, 5.813693E-02_EB, &
    7.051064E-02_EB, 8.693279E-02_EB, 1.151141E-01_EB, 1.080337E-01_EB, 1.296447E-01_EB, 1.360124E-01_EB, &
    4.292817E-01_EB, 3.442013E-01_EB, 3.239004E-01_EB, 2.817132E-01_EB, 2.431369E-01_EB, 1.862490E-01_EB, &
    6.012597E-01_EB, 3.809796E-01_EB, 3.430196E-01_EB, 2.893388E-01_EB, 2.636428E-01_EB, 2.144012E-01_EB/),(/6,8/))

SD4_C2H4(1:6,9:16) = RESHAPE((/ &  ! 3000-3175 cm-1
    7.762048E-01_EB, 4.753439E-01_EB, 3.984269E-01_EB, 3.402300E-01_EB, 2.983538E-01_EB, 2.411789E-01_EB, &
    7.170253E-01_EB, 5.836932E-01_EB, 5.334409E-01_EB, 4.818310E-01_EB, 4.382019E-01_EB, 3.612855E-01_EB, &
    5.313393E-01_EB, 4.669143E-01_EB, 4.452130E-01_EB, 4.101060E-01_EB, 3.943946E-01_EB, 3.352109E-01_EB, &
    8.638005E-01_EB, 5.868537E-01_EB, 4.933968E-01_EB, 4.184901E-01_EB, 3.515578E-01_EB, 2.372120E-01_EB, &
    7.473396E-01_EB, 4.634941E-01_EB, 3.773536E-01_EB, 3.204169E-01_EB, 2.691308E-01_EB, 1.973209E-01_EB, &
    1.075793E+00_EB, 6.901856E-01_EB, 5.863264E-01_EB, 4.953799E-01_EB, 4.099045E-01_EB, 3.087271E-01_EB, &
    7.618639E-01_EB, 5.710744E-01_EB, 5.119297E-01_EB, 4.355606E-01_EB, 3.816839E-01_EB, 2.986601E-01_EB, &
    3.829364E-01_EB, 2.996640E-01_EB, 2.758161E-01_EB, 2.360499E-01_EB, 2.322954E-01_EB, 1.869090E-01_EB/),(/6,8/))

SD4_C2H4(1:6,17:24) = RESHAPE((/ &  ! 3200-3375 cm-1
    1.995666E-01_EB, 1.773581E-01_EB, 1.698712E-01_EB, 1.453373E-01_EB, 1.528033E-01_EB, 1.313525E-01_EB, &
    1.008892E-01_EB, 8.849091E-02_EB, 9.058647E-02_EB, 7.397812E-02_EB, 1.099472E-01_EB, 1.281385E-01_EB, &
    2.554020E-02_EB, 3.191807E-02_EB, 5.917530E-02_EB, 2.447424E-02_EB, 8.973102E-02_EB, 5.369162E-02_EB, &
    7.475495E-03_EB, 4.939349E-03_EB, 6.848337E-03_EB, 3.684887E-03_EB, 3.195268E-02_EB, 1.771297E-02_EB, &
    5.997130E-03_EB, 1.007704E-03_EB, 9.556394E-04_EB, 9.608511E-04_EB, 1.485928E-02_EB, 6.626993E-03_EB, &
    2.282455E-03_EB, 9.656547E-04_EB, 9.765097E-04_EB, 1.015094E-03_EB, 9.909849E-04_EB, 9.771359E-04_EB, &
    9.621108E-04_EB, 9.799641E-04_EB, 9.821167E-04_EB, 9.838631E-04_EB, 9.909490E-04_EB, 9.874240E-04_EB, &
    9.424083E-04_EB, 9.068570E-04_EB, 9.317848E-04_EB, 9.359110E-04_EB, 9.232241E-04_EB, 9.161307E-04_EB/),(/6,8/))

SD4_C2H4(1:6,25:25) = RESHAPE((/ &  ! 3400-3400 cm-1
    8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB, 8.645026E-04_EB/),(/6,1/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C2H4(N_TEMP_C2H4,25)) 

! BAND #4: 2800 cm-1 - 3400 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.18751 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C2H4(1:6,1:8) = RESHAPE((/ &  ! 2800-2975 cm-1
    7.112603E-04_EB, 7.114654E-04_EB, 7.289473E-04_EB, 7.261743E-04_EB, 7.194537E-04_EB, 7.144383E-04_EB, &
    1.076586E-03_EB, 7.403376E-04_EB, 7.326974E-04_EB, 7.505928E-04_EB, 7.750715E-04_EB, 7.542379E-04_EB, &
    1.563220E-03_EB, 7.642951E-04_EB, 1.111717E-03_EB, 8.311487E-04_EB, 2.748361E-03_EB, 2.322678E-03_EB, &
    1.125483E-02_EB, 7.841542E-04_EB, 6.357404E-02_EB, 3.091055E-03_EB, 8.313047E-03_EB, 6.396653E-03_EB, &
    4.385346E-02_EB, 6.665216E-03_EB, 1.401162E-01_EB, 6.667880E-02_EB, 2.339770E-02_EB, 4.843494E-02_EB, &
    5.572982E-02_EB, 2.366442E-01_EB, 8.577598E-01_EB, 8.431427E-01_EB, 1.562732E-01_EB, 2.701328E-01_EB, &
    2.537313E-01_EB, 8.639170E-01_EB, 4.049970E+00_EB, 1.370226E+00_EB, 4.693701E-01_EB, 1.681940E-01_EB, &
    2.566421E-01_EB, 5.613758E-01_EB, 4.050459E+00_EB, 3.268285E+00_EB, 2.979237E-01_EB, 2.258563E-01_EB/),(/6,8/))

GAMMAD4_C2H4(1:6,9:16) = RESHAPE((/ &  ! 3000-3175 cm-1
    1.847591E-01_EB, 2.746024E-01_EB, 4.043030E+00_EB, 1.368760E+00_EB, 3.232859E-01_EB, 2.711939E-01_EB, &
    7.954318E-01_EB, 1.125877E+00_EB, 3.875057E+00_EB, 3.441776E+00_EB, 7.105988E-01_EB, 4.981249E-01_EB, &
    4.477357E-01_EB, 5.183503E-01_EB, 7.222029E-01_EB, 2.369014E+00_EB, 5.607387E-01_EB, 2.437247E-01_EB, &
    6.355275E-01_EB, 3.891620E-01_EB, 4.830097E-01_EB, 1.242821E+00_EB, 8.108797E-01_EB, 2.742511E-01_EB, &
    6.138993E-01_EB, 2.766311E-01_EB, 3.752238E-01_EB, 4.640894E-01_EB, 6.490255E-01_EB, 1.534504E-01_EB, &
    5.622288E-01_EB, 3.720395E-01_EB, 2.872879E-01_EB, 3.900929E-01_EB, 4.021110E-01_EB, 1.299057E-01_EB, &
    2.750640E-01_EB, 2.353369E-01_EB, 1.914636E-01_EB, 3.327059E-01_EB, 2.817036E-01_EB, 1.088329E-01_EB, &
    1.190635E-01_EB, 1.060178E-01_EB, 8.387637E-02_EB, 1.484284E-01_EB, 7.402726E-02_EB, 4.282846E-02_EB/),(/6,8/))

GAMMAD4_C2H4(1:6,17:24) = RESHAPE((/ &  ! 3200-3375 cm-1
    3.949202E-02_EB, 4.546226E-02_EB, 3.784049E-02_EB, 5.864944E-02_EB, 4.264405E-02_EB, 1.631238E-02_EB, &
    3.438038E-03_EB, 1.308622E-02_EB, 1.368345E-02_EB, 4.331880E-02_EB, 1.303476E-02_EB, 4.005084E-03_EB, &
    1.536943E-03_EB, 4.178781E-03_EB, 1.301337E-03_EB, 1.247217E-02_EB, 2.514407E-03_EB, 4.628642E-03_EB, &
    1.436265E-03_EB, 1.433498E-03_EB, 2.920760E-03_EB, 1.642393E-03_EB, 3.221106E-03_EB, 9.960303E-03_EB, &
    2.547261E-03_EB, 7.688175E-04_EB, 7.296401E-04_EB, 7.260751E-04_EB, 1.452626E-03_EB, 2.322270E-03_EB, &
    1.088525E-03_EB, 7.320774E-04_EB, 7.514290E-04_EB, 7.598369E-04_EB, 7.482434E-04_EB, 7.471218E-04_EB, &
    7.272770E-04_EB, 7.461192E-04_EB, 7.294186E-04_EB, 7.452995E-04_EB, 7.374534E-04_EB, 7.422225E-04_EB, &
    7.251778E-04_EB, 6.992918E-04_EB, 7.195863E-04_EB, 7.173893E-04_EB, 7.161041E-04_EB, 7.151194E-04_EB/),(/6,8/))

GAMMAD4_C2H4(1:6,25:25) = RESHAPE((/ &  ! 3400-3400 cm-1
    6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB, 6.792025E-04_EB/),(/6,1/))

!-------------------------Heptane DATA-------------------


! THERE ARE 2 BANDS FOR Heptane

! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 

N_TEMP_C7H16 = 6
N_BAND_C7H16 = 2
I_MODEL_C7H16 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C7H16_TEMP(N_TEMP_C7H16)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Heptane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C7H16(N_BAND_C7H16,3)) 
ALLOCATE(Be_C7H16(N_BAND_C7H16)) 

OM_BND_C7H16 = RESHAPE((/ &
    1100._EB, 2550._EB, &
    1800._EB, 3275._EB, &
     25._EB, 25._EB/),(/N_BAND_C7H16,3/)) 

SD_C7H16_TEMP = (/ &
    293._EB, 400._EB, 450._EB, 490._EB, 593._EB, 794._EB/)

Be_C7H16 = (/ &
    1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C7H16(N_TEMP_C7H16,29)) 

! BAND #1: 1100 cm-1 - 1800 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.51457 % 

SD1_C7H16(1:6,1:8) = RESHAPE((/ &  ! 1100-1275 cm-1
    4.247561E-03_EB, 4.056051E-03_EB, 4.119507E-03_EB, 4.179222E-03_EB, 4.430692E-03_EB, 4.167984E-03_EB, &
    4.550584E-03_EB, 5.072107E-03_EB, 4.593389E-03_EB, 4.469566E-03_EB, 4.637143E-03_EB, 4.667920E-03_EB, &
    4.501318E-03_EB, 4.780836E-03_EB, 4.725253E-03_EB, 4.424367E-03_EB, 4.437726E-03_EB, 4.696414E-03_EB, &
    4.406501E-03_EB, 4.710057E-03_EB, 6.452024E-03_EB, 4.599121E-03_EB, 4.619740E-03_EB, 4.509801E-03_EB, &
    4.642114E-03_EB, 4.612380E-03_EB, 1.158481E-02_EB, 1.472873E-02_EB, 6.121143E-03_EB, 2.475390E-02_EB, &
    5.821180E-02_EB, 3.980631E-02_EB, 3.891614E-02_EB, 3.077336E-02_EB, 4.666368E-02_EB, 3.988005E-02_EB, &
    7.508059E-02_EB, 5.431453E-02_EB, 6.249603E-02_EB, 6.737849E-02_EB, 9.868079E-02_EB, 8.032731E-02_EB, &
    1.235979E-01_EB, 1.079449E-01_EB, 1.056788E-01_EB, 1.044594E-01_EB, 1.122790E-01_EB, 1.426661E-01_EB/),(/6,8/))

SD1_C7H16(1:6,9:16) = RESHAPE((/ &  ! 1300-1475 cm-1
    1.938578E-01_EB, 1.531746E-01_EB, 1.514824E-01_EB, 1.516573E-01_EB, 1.796775E-01_EB, 1.922952E-01_EB, &
    2.044667E-01_EB, 2.122352E-01_EB, 2.086362E-01_EB, 2.186588E-01_EB, 2.662964E-01_EB, 3.076611E-01_EB, &
    4.871830E-01_EB, 8.131384E-01_EB, 6.199039E-01_EB, 4.394687E-01_EB, 5.839705E-01_EB, 4.825560E-01_EB, &
    2.139305E+00_EB, 1.706080E+00_EB, 1.460304E+00_EB, 1.149433E+00_EB, 8.953985E-01_EB, 6.514106E-01_EB, &
    1.140048E+00_EB, 1.290729E+00_EB, 9.839690E-01_EB, 8.617338E-01_EB, 7.900118E-01_EB, 5.056581E-01_EB, &
    2.596275E-01_EB, 3.247129E-01_EB, 3.468173E-01_EB, 5.208494E-01_EB, 5.388607E-01_EB, 4.706885E-01_EB, &
    2.490700E+00_EB, 2.242571E+00_EB, 1.861124E+00_EB, 1.569298E+00_EB, 1.327782E+00_EB, 1.061692E+00_EB, &
    4.043823E+00_EB, 2.917512E+00_EB, 2.141105E+00_EB, 1.805739E+00_EB, 1.349781E+00_EB, 8.141011E-01_EB/),(/6,8/))

SD1_C7H16(1:6,17:24) = RESHAPE((/ &  ! 1500-1675 cm-1
    4.151979E-01_EB, 4.334100E-01_EB, 5.053577E-01_EB, 3.865430E-01_EB, 4.153210E-01_EB, 3.314910E-01_EB, &
    1.298750E-01_EB, 1.765612E-01_EB, 1.929031E-01_EB, 1.560122E-01_EB, 1.761009E-01_EB, 1.780472E-01_EB, &
    1.060491E-01_EB, 1.102569E-01_EB, 1.166378E-01_EB, 7.741840E-02_EB, 7.825769E-02_EB, 7.581170E-02_EB, &
    4.383776E-03_EB, 4.159177E-02_EB, 3.823061E-02_EB, 7.347754E-02_EB, 2.642367E-02_EB, 6.239440E-02_EB, &
    4.507876E-03_EB, 1.212112E-02_EB, 1.344686E-02_EB, 1.391961E-01_EB, 4.522150E-03_EB, 7.924193E-01_EB, &
    4.365428E-03_EB, 4.708160E-03_EB, 4.519335E-03_EB, 3.145269E-02_EB, 4.653199E-03_EB, 4.928615E-02_EB, &
    4.564350E-03_EB, 4.789137E-03_EB, 4.769408E-03_EB, 6.027720E-03_EB, 4.482446E-03_EB, 4.865138E-03_EB, &
    4.661209E-03_EB, 4.750056E-03_EB, 4.493247E-03_EB, 4.674139E-03_EB, 4.436097E-03_EB, 4.542875E-03_EB/),(/6,8/))

SD1_C7H16(1:6,25:29) = RESHAPE((/ &  ! 1700-1800 cm-1
    4.413447E-03_EB, 4.956484E-03_EB, 4.665195E-03_EB, 4.569735E-03_EB, 4.545559E-03_EB, 4.721096E-03_EB, &
    4.452650E-03_EB, 4.579053E-03_EB, 4.618445E-03_EB, 4.649409E-03_EB, 4.598376E-03_EB, 4.370588E-03_EB, &
    4.461563E-03_EB, 4.808041E-03_EB, 4.703359E-03_EB, 4.547977E-03_EB, 4.561663E-03_EB, 4.550320E-03_EB, &
    4.140835E-03_EB, 4.388076E-03_EB, 4.320451E-03_EB, 4.330022E-03_EB, 4.131463E-03_EB, 4.099512E-03_EB, &
    3.825736E-03_EB, 3.828476E-03_EB, 3.825308E-03_EB, 3.825481E-03_EB, 3.824035E-03_EB, 3.834012E-03_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C7H16(N_TEMP_C7H16,29)) 

! BAND #1: 1100 cm-1 - 1800 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.51457 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C7H16(1:6,1:8) = RESHAPE((/ &  ! 1100-1275 cm-1
    3.348316E-03_EB, 3.128153E-03_EB, 3.350836E-03_EB, 3.163388E-03_EB, 3.473944E-03_EB, 3.203916E-03_EB, &
    3.503809E-03_EB, 3.916197E-03_EB, 3.383533E-03_EB, 3.395934E-03_EB, 3.574141E-03_EB, 3.635318E-03_EB, &
    3.425694E-03_EB, 3.570196E-03_EB, 3.596437E-03_EB, 3.368503E-03_EB, 3.437047E-03_EB, 3.698391E-03_EB, &
    3.418465E-03_EB, 3.570045E-03_EB, 4.470005E-03_EB, 3.482776E-03_EB, 3.523937E-03_EB, 3.556204E-03_EB, &
    3.643042E-03_EB, 3.383937E-03_EB, 4.083379E-03_EB, 7.704347E-03_EB, 3.151450E-03_EB, 2.617044E-02_EB, &
    1.702221E-02_EB, 2.112530E-02_EB, 1.635168E-02_EB, 1.852123E-02_EB, 5.867479E-03_EB, 2.932739E-02_EB, &
    1.314327E-02_EB, 2.083361E-02_EB, 4.231875E-03_EB, 5.200613E-03_EB, 1.452560E-02_EB, 1.105714E-01_EB, &
    3.599324E-02_EB, 2.513783E-02_EB, 2.433018E-02_EB, 3.410640E-02_EB, 1.335309E-02_EB, 4.423630E-01_EB/),(/6,8/))

GAMMAD1_C7H16(1:6,9:16) = RESHAPE((/ &  ! 1300-1475 cm-1
    1.198842E-01_EB, 5.418471E-02_EB, 5.149290E-02_EB, 5.646346E-02_EB, 3.913464E-02_EB, 3.107520E-01_EB, &
    7.844312E-02_EB, 3.874217E-02_EB, 4.306812E-02_EB, 4.220300E-02_EB, 8.905774E-03_EB, 3.986277E-02_EB, &
    1.057944E-01_EB, 2.925701E-03_EB, 4.831521E-03_EB, 2.622111E-02_EB, 7.891941E-03_EB, 2.736277E-02_EB, &
    4.335379E-02_EB, 1.996058E-02_EB, 1.827433E-02_EB, 2.291732E-02_EB, 3.950473E-02_EB, 4.195071E-01_EB, &
    2.643640E-02_EB, 7.829182E-03_EB, 1.237217E-02_EB, 1.402409E-02_EB, 1.130150E-02_EB, 1.284013E-01_EB, &
    9.639190E-02_EB, 9.464238E-02_EB, 1.821586E-01_EB, 5.952959E-03_EB, 8.070778E-03_EB, 1.474177E-01_EB, &
    5.540279E-02_EB, 2.364377E-02_EB, 2.742454E-02_EB, 3.028452E-02_EB, 2.975814E-02_EB, 2.813045E-02_EB, &
    8.479643E-02_EB, 3.678012E-02_EB, 4.548722E-02_EB, 3.821395E-02_EB, 3.431344E-02_EB, 4.234303E-01_EB/),(/6,8/))

GAMMAD1_C7H16(1:6,17:24) = RESHAPE((/ &  ! 1500-1675 cm-1
    1.617338E-01_EB, 2.074253E-01_EB, 2.679310E-02_EB, 1.660069E-01_EB, 1.088006E-01_EB, 3.755665E-01_EB, &
    6.429646E-02_EB, 7.868427E-01_EB, 2.160519E-01_EB, 9.343794E-01_EB, 4.745356E-02_EB, 8.346457E-02_EB, &
    9.190561E-02_EB, 1.113220E+00_EB, 1.059461E+00_EB, 3.424980E-01_EB, 2.985428E-02_EB, 1.059920E-01_EB, &
    3.412289E-03_EB, 6.851192E-03_EB, 1.064505E-01_EB, 1.255083E-02_EB, 6.671297E-03_EB, 3.405029E-03_EB, &
    3.504072E-03_EB, 1.181929E-03_EB, 1.675827E-03_EB, 2.437687E-04_EB, 3.439624E-03_EB, 9.621344E-05_EB, &
    3.315091E-03_EB, 3.468544E-03_EB, 3.448970E-03_EB, 5.898791E-03_EB, 3.589500E-03_EB, 5.810129E-03_EB, &
    3.585081E-03_EB, 3.623910E-03_EB, 3.577118E-03_EB, 3.959468E-03_EB, 3.447623E-03_EB, 3.650695E-03_EB, &
    3.649620E-03_EB, 3.621536E-03_EB, 3.389093E-03_EB, 3.575870E-03_EB, 3.285780E-03_EB, 3.478695E-03_EB/),(/6,8/))

GAMMAD1_C7H16(1:6,25:29) = RESHAPE((/ &  ! 1700-1800 cm-1
    3.342671E-03_EB, 3.799850E-03_EB, 3.516234E-03_EB, 3.455451E-03_EB, 3.506473E-03_EB, 3.723501E-03_EB, &
    3.375590E-03_EB, 3.525205E-03_EB, 3.453308E-03_EB, 3.430725E-03_EB, 3.416845E-03_EB, 3.384057E-03_EB, &
    3.509967E-03_EB, 3.712778E-03_EB, 3.580448E-03_EB, 3.397112E-03_EB, 3.551791E-03_EB, 3.566513E-03_EB, &
    3.236424E-03_EB, 3.381189E-03_EB, 3.315315E-03_EB, 3.330451E-03_EB, 3.230674E-03_EB, 3.201291E-03_EB, &
    3.052487E-03_EB, 3.054957E-03_EB, 3.051950E-03_EB, 3.051909E-03_EB, 3.050779E-03_EB, 3.060754E-03_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C7H16(N_TEMP_C7H16,30)) 

! BAND #2: 2550 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 3.7861 % 

SD2_C7H16(1:6,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    4.080204E-03_EB, 1.123603E-02_EB, 6.711301E-03_EB, 9.802853E-03_EB, 1.124791E-02_EB, 4.121361E-03_EB, &
    1.731344E-02_EB, 4.684160E-02_EB, 3.796471E-02_EB, 4.427666E-02_EB, 4.958869E-02_EB, 1.708389E-02_EB, &
    9.875757E-02_EB, 1.029056E-01_EB, 8.408956E-02_EB, 8.208976E-02_EB, 6.200320E-02_EB, 3.054689E-02_EB, &
    1.192361E-01_EB, 1.171238E-01_EB, 8.490684E-02_EB, 8.654542E-02_EB, 6.720643E-02_EB, 4.763998E-02_EB, &
    1.281871E-01_EB, 1.439468E-01_EB, 9.835237E-02_EB, 9.911327E-02_EB, 7.758740E-02_EB, 6.374023E-02_EB, &
    1.565389E-01_EB, 1.699404E-01_EB, 1.190596E-01_EB, 1.237052E-01_EB, 8.224248E-02_EB, 7.484796E-02_EB, &
    1.546301E-01_EB, 1.935034E-01_EB, 1.275741E-01_EB, 1.350121E-01_EB, 1.050690E-01_EB, 1.079705E-01_EB, &
    2.797492E-01_EB, 2.864845E-01_EB, 1.957940E-01_EB, 1.998535E-01_EB, 1.534373E-01_EB, 1.623210E-01_EB/),(/6,8/))

SD2_C7H16(1:6,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    3.007562E-01_EB, 3.229197E-01_EB, 2.505629E-01_EB, 2.533393E-01_EB, 2.079978E-01_EB, 2.387369E-01_EB, &
    2.208750E-01_EB, 3.058176E-01_EB, 2.479657E-01_EB, 2.661380E-01_EB, 2.402915E-01_EB, 3.462509E-01_EB, &
    6.180679E-01_EB, 6.837362E-01_EB, 4.174983E-01_EB, 4.364177E-01_EB, 4.218298E-01_EB, 5.674293E-01_EB, &
    1.204349E+00_EB, 1.229324E+00_EB, 9.817776E-01_EB, 8.506271E-01_EB, 9.113731E-01_EB, 1.109039E+00_EB, &
    5.776649E+00_EB, 4.492173E+00_EB, 3.900577E+00_EB, 3.336657E+00_EB, 2.721262E+00_EB, 2.598481E+00_EB, &
    1.510148E+01_EB, 1.083236E+01_EB, 9.069701E+00_EB, 7.792882E+00_EB, 5.573190E+00_EB, 4.580990E+00_EB, &
    1.297664E+01_EB, 1.027162E+01_EB, 9.142010E+00_EB, 8.154463E+00_EB, 6.417261E+00_EB, 6.006057E+00_EB, &
    2.389360E+01_EB, 1.816540E+01_EB, 1.582531E+01_EB, 1.387161E+01_EB, 1.035691E+01_EB, 9.109852E+00_EB/),(/6,8/))

SD2_C7H16(1:6,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    2.631147E+01_EB, 2.047520E+01_EB, 1.781444E+01_EB, 1.583729E+01_EB, 1.154530E+01_EB, 9.501802E+00_EB, &
    3.000000E+01_EB, 2.021182E+01_EB, 1.622772E+01_EB, 1.401884E+01_EB, 8.979534E+00_EB, 6.291894E+00_EB, &
    2.528195E+00_EB, 2.847775E+00_EB, 2.405703E+00_EB, 2.360813E+00_EB, 1.918715E+00_EB, 1.831897E+00_EB, &
    8.804096E-01_EB, 1.184010E+00_EB, 8.414152E-01_EB, 7.586141E-01_EB, 7.930473E-01_EB, 7.216683E-01_EB, &
    3.958386E-01_EB, 9.180016E-01_EB, 4.289760E-01_EB, 4.574418E-01_EB, 5.250566E-01_EB, 4.507457E-01_EB, &
    2.073441E-01_EB, 6.599118E-01_EB, 2.858318E-01_EB, 3.257800E-01_EB, 2.748349E-01_EB, 3.269363E-01_EB, &
    1.483885E-01_EB, 2.881908E-01_EB, 2.139705E-01_EB, 2.524391E-01_EB, 1.894929E-01_EB, 2.773311E-01_EB, &
    1.046385E-01_EB, 2.582019E-01_EB, 1.748083E-01_EB, 2.040799E-01_EB, 1.423168E-01_EB, 2.103325E-01_EB/),(/6,8/))

SD2_C7H16(1:6,25:30) = RESHAPE((/ &  ! 3150-3275 cm-1
    1.533015E-01_EB, 2.167935E-01_EB, 1.515403E-01_EB, 1.696136E-01_EB, 1.109316E-01_EB, 1.534639E-01_EB, &
    1.962369E-01_EB, 2.229444E-01_EB, 1.460371E-01_EB, 1.520507E-01_EB, 8.260536E-02_EB, 1.016102E-01_EB, &
    1.679871E-01_EB, 1.687087E-01_EB, 9.799173E-02_EB, 1.088772E-01_EB, 5.058788E-02_EB, 5.309083E-02_EB, &
    5.480884E-02_EB, 8.457431E-02_EB, 4.941003E-02_EB, 5.921846E-02_EB, 1.569223E-02_EB, 2.294352E-02_EB, &
    6.444302E-03_EB, 1.503465E-02_EB, 8.996011E-03_EB, 1.181338E-02_EB, 6.970140E-03_EB, 4.276828E-03_EB, &
    3.825736E-03_EB, 3.828476E-03_EB, 3.825308E-03_EB, 3.825481E-03_EB, 3.824035E-03_EB, 3.834012E-03_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C7H16(N_TEMP_C7H16,30)) 

! BAND #2: 2550 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 3.7861 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C7H16(1:6,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    3.201622E-03_EB, 9.701632E-03_EB, 5.222720E-03_EB, 7.816287E-03_EB, 7.859451E-03_EB, 3.228154E-03_EB, &
    9.779021E-03_EB, 6.000437E-02_EB, 3.739470E-02_EB, 3.039173E-02_EB, 2.899610E-02_EB, 9.391948E-03_EB, &
    3.701843E-02_EB, 8.625752E-02_EB, 5.728938E-02_EB, 6.367337E-02_EB, 2.334395E-02_EB, 1.428421E-02_EB, &
    3.594630E-02_EB, 6.623346E-02_EB, 6.696662E-02_EB, 8.145541E-02_EB, 1.079044E-02_EB, 1.320671E-02_EB, &
    2.191533E-02_EB, 2.866743E-02_EB, 5.452113E-02_EB, 7.219253E-02_EB, 3.981684E-02_EB, 6.443265E-03_EB, &
    1.529943E-02_EB, 7.434979E-02_EB, 6.245866E-02_EB, 1.124476E-01_EB, 2.908365E-02_EB, 3.327005E-02_EB, &
    1.163270E-02_EB, 5.595200E-02_EB, 8.478818E-02_EB, 2.160508E-01_EB, 2.734813E-02_EB, 4.740613E-02_EB, &
    1.284105E-02_EB, 2.993142E-02_EB, 1.290806E-01_EB, 1.075272E+00_EB, 9.183182E-03_EB, 1.711266E-02_EB/),(/6,8/))

GAMMAD2_C7H16(1:6,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    1.289006E-01_EB, 1.296124E-01_EB, 8.382441E-02_EB, 2.869739E-01_EB, 4.780892E-02_EB, 7.166080E-02_EB, &
    4.413583E-02_EB, 1.297887E-01_EB, 6.684964E-02_EB, 3.584631E-01_EB, 4.581656E-02_EB, 1.468559E-01_EB, &
    6.214840E-03_EB, 6.604110E-03_EB, 1.095428E-01_EB, 2.419407E-01_EB, 3.035310E-02_EB, 2.458836E-01_EB, &
    1.591309E-02_EB, 1.439033E-02_EB, 2.449424E-02_EB, 4.362116E-01_EB, 2.687288E-02_EB, 4.837061E-02_EB, &
    9.780557E-02_EB, 6.742930E-02_EB, 6.623405E-02_EB, 9.774085E-02_EB, 1.202347E-01_EB, 9.692069E-02_EB, &
    3.063007E-01_EB, 1.957275E-01_EB, 1.767060E-01_EB, 1.952529E-01_EB, 3.359806E-01_EB, 1.740037E-01_EB, &
    2.506931E-01_EB, 1.992184E-01_EB, 1.870646E-01_EB, 2.101962E-01_EB, 3.604422E-01_EB, 2.171672E-01_EB, &
    4.793108E-01_EB, 3.017116E-01_EB, 2.821994E-01_EB, 3.055967E-01_EB, 5.576104E-01_EB, 2.948749E-01_EB/),(/6,8/))

GAMMAD2_C7H16(1:6,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    5.470999E-01_EB, 3.674155E-01_EB, 3.455917E-01_EB, 3.468284E-01_EB, 6.830669E-01_EB, 3.321369E-01_EB, &
    3.849429E-01_EB, 3.087347E-01_EB, 2.829796E-01_EB, 2.573698E-01_EB, 5.589670E-01_EB, 2.635544E-01_EB, &
    3.263784E-02_EB, 3.325031E-02_EB, 4.984527E-02_EB, 5.019273E-02_EB, 1.083155E-01_EB, 1.032347E-01_EB, &
    1.016821E-02_EB, 8.789790E-03_EB, 1.552443E-02_EB, 5.247201E-02_EB, 1.475360E-02_EB, 4.321949E-01_EB, &
    1.083765E-01_EB, 4.130947E-03_EB, 1.135605E-01_EB, 5.041175E-01_EB, 5.832393E-03_EB, 4.662279E-01_EB, &
    5.053333E-02_EB, 2.871959E-03_EB, 6.841283E-02_EB, 1.305780E+00_EB, 2.234411E-02_EB, 5.509204E-01_EB, &
    1.023209E-02_EB, 1.088800E-01_EB, 1.259095E-01_EB, 9.098327E-01_EB, 3.896344E-02_EB, 1.577482E-01_EB, &
    3.176947E-02_EB, 1.075890E-02_EB, 8.894385E-02_EB, 2.725855E-01_EB, 7.776503E-03_EB, 1.260074E-01_EB/),(/6,8/))

GAMMAD2_C7H16(1:6,25:30) = RESHAPE((/ &  ! 3150-3275 cm-1
    1.485244E-02_EB, 3.892775E-02_EB, 2.498053E-02_EB, 2.697280E-01_EB, 1.410130E-02_EB, 9.202896E-02_EB, &
    6.071468E-02_EB, 3.880222E-02_EB, 3.624861E-02_EB, 8.389092E-01_EB, 1.756590E-02_EB, 8.543312E-02_EB, &
    7.124937E-02_EB, 7.686745E-02_EB, 4.378207E-02_EB, 1.500404E+00_EB, 5.827841E-03_EB, 3.837508E-02_EB, &
    1.227911E-02_EB, 3.291310E-02_EB, 1.246109E-02_EB, 3.990291E-01_EB, 3.385579E-03_EB, 1.304394E-02_EB, &
    4.660820E-03_EB, 6.632973E-03_EB, 6.133476E-03_EB, 1.061576E-02_EB, 4.544655E-03_EB, 3.285631E-03_EB, &
    3.052487E-03_EB, 3.054957E-03_EB, 3.051950E-03_EB, 3.051909E-03_EB, 3.050779E-03_EB, 3.060754E-03_EB/),(/6,6/))

!-------------------------Methanol DATA-------------------


! THERE ARE 4 BANDS FOR Methanol

! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1 

N_TEMP_CH3OH = 6
N_BAND_CH3OH = 4
I_MODEL_CH3OH = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_CH3OH_TEMP(N_TEMP_CH3OH)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Methanol ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_CH3OH(N_BAND_CH3OH,3)) 
ALLOCATE(Be_CH3OH(N_BAND_CH3OH)) 

OM_BND_CH3OH = RESHAPE((/ &
    825._EB, 1125._EB, 2600._EB, 3525._EB, &
    1150._EB, 1700._EB, 3225._EB, 3850._EB, &
     5._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_CH3OH,3/)) 

SD_CH3OH_TEMP = (/ &
    293._EB, 396._EB, 443._EB, 483._EB, 570._EB, 804._EB/)

Be_CH3OH = (/ &
    1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_CH3OH(N_TEMP_CH3OH,58)) 

! BAND #1: 825 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 3.5293 % 

SD1_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 825-860 cm-1
    2.092058E-03_EB, 2.177561E-03_EB, 2.025372E-03_EB, 2.066580E-03_EB, 2.032570E-03_EB, 2.055490E-03_EB, &
    2.332369E-03_EB, 2.146353E-03_EB, 2.292441E-03_EB, 2.190905E-03_EB, 2.328545E-03_EB, 2.315297E-03_EB, &
    2.309160E-03_EB, 2.144663E-03_EB, 2.212745E-03_EB, 2.417766E-03_EB, 2.238096E-03_EB, 2.351140E-03_EB, &
    2.297992E-03_EB, 2.376640E-03_EB, 2.305185E-03_EB, 2.245090E-03_EB, 2.304365E-03_EB, 2.070614E-03_EB, &
    2.319978E-03_EB, 2.259332E-03_EB, 2.234532E-03_EB, 2.274525E-03_EB, 2.148807E-03_EB, 2.334803E-03_EB, &
    2.507306E-03_EB, 2.261417E-03_EB, 2.415070E-03_EB, 2.347081E-03_EB, 2.202668E-03_EB, 2.326296E-03_EB, &
    2.266346E-03_EB, 2.293200E-03_EB, 2.351988E-03_EB, 2.395979E-03_EB, 2.119769E-03_EB, 7.505970E-03_EB, &
    2.254628E-03_EB, 2.309387E-03_EB, 2.418908E-03_EB, 2.321693E-03_EB, 2.283795E-03_EB, 2.468735E-02_EB/),(/6,8/))

SD1_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 865-900 cm-1
    2.232540E-03_EB, 2.326400E-03_EB, 2.238340E-03_EB, 2.216995E-03_EB, 2.185376E-03_EB, 3.949919E-02_EB, &
    2.267890E-03_EB, 2.372947E-03_EB, 2.225062E-03_EB, 2.036361E-03_EB, 2.193652E-03_EB, 5.087191E-02_EB, &
    2.255361E-03_EB, 2.020189E-03_EB, 2.198415E-03_EB, 2.322238E-03_EB, 2.224281E-03_EB, 5.915394E-02_EB, &
    1.967092E-03_EB, 2.243285E-03_EB, 2.127487E-03_EB, 1.389794E-02_EB, 4.455241E-03_EB, 6.523861E-02_EB, &
    1.930456E-03_EB, 2.242109E-03_EB, 2.239039E-03_EB, 2.944577E-02_EB, 3.535619E-03_EB, 7.495336E-02_EB, &
    4.650410E-03_EB, 2.524410E-03_EB, 2.395452E-03_EB, 3.316131E-02_EB, 3.209037E-03_EB, 2.296929E-01_EB, &
    7.357214E-03_EB, 2.423850E-03_EB, 4.522750E-03_EB, 3.030167E-02_EB, 1.272098E-02_EB, 1.501605E-01_EB, &
    1.720964E-02_EB, 2.432993E-03_EB, 1.051484E-02_EB, 3.256885E-02_EB, 2.698715E-02_EB, 1.714594E-01_EB/),(/6,8/))

SD1_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 905-940 cm-1
    1.035239E-02_EB, 1.094240E-02_EB, 1.359306E-02_EB, 4.054608E-02_EB, 7.246753E-02_EB, 2.420389E-01_EB, &
    2.058373E-02_EB, 1.591070E-02_EB, 3.234765E-02_EB, 5.490992E-02_EB, 7.483093E-02_EB, 1.703241E-01_EB, &
    2.111524E-02_EB, 1.202985E-02_EB, 4.649524E-02_EB, 8.535592E-02_EB, 1.057174E-01_EB, 5.261237E-01_EB, &
    3.732914E-02_EB, 8.864338E-03_EB, 6.438526E-02_EB, 7.561307E-02_EB, 1.507534E-01_EB, 2.480501E-01_EB, &
    5.801613E-02_EB, 2.611014E-02_EB, 8.860118E-02_EB, 1.403744E-01_EB, 1.775613E-01_EB, 3.665757E-01_EB, &
    6.609547E-02_EB, 5.722284E-02_EB, 9.780364E-02_EB, 1.684845E-01_EB, 2.229380E-01_EB, 1.007671E+00_EB, &
    7.856453E-02_EB, 9.252646E-02_EB, 1.360573E-01_EB, 1.950949E-01_EB, 2.737773E-01_EB, 6.302370E-01_EB, &
    9.733329E-02_EB, 1.302791E-01_EB, 1.796222E-01_EB, 2.586117E-01_EB, 3.483606E-01_EB, 5.573404E-01_EB/),(/6,8/))

SD1_CH3OH(1:6,25:32) = RESHAPE((/ &  ! 945-980 cm-1
    1.001070E-01_EB, 1.728978E-01_EB, 2.268592E-01_EB, 3.327517E-01_EB, 4.585786E-01_EB, 6.720650E-01_EB, &
    1.194413E-01_EB, 2.372982E-01_EB, 3.121431E-01_EB, 4.280557E-01_EB, 5.725477E-01_EB, 7.946447E-01_EB, &
    1.736000E-01_EB, 3.355108E-01_EB, 4.271257E-01_EB, 5.540051E-01_EB, 7.586346E-01_EB, 9.626672E-01_EB, &
    2.604986E-01_EB, 4.708403E-01_EB, 5.847564E-01_EB, 7.323546E-01_EB, 9.252720E-01_EB, 1.074038E+00_EB, &
    3.684381E-01_EB, 6.498069E-01_EB, 7.881784E-01_EB, 9.405731E-01_EB, 1.129310E+00_EB, 1.176751E+00_EB, &
    5.751321E-01_EB, 9.182602E-01_EB, 1.055555E+00_EB, 1.226753E+00_EB, 1.367871E+00_EB, 1.361814E+00_EB, &
    8.861587E-01_EB, 1.264956E+00_EB, 1.374331E+00_EB, 1.549975E+00_EB, 1.618492E+00_EB, 1.455958E+00_EB, &
    1.383922E+00_EB, 1.734533E+00_EB, 1.783409E+00_EB, 1.960052E+00_EB, 1.911433E+00_EB, 1.567399E+00_EB/),(/6,8/))

SD1_CH3OH(1:6,33:40) = RESHAPE((/ &  ! 985-1020 cm-1
    1.996122E+00_EB, 2.225891E+00_EB, 2.182916E+00_EB, 2.313860E+00_EB, 2.164787E+00_EB, 1.622948E+00_EB, &
    2.915470E+00_EB, 2.822832E+00_EB, 2.653037E+00_EB, 2.706394E+00_EB, 2.438423E+00_EB, 1.741545E+00_EB, &
    3.961681E+00_EB, 3.385768E+00_EB, 3.068917E+00_EB, 3.019512E+00_EB, 2.583706E+00_EB, 1.754143E+00_EB, &
    5.193407E+00_EB, 3.926280E+00_EB, 3.388423E+00_EB, 3.261312E+00_EB, 2.699121E+00_EB, 1.757617E+00_EB, &
    6.234834E+00_EB, 4.225103E+00_EB, 3.501529E+00_EB, 3.330742E+00_EB, 2.689982E+00_EB, 1.699072E+00_EB, &
    6.986537E+00_EB, 4.249630E+00_EB, 3.466744E+00_EB, 3.201694E+00_EB, 2.532100E+00_EB, 1.604345E+00_EB, &
    7.022463E+00_EB, 3.987419E+00_EB, 3.269779E+00_EB, 3.012958E+00_EB, 2.459265E+00_EB, 1.681524E+00_EB, &
    6.018656E+00_EB, 3.478293E+00_EB, 2.966517E+00_EB, 2.824377E+00_EB, 2.449004E+00_EB, 1.873353E+00_EB/),(/6,8/))

SD1_CH3OH(1:6,41:48) = RESHAPE((/ &  ! 1025-1060 cm-1
    4.230756E+00_EB, 2.715157E+00_EB, 2.471624E+00_EB, 2.442135E+00_EB, 2.282246E+00_EB, 1.785911E+00_EB, &
    6.082768E+00_EB, 4.674600E+00_EB, 4.198382E+00_EB, 4.036379E+00_EB, 3.434983E+00_EB, 2.281931E+00_EB, &
    9.013047E+00_EB, 5.216322E+00_EB, 4.886268E+00_EB, 4.184170E+00_EB, 3.346732E+00_EB, 1.952844E+00_EB, &
    3.571488E+00_EB, 2.266291E+00_EB, 2.085962E+00_EB, 2.005385E+00_EB, 1.838914E+00_EB, 1.556493E+00_EB, &
    6.476392E+00_EB, 3.578085E+00_EB, 3.000279E+00_EB, 2.835434E+00_EB, 2.406457E+00_EB, 1.855604E+00_EB, &
    9.262277E+00_EB, 5.183215E+00_EB, 4.208440E+00_EB, 3.931063E+00_EB, 3.206750E+00_EB, 2.187826E+00_EB, &
    1.018701E+01_EB, 6.177841E+00_EB, 4.984062E+00_EB, 4.700722E+00_EB, 3.756180E+00_EB, 2.448381E+00_EB, &
    9.082132E+00_EB, 6.186164E+00_EB, 5.144968E+00_EB, 4.900566E+00_EB, 3.963769E+00_EB, 2.530591E+00_EB/),(/6,8/))

SD1_CH3OH(1:6,49:56) = RESHAPE((/ &  ! 1065-1100 cm-1
    6.620610E+00_EB, 5.288865E+00_EB, 4.638265E+00_EB, 4.498958E+00_EB, 3.792425E+00_EB, 2.406785E+00_EB, &
    4.042827E+00_EB, 3.909816E+00_EB, 3.617644E+00_EB, 3.631105E+00_EB, 3.204183E+00_EB, 2.137581E+00_EB, &
    2.046297E+00_EB, 2.449651E+00_EB, 2.449642E+00_EB, 2.541393E+00_EB, 2.403556E+00_EB, 1.735955E+00_EB, &
    8.905360E-01_EB, 1.310038E+00_EB, 1.445531E+00_EB, 1.578338E+00_EB, 1.588356E+00_EB, 1.330593E+00_EB, &
    4.298317E-01_EB, 6.188262E-01_EB, 7.449557E-01_EB, 8.370797E-01_EB, 9.498843E-01_EB, 8.542704E-01_EB, &
    3.092650E-01_EB, 3.183528E-01_EB, 3.754965E-01_EB, 4.360273E-01_EB, 4.956396E-01_EB, 8.645293E-01_EB, &
    3.089754E-01_EB, 2.312936E-01_EB, 2.482608E-01_EB, 2.697129E-01_EB, 2.646085E-01_EB, 6.168094E-01_EB, &
    2.625718E-01_EB, 1.842062E-01_EB, 1.841237E-01_EB, 2.031920E-01_EB, 2.024757E-01_EB, 3.760870E-01_EB/),(/6,8/))

SD1_CH3OH(1:6,57:58) = RESHAPE((/ &  ! 1125-1150 cm-1
    1.055811E-01_EB, 8.237733E-02_EB, 7.535970E-02_EB, 7.739180E-02_EB, 8.628242E-02_EB, 9.250815E-02_EB, &
    1.878821E-03_EB, 1.877877E-03_EB, 1.877905E-03_EB, 1.880174E-03_EB, 1.878741E-03_EB, 1.871949E-03_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_CH3OH(N_TEMP_CH3OH,58)) 

! BAND #1: 825 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 3.5293 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 825-860 cm-1
    1.710835E-03_EB, 1.756456E-03_EB, 1.610567E-03_EB, 1.634777E-03_EB, 1.610361E-03_EB, 1.590749E-03_EB, &
    1.735092E-03_EB, 1.628944E-03_EB, 1.801017E-03_EB, 1.709333E-03_EB, 1.871176E-03_EB, 1.786946E-03_EB, &
    1.779330E-03_EB, 1.675239E-03_EB, 1.742486E-03_EB, 1.925162E-03_EB, 1.844256E-03_EB, 1.904458E-03_EB, &
    1.795215E-03_EB, 1.890259E-03_EB, 1.780477E-03_EB, 1.785604E-03_EB, 1.898177E-03_EB, 1.613934E-03_EB, &
    1.793465E-03_EB, 1.772037E-03_EB, 1.721289E-03_EB, 1.813837E-03_EB, 1.701828E-03_EB, 1.852461E-03_EB, &
    2.034676E-03_EB, 1.732708E-03_EB, 1.958937E-03_EB, 1.835905E-03_EB, 1.695861E-03_EB, 1.774073E-03_EB, &
    1.811188E-03_EB, 1.766977E-03_EB, 1.842126E-03_EB, 1.890326E-03_EB, 1.681456E-03_EB, 1.058912E-02_EB, &
    1.786621E-03_EB, 1.761281E-03_EB, 1.908939E-03_EB, 1.861507E-03_EB, 1.778551E-03_EB, 4.668802E-02_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 865-900 cm-1
    1.770163E-03_EB, 1.833276E-03_EB, 1.788454E-03_EB, 1.749349E-03_EB, 1.719229E-03_EB, 1.300157E-01_EB, &
    1.849905E-03_EB, 1.828470E-03_EB, 1.778496E-03_EB, 1.599179E-03_EB, 1.709292E-03_EB, 4.123274E-02_EB, &
    1.792587E-03_EB, 1.603567E-03_EB, 1.793584E-03_EB, 1.906228E-03_EB, 1.806824E-03_EB, 1.707085E-02_EB, &
    1.566440E-03_EB, 1.786745E-03_EB, 1.688414E-03_EB, 9.819022E-03_EB, 1.940335E-03_EB, 6.805250E-03_EB, &
    1.533932E-03_EB, 1.757015E-03_EB, 1.762042E-03_EB, 1.576448E-02_EB, 1.758146E-03_EB, 2.327789E-02_EB, &
    3.240558E-03_EB, 2.091314E-03_EB, 2.036876E-03_EB, 1.856586E-02_EB, 3.284926E-03_EB, 1.099773E-03_EB, &
    5.031669E-03_EB, 1.923459E-03_EB, 4.151732E-03_EB, 4.927751E-02_EB, 4.267998E-02_EB, 1.309486E-02_EB, &
    1.028583E-02_EB, 1.922450E-03_EB, 3.528419E-03_EB, 1.674904E-01_EB, 9.098065E-01_EB, 7.343414E-02_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 905-940 cm-1
    1.273352E-02_EB, 4.972243E-03_EB, 1.533741E-02_EB, 1.836188E-01_EB, 2.990609E-01_EB, 2.012801E-01_EB, &
    1.677619E-02_EB, 1.225147E-02_EB, 1.331438E-02_EB, 1.183400E-01_EB, 8.582058E-01_EB, 7.234776E-02_EB, &
    4.081360E-02_EB, 6.211673E-03_EB, 3.196312E-02_EB, 2.329370E-01_EB, 2.471335E-01_EB, 2.436443E-03_EB, &
    2.831170E-02_EB, 7.090938E-03_EB, 9.040249E-02_EB, 1.608100E-01_EB, 8.226418E-02_EB, 7.065666E-02_EB, &
    4.216513E-02_EB, 1.241919E+00_EB, 9.482108E-02_EB, 1.204072E-01_EB, 2.930426E-01_EB, 2.452063E-01_EB, &
    7.046835E-02_EB, 5.289961E-01_EB, 5.510716E-01_EB, 2.653669E-01_EB, 3.525914E-01_EB, 7.259111E-03_EB, &
    4.438930E-01_EB, 8.725678E-01_EB, 1.604203E-01_EB, 6.744376E-01_EB, 3.049135E-01_EB, 2.154979E-02_EB, &
    1.907888E-01_EB, 4.786949E-01_EB, 1.704217E-01_EB, 3.447117E-01_EB, 5.894523E-01_EB, 2.037830E+00_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,25:32) = RESHAPE((/ &  ! 945-980 cm-1
    2.460351E-01_EB, 6.898202E-01_EB, 2.864252E+00_EB, 6.207472E-01_EB, 1.130649E+00_EB, 2.838739E+00_EB, &
    1.502283E-01_EB, 7.226004E-01_EB, 3.328886E-01_EB, 1.373872E+00_EB, 1.502191E+00_EB, 2.979122E+00_EB, &
    3.550569E-01_EB, 7.492522E-01_EB, 7.116601E-01_EB, 1.671190E+00_EB, 1.862187E+00_EB, 3.016292E+00_EB, &
    7.369757E-01_EB, 1.795348E+00_EB, 9.905021E-01_EB, 1.980476E+00_EB, 3.534556E+00_EB, 3.018212E+00_EB, &
    7.032863E-01_EB, 4.300730E+00_EB, 1.685681E+00_EB, 3.845864E+00_EB, 3.577965E+00_EB, 3.012415E+00_EB, &
    1.898530E+00_EB, 4.260000E+00_EB, 2.663086E+00_EB, 3.893042E+00_EB, 3.584735E+00_EB, 3.017466E+00_EB, &
    4.106122E+00_EB, 4.300400E+00_EB, 4.013691E+00_EB, 3.894278E+00_EB, 3.584634E+00_EB, 3.017203E+00_EB, &
    4.999789E+00_EB, 4.300816E+00_EB, 3.998276E+00_EB, 3.894282E+00_EB, 3.584805E+00_EB, 3.017959E+00_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,33:40) = RESHAPE((/ &  ! 985-1020 cm-1
    4.991678E+00_EB, 4.300865E+00_EB, 4.059389E+00_EB, 3.893977E+00_EB, 3.584621E+00_EB, 3.018382E+00_EB, &
    4.999999E+00_EB, 4.300589E+00_EB, 4.066053E+00_EB, 3.893347E+00_EB, 3.584242E+00_EB, 2.970990E+00_EB, &
    4.999995E+00_EB, 4.300869E+00_EB, 4.066271E+00_EB, 3.894307E+00_EB, 3.584257E+00_EB, 2.267644E+00_EB, &
    4.999999E+00_EB, 4.300869E+00_EB, 4.066186E+00_EB, 3.894306E+00_EB, 3.584526E+00_EB, 3.002150E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.066280E+00_EB, 3.894303E+00_EB, 3.584285E+00_EB, 3.018301E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.066071E+00_EB, 3.894305E+00_EB, 3.584645E+00_EB, 3.018304E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.063349E+00_EB, 3.894307E+00_EB, 3.584642E+00_EB, 3.018380E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.063438E+00_EB, 3.894307E+00_EB, 3.584711E+00_EB, 1.298616E+00_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,41:48) = RESHAPE((/ &  ! 1025-1060 cm-1
    4.999999E+00_EB, 4.300667E+00_EB, 4.055843E+00_EB, 3.893734E+00_EB, 3.584648E+00_EB, 3.003341E+00_EB, &
    4.999827E+00_EB, 4.300869E+00_EB, 1.282374E+00_EB, 3.894305E+00_EB, 3.584812E+00_EB, 3.014221E+00_EB, &
    3.215868E-01_EB, 4.300866E+00_EB, 4.308000E-01_EB, 3.893922E+00_EB, 3.584812E+00_EB, 3.018393E+00_EB, &
    4.999999E+00_EB, 4.300866E+00_EB, 4.024893E+00_EB, 3.893724E+00_EB, 3.584796E+00_EB, 3.018102E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.064073E+00_EB, 3.893162E+00_EB, 3.584257E+00_EB, 3.010630E+00_EB, &
    5.000000E+00_EB, 4.300869E+00_EB, 4.066303E+00_EB, 3.894305E+00_EB, 3.584811E+00_EB, 3.017454E+00_EB, &
    5.000000E+00_EB, 4.300811E+00_EB, 4.066305E+00_EB, 3.894307E+00_EB, 3.584812E+00_EB, 3.018277E+00_EB, &
    5.000000E+00_EB, 4.300815E+00_EB, 4.066319E+00_EB, 3.894307E+00_EB, 3.584811E+00_EB, 3.018013E+00_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,49:56) = RESHAPE((/ &  ! 1065-1100 cm-1
    5.000000E+00_EB, 4.300869E+00_EB, 4.066228E+00_EB, 3.894306E+00_EB, 3.584811E+00_EB, 3.018285E+00_EB, &
    4.999993E+00_EB, 4.300869E+00_EB, 4.066270E+00_EB, 3.894308E+00_EB, 3.584811E+00_EB, 3.018260E+00_EB, &
    4.998042E+00_EB, 4.300693E+00_EB, 4.052794E+00_EB, 3.893734E+00_EB, 3.584611E+00_EB, 3.018370E+00_EB, &
    3.986178E+00_EB, 4.300023E+00_EB, 2.734521E+00_EB, 3.894039E+00_EB, 3.584786E+00_EB, 2.989137E+00_EB, &
    8.174707E-01_EB, 3.929100E+00_EB, 9.638388E-01_EB, 3.888258E+00_EB, 3.542763E+00_EB, 5.689943E-01_EB, &
    2.535035E-01_EB, 1.739008E+00_EB, 4.546054E-01_EB, 1.143907E+00_EB, 8.223386E-01_EB, 1.346765E-02_EB, &
    4.437384E-01_EB, 7.213379E-01_EB, 1.956188E-01_EB, 2.204748E-01_EB, 6.113907E-01_EB, 7.529073E-03_EB, &
    2.276879E-01_EB, 1.198190E+00_EB, 3.590163E-01_EB, 8.969601E-02_EB, 3.647211E-01_EB, 3.619413E-03_EB/),(/6,8/))

GAMMAD1_CH3OH(1:6,57:58) = RESHAPE((/ &  ! 1125-1150 cm-1
    1.007401E-01_EB, 3.371335E-01_EB, 2.279241E-01_EB, 2.447139E-01_EB, 3.673499E-01_EB, 2.646242E-02_EB, &
    1.498523E-03_EB, 1.497953E-03_EB, 1.497022E-03_EB, 1.499683E-03_EB, 1.498643E-03_EB, 1.492511E-03_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_CH3OH(N_TEMP_CH3OH,24)) 

! BAND #2: 1125 cm-1 - 1700 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.4125 % 

SD2_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 1125-1300 cm-1
    8.450611E-02_EB, 6.418183E-02_EB, 6.310468E-02_EB, 7.660905E-02_EB, 7.706424E-02_EB, 9.437901E-02_EB, &
    1.371028E-01_EB, 1.079723E-01_EB, 1.204347E-01_EB, 1.390379E-01_EB, 1.433370E-01_EB, 7.710077E-01_EB, &
    1.290982E-01_EB, 1.414367E-01_EB, 1.560075E-01_EB, 1.748835E-01_EB, 2.030998E-01_EB, 4.532359E-01_EB, &
    2.291613E-01_EB, 2.459506E-01_EB, 2.544302E-01_EB, 2.644402E-01_EB, 2.908354E-01_EB, 4.030926E-01_EB, &
    2.985497E-01_EB, 2.975485E-01_EB, 2.931653E-01_EB, 3.025454E-01_EB, 3.299110E-01_EB, 4.271199E-01_EB, &
    3.780124E-01_EB, 3.650159E-01_EB, 3.598875E-01_EB, 3.653630E-01_EB, 3.853645E-01_EB, 4.931383E-01_EB, &
    4.291205E-01_EB, 4.110541E-01_EB, 4.018726E-01_EB, 4.158169E-01_EB, 4.404402E-01_EB, 4.822382E-01_EB, &
    6.531570E-01_EB, 4.774917E-01_EB, 4.280704E-01_EB, 4.120357E-01_EB, 4.196151E-01_EB, 4.644855E-01_EB/),(/6,8/))

SD2_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 1325-1500 cm-1
    8.939686E-01_EB, 5.729563E-01_EB, 4.966461E-01_EB, 4.470764E-01_EB, 4.224176E-01_EB, 4.179472E-01_EB, &
    9.818632E-01_EB, 6.476066E-01_EB, 5.518080E-01_EB, 4.956905E-01_EB, 4.589459E-01_EB, 4.047537E-01_EB, &
    7.934918E-01_EB, 5.798297E-01_EB, 5.078331E-01_EB, 4.598626E-01_EB, 4.302476E-01_EB, 3.123068E-01_EB, &
    6.085155E-01_EB, 4.738775E-01_EB, 4.248828E-01_EB, 3.800189E-01_EB, 3.732390E-01_EB, 3.565107E-01_EB, &
    5.093975E-01_EB, 3.603909E-01_EB, 3.097235E-01_EB, 2.780573E-01_EB, 2.805735E-01_EB, 2.978990E-01_EB, &
    4.549118E-01_EB, 3.347414E-01_EB, 2.980123E-01_EB, 2.659373E-01_EB, 2.773117E-01_EB, 3.196630E-01_EB, &
    4.623975E-01_EB, 3.269118E-01_EB, 2.765642E-01_EB, 2.455172E-01_EB, 2.525615E-01_EB, 1.855525E-01_EB, &
    3.255200E-01_EB, 2.040086E-01_EB, 1.743401E-01_EB, 1.597684E-01_EB, 1.792900E-01_EB, 1.396319E-01_EB/),(/6,8/))

SD2_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 1525-1700 cm-1
    2.520907E-01_EB, 1.713915E-01_EB, 1.460993E-01_EB, 1.328205E-01_EB, 1.496750E-01_EB, 2.941672E-01_EB, &
    1.495161E-01_EB, 9.992014E-02_EB, 8.673606E-02_EB, 9.166448E-02_EB, 1.035687E-01_EB, 3.429671E-02_EB, &
    8.876261E-02_EB, 1.212061E-01_EB, 1.004804E-01_EB, 8.464696E-02_EB, 1.060019E-01_EB, 5.158956E-02_EB, &
    5.010532E-02_EB, 1.054022E-01_EB, 8.698803E-02_EB, 5.531148E-02_EB, 8.518388E-02_EB, 6.856675E-02_EB, &
    1.158760E-02_EB, 5.631481E-02_EB, 4.538851E-02_EB, 2.947560E-02_EB, 5.263443E-02_EB, 1.413806E-02_EB, &
    2.316983E-03_EB, 6.543856E-03_EB, 5.980406E-03_EB, 3.945329E-03_EB, 2.428749E-02_EB, 1.902847E-03_EB, &
    2.042728E-03_EB, 2.020924E-03_EB, 2.065135E-03_EB, 1.985574E-03_EB, 1.311723E-02_EB, 2.046333E-03_EB, &
    1.878821E-03_EB, 1.877877E-03_EB, 1.877905E-03_EB, 1.880174E-03_EB, 1.878741E-03_EB, 1.871949E-03_EB/),(/6,8/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_CH3OH(N_TEMP_CH3OH,24)) 

! BAND #2: 1125 cm-1 - 1700 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.4125 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 1125-1300 cm-1
    2.839810E-02_EB, 2.382154E-01_EB, 5.050253E-01_EB, 3.415996E-02_EB, 2.622562E-01_EB, 2.544872E-02_EB, &
    5.503036E-02_EB, 1.254472E+00_EB, 1.310579E-01_EB, 7.982417E-02_EB, 4.974697E-01_EB, 1.377263E-03_EB, &
    6.904929E-02_EB, 4.656750E-01_EB, 2.893366E-01_EB, 1.320435E-01_EB, 5.248210E-01_EB, 3.714388E-03_EB, &
    4.070553E-01_EB, 7.332375E-01_EB, 3.930809E-01_EB, 4.120696E-01_EB, 6.044447E-01_EB, 1.073477E-02_EB, &
    3.822412E-01_EB, 8.896827E-01_EB, 7.713721E-01_EB, 4.642629E-01_EB, 6.452212E-01_EB, 1.507169E-02_EB, &
    4.416356E-01_EB, 1.769715E+00_EB, 6.773441E-01_EB, 5.917155E-01_EB, 1.880027E+00_EB, 1.160920E-02_EB, &
    1.503534E+00_EB, 1.667740E+00_EB, 8.478454E-01_EB, 1.389905E+00_EB, 1.679316E+00_EB, 3.047742E-02_EB, &
    4.422364E+00_EB, 1.801232E+00_EB, 1.200044E+00_EB, 1.820801E+00_EB, 1.791415E+00_EB, 2.729084E-02_EB/),(/6,8/))

GAMMAD2_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 1325-1500 cm-1
    4.042339E+00_EB, 4.298022E+00_EB, 5.329873E-01_EB, 1.459935E+00_EB, 1.888920E+00_EB, 2.377378E-02_EB, &
    4.355025E+00_EB, 4.300470E+00_EB, 1.222991E+00_EB, 8.749741E-01_EB, 1.691725E+00_EB, 2.518145E-02_EB, &
    2.153033E+00_EB, 4.297378E+00_EB, 5.856320E-01_EB, 1.840781E+00_EB, 2.990627E+00_EB, 1.820199E-01_EB, &
    1.762410E+00_EB, 1.794982E+00_EB, 1.218619E+00_EB, 1.062382E+00_EB, 1.101899E+00_EB, 9.679437E-03_EB, &
    8.075686E-01_EB, 1.338339E+00_EB, 4.994659E-01_EB, 1.362670E+00_EB, 6.017519E-01_EB, 6.101605E-03_EB, &
    1.395801E+00_EB, 7.203459E-01_EB, 4.898508E-01_EB, 1.136198E+00_EB, 6.082554E-01_EB, 6.425200E-03_EB, &
    1.318069E+00_EB, 7.008699E-01_EB, 4.579288E-01_EB, 1.066632E+00_EB, 1.238513E+00_EB, 8.481371E-02_EB, &
    6.055957E-02_EB, 5.562031E-01_EB, 2.905837E-01_EB, 1.546591E-01_EB, 3.735574E-01_EB, 7.536593E-03_EB/),(/6,8/))

GAMMAD2_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 1525-1700 cm-1
    1.535814E-01_EB, 4.670332E-01_EB, 1.742382E-01_EB, 1.027607E-01_EB, 3.634900E-01_EB, 6.475884E-04_EB, &
    3.475006E-02_EB, 3.105628E-01_EB, 1.991867E-01_EB, 4.512895E-02_EB, 1.900806E-01_EB, 1.229069E-02_EB, &
    4.333565E-02_EB, 1.256265E-01_EB, 7.507422E-02_EB, 1.588681E-01_EB, 6.609587E-01_EB, 3.150519E-02_EB, &
    2.236980E-02_EB, 1.714019E-01_EB, 5.179932E-02_EB, 4.435785E-01_EB, 7.817483E-01_EB, 2.576489E-01_EB, &
    2.311193E-03_EB, 4.995529E-02_EB, 3.148076E-02_EB, 5.358945E-02_EB, 5.546834E-01_EB, 1.237662E-02_EB, &
    1.853090E-03_EB, 5.372400E-03_EB, 4.467193E-03_EB, 3.286290E-03_EB, 7.349456E-02_EB, 1.523253E-03_EB, &
    1.609057E-03_EB, 1.593462E-03_EB, 1.633348E-03_EB, 1.573745E-03_EB, 1.356902E-02_EB, 1.613453E-03_EB, &
    1.498523E-03_EB, 1.497953E-03_EB, 1.497022E-03_EB, 1.499683E-03_EB, 1.498643E-03_EB, 1.492511E-03_EB/),(/6,8/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_CH3OH(N_TEMP_CH3OH,26)) 

! BAND #3: 2600 cm-1 - 3225 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.6822 % 

SD3_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 2600-2775 cm-1
    2.070921E-03_EB, 2.043784E-03_EB, 2.023843E-03_EB, 2.134607E-03_EB, 2.066460E-03_EB, 1.953845E-03_EB, &
    2.269396E-03_EB, 2.250784E-03_EB, 2.269292E-03_EB, 2.278080E-03_EB, 2.294423E-03_EB, 2.199901E-03_EB, &
    2.218171E-03_EB, 2.238041E-03_EB, 2.274147E-03_EB, 2.144414E-03_EB, 2.314731E-03_EB, 4.419967E-03_EB, &
    2.247801E-03_EB, 2.208915E-03_EB, 2.360135E-03_EB, 2.256752E-03_EB, 2.148026E-03_EB, 2.120227E-02_EB, &
    2.301519E-03_EB, 2.108644E-03_EB, 3.845106E-03_EB, 2.839818E-03_EB, 5.195677E-03_EB, 6.702702E-02_EB, &
    9.602698E-03_EB, 8.931457E-03_EB, 2.038455E-02_EB, 1.557715E-02_EB, 2.212765E-02_EB, 1.272490E-01_EB, &
    7.031940E-02_EB, 5.086752E-02_EB, 6.236728E-02_EB, 6.241221E-02_EB, 7.937387E-02_EB, 2.013048E-01_EB, &
    1.833057E-01_EB, 1.686986E-01_EB, 1.770402E-01_EB, 1.933230E-01_EB, 2.187904E-01_EB, 3.388255E-01_EB/),(/6,8/))

SD3_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 2800-2975 cm-1
    6.437440E-01_EB, 5.831717E-01_EB, 5.596233E-01_EB, 5.722922E-01_EB, 5.437377E-01_EB, 5.407176E-01_EB, &
    1.620698E+00_EB, 1.109159E+00_EB, 9.590591E-01_EB, 9.016919E-01_EB, 7.647151E-01_EB, 6.283780E-01_EB, &
    2.060845E+00_EB, 1.366525E+00_EB, 1.174981E+00_EB, 1.106730E+00_EB, 9.371376E-01_EB, 7.073181E-01_EB, &
    2.382126E+00_EB, 1.752573E+00_EB, 1.533840E+00_EB, 1.477491E+00_EB, 1.257851E+00_EB, 9.347538E-01_EB, &
    2.380425E+00_EB, 1.775818E+00_EB, 1.588506E+00_EB, 1.557372E+00_EB, 1.374490E+00_EB, 1.040405E+00_EB, &
    3.815934E+00_EB, 2.528397E+00_EB, 2.147361E+00_EB, 2.030769E+00_EB, 1.672901E+00_EB, 1.110733E+00_EB, &
    4.185916E+00_EB, 2.657765E+00_EB, 2.230924E+00_EB, 2.083998E+00_EB, 1.698295E+00_EB, 1.090146E+00_EB, &
    4.374182E+00_EB, 2.838260E+00_EB, 2.387548E+00_EB, 2.231780E+00_EB, 1.810253E+00_EB, 1.142638E+00_EB/),(/6,8/))

SD3_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 3000-3175 cm-1
    2.752216E+00_EB, 1.938287E+00_EB, 1.708916E+00_EB, 1.629397E+00_EB, 1.385291E+00_EB, 9.282823E-01_EB, &
    1.661865E+00_EB, 1.230652E+00_EB, 1.093519E+00_EB, 1.052390E+00_EB, 9.174375E-01_EB, 6.360043E-01_EB, &
    7.812840E-01_EB, 6.785784E-01_EB, 6.388467E-01_EB, 6.332864E-01_EB, 5.733846E-01_EB, 4.154880E-01_EB, &
    2.999779E-01_EB, 3.101992E-01_EB, 3.201589E-01_EB, 3.278764E-01_EB, 3.272730E-01_EB, 2.500958E-01_EB, &
    7.542943E-02_EB, 1.009178E-01_EB, 1.262845E-01_EB, 1.310634E-01_EB, 1.509550E-01_EB, 1.340160E-01_EB, &
    2.498997E-02_EB, 1.501317E-02_EB, 4.474250E-02_EB, 3.860068E-02_EB, 5.479609E-02_EB, 5.710606E-02_EB, &
    4.922524E-03_EB, 2.787254E-03_EB, 7.460162E-03_EB, 3.004660E-03_EB, 1.179334E-02_EB, 1.308730E-02_EB, &
    2.240225E-03_EB, 2.157881E-03_EB, 2.530522E-03_EB, 2.229342E-03_EB, 3.739633E-03_EB, 2.858715E-03_EB/),(/6,8/))

SD3_CH3OH(1:6,25:26) = RESHAPE((/ &  ! 3200-3225 cm-1
    2.078655E-03_EB, 2.013440E-03_EB, 2.048449E-03_EB, 2.124377E-03_EB, 2.028600E-03_EB, 1.944696E-03_EB, &
    1.878821E-03_EB, 1.877877E-03_EB, 1.877905E-03_EB, 1.880174E-03_EB, 1.878741E-03_EB, 1.871949E-03_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_CH3OH(N_TEMP_CH3OH,26)) 

! BAND #3: 2600 cm-1 - 3225 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.6822 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 2600-2775 cm-1
    1.646954E-03_EB, 1.626512E-03_EB, 1.589617E-03_EB, 1.690513E-03_EB, 1.642167E-03_EB, 1.566522E-03_EB, &
    1.755908E-03_EB, 1.740668E-03_EB, 1.740469E-03_EB, 1.739053E-03_EB, 1.798664E-03_EB, 1.705582E-03_EB, &
    1.723842E-03_EB, 1.757339E-03_EB, 1.751737E-03_EB, 1.660147E-03_EB, 1.786732E-03_EB, 3.774246E-03_EB, &
    1.755171E-03_EB, 1.726372E-03_EB, 1.847957E-03_EB, 1.742154E-03_EB, 1.684185E-03_EB, 2.125879E-02_EB, &
    1.828214E-03_EB, 1.672045E-03_EB, 3.454654E-03_EB, 2.364010E-03_EB, 4.371479E-03_EB, 5.350869E-02_EB, &
    8.986744E-03_EB, 1.029509E-02_EB, 1.680797E-02_EB, 1.180595E-02_EB, 1.878043E-02_EB, 1.810472E-01_EB, &
    9.924176E-02_EB, 9.068064E-02_EB, 3.627353E-01_EB, 5.527610E-02_EB, 2.191723E-01_EB, 3.310520E-01_EB, &
    7.221028E-01_EB, 5.123951E-01_EB, 3.090250E-01_EB, 4.388020E-01_EB, 4.944594E-01_EB, 5.382263E-01_EB/),(/6,8/))

GAMMAD3_CH3OH(1:6,9:16) = RESHAPE((/ &  ! 2800-2975 cm-1
    4.154210E+00_EB, 2.633252E+00_EB, 1.344844E+00_EB, 1.733568E+00_EB, 1.657050E+00_EB, 3.017780E+00_EB, &
    4.999928E+00_EB, 4.300694E+00_EB, 4.037630E+00_EB, 3.893700E+00_EB, 3.544685E+00_EB, 3.013316E+00_EB, &
    4.999924E+00_EB, 4.300387E+00_EB, 4.061044E+00_EB, 3.888285E+00_EB, 3.545291E+00_EB, 2.987323E+00_EB, &
    4.999427E+00_EB, 4.300838E+00_EB, 4.040951E+00_EB, 3.893896E+00_EB, 3.584120E+00_EB, 3.017460E+00_EB, &
    4.999336E+00_EB, 4.300830E+00_EB, 4.046630E+00_EB, 3.894284E+00_EB, 3.583946E+00_EB, 3.017831E+00_EB, &
    5.000000E+00_EB, 4.300727E+00_EB, 4.028554E+00_EB, 3.894300E+00_EB, 3.584789E+00_EB, 3.015628E+00_EB, &
    5.000000E+00_EB, 4.300725E+00_EB, 4.065888E+00_EB, 3.894303E+00_EB, 3.584780E+00_EB, 3.017679E+00_EB, &
    5.000000E+00_EB, 4.300680E+00_EB, 4.065902E+00_EB, 3.894130E+00_EB, 3.584801E+00_EB, 3.018381E+00_EB/),(/6,8/))

GAMMAD3_CH3OH(1:6,17:24) = RESHAPE((/ &  ! 3000-3175 cm-1
    4.999311E+00_EB, 4.300852E+00_EB, 3.992535E+00_EB, 3.894274E+00_EB, 3.583878E+00_EB, 3.017513E+00_EB, &
    4.999844E+00_EB, 4.299092E+00_EB, 2.609512E+00_EB, 3.889682E+00_EB, 3.545735E+00_EB, 3.012283E+00_EB, &
    2.367107E+00_EB, 3.563169E+00_EB, 9.990040E-01_EB, 3.540835E+00_EB, 3.583828E+00_EB, 2.057097E+00_EB, &
    6.887380E-01_EB, 6.189095E-01_EB, 3.563729E-01_EB, 6.413272E-01_EB, 6.545665E-01_EB, 1.475859E+00_EB, &
    2.703718E-01_EB, 2.170842E-01_EB, 8.206047E-02_EB, 1.764398E-01_EB, 4.234455E-01_EB, 4.390812E-01_EB, &
    1.886385E-01_EB, 1.088833E-02_EB, 2.628568E-02_EB, 1.720233E-02_EB, 8.075002E-01_EB, 6.229979E-02_EB, &
    4.492918E-03_EB, 2.019823E-03_EB, 2.748006E-03_EB, 2.388409E-03_EB, 1.285325E-01_EB, 6.240008E-03_EB, &
    1.741592E-03_EB, 1.696223E-03_EB, 1.913923E-03_EB, 1.748956E-03_EB, 3.821094E-03_EB, 1.965348E-03_EB/),(/6,8/))

GAMMAD3_CH3OH(1:6,25:26) = RESHAPE((/ &  ! 3200-3225 cm-1
    1.643856E-03_EB, 1.603047E-03_EB, 1.609477E-03_EB, 1.697852E-03_EB, 1.641911E-03_EB, 1.539826E-03_EB, &
    1.498523E-03_EB, 1.497953E-03_EB, 1.497022E-03_EB, 1.499683E-03_EB, 1.498643E-03_EB, 1.492511E-03_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #4: 3525 cm-1 - 3850 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.43646 % 

SD4_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 3525-3700 cm-1
    2.060416E-03_EB, 2.016850E-03_EB, 2.060649E-03_EB, 2.043358E-03_EB, 2.042491E-03_EB, 2.068244E-03_EB, &
    2.215092E-03_EB, 7.327218E-03_EB, 3.166782E-03_EB, 5.988766E-03_EB, 2.419201E-03_EB, 2.190864E-03_EB, &
    1.352557E-02_EB, 3.188085E-02_EB, 2.721869E-02_EB, 2.755339E-02_EB, 2.327344E-02_EB, 1.744092E-02_EB, &
    4.828772E-02_EB, 5.777175E-02_EB, 5.871255E-02_EB, 5.983036E-02_EB, 6.119809E-02_EB, 5.561364E-02_EB, &
    2.395985E-01_EB, 2.244556E-01_EB, 2.034701E-01_EB, 2.229951E-01_EB, 2.016785E-01_EB, 1.529798E-01_EB, &
    8.401838E-01_EB, 5.938696E-01_EB, 4.994377E-01_EB, 4.763772E-01_EB, 3.787511E-01_EB, 2.229440E-01_EB, &
    1.158964E+00_EB, 6.742879E-01_EB, 5.397059E-01_EB, 4.799737E-01_EB, 3.592326E-01_EB, 1.948051E-01_EB, &
    1.216575E+00_EB, 7.033415E-01_EB, 5.403969E-01_EB, 4.894709E-01_EB, 3.659367E-01_EB, 2.101812E-01_EB/),(/6,8/))

SD4_CH3OH(1:6,9:14) = RESHAPE((/ &  ! 3725-3850 cm-1
    7.404599E-01_EB, 5.609796E-01_EB, 4.654430E-01_EB, 4.385557E-01_EB, 3.564117E-01_EB, 2.355846E-01_EB, &
    1.629919E-01_EB, 1.281019E-01_EB, 1.199806E-01_EB, 1.268044E-01_EB, 1.078585E-01_EB, 5.912902E-02_EB, &
    4.865894E-02_EB, 6.976140E-02_EB, 5.563887E-02_EB, 2.753925E-02_EB, 2.928424E-02_EB, 4.711971E-02_EB, &
    5.741675E-03_EB, 2.982846E-02_EB, 1.581692E-02_EB, 2.676572E-03_EB, 3.669527E-03_EB, 1.652751E-02_EB, &
    2.082014E-03_EB, 3.722879E-03_EB, 3.235500E-03_EB, 2.011524E-03_EB, 2.043556E-03_EB, 2.034177E-03_EB, &
    1.878821E-03_EB, 1.877877E-03_EB, 1.877905E-03_EB, 1.880174E-03_EB, 1.878741E-03_EB, 1.871949E-03_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #4: 3525 cm-1 - 3850 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.43646 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_CH3OH(1:6,1:8) = RESHAPE((/ &  ! 3525-3700 cm-1
    1.626654E-03_EB, 1.602535E-03_EB, 1.631445E-03_EB, 1.605232E-03_EB, 1.607256E-03_EB, 1.631459E-03_EB, &
    1.723078E-03_EB, 7.768143E-03_EB, 2.499620E-03_EB, 7.076177E-03_EB, 1.971971E-03_EB, 1.705727E-03_EB, &
    1.180889E-01_EB, 4.055410E-02_EB, 2.034008E-02_EB, 3.381172E-01_EB, 2.336132E-02_EB, 6.639625E-03_EB, &
    8.550832E-01_EB, 1.406939E-01_EB, 5.940930E-02_EB, 4.699214E-02_EB, 4.021641E-02_EB, 1.807614E-02_EB, &
    7.812778E-01_EB, 3.139543E+00_EB, 4.126477E-01_EB, 4.372779E-01_EB, 4.725590E-01_EB, 1.149817E-01_EB, &
    4.805381E+00_EB, 2.583554E+00_EB, 1.000172E+00_EB, 8.519776E-01_EB, 1.923003E+00_EB, 2.597800E-01_EB, &
    4.845148E+00_EB, 4.083731E+00_EB, 5.932271E-01_EB, 8.547149E-01_EB, 1.176133E+00_EB, 1.605869E-01_EB, &
    4.993867E+00_EB, 3.422447E+00_EB, 6.243680E-01_EB, 8.794022E-01_EB, 1.994778E+00_EB, 3.561227E-01_EB/),(/6,8/))

GAMMAD4_CH3OH(1:6,9:14) = RESHAPE((/ &  ! 3725-3850 cm-1
    3.783701E+00_EB, 4.300257E+00_EB, 1.419573E+00_EB, 1.801651E+00_EB, 1.169163E+00_EB, 6.333207E-01_EB, &
    1.810755E-01_EB, 6.426424E-01_EB, 1.438808E-01_EB, 1.544789E-01_EB, 4.821333E-01_EB, 1.995849E-02_EB, &
    2.454278E-02_EB, 2.254048E-01_EB, 5.446141E-02_EB, 3.444090E-01_EB, 1.854418E-01_EB, 6.348029E-02_EB, &
    4.574510E-03_EB, 6.585079E-02_EB, 1.847167E-02_EB, 2.120399E-03_EB, 2.873519E-03_EB, 1.182680E-02_EB, &
    1.641036E-03_EB, 2.953831E-03_EB, 2.683454E-03_EB, 1.592042E-03_EB, 1.629044E-03_EB, 1.594709E-03_EB, &
    1.498523E-03_EB, 1.497953E-03_EB, 1.497022E-03_EB, 1.499683E-03_EB, 1.498643E-03_EB, 1.492511E-03_EB/),(/6,6/))

!-------------------------MMA DATA-------------------


! THERE ARE 6 BANDS FOR MMA

! BAND #1: 750 cm-1 - 880 cm-1 
! BAND #2: 875 cm-1 - 1055 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1 

N_TEMP_C5H8O2 = 5
N_BAND_C5H8O2 = 6
I_MODEL_C5H8O2 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C5H8O2_TEMP(N_TEMP_C5H8O2)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR MMA ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C5H8O2(N_BAND_C5H8O2,3)) 
ALLOCATE(Be_C5H8O2(N_BAND_C5H8O2)) 

OM_BND_C5H8O2 = RESHAPE((/ &
    750._EB,  875._EB, 1050._EB, 1250._EB, 1550._EB, 2650._EB, &
    880._EB, 1055._EB, 1275._EB, 1575._EB, 1975._EB, 3275._EB, &
     5._EB, 5._EB, 5._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C5H8O2,3/)) 

SD_C5H8O2_TEMP = (/ &
    396._EB, 441._EB, 483._EB, 597._EB, 803._EB/)

Be_C5H8O2 = (/ &
    1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C5H8O2(N_TEMP_C5H8O2,27)) 

! BAND #1: 750 cm-1 - 880 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.70103 % 

SD1_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 750-785 cm-1
    1.977968E-03_EB, 2.156480E-03_EB, 2.043154E-03_EB, 2.032996E-03_EB, 1.998580E-03_EB, &
    2.278828E-03_EB, 2.161466E-03_EB, 2.379096E-03_EB, 2.380908E-03_EB, 2.134351E-03_EB, &
    2.092760E-03_EB, 2.163484E-03_EB, 2.362076E-03_EB, 2.315581E-03_EB, 2.047509E-03_EB, &
    2.260017E-03_EB, 2.184251E-03_EB, 2.159842E-03_EB, 2.233054E-03_EB, 2.065305E-03_EB, &
    2.338610E-03_EB, 2.230286E-03_EB, 2.216772E-03_EB, 2.264400E-03_EB, 2.290279E-03_EB, &
    2.095256E-03_EB, 2.329624E-03_EB, 2.137686E-03_EB, 2.937296E-02_EB, 4.350639E-02_EB, &
    2.179934E-03_EB, 2.150314E-03_EB, 2.122989E-03_EB, 1.004382E+00_EB, 1.367564E-01_EB, &
    2.798449E-03_EB, 9.925160E-03_EB, 1.823038E-02_EB, 2.844367E+00_EB, 7.056756E-01_EB/),(/5,8/))

SD1_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 790-825 cm-1
    6.655494E-02_EB, 6.911521E-02_EB, 1.659808E-01_EB, 5.491844E+00_EB, 1.065872E+00_EB, &
    2.032964E-01_EB, 1.787689E-01_EB, 2.661095E-01_EB, 9.187026E+00_EB, 8.859010E-01_EB, &
    3.953030E-01_EB, 3.453332E-01_EB, 4.400895E-01_EB, 5.379512E+00_EB, 7.364314E-01_EB, &
    6.543583E-01_EB, 6.113190E-01_EB, 6.462599E-01_EB, 1.652931E+00_EB, 7.669053E-01_EB, &
    1.110150E+00_EB, 1.041891E+00_EB, 1.039608E+00_EB, 1.058753E+00_EB, 7.333727E-01_EB, &
    1.437098E+00_EB, 1.245273E+00_EB, 1.214748E+00_EB, 8.073228E-01_EB, 6.763148E-01_EB, &
    1.274080E+00_EB, 1.134532E+00_EB, 1.057303E+00_EB, 7.049093E-01_EB, 8.405894E-01_EB, &
    1.209532E+00_EB, 1.097683E+00_EB, 9.818507E-01_EB, 6.282549E-01_EB, 1.121762E+00_EB/),(/5,8/))

SD1_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 830-865 cm-1
    9.428976E-01_EB, 8.666572E-01_EB, 8.158085E-01_EB, 6.825674E-01_EB, 1.028508E+00_EB, &
    6.421852E-01_EB, 6.363373E-01_EB, 5.768994E-01_EB, 2.853390E+00_EB, 6.538786E-01_EB, &
    3.616812E-01_EB, 3.540135E-01_EB, 3.699415E-01_EB, 6.810458E+00_EB, 1.005925E+00_EB, &
    1.201674E-01_EB, 1.219608E-01_EB, 2.020640E-01_EB, 4.483012E+00_EB, 8.928660E-01_EB, &
    2.275904E-03_EB, 2.134816E-03_EB, 4.674742E-02_EB, 3.557090E+00_EB, 1.276134E-01_EB, &
    2.305928E-03_EB, 2.627990E-03_EB, 2.230247E-03_EB, 2.619126E+00_EB, 5.567757E-02_EB, &
    2.056231E-03_EB, 2.413242E-03_EB, 2.137246E-03_EB, 9.957676E-01_EB, 1.187661E-02_EB, &
    2.275221E-03_EB, 2.151820E-03_EB, 2.347560E-03_EB, 2.183802E-03_EB, 2.266907E-03_EB/),(/5,8/))

SD1_C5H8O2(1:5,25:27) = RESHAPE((/ &  ! 870-880 cm-1
    2.232094E-03_EB, 2.259397E-03_EB, 2.317550E-03_EB, 2.301286E-03_EB, 2.232390E-03_EB, &
    2.134763E-03_EB, 2.033134E-03_EB, 1.972608E-03_EB, 2.278035E-03_EB, 2.001979E-03_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,3/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C5H8O2(N_TEMP_C5H8O2,27)) 

! BAND #1: 750 cm-1 - 880 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.70103 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 750-785 cm-1
    1.551689E-03_EB, 1.698117E-03_EB, 1.579669E-03_EB, 1.598404E-03_EB, 1.567051E-03_EB, &
    1.742191E-03_EB, 1.666911E-03_EB, 1.850384E-03_EB, 1.974728E-03_EB, 1.658407E-03_EB, &
    1.626790E-03_EB, 1.691094E-03_EB, 1.903957E-03_EB, 1.868088E-03_EB, 1.614908E-03_EB, &
    1.801155E-03_EB, 1.675165E-03_EB, 1.691994E-03_EB, 1.779115E-03_EB, 1.674044E-03_EB, &
    1.773964E-03_EB, 1.751951E-03_EB, 1.760646E-03_EB, 1.804233E-03_EB, 1.799463E-03_EB, &
    1.642251E-03_EB, 1.849014E-03_EB, 1.618065E-03_EB, 2.101093E-03_EB, 1.005992E-02_EB, &
    1.690683E-03_EB, 1.663245E-03_EB, 1.639628E-03_EB, 2.931088E-04_EB, 8.181108E-03_EB, &
    2.233529E-03_EB, 7.019098E-03_EB, 2.867751E-02_EB, 4.233861E-04_EB, 1.610482E-03_EB/),(/5,8/))

GAMMAD1_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 790-825 cm-1
    2.922973E-02_EB, 5.611577E-01_EB, 2.858483E-01_EB, 5.176977E-04_EB, 1.729277E-03_EB, &
    1.323514E-01_EB, 3.703907E-01_EB, 5.695217E-01_EB, 5.065591E-04_EB, 3.636395E-03_EB, &
    3.199403E-01_EB, 6.170498E-01_EB, 2.136953E-01_EB, 1.213386E-03_EB, 1.041759E-02_EB, &
    1.268486E+00_EB, 9.932617E-01_EB, 3.880884E+00_EB, 7.314081E-03_EB, 2.043421E-02_EB, &
    6.689486E-01_EB, 1.299707E+00_EB, 6.503384E-01_EB, 3.154350E-02_EB, 3.303614E-02_EB, &
    7.853134E-01_EB, 2.505057E+00_EB, 2.310651E-01_EB, 4.084265E-01_EB, 4.002361E-02_EB, &
    7.782643E-01_EB, 9.847684E-01_EB, 6.737131E-01_EB, 1.433807E+00_EB, 1.513224E-02_EB, &
    6.484456E-01_EB, 5.907665E-01_EB, 1.086945E+00_EB, 1.171722E+00_EB, 6.035843E-03_EB/),(/5,8/))

GAMMAD1_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 830-865 cm-1
    4.868697E-01_EB, 6.191252E-01_EB, 4.203555E-01_EB, 2.553604E-02_EB, 4.022685E-03_EB, &
    4.458417E-01_EB, 1.111598E-01_EB, 4.852338E-01_EB, 1.567366E-03_EB, 5.304934E-03_EB, &
    6.221067E-01_EB, 1.798369E-01_EB, 2.361277E-01_EB, 4.525827E-04_EB, 1.517584E-03_EB, &
    1.112787E-01_EB, 5.206197E-02_EB, 7.938379E-02_EB, 5.353996E-04_EB, 7.693915E-04_EB, &
    1.826771E-03_EB, 1.725244E-03_EB, 2.126881E-02_EB, 4.819182E-04_EB, 9.312656E-03_EB, &
    1.789451E-03_EB, 1.979768E-03_EB, 1.732042E-03_EB, 4.206314E-04_EB, 3.692964E-01_EB, &
    1.667890E-03_EB, 1.933493E-03_EB, 1.705560E-03_EB, 2.607572E-04_EB, 4.162565E-03_EB, &
    1.783029E-03_EB, 1.732143E-03_EB, 1.777470E-03_EB, 1.723687E-03_EB, 1.752582E-03_EB/),(/5,8/))

GAMMAD1_C5H8O2(1:5,25:27) = RESHAPE((/ &  ! 870-880 cm-1
    1.729111E-03_EB, 1.755530E-03_EB, 1.830232E-03_EB, 1.838747E-03_EB, 1.810246E-03_EB, &
    1.702949E-03_EB, 1.605941E-03_EB, 1.557853E-03_EB, 1.841938E-03_EB, 1.607413E-03_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,3/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C5H8O2(N_TEMP_C5H8O2,37)) 

! BAND #2: 875 cm-1 - 1055 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.6152 % 

SD2_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 875-910 cm-1
    2.042466E-03_EB, 2.110197E-03_EB, 2.115530E-03_EB, 2.021717E-03_EB, 2.002696E-03_EB, &
    2.306623E-03_EB, 2.281435E-03_EB, 2.284688E-03_EB, 2.101845E-03_EB, 2.242374E-03_EB, &
    2.217570E-03_EB, 2.140589E-03_EB, 2.412758E-03_EB, 2.362165E-02_EB, 3.549615E-01_EB, &
    2.212678E-03_EB, 2.180013E-03_EB, 2.606677E-02_EB, 7.688687E-02_EB, 6.830155E-01_EB, &
    2.191413E-03_EB, 7.472758E-03_EB, 7.613374E-02_EB, 7.168518E-01_EB, 2.144276E-01_EB, &
    4.268654E-03_EB, 6.128858E-02_EB, 1.380447E-01_EB, 2.682910E+00_EB, 2.970594E-01_EB, &
    7.314869E-02_EB, 1.447346E-01_EB, 2.055059E-01_EB, 2.637256E+00_EB, 4.791219E-01_EB, &
    2.442803E-01_EB, 3.187050E-01_EB, 4.649318E-01_EB, 4.734934E+00_EB, 6.818840E-01_EB/),(/5,8/))

SD2_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 915-950 cm-1
    5.548001E-01_EB, 5.763900E-01_EB, 6.453431E-01_EB, 7.343137E+00_EB, 9.521638E-01_EB, &
    1.037663E+00_EB, 9.598699E-01_EB, 9.694419E-01_EB, 2.661087E+00_EB, 9.558380E-01_EB, &
    1.587533E+00_EB, 1.364251E+00_EB, 1.282871E+00_EB, 1.912233E+00_EB, 8.171322E-01_EB, &
    1.997673E+00_EB, 1.694393E+00_EB, 1.592114E+00_EB, 1.623632E+00_EB, 9.286486E-01_EB, &
    2.511490E+00_EB, 2.097555E+00_EB, 1.945708E+00_EB, 1.658392E+00_EB, 1.090108E+00_EB, &
    2.912512E+00_EB, 2.358381E+00_EB, 2.060326E+00_EB, 1.452723E+00_EB, 9.276094E-01_EB, &
    2.195118E+00_EB, 1.756372E+00_EB, 1.578649E+00_EB, 9.766806E-01_EB, 7.563211E-01_EB, &
    1.494157E+00_EB, 1.202115E+00_EB, 1.114469E+00_EB, 7.278390E-01_EB, 5.498164E-01_EB/),(/5,8/))

SD2_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 955-990 cm-1
    1.027413E+00_EB, 8.456956E-01_EB, 7.519810E-01_EB, 5.626895E-01_EB, 3.894647E-01_EB, &
    6.696120E-01_EB, 5.473343E-01_EB, 5.061671E-01_EB, 8.270640E-01_EB, 2.881169E-01_EB, &
    3.483895E-01_EB, 3.058405E-01_EB, 3.004113E-01_EB, 1.500322E+00_EB, 2.544801E-01_EB, &
    1.577174E-01_EB, 1.832271E-01_EB, 1.868893E-01_EB, 2.239869E+00_EB, 2.466930E-01_EB, &
    1.472487E-01_EB, 1.737696E-01_EB, 1.622712E-01_EB, 2.436176E+00_EB, 2.298132E-01_EB, &
    2.228549E-01_EB, 2.280001E-01_EB, 2.246147E-01_EB, 2.530489E+00_EB, 2.565302E-01_EB, &
    2.937766E-01_EB, 2.966041E-01_EB, 2.839553E-01_EB, 9.404273E-01_EB, 3.182601E-01_EB, &
    3.786927E-01_EB, 3.882557E-01_EB, 4.068266E-01_EB, 5.961964E-01_EB, 3.550976E-01_EB/),(/5,8/))

SD2_C5H8O2(1:5,25:32) = RESHAPE((/ &  ! 995-1030 cm-1
    4.992607E-01_EB, 5.057721E-01_EB, 5.000547E-01_EB, 5.493983E-01_EB, 4.051127E-01_EB, &
    6.153877E-01_EB, 6.411622E-01_EB, 6.419988E-01_EB, 5.548979E-01_EB, 4.367635E-01_EB, &
    7.938793E-01_EB, 7.921292E-01_EB, 7.915949E-01_EB, 7.073447E-01_EB, 4.522043E-01_EB, &
    1.014579E+00_EB, 9.517353E-01_EB, 8.818405E-01_EB, 6.764847E-01_EB, 5.558685E-01_EB, &
    1.259219E+00_EB, 1.063505E+00_EB, 9.620857E-01_EB, 7.090212E-01_EB, 3.318695E-01_EB, &
    1.239865E+00_EB, 1.024465E+00_EB, 8.758508E-01_EB, 6.539741E-01_EB, 2.370590E-01_EB, &
    1.237456E+00_EB, 9.477991E-01_EB, 7.995255E-01_EB, 7.547196E-01_EB, 1.865461E-01_EB, &
    8.738919E-01_EB, 6.794780E-01_EB, 5.614905E-01_EB, 5.925989E-01_EB, 1.154811E-01_EB/),(/5,8/))

SD2_C5H8O2(1:5,33:37) = RESHAPE((/ &  ! 1035-1055 cm-1
    5.899034E-01_EB, 4.482240E-01_EB, 3.631824E-01_EB, 3.638478E-01_EB, 2.653137E-02_EB, &
    2.244445E-01_EB, 1.926598E-01_EB, 1.587526E-01_EB, 6.140493E-01_EB, 2.070650E-03_EB, &
    4.975979E-02_EB, 7.061794E-02_EB, 4.211112E-02_EB, 3.820360E-02_EB, 2.212095E-03_EB, &
    6.187544E-03_EB, 1.186914E-02_EB, 8.635441E-03_EB, 2.102035E-03_EB, 2.121236E-03_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C5H8O2(N_TEMP_C5H8O2,37)) 

! BAND #2: 875 cm-1 - 1055 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.6152 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 875-910 cm-1
    1.579660E-03_EB, 1.615956E-03_EB, 1.653954E-03_EB, 1.627417E-03_EB, 1.574813E-03_EB, &
    1.797209E-03_EB, 1.781109E-03_EB, 1.785701E-03_EB, 1.666523E-03_EB, 1.768634E-03_EB, &
    1.756356E-03_EB, 1.681279E-03_EB, 1.890300E-03_EB, 6.189191E-03_EB, 3.735195E-04_EB, &
    1.761680E-03_EB, 1.764987E-03_EB, 5.321193E-03_EB, 2.123044E-02_EB, 1.018968E-03_EB, &
    1.728184E-03_EB, 4.475240E-03_EB, 4.951284E-03_EB, 3.608489E-04_EB, 1.450845E-01_EB, &
    3.779303E-03_EB, 1.277594E-02_EB, 2.721333E-02_EB, 4.374101E-04_EB, 5.638164E-02_EB, &
    6.052500E-02_EB, 6.381217E-02_EB, 9.954849E-02_EB, 7.424570E-04_EB, 1.424072E-02_EB, &
    1.033139E-01_EB, 6.848747E-02_EB, 1.656140E-02_EB, 1.126102E-03_EB, 1.547125E-02_EB/),(/5,8/))

GAMMAD2_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 915-950 cm-1
    1.032265E-01_EB, 5.466025E-01_EB, 3.637505E-01_EB, 1.346042E-03_EB, 1.542351E-02_EB, &
    1.144796E-01_EB, 1.010217E+00_EB, 4.886716E-01_EB, 6.927441E-03_EB, 2.619457E-02_EB, &
    1.432006E-01_EB, 1.109353E+00_EB, 8.614672E-01_EB, 1.763253E-02_EB, 1.291572E-01_EB, &
    2.297552E-01_EB, 3.744077E+00_EB, 9.858933E-01_EB, 4.607361E-02_EB, 1.143793E-01_EB, &
    2.778708E-01_EB, 4.355627E+00_EB, 7.930428E-01_EB, 7.972619E-02_EB, 5.966540E-02_EB, &
    3.238868E-01_EB, 4.616573E+00_EB, 1.210304E+00_EB, 1.331642E-01_EB, 1.222994E-01_EB, &
    2.451266E-01_EB, 4.340063E+00_EB, 5.877976E-01_EB, 5.725607E-01_EB, 9.993448E-02_EB, &
    1.795875E-01_EB, 3.576010E+00_EB, 3.146389E-01_EB, 1.098739E-01_EB, 1.559953E-01_EB/),(/5,8/))

GAMMAD2_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 955-990 cm-1
    1.239784E-01_EB, 1.569455E+00_EB, 8.026391E-01_EB, 4.868124E-02_EB, 6.868346E-01_EB, &
    4.572953E-02_EB, 6.085217E-01_EB, 5.667581E-01_EB, 5.232557E-03_EB, 6.215409E-01_EB, &
    2.515002E-02_EB, 4.859401E-01_EB, 5.596246E-01_EB, 1.374426E-03_EB, 6.404047E-01_EB, &
    8.030806E-02_EB, 2.745545E-01_EB, 4.968927E-01_EB, 7.247877E-04_EB, 1.921368E+00_EB, &
    4.290260E-02_EB, 1.202307E-01_EB, 7.789141E-01_EB, 5.988401E-04_EB, 9.332347E-01_EB, &
    9.710587E-02_EB, 2.641851E-01_EB, 1.349045E+00_EB, 7.224204E-04_EB, 2.052309E-01_EB, &
    1.055385E-01_EB, 2.510475E-01_EB, 5.468846E-01_EB, 2.712445E-03_EB, 1.858132E-01_EB, &
    2.193369E-01_EB, 2.609800E-01_EB, 2.125920E-01_EB, 9.608815E-03_EB, 4.845461E-01_EB/),(/5,8/))

GAMMAD2_C5H8O2(1:5,25:32) = RESHAPE((/ &  ! 995-1030 cm-1
    2.145844E-01_EB, 3.481229E-01_EB, 3.403510E-01_EB, 2.837016E-02_EB, 7.414174E-01_EB, &
    3.783368E-01_EB, 4.218983E-01_EB, 4.473844E-01_EB, 3.493477E-01_EB, 3.056384E-01_EB, &
    1.364610E-01_EB, 5.952926E-01_EB, 2.501817E-01_EB, 4.690452E-02_EB, 5.975616E-02_EB, &
    1.514847E-01_EB, 6.154576E-01_EB, 5.248340E-01_EB, 8.472757E-02_EB, 1.404748E-02_EB, &
    1.367876E-01_EB, 1.370025E+00_EB, 3.024798E-01_EB, 4.717083E-02_EB, 1.888060E-01_EB, &
    1.951830E-01_EB, 1.252616E+00_EB, 6.210271E-01_EB, 3.024455E-02_EB, 1.439676E+00_EB, &
    1.111612E-01_EB, 1.159598E+00_EB, 6.967457E-01_EB, 1.218077E-02_EB, 2.562049E+00_EB, &
    1.014253E-01_EB, 1.642295E+00_EB, 8.671713E-01_EB, 7.447326E-03_EB, 5.429616E-01_EB/),(/5,8/))

GAMMAD2_C5H8O2(1:5,33:37) = RESHAPE((/ &  ! 1035-1055 cm-1
    6.752262E-02_EB, 9.605534E-01_EB, 3.926567E-01_EB, 3.947463E-03_EB, 5.168906E-02_EB, &
    1.176035E-01_EB, 3.420822E-01_EB, 3.009257E-01_EB, 6.398171E-04_EB, 1.660897E-03_EB, &
    4.834788E-02_EB, 4.497404E-02_EB, 3.351079E-01_EB, 1.495479E-02_EB, 1.706261E-03_EB, &
    5.986851E-03_EB, 8.614835E-03_EB, 6.722316E-03_EB, 1.664198E-03_EB, 1.661604E-03_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #3: 1050 cm-1 - 1275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.3356 % 

SD3_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1050-1085 cm-1
    1.895316E-03_EB, 3.266740E-03_EB, 4.262770E-03_EB, 1.968277E-03_EB, 1.987200E-03_EB, &
    1.871896E-03_EB, 6.462260E-03_EB, 1.179414E-02_EB, 2.426734E-03_EB, 2.159215E-03_EB, &
    1.871896E-03_EB, 4.004899E-03_EB, 5.048405E-03_EB, 2.544188E-03_EB, 2.296985E-03_EB, &
    1.938284E-03_EB, 1.522413E-02_EB, 2.479717E-03_EB, 2.215632E-03_EB, 2.114329E-02_EB, &
    5.514975E-03_EB, 2.276508E-02_EB, 1.744594E-02_EB, 2.302676E-03_EB, 5.879148E-02_EB, &
    1.821065E-02_EB, 4.230168E-02_EB, 3.224741E-02_EB, 2.213755E-03_EB, 1.277977E-01_EB, &
    3.600080E-02_EB, 6.975337E-02_EB, 6.887688E-02_EB, 1.804451E-02_EB, 1.772755E-01_EB, &
    5.987390E-02_EB, 1.133137E-01_EB, 1.032082E-01_EB, 9.044261E-02_EB, 2.680671E-01_EB/),(/5,8/))

SD3_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 1090-1225 cm-1
    9.373223E-02_EB, 1.441543E-01_EB, 1.465131E-01_EB, 1.675262E-01_EB, 3.359493E-01_EB, &
    1.392028E-01_EB, 1.818684E-01_EB, 1.799138E-01_EB, 3.664029E-01_EB, 3.872205E-01_EB, &
    1.885373E-01_EB, 2.235879E-01_EB, 2.372975E-01_EB, 5.399505E-01_EB, 5.535676E-01_EB, &
    7.165421E-01_EB, 9.177639E-01_EB, 1.091727E+00_EB, 1.638425E+00_EB, 2.652301E+00_EB, &
    8.443639E+00_EB, 7.915300E+00_EB, 8.313690E+00_EB, 7.601797E+00_EB, 6.540142E+00_EB, &
    1.301316E+01_EB, 1.100675E+01_EB, 1.043425E+01_EB, 7.989538E+00_EB, 4.865054E+00_EB, &
    7.209517E+00_EB, 5.933006E+00_EB, 5.289987E+00_EB, 3.611772E+00_EB, 2.004953E+00_EB, &
    2.132598E+00_EB, 1.838141E+00_EB, 1.653118E+00_EB, 1.459786E+00_EB, 7.051564E-01_EB/),(/5,8/))

SD3_C5H8O2(1:5,17:18) = RESHAPE((/ &  ! 1250-1275 cm-1
    2.800021E-01_EB, 2.902226E-01_EB, 2.657141E-01_EB, 4.152738E-01_EB, 1.731737E-01_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #3: 1050 cm-1 - 1275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.3356 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1050-1085 cm-1
    1.514606E-03_EB, 2.500625E-03_EB, 4.192393E-03_EB, 1.558087E-03_EB, 1.586345E-03_EB, &
    1.491981E-03_EB, 4.019258E-03_EB, 3.418916E-03_EB, 1.881187E-03_EB, 1.715737E-03_EB, &
    1.491981E-03_EB, 3.175612E-03_EB, 3.002413E-03_EB, 1.978384E-03_EB, 1.809577E-03_EB, &
    1.528214E-03_EB, 9.963739E-03_EB, 2.170956E-03_EB, 1.707429E-03_EB, 2.163017E-02_EB, &
    3.338923E-03_EB, 1.101571E-02_EB, 1.341983E-02_EB, 1.750739E-03_EB, 2.961511E-01_EB, &
    1.383497E-02_EB, 2.872454E-02_EB, 1.993915E-01_EB, 1.710922E-03_EB, 9.751578E-01_EB, &
    1.320110E-01_EB, 6.864001E-02_EB, 2.826173E-01_EB, 3.711643E-01_EB, 3.077456E-01_EB, &
    7.228539E-02_EB, 1.091734E-01_EB, 1.230627E+00_EB, 5.901011E-01_EB, 8.122831E-01_EB/),(/5,8/))

GAMMAD3_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 1090-1225 cm-1
    1.928799E-01_EB, 5.752051E-01_EB, 3.997556E-01_EB, 1.029453E-01_EB, 1.400010E+00_EB, &
    1.737974E-01_EB, 2.658130E-01_EB, 6.680288E-01_EB, 5.428473E-03_EB, 3.481589E+00_EB, &
    1.901908E-01_EB, 5.145295E-01_EB, 1.189850E+00_EB, 6.206942E-03_EB, 1.461545E+00_EB, &
    3.043708E-01_EB, 1.337188E+00_EB, 1.263786E+00_EB, 1.502601E-01_EB, 6.014760E-01_EB, &
    3.867466E-01_EB, 1.044279E+00_EB, 8.044520E-01_EB, 5.905918E-01_EB, 1.410594E+00_EB, &
    1.043504E+00_EB, 4.526802E+00_EB, 1.594858E+00_EB, 4.780708E-01_EB, 9.633754E-01_EB, &
    8.426404E-01_EB, 4.737972E+00_EB, 1.412341E+00_EB, 3.587971E-01_EB, 2.961172E+00_EB, &
    1.999723E-01_EB, 1.096874E+00_EB, 8.113204E-01_EB, 4.734446E-02_EB, 2.262340E+00_EB/),(/5,8/))

GAMMAD3_C5H8O2(1:5,17:18) = RESHAPE((/ &  ! 1250-1275 cm-1
    1.467329E-01_EB, 2.194264E-01_EB, 2.570358E-01_EB, 3.988524E-03_EB, 3.146867E-01_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C5H8O2(N_TEMP_C5H8O2,14)) 

! BAND #4: 1250 cm-1 - 1575 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.0284 % 

SD4_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    1.660042E-01_EB, 1.748046E-01_EB, 1.697290E-01_EB, 1.882528E-01_EB, 2.343081E-01_EB, &
    9.377115E-01_EB, 1.023593E+00_EB, 1.129948E+00_EB, 1.467469E+00_EB, 1.470851E+00_EB, &
    4.805875E+00_EB, 4.338865E+00_EB, 4.163034E+00_EB, 3.788932E+00_EB, 2.318440E+00_EB, &
    5.225927E+00_EB, 4.286669E+00_EB, 3.734348E+00_EB, 2.703044E+00_EB, 1.259059E+00_EB, &
    1.287300E+00_EB, 1.045692E+00_EB, 8.492504E-01_EB, 1.538004E+00_EB, 2.248091E-01_EB, &
    5.468497E-01_EB, 5.142111E-01_EB, 4.380176E-01_EB, 3.291388E+00_EB, 2.197872E-01_EB, &
    8.848562E-01_EB, 8.281071E-01_EB, 7.415253E-01_EB, 1.712767E+00_EB, 5.886051E-01_EB, &
    1.352467E+00_EB, 1.258988E+00_EB, 1.190252E+00_EB, 1.353289E+00_EB, 7.982821E-01_EB/),(/5,8/))

SD4_C5H8O2(1:5,9:14) = RESHAPE((/ &  ! 1450-1575 cm-1
    2.800381E+00_EB, 2.309955E+00_EB, 2.018710E+00_EB, 1.701056E+00_EB, 8.400276E-01_EB, &
    1.266718E+00_EB, 1.075154E+00_EB, 9.044431E-01_EB, 1.353373E+00_EB, 4.168368E-01_EB, &
    2.277952E-01_EB, 2.289581E-01_EB, 1.796876E-01_EB, 6.112118E-01_EB, 6.865687E-02_EB, &
    1.359860E-01_EB, 1.277648E-01_EB, 9.147878E-02_EB, 2.438037E-02_EB, 3.675435E-03_EB, &
    5.961036E-02_EB, 5.060249E-02_EB, 3.528034E-02_EB, 4.755783E-03_EB, 3.830530E-03_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C5H8O2(N_TEMP_C5H8O2,14)) 

! BAND #4: 1250 cm-1 - 1575 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.0284 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    1.000227E-01_EB, 1.925749E-01_EB, 1.876160E-01_EB, 9.711695E-02_EB, 6.435815E-01_EB, &
    1.003636E-01_EB, 1.396838E+00_EB, 9.956486E-01_EB, 6.399946E-02_EB, 2.863372E-01_EB, &
    5.552385E-01_EB, 4.732894E+00_EB, 1.563780E+00_EB, 1.580531E-01_EB, 5.212981E-01_EB, &
    6.193887E-01_EB, 4.728369E+00_EB, 1.638045E+00_EB, 1.246175E-01_EB, 1.444806E-01_EB, &
    1.503227E-01_EB, 6.007908E-01_EB, 1.026038E+00_EB, 4.397791E-03_EB, 1.428625E-01_EB, &
    1.531302E-01_EB, 4.607107E-01_EB, 1.310725E+00_EB, 8.695787E-04_EB, 9.438721E-02_EB, &
    1.891924E-01_EB, 1.354402E+00_EB, 1.099985E+00_EB, 4.571853E-03_EB, 1.548350E-02_EB, &
    1.920713E-01_EB, 1.695036E+00_EB, 6.655762E-01_EB, 2.445910E-02_EB, 5.249217E-02_EB/),(/5,8/))

GAMMAD4_C5H8O2(1:5,9:14) = RESHAPE((/ &  ! 1450-1575 cm-1
    3.770440E-01_EB, 4.569252E+00_EB, 1.115790E+00_EB, 4.530247E-02_EB, 7.877098E-02_EB, &
    1.762895E-01_EB, 8.978709E-01_EB, 6.233793E-01_EB, 6.587037E-03_EB, 1.381483E-02_EB, &
    3.119500E-01_EB, 3.950605E-01_EB, 3.089391E-01_EB, 6.357531E-04_EB, 3.191263E-02_EB, &
    1.116972E-01_EB, 6.467394E-01_EB, 3.313760E-01_EB, 4.231392E-03_EB, 3.135888E-03_EB, &
    4.275879E-02_EB, 6.526666E-02_EB, 1.717928E-01_EB, 2.346504E-03_EB, 2.410054E-03_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD5_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #5: 1550 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.0191 % 

SD5_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1550-1725 cm-1
    5.578430E-02_EB, 4.566782E-02_EB, 3.214958E-02_EB, 3.567863E-03_EB, 5.904830E-03_EB, &
    1.317600E-01_EB, 1.379142E-01_EB, 1.004524E-01_EB, 1.212591E+00_EB, 3.333504E-01_EB, &
    2.100755E-01_EB, 3.325442E-01_EB, 2.058401E-01_EB, 3.320935E+00_EB, 7.032044E-01_EB, &
    7.837361E-01_EB, 7.305416E-01_EB, 6.634816E-01_EB, 1.791806E+00_EB, 3.041382E-01_EB, &
    9.733299E-01_EB, 8.015791E-01_EB, 6.713429E-01_EB, 3.655976E-01_EB, 1.926133E-01_EB, &
    2.543714E-01_EB, 2.759312E-01_EB, 2.533050E-01_EB, 3.538908E-01_EB, 2.239544E-01_EB, &
    6.200902E-01_EB, 6.600095E-01_EB, 7.040509E-01_EB, 7.462940E-01_EB, 9.714592E-01_EB, &
    5.709150E+00_EB, 5.139891E+00_EB, 5.207722E+00_EB, 4.355082E+00_EB, 3.406176E+00_EB/),(/5,8/))

SD5_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 1750-1925 cm-1
    1.090605E+01_EB, 8.986536E+00_EB, 8.305682E+00_EB, 5.769772E+00_EB, 3.563561E+00_EB, &
    1.301555E+00_EB, 1.223192E+00_EB, 1.222292E+00_EB, 1.054646E+00_EB, 8.492508E-01_EB, &
    3.062321E-01_EB, 3.205413E-01_EB, 2.975804E-01_EB, 2.409595E-01_EB, 1.607568E-01_EB, &
    5.127312E-02_EB, 4.634454E-02_EB, 4.015137E-02_EB, 4.063746E-02_EB, 1.599017E-02_EB, &
    1.928620E-02_EB, 2.460577E-02_EB, 2.235812E-02_EB, 2.775717E-02_EB, 4.194304E-03_EB, &
    1.314133E-01_EB, 1.211079E-01_EB, 1.050035E-01_EB, 6.243796E-02_EB, 1.333471E-02_EB, &
    6.851162E-02_EB, 6.295588E-02_EB, 5.244711E-02_EB, 2.384970E-02_EB, 2.270203E-03_EB, &
    4.785334E-03_EB, 2.127718E-03_EB, 2.993004E-03_EB, 2.108022E-03_EB, 2.145673E-03_EB/),(/5,8/))

SD5_C5H8O2(1:5,17:18) = RESHAPE((/ &  ! 1950-1975 cm-1
    2.041170E-03_EB, 2.081980E-03_EB, 2.068610E-03_EB, 2.090939E-03_EB, 2.029261E-03_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD5_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #5: 1550 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.0191 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD5_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 1550-1725 cm-1
    4.625020E-02_EB, 5.743999E-02_EB, 1.250741E-01_EB, 2.283009E-03_EB, 4.054401E-03_EB, &
    1.003172E-01_EB, 7.003088E-02_EB, 2.383113E-01_EB, 3.129461E-04_EB, 5.866136E-04_EB, &
    1.267319E-01_EB, 7.215189E-03_EB, 1.286866E-01_EB, 5.678760E-04_EB, 1.663931E-03_EB, &
    2.198852E-01_EB, 7.805502E-01_EB, 6.597722E-01_EB, 2.992888E-03_EB, 4.494161E-01_EB, &
    2.485270E-01_EB, 8.221271E-01_EB, 8.610334E-01_EB, 1.991289E-01_EB, 3.274007E+00_EB, &
    2.494447E-01_EB, 2.024321E-01_EB, 2.064188E-01_EB, 4.505978E-03_EB, 1.031386E+00_EB, &
    3.695726E-01_EB, 1.007059E+00_EB, 4.186969E-01_EB, 9.197797E-02_EB, 3.102112E+00_EB, &
    2.866716E-01_EB, 7.958919E-01_EB, 5.612843E-01_EB, 3.338158E-01_EB, 3.499645E+00_EB/),(/5,8/))

GAMMAD5_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 1750-1925 cm-1
    9.320643E-01_EB, 4.441684E+00_EB, 1.420863E+00_EB, 5.088807E-01_EB, 3.508776E+00_EB, &
    9.602140E-02_EB, 5.800404E-01_EB, 4.474404E-01_EB, 1.373700E-01_EB, 3.491679E+00_EB, &
    1.094478E-01_EB, 6.720713E-02_EB, 2.189761E-01_EB, 9.491070E-02_EB, 7.076412E-01_EB, &
    2.109593E-02_EB, 2.024572E-02_EB, 1.470252E-02_EB, 3.215945E-03_EB, 1.702800E-02_EB, &
    8.902892E-03_EB, 6.394130E-03_EB, 1.548294E-02_EB, 1.043673E-02_EB, 4.969734E-03_EB, &
    5.738655E-02_EB, 5.654567E-02_EB, 6.587783E-02_EB, 1.061542E-01_EB, 2.690706E-01_EB, &
    4.378490E-02_EB, 1.662891E-02_EB, 4.066752E-02_EB, 2.293556E-02_EB, 1.933921E-03_EB, &
    3.735976E-03_EB, 1.566580E-03_EB, 2.285848E-03_EB, 1.643824E-03_EB, 1.697660E-03_EB/),(/5,8/))

GAMMAD5_C5H8O2(1:5,17:18) = RESHAPE((/ &  ! 1950-1975 cm-1
    1.611017E-03_EB, 1.604233E-03_EB, 1.646504E-03_EB, 1.654250E-03_EB, 1.598756E-03_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD6_C5H8O2(N_TEMP_C5H8O2,26)) 

! BAND #6: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.4742 % 

SD6_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    2.081932E-03_EB, 1.982133E-03_EB, 2.040393E-03_EB, 2.023451E-03_EB, 2.051222E-03_EB, &
    2.255082E-03_EB, 2.268971E-03_EB, 2.192404E-03_EB, 2.235045E-03_EB, 2.175948E-03_EB, &
    4.261135E-03_EB, 5.494653E-03_EB, 3.997249E-03_EB, 2.208341E-03_EB, 6.438021E-03_EB, &
    1.031064E-02_EB, 1.596989E-02_EB, 1.397345E-02_EB, 7.672350E-03_EB, 2.209382E-02_EB, &
    2.872721E-02_EB, 3.370298E-02_EB, 3.235753E-02_EB, 1.192225E-02_EB, 2.360358E-02_EB, &
    2.051906E-02_EB, 3.078535E-02_EB, 2.651935E-02_EB, 6.895835E-03_EB, 2.196169E-02_EB, &
    5.031565E-02_EB, 4.319529E-02_EB, 4.818224E-02_EB, 3.115285E-02_EB, 6.609277E-02_EB, &
    1.314844E-01_EB, 1.256268E-01_EB, 1.272179E-01_EB, 1.125973E-01_EB, 1.516652E-01_EB/),(/5,8/))

SD6_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    4.749097E-01_EB, 4.254665E-01_EB, 3.852665E-01_EB, 2.871139E-01_EB, 2.319276E-01_EB, &
    4.041978E-01_EB, 3.742492E-01_EB, 3.493278E-01_EB, 2.521537E-01_EB, 2.699664E-01_EB, &
    5.337257E-01_EB, 5.087670E-01_EB, 4.807665E-01_EB, 3.627792E-01_EB, 3.758793E-01_EB, &
    9.904276E-01_EB, 9.047023E-01_EB, 8.602469E-01_EB, 6.609571E-01_EB, 6.472902E-01_EB, &
    2.242995E+00_EB, 2.037571E+00_EB, 1.943232E+00_EB, 1.520726E+00_EB, 1.183715E+00_EB, &
    2.469747E+00_EB, 2.144578E+00_EB, 1.938515E+00_EB, 1.419982E+00_EB, 1.003075E+00_EB, &
    1.768913E+00_EB, 1.529405E+00_EB, 1.350974E+00_EB, 9.212917E-01_EB, 6.420021E-01_EB, &
    1.093911E+00_EB, 9.795332E-01_EB, 8.647345E-01_EB, 5.636678E-01_EB, 4.438437E-01_EB/),(/5,8/))

SD6_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    5.401477E-01_EB, 4.949412E-01_EB, 4.472823E-01_EB, 3.213942E-01_EB, 2.822414E-01_EB, &
    2.490181E-01_EB, 2.536501E-01_EB, 2.411155E-01_EB, 1.922658E-01_EB, 2.280309E-01_EB, &
    3.395895E-01_EB, 3.297513E-01_EB, 3.140281E-01_EB, 2.510681E-01_EB, 2.525567E-01_EB, &
    2.435342E-01_EB, 2.358109E-01_EB, 2.075308E-01_EB, 1.646314E-01_EB, 1.686143E-01_EB, &
    7.281135E-02_EB, 8.146266E-02_EB, 6.592988E-02_EB, 4.842733E-02_EB, 8.856507E-02_EB, &
    4.358956E-02_EB, 4.775850E-02_EB, 2.878433E-02_EB, 1.291386E-02_EB, 6.146989E-02_EB, &
    1.881450E-02_EB, 1.830895E-02_EB, 8.415980E-03_EB, 2.279752E-03_EB, 2.718747E-02_EB, &
    7.857377E-03_EB, 2.667131E-03_EB, 3.129626E-03_EB, 2.139223E-03_EB, 5.201765E-03_EB/),(/5,8/))

SD6_C5H8O2(1:5,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    2.899233E-03_EB, 2.145510E-03_EB, 2.056357E-03_EB, 2.044772E-03_EB, 2.014970E-03_EB, &
    1.871896E-03_EB, 1.877025E-03_EB, 1.876358E-03_EB, 1.875642E-03_EB, 1.868920E-03_EB/),(/5,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD6_C5H8O2(N_TEMP_C5H8O2,26)) 

! BAND #6: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.4742 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD6_C5H8O2(1:5,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    1.653443E-03_EB, 1.563188E-03_EB, 1.613262E-03_EB, 1.606584E-03_EB, 1.614679E-03_EB, &
    1.725296E-03_EB, 1.789139E-03_EB, 1.710164E-03_EB, 1.734651E-03_EB, 1.719502E-03_EB, &
    2.798622E-03_EB, 4.027395E-03_EB, 3.564159E-03_EB, 1.736242E-03_EB, 4.099907E-03_EB, &
    5.482159E-03_EB, 1.592426E-02_EB, 1.514155E-02_EB, 4.769190E-03_EB, 6.893143E-03_EB, &
    1.950234E-02_EB, 1.234098E-01_EB, 3.934805E-02_EB, 1.441185E-02_EB, 7.754860E-03_EB, &
    9.848170E-03_EB, 1.738095E-01_EB, 5.657632E-02_EB, 6.355497E-03_EB, 1.389976E-02_EB, &
    2.792109E-02_EB, 4.937794E-02_EB, 3.956566E-02_EB, 3.065321E-02_EB, 7.394530E-02_EB, &
    7.871749E-02_EB, 4.988171E-01_EB, 1.803420E-01_EB, 4.637719E-02_EB, 4.331286E-01_EB/),(/5,8/))

GAMMAD6_C5H8O2(1:5,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    3.173689E-01_EB, 1.520960E+00_EB, 4.841228E-01_EB, 6.200687E-02_EB, 3.997890E-01_EB, &
    2.169080E-01_EB, 6.574878E-01_EB, 5.027094E-01_EB, 9.772614E-02_EB, 1.914074E-01_EB, &
    5.150202E-01_EB, 8.099970E-01_EB, 2.222449E+00_EB, 2.068439E-01_EB, 2.402609E-01_EB, &
    2.494255E-01_EB, 3.579547E+00_EB, 1.444015E+00_EB, 1.510472E-01_EB, 1.052679E+00_EB, &
    4.072276E-01_EB, 4.719683E+00_EB, 1.060402E+00_EB, 1.840233E-01_EB, 2.770912E+00_EB, &
    3.812094E-01_EB, 4.736921E+00_EB, 3.801489E+00_EB, 1.760368E-01_EB, 2.727431E+00_EB, &
    4.441031E-01_EB, 4.670353E+00_EB, 3.848767E+00_EB, 1.529392E-01_EB, 1.107268E+00_EB, &
    3.999652E-01_EB, 3.695515E+00_EB, 3.232650E+00_EB, 2.792403E-01_EB, 5.778686E-01_EB/),(/5,8/))

GAMMAD6_C5H8O2(1:5,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    3.419296E-01_EB, 9.041296E-01_EB, 3.464140E+00_EB, 2.041363E-01_EB, 4.773478E-01_EB, &
    7.136302E-01_EB, 1.728182E+00_EB, 8.904388E-01_EB, 1.296691E-01_EB, 1.026860E+00_EB, &
    1.147956E-01_EB, 4.801801E-01_EB, 6.023784E-01_EB, 1.107934E-01_EB, 1.953534E+00_EB, &
    3.114162E-01_EB, 4.049442E-01_EB, 5.596892E-01_EB, 2.281719E-02_EB, 2.965819E-01_EB, &
    1.784945E-01_EB, 2.113487E-02_EB, 4.283632E-01_EB, 2.379521E-02_EB, 4.065917E-02_EB, &
    2.042321E-01_EB, 2.711101E-02_EB, 5.250488E-01_EB, 8.786799E-03_EB, 5.323350E-02_EB, &
    2.490314E-02_EB, 1.465991E-02_EB, 6.829601E-03_EB, 1.773685E-03_EB, 1.454823E-01_EB, &
    3.756466E-03_EB, 1.998761E-03_EB, 2.215703E-03_EB, 1.669368E-03_EB, 4.682016E-03_EB/),(/5,8/))

GAMMAD6_C5H8O2(1:5,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    1.942576E-03_EB, 1.655661E-03_EB, 1.623892E-03_EB, 1.618670E-03_EB, 1.588874E-03_EB, &
    1.491981E-03_EB, 1.497063E-03_EB, 1.496390E-03_EB, 1.495702E-03_EB, 1.489750E-03_EB/),(/5,2/))

!-------------------------Propane DATA-------------------


! THERE ARE 2 BANDS FOR Propane

! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 

N_TEMP_C3H8 = 7
N_BAND_C3H8 = 2
I_MODEL_C3H8 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C3H8_TEMP(N_TEMP_C3H8)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Propane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C3H8(N_BAND_C3H8,3)) 
ALLOCATE(Be_C3H8(N_BAND_C3H8)) 

OM_BND_C3H8 = RESHAPE((/ &
    1175._EB, 2550._EB, &
    1675._EB, 3375._EB, &
     25._EB, 25._EB/),(/N_BAND_C3H8,3/)) 

SD_C3H8_TEMP = (/ &
    295._EB, 396._EB, 435._EB, 513._EB, 578._EB, 790._EB,&
    1009._EB/)

Be_C3H8 = (/ &
    1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C3H8(N_TEMP_C3H8,21)) 

! BAND #1: 1175 cm-1 - 1675 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.61556 % 

SD1_C3H8(1:7,1:8) = RESHAPE((/ &  ! 1175-1350 cm-1
    2.807532E-02_EB, 1.941412E-02_EB, 1.736790E-02_EB, 1.765869E-02_EB, 1.975785E-03_EB, 1.985715E-03_EB, &
    2.005278E-03_EB, &
    1.477174E-02_EB, 1.333025E-02_EB, 1.473275E-02_EB, 7.125861E-02_EB, 2.988908E-03_EB, 2.693155E-03_EB, &
    4.534358E-03_EB, &
    2.056046E-03_EB, 2.177646E-03_EB, 1.106298E-02_EB, 3.081074E-02_EB, 2.425334E-03_EB, 3.096857E-03_EB, &
    1.076691E-02_EB, &
    2.079291E-03_EB, 2.220571E-03_EB, 1.124562E-02_EB, 4.527308E-01_EB, 3.658854E-03_EB, 6.638144E-03_EB, &
    8.495990E-03_EB, &
    2.074139E-03_EB, 3.366310E-03_EB, 1.471029E-02_EB, 1.138321E-01_EB, 5.450811E-03_EB, 5.811568E-02_EB, &
    4.721770E-02_EB, &
    1.951993E-02_EB, 3.101658E-02_EB, 4.657291E-02_EB, 7.873333E-02_EB, 5.029496E-02_EB, 1.809751E-01_EB, &
    7.376484E-01_EB, &
    1.666774E-01_EB, 1.248723E-01_EB, 1.216181E-01_EB, 3.361518E-01_EB, 8.446061E-02_EB, 9.490239E-02_EB, &
    5.636226E-01_EB, &
    3.018940E-01_EB, 2.213919E-01_EB, 2.171539E-01_EB, 2.358028E-01_EB, 1.600575E-01_EB, 2.839406E-01_EB, &
    2.356342E-01_EB/),(/7,8/))

SD1_C3H8(1:7,9:16) = RESHAPE((/ &  ! 1375-1550 cm-1
    5.308926E-01_EB, 3.223839E-01_EB, 2.914391E-01_EB, 4.100167E-01_EB, 1.960547E-01_EB, 2.296875E-01_EB, &
    8.550874E-01_EB, &
    4.931572E-01_EB, 3.648375E-01_EB, 3.475520E-01_EB, 3.612059E-01_EB, 2.627054E-01_EB, 2.686324E-01_EB, &
    1.653662E-01_EB, &
    3.597452E-01_EB, 3.036583E-01_EB, 3.048711E-01_EB, 7.580500E-01_EB, 2.507773E-01_EB, 2.459167E-01_EB, &
    2.966357E-01_EB, &
    8.768985E-01_EB, 5.686631E-01_EB, 5.141669E-01_EB, 6.043568E-01_EB, 3.362020E-01_EB, 2.307445E-01_EB, &
    1.084082E+00_EB, &
    1.194832E+00_EB, 6.979711E-01_EB, 5.914913E-01_EB, 8.014039E-01_EB, 3.630513E-01_EB, 2.260164E-01_EB, &
    1.533703E-01_EB, &
    6.645102E-01_EB, 3.825983E-01_EB, 3.703471E-01_EB, 7.364319E-01_EB, 2.377629E-01_EB, 1.528349E-01_EB, &
    5.723740E-01_EB, &
    1.799018E-01_EB, 1.243084E-01_EB, 1.390905E-01_EB, 9.140307E-01_EB, 1.092046E-01_EB, 8.616384E-02_EB, &
    6.218926E-02_EB, &
    1.689867E-02_EB, 9.879771E-03_EB, 3.282082E-02_EB, 8.374363E-01_EB, 3.270333E-02_EB, 3.191721E-02_EB, &
    4.274275E-02_EB/),(/7,8/))

SD1_C3H8(1:7,17:21) = RESHAPE((/ &  ! 1575-1675 cm-1
    4.736410E-03_EB, 1.635064E-02_EB, 9.505252E-03_EB, 2.989885E-02_EB, 1.098054E-02_EB, 1.734710E-02_EB, &
    4.441981E-01_EB, &
    2.270061E-03_EB, 1.052246E-01_EB, 1.014733E-02_EB, 3.818443E-03_EB, 7.422981E-03_EB, 1.964536E-02_EB, &
    4.264141E-02_EB, &
    2.057224E-03_EB, 3.439032E-03_EB, 2.056532E-03_EB, 2.151250E-03_EB, 2.393808E-03_EB, 4.824597E-03_EB, &
    6.766463E-03_EB, &
    1.918898E-03_EB, 2.018742E-03_EB, 1.973611E-03_EB, 1.954819E-03_EB, 1.939240E-03_EB, 2.042574E-03_EB, &
    2.028859E-03_EB, &
    1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, &
    1.851911E-03_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C3H8(N_TEMP_C3H8,21)) 

! BAND #1: 1175 cm-1 - 1675 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.61556 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C3H8(1:7,1:8) = RESHAPE((/ &  ! 1175-1350 cm-1
    1.882113E-02_EB, 1.474096E-02_EB, 1.933697E-02_EB, 1.464254E-02_EB, 1.528556E-03_EB, 1.537446E-03_EB, &
    1.549670E-03_EB, &
    1.102047E-02_EB, 6.100707E-03_EB, 2.060620E-01_EB, 6.203700E-03_EB, 2.602478E-03_EB, 1.398273E-03_EB, &
    2.110205E-03_EB, &
    1.555576E-03_EB, 1.667725E-03_EB, 2.647167E-01_EB, 9.660959E-03_EB, 1.397655E-03_EB, 1.267440E-03_EB, &
    2.049549E-03_EB, &
    1.621438E-03_EB, 1.693444E-03_EB, 2.821198E-01_EB, 1.637114E-04_EB, 1.449551E-03_EB, 1.923851E-03_EB, &
    9.924894E-03_EB, &
    1.607288E-03_EB, 2.711217E-03_EB, 4.631113E-01_EB, 2.280979E-04_EB, 4.796461E-03_EB, 2.179294E-04_EB, &
    7.944411E-02_EB, &
    1.524901E-02_EB, 2.192657E-02_EB, 2.791077E-01_EB, 7.206349E-03_EB, 1.399975E-02_EB, 6.562472E-04_EB, &
    2.856461E-04_EB, &
    8.569799E-02_EB, 5.964123E-02_EB, 2.989339E-01_EB, 1.404058E-03_EB, 9.114857E-02_EB, 3.180397E-02_EB, &
    3.706610E-04_EB, &
    1.517924E-01_EB, 9.686259E-02_EB, 1.121884E+00_EB, 1.308399E-02_EB, 8.711828E-02_EB, 2.498552E-03_EB, &
    3.262653E-03_EB/),(/7,8/))

GAMMAD1_C3H8(1:7,9:16) = RESHAPE((/ &  ! 1375-1550 cm-1
    1.548701E-01_EB, 1.903829E-01_EB, 3.141992E-01_EB, 6.613422E-03_EB, 1.312048E-01_EB, 7.543849E-03_EB, &
    8.668488E-04_EB, &
    2.087283E-01_EB, 2.306862E-01_EB, 1.057583E+00_EB, 2.357875E-02_EB, 1.636995E-01_EB, 9.837639E-03_EB, &
    6.698341E-02_EB, &
    2.283900E-01_EB, 3.300749E-01_EB, 3.774782E-01_EB, 3.947095E-03_EB, 9.777909E-02_EB, 7.636174E-03_EB, &
    3.550836E-03_EB, &
    2.732414E-01_EB, 2.034951E-01_EB, 2.231112E+00_EB, 1.588921E-02_EB, 5.706704E-01_EB, 1.256673E-01_EB, &
    6.888018E-04_EB, &
    2.292222E-01_EB, 1.666604E-01_EB, 3.972836E-01_EB, 1.131766E-02_EB, 1.963842E-01_EB, 1.152868E-01_EB, &
    2.794360E-02_EB, &
    2.195911E-01_EB, 3.458146E+00_EB, 1.911489E+00_EB, 4.621672E-03_EB, 1.800471E-01_EB, 7.193850E-02_EB, &
    5.169037E-04_EB, &
    1.697146E-01_EB, 1.026327E+00_EB, 5.265678E-01_EB, 6.464526E-04_EB, 4.766640E-01_EB, 3.853589E-02_EB, &
    1.629443E-02_EB, &
    1.665885E-02_EB, 1.670520E-01_EB, 1.134411E+00_EB, 1.536773E-04_EB, 1.434389E-01_EB, 2.434211E-03_EB, &
    8.219656E-03_EB/),(/7,8/))

GAMMAD1_C3H8(1:7,17:21) = RESHAPE((/ &  ! 1575-1675 cm-1
    2.609840E-03_EB, 8.472556E-03_EB, 1.935804E-01_EB, 5.685735E-03_EB, 1.415272E-02_EB, 3.731969E-03_EB, &
    1.278843E-04_EB, &
    1.707776E-03_EB, 1.606099E-04_EB, 6.442595E-03_EB, 2.742956E-03_EB, 5.413608E-03_EB, 4.847028E-03_EB, &
    2.214520E-02_EB, &
    1.597814E-03_EB, 1.907255E-03_EB, 1.578770E-03_EB, 1.655036E-03_EB, 1.930011E-03_EB, 2.985594E-03_EB, &
    2.620878E-03_EB, &
    1.506536E-03_EB, 1.575192E-03_EB, 1.540180E-03_EB, 1.522683E-03_EB, 1.510396E-03_EB, 1.572048E-03_EB, &
    1.562457E-03_EB, &
    1.471783E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, &
    1.471784E-03_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C3H8(N_TEMP_C3H8,34)) 

! BAND #2: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.8443 % 

SD2_C3H8(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    1.933138E-03_EB, 1.976283E-03_EB, 2.194989E-03_EB, 1.978140E-03_EB, 1.933219E-03_EB, 1.982445E-03_EB, &
    2.259545E-03_EB, &
    8.889190E-03_EB, 6.765294E-03_EB, 5.884308E-03_EB, 3.467345E-03_EB, 4.718816E-03_EB, 3.878206E-03_EB, &
    1.405160E-02_EB, &
    3.729510E-02_EB, 2.412470E-02_EB, 2.276127E-02_EB, 1.126585E-02_EB, 1.259502E-02_EB, 9.645531E-03_EB, &
    1.219759E-01_EB, &
    6.236863E-02_EB, 3.982428E-02_EB, 3.278951E-02_EB, 2.785946E-02_EB, 1.809875E-02_EB, 1.052557E-02_EB, &
    1.594348E-02_EB, &
    7.832950E-02_EB, 4.630525E-02_EB, 3.917210E-02_EB, 2.762095E-02_EB, 1.735965E-02_EB, 1.123608E-02_EB, &
    2.292493E-02_EB, &
    6.152482E-02_EB, 3.367008E-02_EB, 3.019058E-02_EB, 2.941766E-02_EB, 2.043441E-02_EB, 1.823829E-02_EB, &
    9.725952E-02_EB, &
    3.265299E-02_EB, 2.490020E-02_EB, 2.773659E-02_EB, 2.777141E-02_EB, 2.568551E-02_EB, 3.140407E-02_EB, &
    4.964458E-02_EB, &
    8.523156E-02_EB, 6.094231E-02_EB, 6.332829E-02_EB, 6.734729E-02_EB, 6.053273E-02_EB, 6.251007E-02_EB, &
    8.735488E-01_EB/),(/7,8/))

SD2_C3H8(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    1.649003E-01_EB, 1.218817E-01_EB, 1.188709E-01_EB, 1.109183E-01_EB, 1.012013E-01_EB, 1.000376E-01_EB, &
    1.209959E-01_EB, &
    1.640175E-01_EB, 1.399406E-01_EB, 1.371501E-01_EB, 1.368714E-01_EB, 1.310225E-01_EB, 1.381156E-01_EB, &
    1.894847E-01_EB, &
    1.994267E-01_EB, 1.611532E-01_EB, 1.601932E-01_EB, 1.648523E-01_EB, 1.662487E-01_EB, 2.029414E-01_EB, &
    2.720218E-01_EB, &
    3.436492E-01_EB, 3.089277E-01_EB, 3.255758E-01_EB, 3.194768E-01_EB, 3.154287E-01_EB, 3.580074E-01_EB, &
    5.036525E-01_EB, &
    9.986329E-01_EB, 9.192921E-01_EB, 9.103570E-01_EB, 8.988432E-01_EB, 8.868185E-01_EB, 7.832163E-01_EB, &
    9.307987E-01_EB, &
    3.745645E+00_EB, 2.668252E+00_EB, 2.472562E+00_EB, 2.030386E+00_EB, 1.802049E+00_EB, 1.245523E+00_EB, &
    1.169125E+00_EB, &
    5.225197E+00_EB, 3.751661E+00_EB, 3.498643E+00_EB, 2.923959E+00_EB, 2.613690E+00_EB, 1.839938E+00_EB, &
    1.776560E+00_EB, &
    5.562511E+00_EB, 4.658686E+00_EB, 4.466355E+00_EB, 3.922363E+00_EB, 3.547489E+00_EB, 2.473488E+00_EB, &
    2.078821E+00_EB/),(/7,8/))

SD2_C3H8(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.053041E+01_EB, 7.568084E+00_EB, 6.981484E+00_EB, 5.621361E+00_EB, 4.901422E+00_EB, 3.021770E+00_EB, &
    2.460445E+00_EB, &
    1.307930E+01_EB, 8.571509E+00_EB, 7.693437E+00_EB, 5.921827E+00_EB, 4.990404E+00_EB, 2.780420E+00_EB, &
    2.149958E+00_EB, &
    5.632264E+00_EB, 4.266018E+00_EB, 3.960546E+00_EB, 3.365842E+00_EB, 2.915102E+00_EB, 1.758837E+00_EB, &
    1.578442E+00_EB, &
    7.275858E-01_EB, 8.759216E-01_EB, 8.946312E-01_EB, 1.003194E+00_EB, 9.658789E-01_EB, 7.741225E-01_EB, &
    9.048076E-01_EB, &
    6.654036E-02_EB, 1.468430E-01_EB, 1.726638E-01_EB, 2.383638E-01_EB, 2.586558E-01_EB, 3.163978E-01_EB, &
    5.387948E-01_EB, &
    3.847787E-02_EB, 7.994660E-02_EB, 1.003264E-01_EB, 1.376914E-01_EB, 1.413569E-01_EB, 1.781475E-01_EB, &
    6.728271E-01_EB, &
    4.638732E-02_EB, 7.823963E-02_EB, 9.325056E-02_EB, 1.216433E-01_EB, 1.207524E-01_EB, 1.401238E-01_EB, &
    8.090223E-01_EB, &
    7.556908E-02_EB, 7.785607E-02_EB, 9.018981E-02_EB, 1.081423E-01_EB, 1.027188E-01_EB, 1.067561E-01_EB, &
    1.596085E+00_EB/),(/7,8/))

SD2_C3H8(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    1.020482E-01_EB, 9.528808E-02_EB, 1.000798E-01_EB, 1.004546E-01_EB, 9.290392E-02_EB, 7.841011E-02_EB, &
    9.318127E-01_EB, &
    1.452647E-01_EB, 1.036644E-01_EB, 1.032274E-01_EB, 9.374593E-02_EB, 8.299275E-02_EB, 5.692665E-02_EB, &
    1.515308E+00_EB, &
    1.175916E-01_EB, 8.610554E-02_EB, 8.053559E-02_EB, 8.057774E-02_EB, 6.774736E-02_EB, 3.828982E-02_EB, &
    1.393599E+00_EB, &
    7.093004E-02_EB, 4.486408E-02_EB, 4.557955E-02_EB, 4.791673E-02_EB, 3.995717E-02_EB, 1.872254E-02_EB, &
    7.946954E-01_EB, &
    2.111472E-02_EB, 1.655889E-02_EB, 1.578715E-02_EB, 2.832291E-02_EB, 1.194095E-02_EB, 3.796746E-03_EB, &
    7.065775E-01_EB, &
    2.109050E-03_EB, 3.485655E-03_EB, 2.681335E-03_EB, 5.921068E-03_EB, 2.919065E-03_EB, 2.530664E-03_EB, &
    3.693217E-01_EB, &
    2.041225E-03_EB, 2.081746E-03_EB, 2.050917E-03_EB, 2.115858E-03_EB, 2.124828E-03_EB, 3.356252E-03_EB, &
    2.881310E-01_EB, &
    2.040221E-03_EB, 2.145810E-03_EB, 2.170779E-03_EB, 2.179252E-03_EB, 2.086062E-03_EB, 3.310962E-03_EB, &
    1.402499E-02_EB/),(/7,8/))

SD2_C3H8(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    1.972848E-03_EB, 2.032362E-03_EB, 2.001075E-03_EB, 2.000610E-03_EB, 1.942112E-03_EB, 2.286053E-03_EB, &
    1.976761E-03_EB, &
    1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, 1.851911E-03_EB, &
    1.851911E-03_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C3H8(N_TEMP_C3H8,34)) 

! BAND #2: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 2.8443 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C3H8(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    1.515523E-03_EB, 1.538015E-03_EB, 1.796088E-03_EB, 1.563089E-03_EB, 1.503790E-03_EB, 1.551082E-03_EB, &
    1.711035E-03_EB, &
    6.000229E-03_EB, 7.419600E-03_EB, 5.515396E-03_EB, 2.917170E-03_EB, 3.793756E-03_EB, 2.739117E-03_EB, &
    5.959097E-03_EB, &
    1.405142E-02_EB, 5.199086E-02_EB, 5.918616E-02_EB, 1.656503E-02_EB, 5.619514E-03_EB, 1.345450E-02_EB, &
    7.509335E-05_EB, &
    5.883261E-02_EB, 1.782406E-01_EB, 1.054825E-01_EB, 2.649569E-02_EB, 1.370244E-02_EB, 2.893217E-01_EB, &
    7.433371E-03_EB, &
    3.120888E-02_EB, 4.204781E-02_EB, 7.713085E-02_EB, 2.203710E-02_EB, 1.449613E-02_EB, 3.444467E-02_EB, &
    5.149322E-03_EB, &
    2.588281E-02_EB, 1.355357E-01_EB, 1.719534E-01_EB, 2.564173E-02_EB, 1.245475E-02_EB, 1.486743E-02_EB, &
    2.826732E-04_EB, &
    1.403601E-02_EB, 4.040717E-01_EB, 1.807703E-01_EB, 2.257120E-02_EB, 8.566584E-03_EB, 1.007295E-01_EB, &
    9.302631E-03_EB, &
    5.134834E-02_EB, 8.369722E-02_EB, 2.824852E-02_EB, 3.003423E-02_EB, 1.741192E-02_EB, 8.623081E-02_EB, &
    2.645267E-04_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    6.722149E-02_EB, 1.262949E-01_EB, 1.299249E-01_EB, 7.594602E-02_EB, 3.797132E-02_EB, 9.202211E-01_EB, &
    3.926387E-02_EB, &
    8.331437E-02_EB, 3.761042E-01_EB, 1.836122E-01_EB, 9.144938E-02_EB, 2.855513E-02_EB, 3.000943E-01_EB, &
    2.699089E-02_EB, &
    1.326419E-01_EB, 1.063207E-01_EB, 2.496077E-01_EB, 7.181163E-02_EB, 8.958140E-02_EB, 1.072344E+00_EB, &
    8.374055E-02_EB, &
    2.251611E-01_EB, 1.920765E-01_EB, 8.468114E-02_EB, 1.832667E-01_EB, 1.823739E-01_EB, 3.054401E+00_EB, &
    2.909294E-02_EB, &
    1.974642E-01_EB, 7.714302E-02_EB, 1.379424E-01_EB, 1.067254E-01_EB, 1.095362E-01_EB, 3.055049E+00_EB, &
    4.263077E-02_EB, &
    6.448974E-01_EB, 2.498951E-01_EB, 2.660747E-01_EB, 2.174830E-01_EB, 2.015537E-01_EB, 3.055391E+00_EB, &
    1.005480E-01_EB, &
    1.010131E+00_EB, 3.856648E-01_EB, 3.690334E-01_EB, 2.989598E-01_EB, 2.979756E-01_EB, 3.055393E+00_EB, &
    1.045675E-01_EB, &
    1.078522E+00_EB, 4.461561E-01_EB, 4.800357E-01_EB, 3.867069E-01_EB, 4.238238E-01_EB, 3.055354E+00_EB, &
    2.028953E-01_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.876916E+00_EB, 6.577901E-01_EB, 6.930650E-01_EB, 5.521851E-01_EB, 5.405090E-01_EB, 3.055389E+00_EB, &
    1.643568E-01_EB, &
    4.262535E+00_EB, 9.485173E-01_EB, 7.819798E-01_EB, 5.840097E-01_EB, 5.165435E-01_EB, 3.055394E+00_EB, &
    1.602365E-01_EB, &
    5.078109E-01_EB, 5.233227E-01_EB, 3.759560E-01_EB, 2.893035E-01_EB, 2.700615E-01_EB, 3.055390E+00_EB, &
    1.231999E-01_EB, &
    1.168641E-01_EB, 6.182349E-01_EB, 2.068583E-01_EB, 9.929227E-02_EB, 9.556393E-02_EB, 3.048740E+00_EB, &
    5.953302E-02_EB, &
    1.866184E-02_EB, 1.702166E-01_EB, 2.846136E-01_EB, 1.083263E-01_EB, 7.670916E-02_EB, 1.145002E+00_EB, &
    2.234615E-02_EB, &
    1.821036E-02_EB, 1.474304E-01_EB, 9.330159E-02_EB, 5.143735E-02_EB, 8.264873E-02_EB, 8.064490E-01_EB, &
    4.294042E-03_EB, &
    1.779764E-02_EB, 8.897916E-02_EB, 2.056694E-01_EB, 6.846888E-02_EB, 6.989486E-02_EB, 3.168833E-01_EB, &
    2.250518E-03_EB, &
    3.741051E-02_EB, 9.681927E-02_EB, 2.324478E-02_EB, 4.395891E-02_EB, 4.243202E-02_EB, 2.312789E+00_EB, &
    8.120084E-04_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    6.533903E-02_EB, 5.482700E-02_EB, 6.169652E-02_EB, 4.574510E-02_EB, 3.389545E-02_EB, 2.834306E-01_EB, &
    8.696773E-04_EB, &
    6.416463E-02_EB, 2.018626E-01_EB, 1.322680E-01_EB, 5.357373E-02_EB, 3.737963E-02_EB, 6.735982E-02_EB, &
    3.187662E-04_EB, &
    3.832010E-02_EB, 8.492767E-02_EB, 5.860104E-02_EB, 3.921119E-02_EB, 9.656580E-03_EB, 9.945935E-02_EB, &
    1.675882E-04_EB, &
    1.695480E-02_EB, 2.214333E-01_EB, 1.848519E-02_EB, 3.873563E-02_EB, 4.342961E-03_EB, 7.074202E-02_EB, &
    1.773679E-04_EB, &
    1.019689E-02_EB, 1.377063E-02_EB, 7.854795E-03_EB, 1.812384E-02_EB, 2.181683E-03_EB, 2.315823E-03_EB, &
    9.619261E-05_EB, &
    1.627724E-03_EB, 2.617168E-03_EB, 2.016667E-03_EB, 5.905281E-03_EB, 1.457948E-03_EB, 1.455439E-03_EB, &
    1.273381E-04_EB, &
    1.576400E-03_EB, 1.604403E-03_EB, 1.559450E-03_EB, 1.614497E-03_EB, 1.580698E-03_EB, 2.772633E-03_EB, &
    1.286796E-04_EB, &
    1.578361E-03_EB, 1.648631E-03_EB, 1.647666E-03_EB, 1.700157E-03_EB, 1.582437E-03_EB, 1.978209E-03_EB, &
    3.549987E-03_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    1.540909E-03_EB, 1.598127E-03_EB, 1.528073E-03_EB, 1.574253E-03_EB, 1.515260E-03_EB, 1.648496E-03_EB, &
    1.545025E-03_EB, &
    1.471783E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, 1.471784E-03_EB, &
    1.471784E-03_EB/),(/7,2/))

!-------------------------Propylene DATA-------------------


! THERE ARE 3 BANDS FOR Propylene

! BAND #1: 775 cm-1 - 1150 cm-1 
! BAND #2: 1225 cm-1 - 1975 cm-1 
! BAND #3: 2650 cm-1 - 3275 cm-1 

N_TEMP_C3H6 = 7
N_BAND_C3H6 = 3
I_MODEL_C3H6 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C3H6_TEMP(N_TEMP_C3H6)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Propylene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C3H6(N_BAND_C3H6,3)) 
ALLOCATE(Be_C3H6(N_BAND_C3H6)) 

OM_BND_C3H6 = RESHAPE((/ &
    775._EB, 1225._EB, 2650._EB, &
    1150._EB, 1975._EB, 3275._EB, &
     5._EB, 25._EB, 25._EB/),(/N_BAND_C3H6,3/)) 

SD_C3H6_TEMP = (/ &
    296._EB, 390._EB, 444._EB, 491._EB, 594._EB, 793._EB,&
    1003._EB/)

Be_C3H6 = (/ &
    1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C3H6(N_TEMP_C3H6,68)) 

! BAND #1: 775 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.8948 % 

SD1_C3H6(1:7,1:8) = RESHAPE((/ &  ! 775-810 cm-1
    4.818884E-04_EB, 4.775934E-04_EB, 4.535031E-04_EB, 4.218721E-04_EB, 4.428165E-04_EB, 4.628460E-04_EB, &
    5.330391E-04_EB, &
    6.999387E-04_EB, 6.212567E-04_EB, 5.303341E-04_EB, 5.191474E-04_EB, 4.517616E-04_EB, 4.957013E-04_EB, &
    6.407369E-04_EB, &
    6.616061E-04_EB, 5.907736E-04_EB, 5.690086E-04_EB, 5.387688E-04_EB, 5.293374E-04_EB, 4.980604E-04_EB, &
    6.699905E-04_EB, &
    1.069433E-03_EB, 5.471289E-04_EB, 5.579524E-04_EB, 5.215811E-04_EB, 2.557454E-03_EB, 4.833100E-04_EB, &
    6.441945E-04_EB, &
    7.347790E-04_EB, 5.871612E-04_EB, 4.956149E-04_EB, 1.385682E-03_EB, 1.348290E-02_EB, 4.790223E-03_EB, &
    5.770348E-04_EB, &
    6.189989E-03_EB, 2.150236E-02_EB, 8.910133E-03_EB, 1.638991E-02_EB, 7.883080E-02_EB, 1.277873E-02_EB, &
    5.587035E-04_EB, &
    9.113268E-03_EB, 2.147360E-02_EB, 1.760993E-02_EB, 1.524259E-02_EB, 1.343539E-01_EB, 1.353371E-02_EB, &
    6.064849E-04_EB, &
    6.110952E-02_EB, 3.918949E-02_EB, 1.815066E-02_EB, 2.024890E-02_EB, 2.543117E-01_EB, 2.377977E-02_EB, &
    5.996494E-04_EB/),(/7,8/))

SD1_C3H6(1:7,9:16) = RESHAPE((/ &  ! 815-850 cm-1
    1.397124E-01_EB, 3.077514E-02_EB, 2.138680E-02_EB, 3.933231E-02_EB, 2.200071E-01_EB, 3.809062E-02_EB, &
    1.686780E-03_EB, &
    1.705873E-01_EB, 3.768035E-02_EB, 3.812648E-02_EB, 5.156898E-02_EB, 2.423556E-01_EB, 6.538697E-02_EB, &
    4.562715E-04_EB, &
    1.258390E-01_EB, 5.600789E-02_EB, 5.496832E-02_EB, 6.966623E-02_EB, 1.197677E-01_EB, 6.322172E-02_EB, &
    4.185044E-03_EB, &
    7.186079E-02_EB, 7.865522E-02_EB, 7.935802E-02_EB, 1.064189E-01_EB, 1.320026E-01_EB, 9.709582E-02_EB, &
    2.548098E-02_EB, &
    9.406617E-02_EB, 1.081501E-01_EB, 1.044191E-01_EB, 1.113506E-01_EB, 1.855635E-01_EB, 1.333879E-01_EB, &
    5.853355E-02_EB, &
    1.456986E-01_EB, 1.687523E-01_EB, 1.521434E-01_EB, 1.498789E-01_EB, 2.146857E-01_EB, 1.637471E-01_EB, &
    9.221016E-02_EB, &
    2.015859E-01_EB, 2.353070E-01_EB, 1.948293E-01_EB, 2.025535E-01_EB, 2.521235E-01_EB, 1.853248E-01_EB, &
    1.159362E-01_EB, &
    2.790623E-01_EB, 3.047905E-01_EB, 2.552215E-01_EB, 3.054988E-01_EB, 3.088517E-01_EB, 2.124805E-01_EB, &
    1.370357E-01_EB/),(/7,8/))

SD1_C3H6(1:7,17:24) = RESHAPE((/ &  ! 855-890 cm-1
    3.893391E-01_EB, 3.883084E-01_EB, 3.322061E-01_EB, 3.631993E-01_EB, 4.672099E-01_EB, 2.285498E-01_EB, &
    1.421035E-01_EB, &
    5.050301E-01_EB, 4.692129E-01_EB, 3.969447E-01_EB, 4.112687E-01_EB, 4.901643E-01_EB, 3.092180E-01_EB, &
    2.179292E-01_EB, &
    6.806225E-01_EB, 5.860365E-01_EB, 4.848718E-01_EB, 4.917432E-01_EB, 5.062814E-01_EB, 3.110966E-01_EB, &
    1.951580E-01_EB, &
    8.560665E-01_EB, 7.050724E-01_EB, 5.659625E-01_EB, 5.759850E-01_EB, 6.133756E-01_EB, 4.481766E-01_EB, &
    1.367051E-01_EB, &
    1.111389E+00_EB, 8.575076E-01_EB, 6.709804E-01_EB, 6.800058E-01_EB, 6.619646E-01_EB, 4.202347E-01_EB, &
    2.345276E-01_EB, &
    1.290724E+00_EB, 9.631418E-01_EB, 7.508108E-01_EB, 7.623652E-01_EB, 6.646431E-01_EB, 4.174551E-01_EB, &
    2.925311E-01_EB, &
    1.603203E+00_EB, 1.127986E+00_EB, 8.814175E-01_EB, 8.410159E-01_EB, 7.253394E-01_EB, 4.520960E-01_EB, &
    2.596079E-01_EB, &
    1.760031E+00_EB, 1.233673E+00_EB, 9.801342E-01_EB, 9.085151E-01_EB, 7.842073E-01_EB, 4.961241E-01_EB, &
    2.989344E-01_EB/),(/7,8/))

SD1_C3H6(1:7,25:32) = RESHAPE((/ &  ! 895-930 cm-1
    2.023296E+00_EB, 1.364999E+00_EB, 1.081492E+00_EB, 9.722940E-01_EB, 8.595886E-01_EB, 5.509029E-01_EB, &
    4.944221E-01_EB, &
    2.100620E+00_EB, 1.404832E+00_EB, 1.105029E+00_EB, 1.027387E+00_EB, 8.828880E-01_EB, 6.591108E-01_EB, &
    4.132906E-01_EB, &
    2.232661E+00_EB, 1.502628E+00_EB, 1.222899E+00_EB, 1.116396E+00_EB, 1.011855E+00_EB, 7.029337E-01_EB, &
    6.178590E-01_EB, &
    4.505724E+00_EB, 3.207800E+00_EB, 2.570857E+00_EB, 2.239800E+00_EB, 1.841537E+00_EB, 1.102134E+00_EB, &
    6.789808E-01_EB, &
    3.462369E+00_EB, 2.546336E+00_EB, 2.124493E+00_EB, 1.957229E+00_EB, 1.653661E+00_EB, 1.116637E+00_EB, &
    6.383051E-01_EB, &
    2.522005E+00_EB, 1.683423E+00_EB, 1.368031E+00_EB, 1.263423E+00_EB, 1.114885E+00_EB, 7.530199E-01_EB, &
    5.037800E-01_EB, &
    2.434619E+00_EB, 1.615984E+00_EB, 1.289574E+00_EB, 1.181928E+00_EB, 1.036128E+00_EB, 6.576284E-01_EB, &
    4.380091E-01_EB, &
    2.351798E+00_EB, 1.568888E+00_EB, 1.252988E+00_EB, 1.144719E+00_EB, 9.981796E-01_EB, 6.737712E-01_EB, &
    4.057907E-01_EB/),(/7,8/))

SD1_C3H6(1:7,33:40) = RESHAPE((/ &  ! 935-970 cm-1
    2.284666E+00_EB, 1.566711E+00_EB, 1.254907E+00_EB, 1.144440E+00_EB, 9.763623E-01_EB, 6.779294E-01_EB, &
    4.011645E-01_EB, &
    2.247977E+00_EB, 1.605916E+00_EB, 1.303617E+00_EB, 1.166449E+00_EB, 9.982459E-01_EB, 6.608140E-01_EB, &
    3.846611E-01_EB, &
    2.120714E+00_EB, 1.571739E+00_EB, 1.307915E+00_EB, 1.161610E+00_EB, 1.005959E+00_EB, 6.743056E-01_EB, &
    4.507055E-01_EB, &
    1.995439E+00_EB, 1.563325E+00_EB, 1.332440E+00_EB, 1.196841E+00_EB, 1.052472E+00_EB, 6.652023E-01_EB, &
    5.493086E-01_EB, &
    1.763001E+00_EB, 1.470290E+00_EB, 1.276756E+00_EB, 1.163883E+00_EB, 1.050489E+00_EB, 6.611791E-01_EB, &
    4.645264E-01_EB, &
    1.507715E+00_EB, 1.309514E+00_EB, 1.150601E+00_EB, 1.074743E+00_EB, 9.648161E-01_EB, 7.900440E-01_EB, &
    4.121242E-01_EB, &
    1.296035E+00_EB, 1.108502E+00_EB, 9.707340E-01_EB, 9.275159E-01_EB, 9.027085E-01_EB, 6.793653E-01_EB, &
    3.892277E-01_EB, &
    1.118487E+00_EB, 9.211315E-01_EB, 7.988790E-01_EB, 8.016262E-01_EB, 8.132495E-01_EB, 5.928353E-01_EB, &
    4.102519E-01_EB/),(/7,8/))

SD1_C3H6(1:7,41:48) = RESHAPE((/ &  ! 975-1010 cm-1
    1.086570E+00_EB, 8.675587E-01_EB, 7.383333E-01_EB, 7.335069E-01_EB, 7.489447E-01_EB, 5.926594E-01_EB, &
    3.874552E-01_EB, &
    1.092392E+00_EB, 8.465895E-01_EB, 7.136522E-01_EB, 7.028557E-01_EB, 7.222337E-01_EB, 5.854703E-01_EB, &
    4.218779E-01_EB, &
    1.168888E+00_EB, 9.506999E-01_EB, 8.102676E-01_EB, 7.933108E-01_EB, 7.610771E-01_EB, 5.932497E-01_EB, &
    4.748461E-01_EB, &
    2.169625E+00_EB, 1.477186E+00_EB, 1.183852E+00_EB, 1.041073E+00_EB, 8.819922E-01_EB, 6.318582E-01_EB, &
    3.752706E-01_EB, &
    1.021363E+00_EB, 8.095250E-01_EB, 7.053713E-01_EB, 6.467141E-01_EB, 5.926002E-01_EB, 4.364454E-01_EB, &
    3.160274E-01_EB, &
    8.516865E-01_EB, 6.479941E-01_EB, 5.785139E-01_EB, 5.215198E-01_EB, 5.030067E-01_EB, 3.605308E-01_EB, &
    2.545028E-01_EB, &
    8.151796E-01_EB, 6.005579E-01_EB, 5.258081E-01_EB, 4.829748E-01_EB, 4.714507E-01_EB, 3.636355E-01_EB, &
    2.470243E-01_EB, &
    7.833900E-01_EB, 5.616312E-01_EB, 4.850365E-01_EB, 4.515769E-01_EB, 4.336068E-01_EB, 3.012032E-01_EB, &
    2.202777E-01_EB/),(/7,8/))

SD1_C3H6(1:7,49:56) = RESHAPE((/ &  ! 1015-1050 cm-1
    7.334395E-01_EB, 5.249921E-01_EB, 4.362439E-01_EB, 4.184092E-01_EB, 3.777229E-01_EB, 3.090995E-01_EB, &
    2.299511E-01_EB, &
    6.512502E-01_EB, 4.740756E-01_EB, 3.878005E-01_EB, 3.671105E-01_EB, 3.467124E-01_EB, 2.541005E-01_EB, &
    2.175792E-01_EB, &
    5.604628E-01_EB, 4.205422E-01_EB, 3.384537E-01_EB, 3.288250E-01_EB, 3.428866E-01_EB, 2.285296E-01_EB, &
    1.438594E-01_EB, &
    4.764812E-01_EB, 3.700585E-01_EB, 2.990451E-01_EB, 2.913167E-01_EB, 2.830803E-01_EB, 2.097052E-01_EB, &
    1.088138E-01_EB, &
    3.958085E-01_EB, 3.254281E-01_EB, 2.701850E-01_EB, 2.486863E-01_EB, 2.756256E-01_EB, 1.941627E-01_EB, &
    1.320909E-01_EB, &
    3.597536E-01_EB, 3.030674E-01_EB, 2.739503E-01_EB, 2.346761E-01_EB, 2.436165E-01_EB, 1.845310E-01_EB, &
    1.373604E-01_EB, &
    4.297146E-01_EB, 3.104860E-01_EB, 2.799546E-01_EB, 2.281778E-01_EB, 2.273168E-01_EB, 1.667692E-01_EB, &
    6.782537E-02_EB, &
    2.146376E-01_EB, 1.707075E-01_EB, 1.804829E-01_EB, 1.505491E-01_EB, 1.681917E-01_EB, 1.193132E-01_EB, &
    2.545305E-01_EB/),(/7,8/))

SD1_C3H6(1:7,57:64) = RESHAPE((/ &  ! 1055-1090 cm-1
    1.741268E-01_EB, 1.284830E-01_EB, 1.336107E-01_EB, 1.157873E-01_EB, 1.261020E-01_EB, 9.831758E-02_EB, &
    4.398613E-02_EB, &
    1.666351E-01_EB, 1.098270E-01_EB, 9.955346E-02_EB, 9.805474E-02_EB, 1.114702E-01_EB, 1.030214E-01_EB, &
    3.058840E-02_EB, &
    1.419506E-01_EB, 9.538939E-02_EB, 8.210686E-02_EB, 7.570115E-02_EB, 7.962109E-02_EB, 6.698911E-02_EB, &
    4.740955E-01_EB, &
    1.177085E-01_EB, 8.166022E-02_EB, 6.517681E-02_EB, 5.767508E-02_EB, 7.353478E-02_EB, 4.812671E-02_EB, &
    4.945858E-02_EB, &
    9.710934E-02_EB, 7.171137E-02_EB, 5.262393E-02_EB, 4.916112E-02_EB, 7.898114E-02_EB, 3.910710E-02_EB, &
    4.272014E-01_EB, &
    7.715193E-02_EB, 5.618039E-02_EB, 4.271806E-02_EB, 3.394970E-02_EB, 4.566476E-02_EB, 3.720262E-02_EB, &
    5.490680E-02_EB, &
    5.781083E-02_EB, 4.659058E-02_EB, 3.457878E-02_EB, 2.506088E-02_EB, 8.768415E-02_EB, 3.236252E-02_EB, &
    4.264257E-01_EB, &
    4.667355E-02_EB, 3.133257E-02_EB, 3.318321E-02_EB, 1.708158E-02_EB, 2.443622E-02_EB, 3.573900E-02_EB, &
    3.171516E-03_EB/),(/7,8/))

SD1_C3H6(1:7,65:68) = RESHAPE((/ &  ! 1095-1150 cm-1
    3.253917E-02_EB, 1.805401E-02_EB, 2.675427E-02_EB, 1.175778E-02_EB, 1.113453E-02_EB, 1.994312E-02_EB, &
    4.883927E-04_EB, &
    1.529752E-02_EB, 9.510834E-03_EB, 7.192125E-02_EB, 5.543192E-03_EB, 5.917892E-03_EB, 6.628937E-03_EB, &
    6.587929E-04_EB, &
    5.706293E-04_EB, 4.853376E-04_EB, 5.181158E-04_EB, 4.668262E-04_EB, 4.448894E-04_EB, 4.388254E-04_EB, &
    5.309773E-04_EB, &
    4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, &
    4.069875E-04_EB/),(/7,4/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C3H6(N_TEMP_C3H6,68)) 

! BAND #1: 775 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.8948 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C3H6(1:7,1:8) = RESHAPE((/ &  ! 775-810 cm-1
    3.394630E-04_EB, 3.731137E-04_EB, 3.454326E-04_EB, 3.225712E-04_EB, 3.342413E-04_EB, 3.548770E-04_EB, &
    4.036087E-04_EB, &
    4.380285E-04_EB, 4.175482E-04_EB, 4.064549E-04_EB, 3.686819E-04_EB, 3.406261E-04_EB, 3.785180E-04_EB, &
    4.721401E-04_EB, &
    4.900864E-04_EB, 4.081404E-04_EB, 4.357570E-04_EB, 3.835816E-04_EB, 4.108044E-04_EB, 3.642445E-04_EB, &
    4.304487E-04_EB, &
    8.829577E-04_EB, 3.618215E-04_EB, 4.093852E-04_EB, 3.690100E-04_EB, 1.259640E-03_EB, 3.655781E-04_EB, &
    4.315437E-04_EB, &
    6.119833E-04_EB, 4.396173E-04_EB, 3.757813E-04_EB, 5.596268E-04_EB, 1.802284E-03_EB, 6.698260E-02_EB, &
    4.347025E-04_EB, &
    7.979689E-04_EB, 3.681883E-04_EB, 9.102606E-02_EB, 8.700861E-04_EB, 8.256847E-04_EB, 2.678549E-01_EB, &
    3.894134E-04_EB, &
    2.918796E-03_EB, 4.734143E-04_EB, 2.627379E-01_EB, 2.717688E-03_EB, 1.272179E-03_EB, 2.691989E-01_EB, &
    3.766117E-04_EB, &
    3.957675E-04_EB, 7.240266E-04_EB, 1.248094E-01_EB, 9.895767E-03_EB, 1.077035E-03_EB, 4.770402E-01_EB, &
    4.214816E-04_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,9:16) = RESHAPE((/ &  ! 815-850 cm-1
    3.367650E-04_EB, 7.489059E-03_EB, 2.995808E-01_EB, 6.370793E-03_EB, 2.059817E-03_EB, 6.036107E-01_EB, &
    2.546491E-02_EB, &
    5.682712E-04_EB, 5.175286E-02_EB, 5.822760E-01_EB, 4.845771E-02_EB, 3.210351E-03_EB, 6.121724E-01_EB, &
    3.714073E-04_EB, &
    1.751089E-03_EB, 3.204364E-01_EB, 9.847070E-01_EB, 2.295535E-01_EB, 1.546033E-02_EB, 2.663601E-01_EB, &
    9.367120E-02_EB, &
    1.503101E-02_EB, 3.011702E-01_EB, 2.957969E+00_EB, 6.821055E-02_EB, 4.958575E-02_EB, 8.062724E-01_EB, &
    7.222394E-01_EB, &
    2.746131E-02_EB, 7.117119E-01_EB, 4.081900E+00_EB, 2.197207E+00_EB, 4.449399E-02_EB, 1.501466E+00_EB, &
    1.325580E+00_EB, &
    3.441515E-02_EB, 8.135771E-02_EB, 4.073501E+00_EB, 3.216710E+00_EB, 6.542580E-02_EB, 1.517836E+00_EB, &
    2.716196E+00_EB, &
    4.091750E-02_EB, 6.672430E-02_EB, 4.054977E+00_EB, 3.891261E-01_EB, 7.389938E-02_EB, 3.051278E+00_EB, &
    2.716177E+00_EB, &
    6.051434E-02_EB, 9.277364E-02_EB, 3.957640E+00_EB, 9.062278E-02_EB, 8.250768E-02_EB, 3.054748E+00_EB, &
    2.712876E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,17:24) = RESHAPE((/ &  ! 855-890 cm-1
    9.022894E-02_EB, 1.366018E-01_EB, 7.982027E-01_EB, 1.394413E-01_EB, 4.770458E-02_EB, 3.051702E+00_EB, &
    2.710363E+00_EB, &
    1.277628E-01_EB, 2.124406E-01_EB, 4.052509E+00_EB, 2.603159E-01_EB, 6.645127E-02_EB, 4.021000E-01_EB, &
    2.708678E+00_EB, &
    1.905908E-01_EB, 3.183825E-01_EB, 3.998226E+00_EB, 3.050157E-01_EB, 1.243977E-01_EB, 3.030234E+00_EB, &
    2.714039E+00_EB, &
    2.578764E-01_EB, 3.521773E-01_EB, 4.082231E+00_EB, 3.058962E-01_EB, 9.827767E-02_EB, 1.235191E-01_EB, &
    2.716222E+00_EB, &
    3.885071E-01_EB, 4.525603E-01_EB, 2.931215E+00_EB, 3.365984E-01_EB, 1.308288E-01_EB, 5.274859E-01_EB, &
    2.715651E+00_EB, &
    5.062915E-01_EB, 4.703365E-01_EB, 2.101069E+00_EB, 3.263178E-01_EB, 2.008678E-01_EB, 3.050148E+00_EB, &
    2.716212E+00_EB, &
    5.702606E-01_EB, 4.875195E-01_EB, 9.983432E-01_EB, 4.170436E-01_EB, 2.289008E-01_EB, 3.041906E+00_EB, &
    2.716206E+00_EB, &
    6.332974E-01_EB, 4.469504E-01_EB, 6.790574E-01_EB, 3.987114E-01_EB, 2.444743E-01_EB, 1.361543E+00_EB, &
    2.716195E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,25:32) = RESHAPE((/ &  ! 895-930 cm-1
    7.027987E-01_EB, 4.929064E-01_EB, 6.402471E-01_EB, 4.743636E-01_EB, 2.287887E-01_EB, 5.258960E-01_EB, &
    9.078702E-02_EB, &
    8.234450E-01_EB, 5.229815E-01_EB, 7.319872E-01_EB, 4.196357E-01_EB, 2.649686E-01_EB, 2.980547E-01_EB, &
    2.335262E+00_EB, &
    9.809355E-01_EB, 5.891760E-01_EB, 7.265010E-01_EB, 5.575574E-01_EB, 3.144922E-01_EB, 3.053526E+00_EB, &
    1.142144E-01_EB, &
    4.416396E-01_EB, 3.942752E-01_EB, 4.451993E-01_EB, 4.555784E-01_EB, 3.572107E-01_EB, 6.674302E-01_EB, &
    7.693316E-01_EB, &
    5.270505E-01_EB, 4.076891E-01_EB, 4.784219E-01_EB, 4.128916E-01_EB, 3.683438E-01_EB, 4.334093E-01_EB, &
    2.716223E+00_EB, &
    1.393165E+00_EB, 7.187042E-01_EB, 8.943792E-01_EB, 5.504996E-01_EB, 3.135510E-01_EB, 8.572271E-01_EB, &
    2.713117E+00_EB, &
    1.247700E+00_EB, 7.287635E-01_EB, 1.011225E+00_EB, 5.862371E-01_EB, 2.739991E-01_EB, 3.054746E+00_EB, &
    2.693224E+00_EB, &
    1.234745E+00_EB, 6.842441E-01_EB, 9.374940E-01_EB, 5.861482E-01_EB, 2.908252E-01_EB, 4.913508E-01_EB, &
    2.716170E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,33:40) = RESHAPE((/ &  ! 935-970 cm-1
    1.094801E+00_EB, 6.377435E-01_EB, 8.594007E-01_EB, 5.677260E-01_EB, 3.436799E-01_EB, 4.480297E-01_EB, &
    2.716222E+00_EB, &
    1.063639E+00_EB, 5.965083E-01_EB, 7.269071E-01_EB, 5.475283E-01_EB, 3.033831E-01_EB, 9.406333E-01_EB, &
    2.716219E+00_EB, &
    1.014011E+00_EB, 6.126512E-01_EB, 6.681710E-01_EB, 5.470526E-01_EB, 3.176384E-01_EB, 6.576830E-01_EB, &
    2.516084E+00_EB, &
    9.447857E-01_EB, 6.338665E-01_EB, 6.736740E-01_EB, 5.604851E-01_EB, 3.017796E-01_EB, 1.667237E+00_EB, &
    2.264311E-01_EB, &
    8.254328E-01_EB, 6.022861E-01_EB, 6.495487E-01_EB, 5.306610E-01_EB, 2.852422E-01_EB, 3.026771E+00_EB, &
    2.716221E+00_EB, &
    7.197869E-01_EB, 5.584117E-01_EB, 6.897105E-01_EB, 5.101314E-01_EB, 3.167146E-01_EB, 1.931781E-01_EB, &
    2.716217E+00_EB, &
    5.942749E-01_EB, 4.666096E-01_EB, 7.385247E-01_EB, 4.714916E-01_EB, 2.286994E-01_EB, 3.339971E-01_EB, &
    2.715201E+00_EB, &
    5.210728E-01_EB, 4.318874E-01_EB, 1.075410E+00_EB, 3.776693E-01_EB, 1.861029E-01_EB, 5.452610E-01_EB, &
    2.716215E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,41:48) = RESHAPE((/ &  ! 975-1010 cm-1
    4.798054E-01_EB, 3.902874E-01_EB, 9.402154E-01_EB, 3.882760E-01_EB, 1.811196E-01_EB, 2.903406E-01_EB, &
    3.197209E-01_EB, &
    4.244873E-01_EB, 3.658932E-01_EB, 8.219536E-01_EB, 3.735714E-01_EB, 1.668177E-01_EB, 3.264816E-01_EB, &
    2.868836E-01_EB, &
    4.284099E-01_EB, 3.688961E-01_EB, 6.980741E-01_EB, 3.985847E-01_EB, 2.246880E-01_EB, 3.761024E-01_EB, &
    1.765513E-01_EB, &
    4.259514E-01_EB, 4.093741E-01_EB, 5.117670E-01_EB, 4.391553E-01_EB, 2.542867E-01_EB, 2.421158E-01_EB, &
    7.183406E-01_EB, &
    3.984957E-01_EB, 2.900698E-01_EB, 3.841716E-01_EB, 3.223574E-01_EB, 1.992312E-01_EB, 2.098513E+00_EB, &
    2.706901E+00_EB, &
    4.079526E-01_EB, 3.008284E-01_EB, 3.279547E-01_EB, 3.122041E-01_EB, 1.430283E-01_EB, 3.021343E+00_EB, &
    2.703691E+00_EB, &
    3.632099E-01_EB, 3.174576E-01_EB, 3.859517E-01_EB, 2.794578E-01_EB, 1.228730E-01_EB, 2.266968E-01_EB, &
    1.075809E+00_EB, &
    3.259163E-01_EB, 3.259052E-01_EB, 4.393994E-01_EB, 2.437095E-01_EB, 1.240616E-01_EB, 2.924400E+00_EB, &
    2.716072E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,49:56) = RESHAPE((/ &  ! 1015-1050 cm-1
    2.825611E-01_EB, 2.915529E-01_EB, 7.510441E-01_EB, 2.253869E-01_EB, 1.544184E-01_EB, 1.517855E-01_EB, &
    6.950904E-02_EB, &
    2.436687E-01_EB, 2.269100E-01_EB, 1.013899E+00_EB, 2.585318E-01_EB, 1.113880E-01_EB, 1.475703E+00_EB, &
    6.781810E-02_EB, &
    1.961885E-01_EB, 1.861983E-01_EB, 2.022911E+00_EB, 2.098004E-01_EB, 6.500465E-02_EB, 3.013196E+00_EB, &
    2.715653E+00_EB, &
    1.584160E-01_EB, 1.427991E-01_EB, 7.894695E-01_EB, 1.776560E-01_EB, 8.477210E-02_EB, 9.782084E-01_EB, &
    2.716167E+00_EB, &
    1.191024E-01_EB, 1.072075E-01_EB, 2.712733E-01_EB, 2.764286E-01_EB, 5.280852E-02_EB, 4.802650E-01_EB, &
    2.716137E+00_EB, &
    1.224123E-01_EB, 1.189629E-01_EB, 1.527926E-01_EB, 3.485418E-01_EB, 7.796533E-02_EB, 3.052885E+00_EB, &
    8.779680E-01_EB, &
    1.338510E-01_EB, 1.156906E-01_EB, 9.685327E-02_EB, 1.781488E-01_EB, 5.247137E-02_EB, 2.337404E-01_EB, &
    2.212581E+00_EB, &
    7.464619E-02_EB, 1.213094E-01_EB, 6.461525E-02_EB, 1.185296E-01_EB, 2.955999E-02_EB, 1.391105E+00_EB, &
    3.325019E-03_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,57:64) = RESHAPE((/ &  ! 1055-1090 cm-1
    6.078364E-02_EB, 1.447071E-01_EB, 7.377991E-02_EB, 1.171087E-01_EB, 3.013961E-02_EB, 1.309380E+00_EB, &
    4.775127E-01_EB, &
    3.418611E-02_EB, 9.838683E-02_EB, 3.803859E-01_EB, 6.507413E-02_EB, 1.746541E-02_EB, 1.315834E-02_EB, &
    2.713416E-01_EB, &
    3.500693E-02_EB, 6.316545E-02_EB, 2.883898E-01_EB, 1.046009E-01_EB, 1.675071E-02_EB, 1.693424E-01_EB, &
    5.624173E-04_EB, &
    3.953543E-02_EB, 3.258825E-02_EB, 2.622403E-01_EB, 2.448714E-01_EB, 1.064266E-02_EB, 3.994949E-01_EB, &
    9.333500E-03_EB, &
    3.149142E-02_EB, 1.731624E-02_EB, 4.844516E-01_EB, 4.404086E-02_EB, 4.211264E-03_EB, 8.701586E-02_EB, &
    2.100987E-04_EB, &
    2.235962E-02_EB, 1.467614E-02_EB, 8.480268E-02_EB, 6.922474E-02_EB, 5.004359E-03_EB, 1.120593E-02_EB, &
    1.176943E-04_EB, &
    1.657669E-02_EB, 7.244909E-03_EB, 4.680041E-02_EB, 1.116710E-01_EB, 7.344214E-04_EB, 1.795426E-02_EB, &
    2.574471E-04_EB, &
    9.402877E-03_EB, 8.123332E-03_EB, 5.789732E-03_EB, 6.039791E-02_EB, 2.228671E-03_EB, 6.760326E-03_EB, &
    7.033244E-04_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,65:68) = RESHAPE((/ &  ! 1095-1150 cm-1
    5.496511E-03_EB, 1.962852E-02_EB, 4.324339E-03_EB, 1.720966E-02_EB, 6.286435E-03_EB, 1.309093E-02_EB, &
    3.066188E-04_EB, &
    2.037331E-03_EB, 1.211050E-02_EB, 2.978296E-04_EB, 3.685014E-02_EB, 2.012738E-02_EB, 3.093791E-03_EB, &
    5.449442E-04_EB, &
    4.039806E-04_EB, 3.754738E-04_EB, 3.878077E-04_EB, 3.460337E-04_EB, 3.413308E-04_EB, 3.382249E-04_EB, &
    3.916160E-04_EB, &
    3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, &
    3.176583E-04_EB/),(/7,4/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C3H6(N_TEMP_C3H6,31)) 

! BAND #2: 1225 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.71804 % 

SD2_C3H6(1:7,1:8) = RESHAPE((/ &  ! 1225-1400 cm-1
    5.371358E-04_EB, 5.106087E-04_EB, 5.151777E-04_EB, 4.588800E-04_EB, 4.343886E-04_EB, 4.487517E-04_EB, &
    4.819345E-04_EB, &
    7.875943E-04_EB, 5.538461E-04_EB, 6.128437E-04_EB, 5.242800E-04_EB, 4.943504E-04_EB, 4.994889E-04_EB, &
    3.408801E-03_EB, &
    9.210981E-04_EB, 5.899698E-03_EB, 1.766929E-02_EB, 5.552612E-03_EB, 5.202514E-03_EB, 1.485897E-02_EB, &
    5.530005E-02_EB, &
    7.951689E-04_EB, 1.757199E-02_EB, 2.682924E-02_EB, 1.852410E-02_EB, 1.665389E-02_EB, 1.189745E-01_EB, &
    5.453036E-02_EB, &
    4.277157E-03_EB, 3.108371E-02_EB, 4.649207E-02_EB, 3.749401E-02_EB, 3.851261E-02_EB, 1.130065E-01_EB, &
    4.358540E-02_EB, &
    1.199917E-01_EB, 7.328895E-02_EB, 9.222138E-02_EB, 8.095132E-02_EB, 8.348335E-02_EB, 1.013688E-01_EB, &
    9.055050E-02_EB, &
    2.698797E-01_EB, 2.007594E-01_EB, 2.157895E-01_EB, 1.894810E-01_EB, 1.706483E-01_EB, 1.717348E-01_EB, &
    1.308641E-01_EB, &
    5.421860E-01_EB, 3.931486E-01_EB, 3.591157E-01_EB, 3.169622E-01_EB, 2.628424E-01_EB, 2.192079E-01_EB, &
    1.540610E-01_EB/),(/7,8/))

SD2_C3H6(1:7,9:16) = RESHAPE((/ &  ! 1425-1600 cm-1
    7.267959E-01_EB, 4.823878E-01_EB, 4.325191E-01_EB, 3.795944E-01_EB, 3.196341E-01_EB, 2.459087E-01_EB, &
    1.761103E-01_EB, &
    1.217311E+00_EB, 7.143221E-01_EB, 5.740964E-01_EB, 4.842953E-01_EB, 3.522185E-01_EB, 2.400135E-01_EB, &
    1.667799E-01_EB, &
    1.066191E+00_EB, 6.216855E-01_EB, 5.141892E-01_EB, 4.226006E-01_EB, 3.136087E-01_EB, 2.356521E-01_EB, &
    1.550589E-01_EB, &
    4.903725E-01_EB, 3.249395E-01_EB, 2.649127E-01_EB, 2.502942E-01_EB, 2.105298E-01_EB, 1.666857E-01_EB, &
    1.270891E-01_EB, &
    2.666029E-01_EB, 1.539996E-01_EB, 1.436365E-01_EB, 1.418584E-01_EB, 1.283814E-01_EB, 1.172524E-01_EB, &
    1.193711E-01_EB, &
    2.112478E-01_EB, 1.033995E-01_EB, 8.850454E-02_EB, 1.015494E-01_EB, 1.012777E-01_EB, 9.403151E-02_EB, &
    1.112459E-01_EB, &
    6.154680E-01_EB, 1.068368E-01_EB, 1.066378E-01_EB, 9.788033E-02_EB, 1.007785E-01_EB, 1.303908E-01_EB, &
    1.436765E-01_EB, &
    2.020388E+00_EB, 1.314824E-01_EB, 1.663817E-01_EB, 1.646570E-01_EB, 1.903679E-01_EB, 2.405626E-01_EB, &
    1.999871E-01_EB/),(/7,8/))

SD2_C3H6(1:7,17:24) = RESHAPE((/ &  ! 1625-1800 cm-1
    7.266781E-01_EB, 5.235759E-01_EB, 4.845024E-01_EB, 4.406769E-01_EB, 3.743746E-01_EB, 2.866654E-01_EB, &
    2.165776E-01_EB, &
    1.158670E+00_EB, 6.687397E-01_EB, 5.367869E-01_EB, 4.750755E-01_EB, 3.790532E-01_EB, 2.633253E-01_EB, &
    1.890695E-01_EB, &
    7.359108E-01_EB, 4.624098E-01_EB, 4.143563E-01_EB, 3.267419E-01_EB, 2.427211E-01_EB, 1.554714E-01_EB, &
    1.033768E-01_EB, &
    1.616064E-02_EB, 1.241128E-02_EB, 1.100924E-02_EB, 1.207945E-02_EB, 7.431117E-03_EB, 1.442282E-02_EB, &
    1.263532E-02_EB, &
    7.859711E-04_EB, 6.089692E-04_EB, 5.738631E-04_EB, 2.582023E-03_EB, 4.924534E-04_EB, 4.771685E-04_EB, &
    5.976946E-04_EB, &
    7.855927E-04_EB, 5.582022E-04_EB, 6.012881E-04_EB, 9.968765E-04_EB, 5.079255E-04_EB, 1.478359E-03_EB, &
    1.478968E-03_EB, &
    3.761084E-03_EB, 8.693166E-03_EB, 9.000696E-03_EB, 1.198023E-02_EB, 1.436101E-02_EB, 1.791215E-02_EB, &
    2.161788E-02_EB, &
    1.400808E-01_EB, 1.050241E-01_EB, 9.798400E-02_EB, 8.450494E-02_EB, 7.204515E-02_EB, 5.614724E-02_EB, &
    4.008139E-02_EB/),(/7,8/))

SD2_C3H6(1:7,25:31) = RESHAPE((/ &  ! 1825-1975 cm-1
    2.598323E-01_EB, 1.510729E-01_EB, 1.262306E-01_EB, 1.086780E-01_EB, 8.795577E-02_EB, 7.109326E-02_EB, &
    4.835911E-02_EB, &
    1.759201E-01_EB, 1.292754E-01_EB, 1.214272E-01_EB, 9.830493E-02_EB, 8.062465E-02_EB, 6.814797E-02_EB, &
    4.485466E-02_EB, &
    4.613168E-02_EB, 2.964876E-02_EB, 3.049536E-02_EB, 2.689093E-02_EB, 2.367193E-02_EB, 3.135636E-02_EB, &
    1.966905E-02_EB, &
    1.399654E-02_EB, 7.363816E-03_EB, 1.845686E-02_EB, 5.055719E-03_EB, 3.429260E-03_EB, 1.644171E-03_EB, &
    2.674718E-03_EB, &
    1.580369E-03_EB, 8.012104E-04_EB, 9.738929E-04_EB, 5.732225E-04_EB, 4.706468E-04_EB, 4.877841E-04_EB, &
    5.612786E-04_EB, &
    6.458280E-04_EB, 4.685864E-04_EB, 5.153428E-04_EB, 4.688756E-04_EB, 4.380288E-04_EB, 4.535362E-04_EB, &
    4.962565E-04_EB, &
    4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, &
    4.069875E-04_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C3H6(N_TEMP_C3H6,31)) 

! BAND #2: 1225 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.71804 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C3H6(1:7,1:8) = RESHAPE((/ &  ! 1225-1400 cm-1
    4.069459E-04_EB, 3.895117E-04_EB, 3.790129E-04_EB, 3.474468E-04_EB, 3.372216E-04_EB, 3.487807E-04_EB, &
    3.477174E-04_EB, &
    6.029608E-04_EB, 4.126780E-04_EB, 4.505192E-04_EB, 3.602740E-04_EB, 3.673125E-04_EB, 3.695774E-04_EB, &
    2.843129E-03_EB, &
    6.735906E-04_EB, 2.218392E-02_EB, 4.458966E-04_EB, 3.219060E-03_EB, 3.202154E-03_EB, 7.707429E-05_EB, &
    1.693955E-03_EB, &
    5.764361E-04_EB, 3.882275E-02_EB, 4.676826E-03_EB, 6.501005E-03_EB, 1.247140E-02_EB, 3.320735E-04_EB, &
    5.708415E-03_EB, &
    1.488120E-03_EB, 3.013991E-02_EB, 5.134607E-03_EB, 1.158541E-02_EB, 2.384481E-02_EB, 2.717011E-03_EB, &
    8.593684E-01_EB, &
    3.373765E-03_EB, 6.758005E-02_EB, 1.726775E-02_EB, 5.258981E-02_EB, 7.569248E-02_EB, 2.966049E-02_EB, &
    1.961833E+00_EB, &
    3.542925E-02_EB, 1.507459E-01_EB, 5.010813E-02_EB, 8.847995E-02_EB, 1.359316E-01_EB, 4.951711E-02_EB, &
    2.497788E+00_EB, &
    1.065729E-01_EB, 1.975744E-01_EB, 1.274975E-01_EB, 1.589009E-01_EB, 1.458819E-01_EB, 7.035332E-02_EB, &
    2.715476E+00_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,9:16) = RESHAPE((/ &  ! 1425-1600 cm-1
    1.528760E-01_EB, 2.517031E-01_EB, 1.591622E-01_EB, 1.910433E-01_EB, 1.583343E-01_EB, 1.442361E-01_EB, &
    2.713958E+00_EB, &
    2.751805E-01_EB, 2.841683E-01_EB, 2.349198E-01_EB, 2.154800E-01_EB, 2.021491E-01_EB, 1.013137E-01_EB, &
    2.714253E+00_EB, &
    2.553942E-01_EB, 2.747333E-01_EB, 1.962111E-01_EB, 2.175545E-01_EB, 1.960764E-01_EB, 8.149258E-02_EB, &
    2.709584E+00_EB, &
    7.381629E-02_EB, 1.713007E-01_EB, 5.508050E-01_EB, 1.908078E-01_EB, 1.313698E-01_EB, 1.475775E-01_EB, &
    2.716051E+00_EB, &
    9.298979E-03_EB, 1.083578E-01_EB, 1.979138E-01_EB, 1.137512E-01_EB, 1.598959E-01_EB, 6.318486E-01_EB, &
    4.386794E-01_EB, &
    4.077934E-03_EB, 1.118942E-01_EB, 2.421074E+00_EB, 1.087511E-01_EB, 9.989253E-02_EB, 1.458297E+00_EB, &
    1.408020E+00_EB, &
    1.261493E-03_EB, 3.056722E-02_EB, 2.914515E-02_EB, 6.245480E-02_EB, 9.987304E-02_EB, 6.123777E-02_EB, &
    2.599539E+00_EB, &
    4.894122E-04_EB, 7.673872E-02_EB, 3.339858E-02_EB, 7.648348E-02_EB, 1.124484E-01_EB, 6.698038E-02_EB, &
    2.715309E+00_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,17:24) = RESHAPE((/ &  ! 1625-1800 cm-1
    6.948155E-02_EB, 2.236131E-01_EB, 1.813586E-01_EB, 2.267188E-01_EB, 2.235488E-01_EB, 1.860064E-01_EB, &
    2.706104E+00_EB, &
    2.296230E-01_EB, 2.901094E-01_EB, 3.103661E-01_EB, 2.518771E-01_EB, 1.921871E-01_EB, 2.628291E-01_EB, &
    1.607715E+00_EB, &
    8.453631E-02_EB, 1.275392E-01_EB, 9.599000E-02_EB, 1.545414E-01_EB, 1.564341E-01_EB, 2.162337E-01_EB, &
    2.894109E-01_EB, &
    4.944783E-04_EB, 1.663089E-04_EB, 1.190907E-02_EB, 2.781585E-02_EB, 2.421093E-03_EB, 6.546793E-02_EB, &
    3.322643E-02_EB, &
    5.687164E-04_EB, 4.469615E-04_EB, 4.439781E-04_EB, 2.591319E-03_EB, 3.719154E-04_EB, 3.597131E-04_EB, &
    4.353449E-04_EB, &
    5.470678E-04_EB, 4.049474E-04_EB, 4.275184E-04_EB, 7.739759E-04_EB, 3.753511E-04_EB, 9.902487E-04_EB, &
    1.459139E-03_EB, &
    1.738222E-03_EB, 1.858962E-03_EB, 6.107450E-03_EB, 1.630960E-02_EB, 6.356633E-03_EB, 4.621663E-02_EB, &
    5.419508E-02_EB, &
    2.406984E-02_EB, 3.460164E-02_EB, 2.821232E-02_EB, 6.073769E-02_EB, 6.418059E-02_EB, 6.815047E-02_EB, &
    4.424753E-01_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,25:31) = RESHAPE((/ &  ! 1825-1975 cm-1
    7.155267E-02_EB, 7.004680E-02_EB, 6.376639E-02_EB, 7.183908E-02_EB, 5.620135E-02_EB, 2.772873E-02_EB, &
    3.565166E-01_EB, &
    6.512678E-02_EB, 4.755030E-02_EB, 3.298563E-02_EB, 5.902057E-02_EB, 5.466058E-02_EB, 2.199150E-02_EB, &
    8.243532E-01_EB, &
    6.903396E-03_EB, 1.465301E-02_EB, 1.484291E-02_EB, 2.149630E-02_EB, 1.757375E-02_EB, 3.235867E-03_EB, &
    1.735086E-01_EB, &
    2.597579E-03_EB, 3.940632E-03_EB, 4.409047E-04_EB, 4.452051E-03_EB, 2.415952E-03_EB, 1.161838E-03_EB, &
    1.836274E-03_EB, &
    9.049090E-04_EB, 6.187485E-04_EB, 5.655264E-04_EB, 3.980090E-04_EB, 3.554606E-04_EB, 3.667998E-04_EB, &
    4.233603E-04_EB, &
    4.793724E-04_EB, 3.513820E-04_EB, 3.816107E-04_EB, 3.407330E-04_EB, 3.388878E-04_EB, 3.454325E-04_EB, &
    3.758847E-04_EB, &
    3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, &
    3.176583E-04_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C3H6(N_TEMP_C3H6,26)) 

! BAND #3: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.62248 % 

SD3_C3H6(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    9.823606E-04_EB, 1.047116E-03_EB, 6.339279E-04_EB, 4.646369E-04_EB, 4.581637E-04_EB, 4.453153E-04_EB, &
    4.765197E-04_EB, &
    1.790446E-03_EB, 1.213798E-03_EB, 9.801787E-04_EB, 1.652768E-03_EB, 7.551362E-04_EB, 1.780132E-03_EB, &
    1.322880E-02_EB, &
    1.156738E-02_EB, 8.840293E-03_EB, 1.053937E-02_EB, 1.273243E-02_EB, 7.821961E-03_EB, 9.966967E-03_EB, &
    3.101635E-02_EB, &
    6.054263E-02_EB, 3.799331E-02_EB, 3.448608E-02_EB, 3.283665E-02_EB, 2.275614E-02_EB, 2.583522E-02_EB, &
    4.587110E-02_EB, &
    7.538062E-02_EB, 5.476296E-02_EB, 5.194914E-02_EB, 4.998438E-02_EB, 3.798801E-02_EB, 4.377561E-02_EB, &
    5.601207E-02_EB, &
    5.623486E-02_EB, 4.578094E-02_EB, 4.797817E-02_EB, 5.487067E-02_EB, 4.385279E-02_EB, 5.851594E-02_EB, &
    8.825224E-02_EB, &
    9.541978E-02_EB, 7.588989E-02_EB, 7.953675E-02_EB, 8.105257E-02_EB, 7.178028E-02_EB, 8.733592E-02_EB, &
    1.365780E-01_EB, &
    1.162809E-01_EB, 1.122422E-01_EB, 1.259132E-01_EB, 1.365741E-01_EB, 1.321748E-01_EB, 1.536630E-01_EB, &
    1.752584E-01_EB/),(/7,8/))

SD3_C3H6(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    4.894494E-01_EB, 3.702887E-01_EB, 3.576070E-01_EB, 3.385695E-01_EB, 2.897336E-01_EB, 2.677832E-01_EB, &
    2.630918E-01_EB, &
    9.478468E-01_EB, 6.986744E-01_EB, 6.414268E-01_EB, 5.902386E-01_EB, 5.030005E-01_EB, 4.339924E-01_EB, &
    4.212834E-01_EB, &
    1.382625E+00_EB, 1.079199E+00_EB, 1.001262E+00_EB, 9.263539E-01_EB, 8.030256E-01_EB, 6.604462E-01_EB, &
    5.854730E-01_EB, &
    2.155177E+00_EB, 1.551999E+00_EB, 1.371319E+00_EB, 1.229860E+00_EB, 1.009895E+00_EB, 7.859340E-01_EB, &
    6.619388E-01_EB, &
    2.941990E+00_EB, 2.072725E+00_EB, 1.809995E+00_EB, 1.592028E+00_EB, 1.281956E+00_EB, 9.610622E-01_EB, &
    7.587408E-01_EB, &
    2.742255E+00_EB, 1.804637E+00_EB, 1.539244E+00_EB, 1.329847E+00_EB, 1.042322E+00_EB, 7.995784E-01_EB, &
    6.304867E-01_EB, &
    2.475823E+00_EB, 1.754264E+00_EB, 1.520076E+00_EB, 1.322722E+00_EB, 1.046514E+00_EB, 7.909785E-01_EB, &
    6.265450E-01_EB, &
    1.471532E+00_EB, 1.165830E+00_EB, 1.090020E+00_EB, 9.854131E-01_EB, 8.471639E-01_EB, 7.172103E-01_EB, &
    6.190659E-01_EB/),(/7,8/))

SD3_C3H6(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    1.153386E+00_EB, 9.939091E-01_EB, 9.675353E-01_EB, 8.984828E-01_EB, 8.064276E-01_EB, 6.943803E-01_EB, &
    5.752264E-01_EB, &
    1.610514E+00_EB, 1.157571E+00_EB, 1.051685E+00_EB, 9.330023E-01_EB, 7.764487E-01_EB, 6.191821E-01_EB, &
    4.975246E-01_EB, &
    1.662881E+00_EB, 1.149993E+00_EB, 1.023865E+00_EB, 8.861354E-01_EB, 7.177391E-01_EB, 5.601541E-01_EB, &
    4.199159E-01_EB, &
    6.606572E-01_EB, 5.485138E-01_EB, 5.377449E-01_EB, 4.716206E-01_EB, 4.046733E-01_EB, 3.483560E-01_EB, &
    2.613788E-01_EB, &
    1.931578E-01_EB, 1.766015E-01_EB, 1.986674E-01_EB, 1.686244E-01_EB, 1.577751E-01_EB, 1.652678E-01_EB, &
    1.243299E-01_EB, &
    3.630390E-02_EB, 4.104319E-02_EB, 8.625607E-02_EB, 6.317587E-02_EB, 6.364564E-02_EB, 6.930467E-02_EB, &
    5.986582E-02_EB, &
    4.421454E-03_EB, 5.927923E-03_EB, 2.615871E-02_EB, 2.573185E-02_EB, 2.372599E-02_EB, 2.807027E-02_EB, &
    1.903581E-02_EB, &
    7.799207E-04_EB, 5.613548E-04_EB, 1.855855E-02_EB, 9.545204E-03_EB, 1.026900E-02_EB, 1.105055E-02_EB, &
    4.422276E-03_EB/),(/7,8/))

SD3_C3H6(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    6.392406E-04_EB, 5.165657E-04_EB, 3.996901E-03_EB, 2.997854E-03_EB, 3.117944E-03_EB, 2.589997E-03_EB, &
    4.319721E-04_EB, &
    4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, 4.069875E-04_EB, &
    4.069875E-04_EB/),(/7,2/))


!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C3H6(N_TEMP_C3H6,26)) 

! BAND #3: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.62248 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C3H6(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    5.403541E-04_EB, 8.792945E-04_EB, 5.056375E-04_EB, 3.496117E-04_EB, 3.518674E-04_EB, 3.438277E-04_EB, &
    3.495719E-04_EB, &
    7.122538E-04_EB, 9.654091E-04_EB, 7.123981E-04_EB, 7.997035E-04_EB, 6.221027E-04_EB, 6.478821E-04_EB, &
    1.886022E-03_EB, &
    6.055248E-03_EB, 2.810157E-02_EB, 7.205805E-03_EB, 5.135720E-03_EB, 1.148251E-02_EB, 3.479804E-03_EB, &
    4.642567E-03_EB, &
    1.802129E-02_EB, 3.111348E-02_EB, 1.652664E-02_EB, 1.262308E-02_EB, 4.156066E-02_EB, 7.064161E-03_EB, &
    7.064147E-03_EB, &
    3.950703E-02_EB, 4.511920E-02_EB, 2.940389E-02_EB, 2.136928E-02_EB, 2.924862E-02_EB, 6.853830E-03_EB, &
    2.155653E-02_EB, &
    2.696670E-02_EB, 4.150944E-02_EB, 2.661925E-02_EB, 1.199161E-02_EB, 3.045917E-02_EB, 1.275222E-02_EB, &
    1.882532E-02_EB, &
    3.843866E-02_EB, 5.924414E-02_EB, 2.750526E-02_EB, 2.824108E-02_EB, 5.479622E-02_EB, 3.487536E-02_EB, &
    3.014406E-02_EB, &
    4.267090E-02_EB, 8.903448E-02_EB, 4.314219E-02_EB, 4.798991E-02_EB, 1.150675E-01_EB, 6.448018E-02_EB, &
    1.985851E-01_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    1.360974E-01_EB, 1.878816E-01_EB, 1.009398E-01_EB, 1.211061E-01_EB, 1.943889E-01_EB, 1.344776E-01_EB, &
    4.550171E-01_EB, &
    2.997042E-01_EB, 3.261537E-01_EB, 2.127525E-01_EB, 2.482599E-01_EB, 2.968594E-01_EB, 2.203126E-01_EB, &
    3.135037E-01_EB, &
    4.858595E-01_EB, 5.065914E-01_EB, 3.519248E-01_EB, 3.956430E-01_EB, 4.087118E-01_EB, 3.323798E-01_EB, &
    4.364924E-01_EB, &
    8.295040E-01_EB, 7.608021E-01_EB, 5.445346E-01_EB, 5.604645E-01_EB, 5.183071E-01_EB, 3.854799E-01_EB, &
    5.783205E-01_EB, &
    1.189035E+00_EB, 8.983699E-01_EB, 6.879399E-01_EB, 7.011190E-01_EB, 6.183493E-01_EB, 4.573149E-01_EB, &
    7.247696E-01_EB, &
    1.613731E+00_EB, 9.279943E-01_EB, 6.877675E-01_EB, 6.379556E-01_EB, 5.548252E-01_EB, 3.574696E-01_EB, &
    1.069424E+00_EB, &
    1.470423E+00_EB, 8.306409E-01_EB, 6.721568E-01_EB, 6.132407E-01_EB, 5.471048E-01_EB, 3.567919E-01_EB, &
    9.190327E-01_EB, &
    7.550487E-01_EB, 5.649773E-01_EB, 4.721665E-01_EB, 4.657506E-01_EB, 4.544038E-01_EB, 3.393934E-01_EB, &
    5.769258E-01_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    4.764985E-01_EB, 5.071092E-01_EB, 4.093288E-01_EB, 4.183789E-01_EB, 4.129356E-01_EB, 3.190134E-01_EB, &
    7.652687E-01_EB, &
    6.768093E-01_EB, 5.678219E-01_EB, 4.160289E-01_EB, 4.110529E-01_EB, 3.804961E-01_EB, 2.887677E-01_EB, &
    6.907067E-01_EB, &
    8.606003E-01_EB, 5.212424E-01_EB, 4.059243E-01_EB, 3.776303E-01_EB, 3.264591E-01_EB, 2.357814E-01_EB, &
    2.013184E+00_EB, &
    3.754852E-01_EB, 2.153618E-01_EB, 1.929420E-01_EB, 1.825438E-01_EB, 1.584548E-01_EB, 1.192581E-01_EB, &
    2.685672E+00_EB, &
    8.653925E-02_EB, 7.279170E-02_EB, 7.311958E-02_EB, 7.967030E-02_EB, 6.259732E-02_EB, 3.450672E-02_EB, &
    1.451927E+00_EB, &
    1.900654E-02_EB, 2.480232E-02_EB, 8.520497E-03_EB, 1.508821E-02_EB, 2.984931E-02_EB, 1.767486E-02_EB, &
    2.517844E-01_EB, &
    1.459582E-03_EB, 2.273309E-03_EB, 5.243089E-03_EB, 2.245596E-03_EB, 1.447928E-02_EB, 7.429006E-03_EB, &
    2.491091E-01_EB, &
    5.565694E-04_EB, 4.018610E-04_EB, 1.839321E-03_EB, 2.389757E-03_EB, 6.139953E-03_EB, 2.803719E-03_EB, &
    6.166058E-02_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    4.839528E-04_EB, 3.870932E-04_EB, 1.787058E-03_EB, 1.565363E-03_EB, 2.160706E-03_EB, 1.586268E-03_EB, &
    3.409650E-04_EB, &
    3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, 3.176583E-04_EB, &
    3.176583E-04_EB/),(/7,2/))

!-------------------------Toluene DATA-------------------


! THERE ARE 5 BANDS FOR Toluene

! BAND #1: 700 cm-1 - 805 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 

N_TEMP_C7H8 = 6
N_BAND_C7H8 = 5
I_MODEL_C7H8 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C7H8_TEMP(N_TEMP_C7H8)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Toluene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C7H8(N_BAND_C7H8,3)) 
ALLOCATE(Be_C7H8(N_BAND_C7H8)) 

OM_BND_C7H8 = RESHAPE((/ &
    700._EB,  975._EB, 1275._EB, 1650._EB, 2675._EB, &
    805._EB, 1175._EB, 1675._EB, 2075._EB, 3225._EB, &
     5._EB, 5._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C7H8,3/)) 

SD_C7H8_TEMP = (/ &
    300._EB, 396._EB, 440._EB, 477._EB, 587._EB, 795._EB/)

Be_C7H8 = (/ &
    1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB, 1.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C7H8(N_TEMP_C7H8,22)) 

! BAND #1: 700 cm-1 - 805 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 5.0157 % 

SD1_C7H8(1:6,1:8) = RESHAPE((/ &  ! 700-735 cm-1
    1.115277E+00_EB, 9.064487E-01_EB, 9.114340E-01_EB, 8.960143E-01_EB, 9.108314E-01_EB, 1.321915E+00_EB, &
    2.860325E+00_EB, 2.498343E+00_EB, 2.373842E+00_EB, 2.291232E+00_EB, 2.135973E+00_EB, 1.926214E+00_EB, &
    3.484324E+00_EB, 3.192570E+00_EB, 2.864259E+00_EB, 2.640477E+00_EB, 2.486178E+00_EB, 1.926262E+00_EB, &
    4.333473E+00_EB, 3.595912E+00_EB, 2.985116E+00_EB, 2.812329E+00_EB, 2.419191E+00_EB, 1.906946E+00_EB, &
    4.720288E+00_EB, 3.755670E+00_EB, 3.279737E+00_EB, 3.085614E+00_EB, 2.900784E+00_EB, 2.474091E+00_EB, &
    7.499689E+00_EB, 6.222745E+00_EB, 5.475099E+00_EB, 5.339125E+00_EB, 4.708196E+00_EB, 3.464929E+00_EB, &
    9.819465E+00_EB, 6.863940E+00_EB, 5.678034E+00_EB, 5.357774E+00_EB, 4.115956E+00_EB, 2.531953E+00_EB, &
    4.770778E+00_EB, 3.134058E+00_EB, 2.771841E+00_EB, 2.670464E+00_EB, 2.265161E+00_EB, 1.919217E+00_EB/),(/6,8/))

SD1_C7H8(1:6,9:16) = RESHAPE((/ &  ! 740-775 cm-1
    4.233918E+00_EB, 2.785962E+00_EB, 2.553246E+00_EB, 2.403379E+00_EB, 2.097930E+00_EB, 1.350915E+00_EB, &
    2.858402E+00_EB, 2.230312E+00_EB, 2.091368E+00_EB, 1.998043E+00_EB, 1.819950E+00_EB, 1.535500E+00_EB, &
    1.331963E+00_EB, 1.446134E+00_EB, 1.395384E+00_EB, 1.427066E+00_EB, 1.333588E+00_EB, 1.290415E+00_EB, &
    4.539777E-01_EB, 7.996155E-01_EB, 7.614217E-01_EB, 7.995680E-01_EB, 8.205333E-01_EB, 8.414433E-01_EB, &
    1.132036E-01_EB, 6.874098E-01_EB, 3.263682E-01_EB, 3.549264E-01_EB, 4.385666E-01_EB, 5.629917E-01_EB, &
    3.785165E-02_EB, 5.834066E-01_EB, 1.748823E-01_EB, 1.495116E-01_EB, 2.106436E-01_EB, 3.300545E-01_EB, &
    4.206835E-02_EB, 7.400053E-02_EB, 1.106324E-01_EB, 7.435615E-02_EB, 9.035603E-02_EB, 1.524856E-01_EB, &
    6.724334E-02_EB, 1.272956E-03_EB, 6.436374E-02_EB, 5.382572E-02_EB, 5.652076E-02_EB, 5.045055E-02_EB/),(/6,8/))

SD1_C7H8(1:6,17:22) = RESHAPE((/ &  ! 780-805 cm-1
    6.279361E-02_EB, 1.139930E-03_EB, 4.318806E-02_EB, 2.932693E-02_EB, 3.125667E-02_EB, 1.252956E-02_EB, &
    5.183976E-02_EB, 1.175051E-03_EB, 1.916625E-02_EB, 1.671218E-02_EB, 2.263446E-02_EB, 1.679786E-03_EB, &
    3.526041E-02_EB, 1.278873E-03_EB, 2.846670E-03_EB, 1.470988E-02_EB, 1.167797E-02_EB, 9.830046E-04_EB, &
    6.337277E-03_EB, 1.171620E-03_EB, 2.166429E-03_EB, 6.319178E-03_EB, 3.931505E-03_EB, 1.050672E-03_EB, &
    1.082950E-03_EB, 1.108759E-03_EB, 1.944758E-03_EB, 9.715975E-04_EB, 1.893371E-03_EB, 1.031392E-03_EB, &
    9.233037E-04_EB, 9.269044E-04_EB, 1.865152E-03_EB, 9.264789E-04_EB, 1.857160E-03_EB, 9.259403E-04_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C7H8(N_TEMP_C7H8,22)) 

! BAND #1: 700 cm-1 - 805 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 5.0157 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C7H8(1:6,1:8) = RESHAPE((/ &  ! 700-735 cm-1
    4.997333E+00_EB, 4.295584E+00_EB, 1.481681E+00_EB, 3.965139E+00_EB, 3.550717E+00_EB, 2.717676E-02_EB, &
    5.000000E+00_EB, 4.351750E+00_EB, 4.128579E+00_EB, 3.965258E+00_EB, 3.573542E+00_EB, 1.888351E-01_EB, &
    5.000000E+00_EB, 4.322994E+00_EB, 2.131994E+00_EB, 3.965222E+00_EB, 3.574469E+00_EB, 6.492432E-02_EB, &
    5.000000E+00_EB, 4.285913E+00_EB, 4.126659E+00_EB, 3.965226E+00_EB, 3.574464E+00_EB, 3.636259E-01_EB, &
    5.000000E+00_EB, 2.700818E+00_EB, 4.128609E+00_EB, 3.965254E+00_EB, 3.574446E+00_EB, 3.071311E+00_EB, &
    5.000000E+00_EB, 4.351940E+00_EB, 4.128611E+00_EB, 3.888235E+00_EB, 3.574469E+00_EB, 1.157600E+00_EB, &
    5.000000E+00_EB, 4.351940E+00_EB, 4.128612E+00_EB, 1.618868E+00_EB, 3.574464E+00_EB, 3.071371E+00_EB, &
    4.999999E+00_EB, 4.351825E+00_EB, 4.128540E+00_EB, 3.965020E+00_EB, 3.574448E+00_EB, 1.035856E-01_EB/),(/6,8/))

GAMMAD1_C7H8(1:6,9:16) = RESHAPE((/ &  ! 740-775 cm-1
    5.000000E+00_EB, 4.351918E+00_EB, 4.128010E+00_EB, 3.942192E+00_EB, 3.572446E+00_EB, 3.064808E+00_EB, &
    4.999998E+00_EB, 4.351939E+00_EB, 4.126848E+00_EB, 3.965239E+00_EB, 3.562160E+00_EB, 1.151729E-01_EB, &
    4.997066E+00_EB, 4.348323E+00_EB, 3.816962E+00_EB, 3.897876E+00_EB, 3.557603E+00_EB, 1.782920E-01_EB, &
    3.327768E+00_EB, 1.907450E-01_EB, 1.941949E+00_EB, 2.087414E+00_EB, 3.571989E+00_EB, 7.642862E-01_EB, &
    6.209655E-01_EB, 7.573622E-03_EB, 1.117290E-01_EB, 5.471591E-01_EB, 8.849112E-01_EB, 1.020274E+00_EB, &
    3.118993E-01_EB, 2.047036E-03_EB, 7.823538E-02_EB, 5.426851E-01_EB, 8.958391E-01_EB, 3.073679E-01_EB, &
    1.427902E+00_EB, 4.479483E-02_EB, 5.025683E-02_EB, 2.526941E-01_EB, 7.184991E-02_EB, 1.464098E-01_EB, &
    2.593216E-01_EB, 9.945700E-04_EB, 3.155324E-02_EB, 1.128797E-01_EB, 2.661918E-02_EB, 2.711249E-02_EB/),(/6,8/))

GAMMAD1_C7H8(1:6,17:22) = RESHAPE((/ &  ! 780-805 cm-1
    2.781363E-01_EB, 8.721781E-04_EB, 9.487288E-03_EB, 5.055562E-02_EB, 1.923327E-02_EB, 1.894720E-03_EB, &
    3.164064E-01_EB, 9.026308E-04_EB, 1.494655E-02_EB, 1.129990E-02_EB, 1.932504E-02_EB, 1.636419E-03_EB, &
    2.429947E-01_EB, 1.003226E-03_EB, 2.343296E-03_EB, 1.417139E-02_EB, 3.331706E-02_EB, 7.998148E-04_EB, &
    6.549588E-03_EB, 9.247472E-04_EB, 1.695476E-03_EB, 5.500035E-03_EB, 3.368747E-03_EB, 7.980915E-04_EB, &
    8.719439E-04_EB, 8.729150E-04_EB, 1.545207E-03_EB, 7.670839E-04_EB, 1.504329E-03_EB, 7.824870E-04_EB, &
    7.355779E-04_EB, 7.393154E-04_EB, 1.488682E-03_EB, 7.390167E-04_EB, 1.482552E-03_EB, 7.384415E-04_EB/),(/6,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C7H8(N_TEMP_C7H8,29)) 

! BAND #2: 975 cm-1 - 1175 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.56956 % 

SD2_C7H8(1:6,1:8) = RESHAPE((/ &  ! 975-1010 cm-1
    1.034632E-03_EB, 1.049900E-03_EB, 2.050487E-03_EB, 1.148148E-03_EB, 2.040707E-03_EB, 9.765901E-04_EB, &
    1.122679E-03_EB, 1.235435E-03_EB, 2.188126E-03_EB, 1.173493E-03_EB, 2.109625E-03_EB, 1.075063E-03_EB, &
    1.194097E-03_EB, 4.906372E-02_EB, 2.177762E-03_EB, 1.147826E-03_EB, 2.090287E-03_EB, 2.969093E-03_EB, &
    4.488651E-02_EB, 8.690214E-02_EB, 1.968275E-03_EB, 1.253949E-03_EB, 2.330817E-03_EB, 2.857406E-02_EB, &
    4.184895E-02_EB, 5.813898E-02_EB, 6.141136E-03_EB, 5.172732E-03_EB, 1.370475E-02_EB, 1.699294E-02_EB, &
    2.338695E-02_EB, 1.674305E-02_EB, 2.363978E-02_EB, 2.751699E-02_EB, 1.128329E-02_EB, 2.345377E-02_EB, &
    1.377996E-02_EB, 1.331161E-03_EB, 3.678107E-02_EB, 2.278175E-02_EB, 2.434238E-02_EB, 4.251685E-02_EB, &
    2.627855E-02_EB, 3.336344E-03_EB, 7.435328E-02_EB, 7.299144E-02_EB, 8.073743E-02_EB, 8.520512E-02_EB/),(/6,8/))

SD2_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1015-1050 cm-1
    8.636487E-02_EB, 8.394031E-02_EB, 1.637850E-01_EB, 1.750384E-01_EB, 1.718331E-01_EB, 1.480802E-01_EB, &
    3.009511E-01_EB, 2.806748E-01_EB, 2.898305E-01_EB, 2.823082E-01_EB, 2.472842E-01_EB, 1.464400E-01_EB, &
    5.284352E-01_EB, 3.730246E-01_EB, 2.986370E-01_EB, 2.725747E-01_EB, 2.442423E-01_EB, 1.381949E-01_EB, &
    5.853563E-01_EB, 4.757127E-01_EB, 3.603343E-01_EB, 3.461394E-01_EB, 2.790166E-01_EB, 1.227668E-01_EB, &
    4.736166E-01_EB, 3.773869E-01_EB, 2.671360E-01_EB, 2.575362E-01_EB, 2.269498E-01_EB, 1.538097E-01_EB, &
    5.537088E-01_EB, 4.507385E-01_EB, 3.326090E-01_EB, 3.311390E-01_EB, 3.036026E-01_EB, 2.043985E-01_EB, &
    4.136599E-01_EB, 3.258368E-01_EB, 2.722028E-01_EB, 2.684519E-01_EB, 2.490297E-01_EB, 1.862948E-01_EB, &
    2.617106E-01_EB, 1.802808E-01_EB, 1.980298E-01_EB, 1.895395E-01_EB, 2.193744E-01_EB, 1.350301E-01_EB/),(/6,8/))

SD2_C7H8(1:6,17:24) = RESHAPE((/ &  ! 1055-1090 cm-1
    2.738466E-01_EB, 1.767469E-01_EB, 2.225122E-01_EB, 2.166852E-01_EB, 2.231000E-01_EB, 1.470641E-01_EB, &
    2.820001E-01_EB, 2.052839E-01_EB, 2.527294E-01_EB, 2.344097E-01_EB, 2.284998E-01_EB, 2.547503E-01_EB, &
    3.266204E-01_EB, 2.891812E-01_EB, 2.919988E-01_EB, 2.815199E-01_EB, 2.790406E-01_EB, 2.776012E-01_EB, &
    4.244508E-01_EB, 3.880752E-01_EB, 3.452768E-01_EB, 3.166048E-01_EB, 2.886578E-01_EB, 2.030225E-01_EB, &
    5.537399E-01_EB, 4.365326E-01_EB, 3.327742E-01_EB, 3.063188E-01_EB, 2.623075E-01_EB, 1.520590E-01_EB, &
    4.373412E-01_EB, 3.571425E-01_EB, 2.738070E-01_EB, 2.412283E-01_EB, 2.238149E-01_EB, 2.011193E-01_EB, &
    4.689702E-01_EB, 3.738704E-01_EB, 2.871318E-01_EB, 2.540734E-01_EB, 2.501572E-01_EB, 2.069856E-01_EB, &
    4.704753E-01_EB, 3.537423E-01_EB, 2.833734E-01_EB, 2.632639E-01_EB, 2.218036E-01_EB, 1.632007E-01_EB/),(/6,8/))

SD2_C7H8(1:6,25:29) = RESHAPE((/ &  ! 1095-1175 cm-1
    3.653179E-01_EB, 2.739321E-01_EB, 2.411873E-01_EB, 2.292279E-01_EB, 1.883729E-01_EB, 1.226381E-01_EB, &
    2.689138E-01_EB, 1.704843E-01_EB, 1.676705E-01_EB, 1.514745E-01_EB, 1.165836E-01_EB, 7.284228E-02_EB, &
    4.980468E-02_EB, 6.295430E-02_EB, 4.645419E-02_EB, 3.373359E-02_EB, 2.675533E-02_EB, 9.862022E-03_EB, &
    1.064992E-03_EB, 2.785955E-03_EB, 5.534785E-03_EB, 1.075858E-03_EB, 2.013082E-03_EB, 1.086934E-03_EB, &
    9.233037E-04_EB, 9.269044E-04_EB, 1.865152E-03_EB, 9.264789E-04_EB, 1.857160E-03_EB, 9.259403E-04_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C7H8(N_TEMP_C7H8,29)) 

! BAND #2: 975 cm-1 - 1175 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.56956 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C7H8(1:6,1:8) = RESHAPE((/ &  ! 975-1010 cm-1
    7.953644E-04_EB, 8.304906E-04_EB, 1.630953E-03_EB, 8.979058E-04_EB, 1.605583E-03_EB, 7.744304E-04_EB, &
    8.778370E-04_EB, 9.878483E-04_EB, 1.729643E-03_EB, 9.293189E-04_EB, 1.666472E-03_EB, 8.368870E-04_EB, &
    9.366512E-04_EB, 1.801635E-02_EB, 1.699594E-03_EB, 8.925264E-04_EB, 1.693787E-03_EB, 2.932669E-03_EB, &
    3.342545E+00_EB, 3.952421E-02_EB, 1.570035E-03_EB, 9.348913E-04_EB, 1.830973E-03_EB, 1.073752E-02_EB, &
    1.059385E+00_EB, 7.503390E-02_EB, 7.577251E-03_EB, 5.019341E-03_EB, 1.045618E-01_EB, 1.297997E-02_EB, &
    1.801174E-01_EB, 5.001496E-01_EB, 4.482872E-02_EB, 1.056397E-02_EB, 1.204186E-01_EB, 2.418524E-01_EB, &
    2.768309E-01_EB, 1.232991E-03_EB, 1.097419E-01_EB, 3.497525E-02_EB, 1.384708E-01_EB, 1.305341E-01_EB, &
    3.099755E-01_EB, 3.562212E-03_EB, 1.866215E-01_EB, 2.021930E-01_EB, 7.746078E-02_EB, 1.886219E+00_EB/),(/6,8/))

GAMMAD2_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1015-1050 cm-1
    3.198617E+00_EB, 9.169389E-01_EB, 3.588399E-01_EB, 2.889031E-01_EB, 4.592746E-01_EB, 1.299407E+00_EB, &
    1.845628E+00_EB, 5.353485E-01_EB, 3.267932E-01_EB, 1.477488E+00_EB, 3.141091E-01_EB, 1.309145E+00_EB, &
    4.992004E+00_EB, 3.809011E-01_EB, 5.567131E-01_EB, 6.321892E-01_EB, 9.570165E-01_EB, 6.830364E-01_EB, &
    4.457917E+00_EB, 3.144746E-01_EB, 6.465005E-01_EB, 3.548138E-01_EB, 1.756047E+00_EB, 6.957288E-01_EB, &
    3.475027E+00_EB, 3.488655E-01_EB, 6.648675E-01_EB, 5.615573E-01_EB, 8.145950E-01_EB, 6.648922E-01_EB, &
    4.999937E+00_EB, 1.075274E+00_EB, 6.408375E-01_EB, 4.900735E-01_EB, 5.012133E-01_EB, 2.440501E+00_EB, &
    2.468116E+00_EB, 1.401950E+00_EB, 6.357307E-01_EB, 2.478059E-01_EB, 1.232354E+00_EB, 2.669585E+00_EB, &
    1.967402E+00_EB, 3.776356E+00_EB, 4.042848E-01_EB, 4.229093E-01_EB, 8.362265E-01_EB, 6.739183E-01_EB/),(/6,8/))

GAMMAD2_C7H8(1:6,17:24) = RESHAPE((/ &  ! 1055-1090 cm-1
    9.850818E-01_EB, 3.804397E+00_EB, 4.978725E-01_EB, 3.502723E-01_EB, 4.801633E-01_EB, 1.302693E+00_EB, &
    1.860999E+00_EB, 3.037654E+00_EB, 6.502408E-01_EB, 1.727920E+00_EB, 7.886479E-01_EB, 1.510159E+00_EB, &
    1.820274E+00_EB, 1.648433E+00_EB, 5.889326E-01_EB, 5.459876E-01_EB, 2.684612E-01_EB, 5.249360E-01_EB, &
    4.023538E+00_EB, 5.084315E-01_EB, 5.599393E-01_EB, 5.315030E-01_EB, 5.347815E-01_EB, 9.533184E-01_EB, &
    4.993522E+00_EB, 6.954744E-01_EB, 6.322409E-01_EB, 5.166785E-01_EB, 1.739963E+00_EB, 1.277813E+00_EB, &
    2.486163E+00_EB, 3.850261E-01_EB, 6.740432E-01_EB, 3.542026E-01_EB, 3.730206E-01_EB, 1.102249E+00_EB, &
    3.527235E+00_EB, 6.055559E-01_EB, 6.600369E-01_EB, 1.599454E+00_EB, 3.547345E-01_EB, 4.566775E-01_EB, &
    3.491336E+00_EB, 7.173797E-01_EB, 6.896040E-01_EB, 3.778014E-01_EB, 8.247503E-01_EB, 2.724760E-01_EB/),(/6,8/))

GAMMAD2_C7H8(1:6,25:29) = RESHAPE((/ &  ! 1095-1175 cm-1
    3.782606E+00_EB, 1.885894E+00_EB, 1.007227E+00_EB, 2.176024E-01_EB, 4.934887E-01_EB, 8.605999E-02_EB, &
    9.863064E-01_EB, 8.375179E-01_EB, 5.285793E-01_EB, 3.659406E-01_EB, 2.654634E-01_EB, 9.393051E-01_EB, &
    2.937353E-01_EB, 2.607173E-01_EB, 5.761068E-01_EB, 1.524875E-01_EB, 3.895640E-01_EB, 3.308805E-02_EB, &
    8.498874E-04_EB, 2.626634E-03_EB, 7.813529E-03_EB, 8.390301E-04_EB, 1.609410E-03_EB, 8.634216E-04_EB, &
    7.355779E-04_EB, 7.393154E-04_EB, 1.488682E-03_EB, 7.390167E-04_EB, 1.482552E-03_EB, 7.384415E-04_EB/),(/6,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C7H8(N_TEMP_C7H8,17)) 

! BAND #3: 1275 cm-1 - 1675 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.4397 % 

SD3_C7H8(1:6,1:8) = RESHAPE((/ &  ! 1275-1450 cm-1
    1.062005E-03_EB, 7.598167E-03_EB, 2.404327E-03_EB, 1.292698E-03_EB, 6.220543E-03_EB, 4.506206E-03_EB, &
    1.176419E-03_EB, 3.467740E-02_EB, 2.846407E-02_EB, 1.505359E-02_EB, 2.800752E-02_EB, 1.191268E-02_EB, &
    3.826015E-03_EB, 3.630517E-02_EB, 4.212714E-02_EB, 2.421863E-02_EB, 4.333555E-02_EB, 3.186140E-02_EB, &
    5.571416E-02_EB, 6.837515E-02_EB, 8.182510E-02_EB, 6.363461E-02_EB, 6.993668E-02_EB, 5.899239E-02_EB, &
    2.342374E-01_EB, 2.090661E-01_EB, 1.890934E-01_EB, 1.668369E-01_EB, 1.532424E-01_EB, 1.144887E-01_EB, &
    2.298859E-01_EB, 1.959762E-01_EB, 1.873649E-01_EB, 1.557448E-01_EB, 1.474642E-01_EB, 9.999243E-02_EB, &
    2.468532E-01_EB, 2.254116E-01_EB, 2.151254E-01_EB, 1.850743E-01_EB, 1.918668E-01_EB, 1.699306E-01_EB, &
    6.346606E-01_EB, 4.869849E-01_EB, 4.485960E-01_EB, 3.958280E-01_EB, 3.396720E-01_EB, 2.533752E-01_EB/),(/6,8/))

SD3_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1475-1650 cm-1
    8.106021E-01_EB, 6.861535E-01_EB, 6.363570E-01_EB, 6.077620E-01_EB, 5.853518E-01_EB, 4.901586E-01_EB, &
    1.994754E+00_EB, 1.439347E+00_EB, 1.200622E+00_EB, 1.093848E+00_EB, 8.769635E-01_EB, 5.742516E-01_EB, &
    5.176617E-01_EB, 4.492315E-01_EB, 4.342196E-01_EB, 3.556532E-01_EB, 3.148816E-01_EB, 2.349145E-01_EB, &
    2.374710E-01_EB, 2.201665E-01_EB, 2.374197E-01_EB, 1.856509E-01_EB, 1.760616E-01_EB, 1.697913E-01_EB, &
    2.320405E-01_EB, 2.237291E-01_EB, 2.129523E-01_EB, 2.116101E-01_EB, 2.288491E-01_EB, 2.536384E-01_EB, &
    8.302692E-01_EB, 1.373962E+00_EB, 9.593470E-01_EB, 7.035542E-01_EB, 4.624247E-01_EB, 3.254581E-01_EB, &
    5.574947E-01_EB, 4.345387E-01_EB, 3.226913E-01_EB, 3.021458E-01_EB, 1.705109E-01_EB, 8.936322E-02_EB, &
    2.548442E-02_EB, 4.882681E-03_EB, 1.656181E-02_EB, 8.783028E-03_EB, 1.976697E-03_EB, 1.115219E-03_EB/),(/6,8/))

SD3_C7H8(1:6,17:17) = RESHAPE((/ &  ! 1675-1675 cm-1
    9.233037E-04_EB, 9.269044E-04_EB, 1.865152E-03_EB, 9.264789E-04_EB, 1.857160E-03_EB, 9.259403E-04_EB/),(/6,1/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C7H8(N_TEMP_C7H8,17)) 

! BAND #3: 1275 cm-1 - 1675 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.4397 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C7H8(1:6,1:8) = RESHAPE((/ &  ! 1275-1450 cm-1
    8.403990E-04_EB, 4.882315E-03_EB, 1.962226E-03_EB, 1.039514E-03_EB, 5.217651E-03_EB, 3.194750E-03_EB, &
    9.217771E-04_EB, 1.600478E-02_EB, 1.117939E-02_EB, 1.074178E-01_EB, 5.540868E-02_EB, 2.503607E-03_EB, &
    3.046278E-03_EB, 5.273450E-02_EB, 6.589606E-03_EB, 7.216902E-01_EB, 1.072235E-01_EB, 1.355432E-01_EB, &
    5.469603E-02_EB, 3.266205E-01_EB, 1.373959E-02_EB, 2.215699E-01_EB, 2.024983E-01_EB, 1.079261E-01_EB, &
    7.230174E-01_EB, 3.084006E-01_EB, 1.189080E-01_EB, 4.000928E-01_EB, 4.250364E-01_EB, 2.141772E-01_EB, &
    1.865284E+00_EB, 4.677921E-01_EB, 1.169895E-01_EB, 5.042163E-01_EB, 4.674422E-01_EB, 3.021245E-01_EB, &
    2.114475E+00_EB, 2.833302E+00_EB, 3.298511E-01_EB, 7.317477E-01_EB, 1.227053E+00_EB, 4.151732E-01_EB, &
    4.998342E+00_EB, 3.066710E+00_EB, 6.333725E-01_EB, 3.313537E+00_EB, 6.873515E-01_EB, 6.556912E-01_EB/),(/6,8/))

GAMMAD3_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1475-1650 cm-1
    4.991174E+00_EB, 2.606623E+00_EB, 4.699752E-01_EB, 1.261479E+00_EB, 1.562480E+00_EB, 1.627266E+00_EB, &
    4.999853E+00_EB, 4.348563E+00_EB, 4.093131E+00_EB, 3.963494E+00_EB, 3.559566E+00_EB, 2.114072E+00_EB, &
    4.999975E+00_EB, 3.255310E+00_EB, 2.314826E+00_EB, 3.794960E+00_EB, 1.538554E+00_EB, 1.761121E+00_EB, &
    2.319535E+00_EB, 9.901741E-01_EB, 1.980977E+00_EB, 2.452492E+00_EB, 3.280997E+00_EB, 6.465125E-01_EB, &
    1.685294E-01_EB, 2.206855E-02_EB, 2.531160E-02_EB, 7.778066E-02_EB, 2.482244E-01_EB, 1.155942E-01_EB, &
    1.042855E-01_EB, 8.622274E-03_EB, 9.285619E-03_EB, 2.471090E-02_EB, 1.219237E-01_EB, 2.754584E-02_EB, &
    4.233407E+00_EB, 2.790950E-02_EB, 3.000446E-02_EB, 2.255016E-02_EB, 1.740175E-01_EB, 5.331902E-02_EB, &
    1.613119E-02_EB, 2.421347E-03_EB, 8.060934E-03_EB, 3.812276E-03_EB, 1.575925E-03_EB, 8.714612E-04_EB/),(/6,8/))

GAMMAD3_C7H8(1:6,17:17) = RESHAPE((/ &  ! 1675-1675 cm-1
    7.355779E-04_EB, 7.393154E-04_EB, 1.488682E-03_EB, 7.390167E-04_EB, 1.482552E-03_EB, 7.384415E-04_EB/),(/6,1/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C7H8(N_TEMP_C7H8,18)) 

! BAND #4: 1650 cm-1 - 2075 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.34996 % 

SD4_C7H8(1:6,1:8) = RESHAPE((/ &  ! 1650-1825 cm-1
    1.607388E-02_EB, 1.276761E-03_EB, 3.671311E-03_EB, 1.259532E-03_EB, 1.983422E-03_EB, 9.570047E-04_EB, &
    4.846418E-02_EB, 8.736357E-03_EB, 1.809071E-02_EB, 1.446177E-02_EB, 2.105683E-03_EB, 1.026872E-03_EB, &
    3.744609E-02_EB, 1.615485E-02_EB, 2.566976E-02_EB, 1.641904E-02_EB, 1.017383E-02_EB, 3.051346E-03_EB, &
    1.002633E-01_EB, 4.951832E-02_EB, 5.608323E-02_EB, 4.803435E-02_EB, 3.126588E-02_EB, 1.258169E-02_EB, &
    6.347046E-02_EB, 4.029275E-02_EB, 4.073767E-02_EB, 4.270702E-02_EB, 3.297945E-02_EB, 3.027872E-02_EB, &
    4.298909E-01_EB, 3.153382E-01_EB, 8.879303E-02_EB, 1.007476E-01_EB, 9.288538E-02_EB, 9.428744E-02_EB, &
    4.806549E-01_EB, 8.471411E-01_EB, 1.568230E-01_EB, 1.567358E-01_EB, 1.195061E-01_EB, 9.579418E-02_EB, &
    6.025041E-01_EB, 2.770965E-01_EB, 7.542958E-02_EB, 8.089050E-02_EB, 8.057888E-02_EB, 8.730313E-02_EB/),(/6,8/))

SD4_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1850-2025 cm-1
    6.012163E-01_EB, 5.964223E-01_EB, 1.512738E-01_EB, 1.472022E-01_EB, 1.224581E-01_EB, 1.196653E-01_EB, &
    6.006986E-01_EB, 4.345743E-01_EB, 1.090142E-01_EB, 1.168026E-01_EB, 7.618608E-02_EB, 5.169675E-02_EB, &
    2.689299E-01_EB, 3.172213E-02_EB, 1.877107E-02_EB, 3.918623E-02_EB, 4.009945E-02_EB, 5.364820E-02_EB, &
    4.041662E-01_EB, 3.086099E-01_EB, 1.255077E-01_EB, 1.314917E-01_EB, 1.243512E-01_EB, 1.156554E-01_EB, &
    2.784135E-01_EB, 2.879121E-01_EB, 1.615320E-01_EB, 1.650307E-01_EB, 1.223631E-01_EB, 8.413521E-02_EB, &
    7.149065E-02_EB, 2.554608E-02_EB, 3.284575E-02_EB, 3.199253E-02_EB, 1.894216E-02_EB, 1.602093E-02_EB, &
    2.985724E-02_EB, 1.033994E-02_EB, 1.130765E-02_EB, 1.538741E-02_EB, 1.161064E-02_EB, 2.931882E-03_EB, &
    1.328166E-02_EB, 1.256753E-03_EB, 4.743058E-03_EB, 4.951792E-03_EB, 5.124635E-03_EB, 1.257266E-03_EB/),(/6,8/))

SD4_C7H8(1:6,17:18) = RESHAPE((/ &  ! 2050-2075 cm-1
    1.040423E-03_EB, 1.049141E-03_EB, 2.051953E-03_EB, 1.050237E-03_EB, 1.985675E-03_EB, 1.061126E-03_EB, &
    9.233037E-04_EB, 9.269044E-04_EB, 1.865152E-03_EB, 9.264789E-04_EB, 1.857160E-03_EB, 9.259403E-04_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C7H8(N_TEMP_C7H8,18)) 

! BAND #4: 1650 cm-1 - 2075 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 0.34996 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C7H8(1:6,1:8) = RESHAPE((/ &  ! 1650-1825 cm-1
    2.496706E-01_EB, 1.040935E-03_EB, 3.395651E-03_EB, 1.018554E-03_EB, 1.580735E-03_EB, 7.642523E-04_EB, &
    2.070191E-01_EB, 2.864416E-03_EB, 6.948674E-03_EB, 3.771246E-03_EB, 1.679742E-03_EB, 8.067892E-04_EB, &
    4.678302E-01_EB, 2.284430E-01_EB, 4.687372E-01_EB, 2.165363E-01_EB, 1.290439E-01_EB, 2.834816E-03_EB, &
    4.341037E-02_EB, 1.393304E-02_EB, 1.742751E-02_EB, 1.712027E-02_EB, 4.709744E-02_EB, 7.977971E-03_EB, &
    8.286606E-03_EB, 1.270621E-02_EB, 2.049040E-02_EB, 2.293953E-02_EB, 1.117927E-01_EB, 9.864035E-03_EB, &
    8.163724E-04_EB, 4.245300E-04_EB, 3.027280E-02_EB, 3.523384E-02_EB, 5.373142E-02_EB, 5.744076E-02_EB, &
    5.519416E-03_EB, 1.036416E-03_EB, 7.529227E-02_EB, 8.412704E-02_EB, 8.604982E-02_EB, 3.859562E-02_EB, &
    4.912771E-04_EB, 3.461673E-04_EB, 2.490526E-02_EB, 2.912078E-02_EB, 1.149004E-02_EB, 3.309678E-02_EB/),(/6,8/))

GAMMAD4_C7H8(1:6,9:16) = RESHAPE((/ &  ! 1850-2025 cm-1
    2.350959E-03_EB, 1.139295E-03_EB, 1.672691E-02_EB, 7.867110E-02_EB, 7.245583E-02_EB, 1.112776E-02_EB, &
    1.974130E-03_EB, 6.863236E-04_EB, 9.038861E-03_EB, 9.706118E-03_EB, 2.065325E-02_EB, 1.315245E-02_EB, &
    2.620171E-04_EB, 1.370626E-03_EB, 3.664955E-03_EB, 1.239577E-02_EB, 3.911631E-03_EB, 1.472174E-02_EB, &
    1.745495E-03_EB, 1.108797E-03_EB, 1.021527E-02_EB, 2.792718E-02_EB, 8.357283E-02_EB, 4.009886E-02_EB, &
    7.517409E-02_EB, 5.163990E-03_EB, 2.586329E-02_EB, 3.109004E-02_EB, 8.829114E-02_EB, 1.491041E-02_EB, &
    7.805253E-03_EB, 4.792063E-03_EB, 4.280297E-03_EB, 6.170754E-03_EB, 1.116148E-02_EB, 8.352453E-03_EB, &
    4.706225E-03_EB, 3.670066E-03_EB, 3.553553E-03_EB, 5.325529E-03_EB, 6.440955E-03_EB, 2.188709E-03_EB, &
    4.020419E-03_EB, 9.018852E-04_EB, 3.289713E-03_EB, 3.033640E-03_EB, 3.584390E-03_EB, 9.814831E-04_EB/),(/6,8/))

GAMMAD4_C7H8(1:6,17:18) = RESHAPE((/ &  ! 2050-2075 cm-1
    8.212450E-04_EB, 8.179942E-04_EB, 1.622313E-03_EB, 8.319414E-04_EB, 1.584783E-03_EB, 8.313481E-04_EB, &
    7.355779E-04_EB, 7.393154E-04_EB, 1.488682E-03_EB, 7.390167E-04_EB, 1.482552E-03_EB, 7.384415E-04_EB/),(/6,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD5_C7H8(N_TEMP_C7H8,23)) 

! BAND #5: 2675 cm-1 - 3225 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.9882 % 

SD5_C7H8(1:6,1:8) = RESHAPE((/ &  ! 2675-2850 cm-1
    1.044976E-03_EB, 1.099851E-03_EB, 2.077211E-03_EB, 1.109101E-03_EB, 2.039815E-03_EB, 1.016781E-03_EB, &
    1.184702E-03_EB, 1.150926E-03_EB, 2.236635E-03_EB, 1.192032E-03_EB, 2.721191E-03_EB, 9.995167E-03_EB, &
    1.144291E-03_EB, 1.270278E-03_EB, 2.232317E-03_EB, 1.239971E-03_EB, 2.331069E-02_EB, 2.974739E-02_EB, &
    1.249634E-03_EB, 1.297152E-03_EB, 3.564740E-03_EB, 2.974301E-03_EB, 4.642796E-02_EB, 4.367080E-02_EB, &
    1.240352E-03_EB, 2.640793E-03_EB, 6.785723E-03_EB, 4.151419E-03_EB, 2.582413E-02_EB, 3.978670E-02_EB, &
    9.722240E-03_EB, 1.338012E-02_EB, 2.449457E-02_EB, 1.529454E-02_EB, 4.706864E-02_EB, 6.689340E-02_EB, &
    5.837316E-02_EB, 6.591992E-02_EB, 7.324766E-02_EB, 6.626278E-02_EB, 1.018196E-01_EB, 1.260772E-01_EB, &
    2.668238E-01_EB, 2.686899E-01_EB, 2.786223E-01_EB, 2.548030E-01_EB, 2.785268E-01_EB, 2.514942E-01_EB/),(/6,8/))

SD5_C7H8(1:6,9:16) = RESHAPE((/ &  ! 2875-3050 cm-1
    1.195574E+00_EB, 9.248040E-01_EB, 8.318667E-01_EB, 7.404250E-01_EB, 6.302484E-01_EB, 4.590100E-01_EB, &
    1.114009E+00_EB, 9.416306E-01_EB, 8.669533E-01_EB, 8.074763E-01_EB, 7.473116E-01_EB, 6.180415E-01_EB, &
    2.029815E+00_EB, 1.638525E+00_EB, 1.555931E+00_EB, 1.367907E+00_EB, 1.171682E+00_EB, 8.552603E-01_EB, &
    1.941623E+00_EB, 1.408191E+00_EB, 1.305545E+00_EB, 1.085556E+00_EB, 8.900512E-01_EB, 6.006005E-01_EB, &
    9.827046E-01_EB, 7.124183E-01_EB, 6.790377E-01_EB, 5.510380E-01_EB, 4.818843E-01_EB, 3.939638E-01_EB, &
    1.230302E+00_EB, 9.523176E-01_EB, 8.279963E-01_EB, 8.331705E-01_EB, 8.342897E-01_EB, 7.838367E-01_EB, &
    3.288751E+00_EB, 2.742988E+00_EB, 2.314616E+00_EB, 2.283915E+00_EB, 1.947276E+00_EB, 1.376393E+00_EB, &
    3.587259E+00_EB, 2.837358E+00_EB, 2.404658E+00_EB, 2.297969E+00_EB, 1.959505E+00_EB, 1.469484E+00_EB/),(/6,8/))

SD5_C7H8(1:6,17:23) = RESHAPE((/ &  ! 3075-3225 cm-1
    2.711783E+00_EB, 2.229871E+00_EB, 1.969116E+00_EB, 1.880398E+00_EB, 1.652984E+00_EB, 1.231443E+00_EB, &
    1.510657E+00_EB, 1.183474E+00_EB, 1.049503E+00_EB, 9.595928E-01_EB, 8.176629E-01_EB, 5.623793E-01_EB, &
    3.957752E-01_EB, 3.089913E-01_EB, 2.808929E-01_EB, 2.350058E-01_EB, 1.992946E-01_EB, 1.346263E-01_EB, &
    2.641122E-02_EB, 3.375059E-02_EB, 3.912942E-02_EB, 2.153990E-02_EB, 3.753137E-02_EB, 3.284597E-02_EB, &
    2.061190E-02_EB, 1.343173E-02_EB, 1.929005E-02_EB, 6.023065E-03_EB, 1.866458E-02_EB, 1.109563E-02_EB, &
    2.247600E-03_EB, 2.881597E-03_EB, 4.404862E-03_EB, 1.065931E-03_EB, 2.908462E-03_EB, 3.294728E-03_EB, &
    9.233037E-04_EB, 9.269044E-04_EB, 1.865152E-03_EB, 9.264789E-04_EB, 1.857160E-03_EB, 9.259403E-04_EB/),(/6,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD5_C7H8(N_TEMP_C7H8,23)) 

! BAND #5: 2675 cm-1 - 3225 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! On Transmissivity: 1.9882 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD5_C7H8(1:6,1:8) = RESHAPE((/ &  ! 2675-2850 cm-1
    8.134269E-04_EB, 8.791858E-04_EB, 1.635934E-03_EB, 8.810737E-04_EB, 1.632043E-03_EB, 8.012732E-04_EB, &
    9.255151E-04_EB, 9.195346E-04_EB, 1.758389E-03_EB, 9.271998E-04_EB, 2.153707E-03_EB, 6.555238E-03_EB, &
    9.036198E-04_EB, 9.892650E-04_EB, 1.756905E-03_EB, 9.667189E-04_EB, 1.979441E-02_EB, 2.810361E-02_EB, &
    9.701094E-04_EB, 1.008228E-03_EB, 2.777387E-03_EB, 2.313487E-03_EB, 1.199662E-01_EB, 8.716498E-02_EB, &
    9.647636E-04_EB, 1.989313E-03_EB, 5.120309E-03_EB, 2.565845E-03_EB, 3.351359E-02_EB, 1.387132E-01_EB, &
    2.855203E-02_EB, 2.458194E-02_EB, 1.917879E-02_EB, 4.735540E-03_EB, 1.323825E-01_EB, 3.072685E-01_EB, &
    2.401306E-01_EB, 2.736097E-01_EB, 4.909293E-02_EB, 5.045153E-02_EB, 2.876118E-01_EB, 1.635999E+00_EB, &
    1.600847E+00_EB, 3.186908E-01_EB, 1.783169E-01_EB, 3.041834E-01_EB, 5.943319E-01_EB, 1.509504E+00_EB/),(/6,8/))

GAMMAD5_C7H8(1:6,9:16) = RESHAPE((/ &  ! 2875-3050 cm-1
    4.998196E+00_EB, 2.173066E+00_EB, 8.391151E-01_EB, 1.069247E+00_EB, 3.442730E+00_EB, 3.061746E+00_EB, &
    4.999803E+00_EB, 4.324200E+00_EB, 1.024595E+00_EB, 1.803800E+00_EB, 3.569261E+00_EB, 2.490015E+00_EB, &
    4.999994E+00_EB, 4.290257E+00_EB, 9.576503E-01_EB, 1.094685E+00_EB, 3.554776E+00_EB, 3.027816E+00_EB, &
    4.999437E+00_EB, 4.305385E+00_EB, 2.348049E+00_EB, 1.901662E+00_EB, 2.937810E+00_EB, 3.049648E+00_EB, &
    4.999103E+00_EB, 3.071377E+00_EB, 2.799817E+00_EB, 1.066124E+00_EB, 1.530405E+00_EB, 2.690290E+00_EB, &
    4.998475E+00_EB, 4.295113E+00_EB, 7.950271E-01_EB, 1.432251E+00_EB, 3.568463E+00_EB, 3.070086E+00_EB, &
    4.999994E+00_EB, 4.343828E+00_EB, 2.666528E+00_EB, 3.387625E+00_EB, 3.569510E+00_EB, 3.070845E+00_EB, &
    5.000000E+00_EB, 4.351466E+00_EB, 4.124114E+00_EB, 3.835530E+00_EB, 3.569316E+00_EB, 3.070721E+00_EB/),(/6,8/))

GAMMAD5_C7H8(1:6,17:23) = RESHAPE((/ &  ! 3075-3225 cm-1
    4.999999E+00_EB, 4.349327E+00_EB, 4.126832E+00_EB, 2.866225E+00_EB, 3.574407E+00_EB, 3.069896E+00_EB, &
    4.999799E+00_EB, 4.330469E+00_EB, 4.023387E+00_EB, 2.769143E+00_EB, 3.564252E+00_EB, 1.255506E+00_EB, &
    2.807994E+00_EB, 5.343292E-01_EB, 3.231685E-01_EB, 2.554001E-01_EB, 4.957148E-01_EB, 3.624123E-01_EB, &
    1.938701E-01_EB, 1.485515E-01_EB, 9.836844E-02_EB, 1.481913E-02_EB, 7.182972E-02_EB, 1.247236E-01_EB, &
    5.463393E-01_EB, 1.315628E-01_EB, 1.712222E-02_EB, 3.611177E-03_EB, 1.385160E-02_EB, 3.899412E-01_EB, &
    2.357898E-03_EB, 2.407989E-03_EB, 3.316407E-03_EB, 8.326216E-04_EB, 2.221199E-03_EB, 2.850718E-03_EB, &
    7.355779E-04_EB, 7.393154E-04_EB, 1.488682E-03_EB, 7.390167E-04_EB, 1.482552E-03_EB, 7.384415E-04_EB/),(/6,7/))

!--------------------------------OLD RADCAL DATA----------------------------------------

!  Initialize SD Array

! TEMP,K= 300     600      1000      1500      2000      2500       

SD(1:6,1:8) = RESHAPE ((/  & ! 50-225
.950E+00_EB, .103E+00_EB, .420E-01_EB, .114E-01_EB, .450E-02_EB, .300E-02_EB, &
.208E+01_EB, .365E+00_EB, .113E+00_EB, .375E-01_EB, .195E-01_EB, .134E-01_EB, &
.368E+01_EB, .990E+00_EB, .300E+00_EB, .104E+00_EB, .577E-01_EB, .365E-01_EB,  & 
.650E+01_EB, .201E+01_EB, .650E+00_EB, .214E+00_EB, .128E+00_EB, .845E-01_EB, &   
.825E+01_EB, .325E+01_EB, .121E+01_EB, .415E+00_EB, .260E+00_EB, .168E+00_EB, &  
.870E+01_EB, .452E+01_EB, .189E+01_EB, .765E+00_EB, .450E+00_EB, .289E+00_EB, &  
.810E+01_EB, .540E+01_EB, .261E+01_EB, .126E+01_EB, .695E+00_EB, .460E+00_EB, &  
.682E+01_EB, .600E+01_EB, .337E+01_EB, .179E+01_EB, .101E+01_EB, .679E+00_EB/), &
(/6,8/))
SD(1:6,9:16) = RESHAPE ((/ &  ! 250-425
.493E+01_EB, .622E+01_EB, .407E+01_EB, .230E+01_EB, .135E+01_EB, .935E+00_EB,  &   
.316E+01_EB, .592E+01_EB, .456E+01_EB, .281E+01_EB, .172E+01_EB, .122E+01_EB,  &  
.199E+01_EB, .528E+01_EB, .479E+01_EB, .328E+01_EB, .213E+01_EB, .149E+01_EB,  &   
.113E+01_EB, .450E+01_EB, .484E+01_EB, .361E+01_EB, .249E+01_EB, .179E+01_EB,  &   
.585E+00_EB, .370E+01_EB, .471E+01_EB, .383E+01_EB, .284E+01_EB, .208E+01_EB, &    
.293E+00_EB, .289E+01_EB, .443E+01_EB, .394E+01_EB, .312E+01_EB, .237E+01_EB, &    
.138E+00_EB, .205E+01_EB, .400E+01_EB, .396E+01_EB, .330E+01_EB, .260E+01_EB, &    
.620E-01_EB, .143E+01_EB, .347E+01_EB, .388E+01_EB, .341E+01_EB, .280E+01_EB/), &  
(/6,8/))
SD(1:6,17:24) = RESHAPE ((/ & ! 450-625
.255E-01_EB, .950E+00_EB, .292E+01_EB, .370E+01_EB, .345E+01_EB, .295E+01_EB,   &  
.940E-02_EB, .610E+00_EB, .236E+01_EB, .343E+01_EB, .342E+01_EB, .304E+01_EB,  &   
.340E-02_EB, .386E+00_EB, .188E+01_EB, .310E+01_EB, .334E+01_EB, .309E+01_EB,   &  
.105E-02_EB, .236E+00_EB, .145E+01_EB, .274E+01_EB, .319E+01_EB, .307E+01_EB,   &  
.350E-03_EB, .144E+00_EB, .110E+01_EB, .238E+01_EB, .300E+01_EB, .301E+01_EB,   & 
.126E-03_EB, .820E-01_EB, .818E+00_EB, .204E+01_EB, .276E+01_EB, .289E+01_EB,   &  
.430E-04_EB, .445E-01_EB, .598E+00_EB, .174E+01_EB, .248E+01_EB, .275E+01_EB,  &  
.150E-04_EB, .242E-01_EB, .427E+00_EB, .145E+01_EB, .222E+01_EB, .260E+01_EB/), & 
(/6,8/))
SD(1:6,25:32) = RESHAPE ((/  &! 650-825
.510E-05_EB, .127E-01_EB, .294E+00_EB, .118E+01_EB, .195E+01_EB, .241E+01_EB,   &  
.170E-05_EB, .630E-02_EB, .200E+00_EB, .950E+00_EB, .169E+01_EB, .221E+01_EB,   &  
.570E-06_EB, .300E-02_EB, .134E+00_EB, .748E+00_EB, .146E+01_EB, .200E+01_EB,   &  
.195E-06_EB, .140E-02_EB, .902E-01_EB, .580E+00_EB, .124E+01_EB, .178E+01_EB,   &  
.680E-07_EB, .620E-03_EB, .590E-01_EB, .443E+00_EB, .103E+01_EB, .156E+01_EB,   &  
.385E-07_EB, .275E-03_EB, .450E-01_EB, .330E+00_EB, .845E+00_EB, .136E+01_EB,   &  
.670E-07_EB, .113E-03_EB, .355E-01_EB, .242E+00_EB, .695E+00_EB, .117E+01_EB,   &  
.113E-06_EB, .500E-04_EB, .289E-01_EB, .174E+00_EB, .560E+00_EB, .100E+01_EB/),  & 
(/6,8/))
SD(1:6,33:40) = RESHAPE ((/ & ! 850-1025
.195E-06_EB, .230E-04_EB, .245E-01_EB, .123E+00_EB, .450E+00_EB, .855E+00_EB,   &  
.328E-06_EB, .103E-04_EB, .214E-01_EB, .100E+00_EB, .357E+00_EB, .718E+00_EB,  &   
.560E-06_EB, .460E-05_EB, .189E-01_EB, .830E-01_EB, .278E+00_EB, .595E+00_EB,  &   
.950E-06_EB, .205E-05_EB, .174E-01_EB, .730E-01_EB, .239E+00_EB, .492E+00_EB,  &   
.160E-05_EB, .140E-05_EB, .166E-01_EB, .665E-01_EB, .211E+00_EB, .405E+00_EB, &    
.275E-05_EB, .350E-05_EB, .165E-01_EB, .630E-01_EB, .195E+00_EB, .352E+00_EB, &    
.470E-05_EB, .850E-05_EB, .167E-01_EB, .620E-01_EB, .190E+00_EB, .312E+00_EB, &   
.810E-05_EB, .215E-04_EB, .175E-01_EB, .630E-01_EB, .191E+00_EB, .289E+00_EB/), &  
(/6,8/))
SD(1:6,41:48) = RESHAPE ((/ & ! 1050-1225
.136E-04_EB, .570E-04_EB, .188E-01_EB, .675E-01_EB, .194E+00_EB, .281E+00_EB,   &  
.235E-04_EB, .150E-03_EB, .208E-01_EB, .745E-01_EB, .202E+00_EB, .283E+00_EB,   &  
.400E-04_EB, .380E-03_EB, .233E-01_EB, .865E-01_EB, .223E+00_EB, .314E+00_EB,  &   
.680E-04_EB, .950E-03_EB, .268E-01_EB, .122E+00_EB, .260E+00_EB, .380E+00_EB,  &   
.120E-03_EB, .245E-02_EB, .343E-01_EB, .176E+00_EB, .328E+00_EB, .461E+00_EB,  &   
.200E-03_EB, .620E-02_EB, .638E-01_EB, .251E+00_EB, .411E+00_EB, .511E+00_EB,  &   
.365E-03_EB, .140E-01_EB, .107E+00_EB, .330E+00_EB, .458E+00_EB, .542E+00_EB,  &   
.680E-03_EB, .330E-01_EB, .166E+00_EB, .405E+00_EB, .487E+00_EB, .571E+00_EB/),&   
(/6,8/))
SD(1:6,49:56) = RESHAPE ((/ & ! 1250-1425
.130E-02_EB, .635E-01_EB, .244E+00_EB, .459E+00_EB, .535E+00_EB, .557E+00_EB,  &   
.250E-02_EB, .123E+00_EB, .341E+00_EB, .477E+00_EB, .502E+00_EB, .562E+00_EB,  &   
.500E-02_EB, .212E+00_EB, .407E+00_EB, .547E+00_EB, .531E+00_EB, .514E+00_EB,  &   
.103E-01_EB, .285E+00_EB, .489E+00_EB, .592E+00_EB, .497E+00_EB, .486E+00_EB,  &   
.219E-01_EB, .328E+00_EB, .491E+00_EB, .558E+00_EB, .489E+00_EB, .485E+00_EB,  &   
.485E-01_EB, .345E+00_EB, .505E+00_EB, .521E+00_EB, .477E+00_EB, .484E+00_EB,  &   
.114E+00_EB, .361E+00_EB, .538E+00_EB, .563E+00_EB, .503E+00_EB, .502E+00_EB,  &   
.249E+00_EB, .460E+00_EB, .621E+00_EB, .624E+00_EB, .538E+00_EB, .538E+00_EB/), &  
(/6,8/))
SD(1:6,57:64) = RESHAPE ((/ & ! 1450-1625
.397E+00_EB, .569E+00_EB, .749E+00_EB, .768E+00_EB, .581E+00_EB, .565E+00_EB,  &   
.418E+00_EB, .627E+00_EB, .824E+00_EB, .849E+00_EB, .640E+00_EB, .594E+00_EB,  &   
.108E+01_EB, .125E+01_EB, .113E+01_EB, .940E+00_EB, .807E+00_EB, .663E+00_EB,  &   
.165E+01_EB, .155E+01_EB, .118E+01_EB, .670E+00_EB, .562E+00_EB, .483E+00_EB,  &   
.142E+01_EB, .675E+00_EB, .557E+00_EB, .349E+00_EB, .276E+00_EB, .263E+00_EB,  &   
.451E+00_EB, .202E+00_EB, .132E+00_EB, .118E+00_EB, .134E+00_EB, .156E+00_EB,  &   
.603E-01_EB, .538E-01_EB, .863E-01_EB, .112E+00_EB, .120E+00_EB, .125E+00_EB,  &   
.501E+00_EB, .252E+00_EB, .118E+00_EB, .112E+00_EB, .131E+00_EB, .140E+00_EB/), &  
(/6,8/))
SD(1:6,65:72) = RESHAPE ((/ & ! 1650-1825
.730E+00_EB, .430E+00_EB, .237E+00_EB, .191E+00_EB, .171E+00_EB, .170E+00_EB,   &  
.149E+01_EB, .506E+00_EB, .294E+00_EB, .238E+00_EB, .210E+00_EB, .201E+00_EB,  &   
.100E+01_EB, .553E+00_EB, .434E+00_EB, .340E+00_EB, .260E+00_EB, .220E+00_EB,   &  
.802E+00_EB, .658E+00_EB, .528E+00_EB, .411E+00_EB, .300E+00_EB, .240E+00_EB,    & 
.580E+00_EB, .527E+00_EB, .460E+00_EB, .378E+00_EB, .322E+00_EB, .283E+00_EB,  &   
.330E+00_EB, .403E+00_EB, .430E+00_EB, .356E+00_EB, .318E+00_EB, .270E+00_EB,  &   
.250E+00_EB, .393E+00_EB, .405E+00_EB, .342E+00_EB, .301E+00_EB, .275E+00_EB,  &   
.147E+00_EB, .249E+00_EB, .313E+00_EB, .318E+00_EB, .291E+00_EB, .268E+00_EB/), &  
(/6,8/))
SD(1:6,73:80) = RESHAPE ((/ & ! 1850-2025
.910E-01_EB, .252E+00_EB, .298E+00_EB, .295E+00_EB, .269E+00_EB, .253E+00_EB,   &  
.580E-01_EB, .158E+00_EB, .214E+00_EB, .244E+00_EB, .244E+00_EB, .245E+00_EB,   &  
.370E-01_EB, .113E+00_EB, .184E+00_EB, .218E+00_EB, .214E+00_EB, .218E+00_EB,   &  
.244E-01_EB, .118E+00_EB, .156E+00_EB, .188E+00_EB, .195E+00_EB, .200E+00_EB,   & 
.162E-01_EB, .606E-01_EB, .976E-01_EB, .141E+00_EB, .166E+00_EB, .179E+00_EB,   & 
.112E-01_EB, .425E-01_EB, .903E-01_EB, .133E+00_EB, .148E+00_EB, .156E+00_EB,   & 
.780E-02_EB, .400E-01_EB, .765E-01_EB, .112E+00_EB, .129E+00_EB, .137E+00_EB,   & 
.540E-02_EB, .352E-01_EB, .647E-01_EB, .876E-01_EB, .110E+00_EB, .118E+00_EB/),  &
(/6,8/))
SD(1:6,81:88) = RESHAPE ((/ & ! 2050-2225
.380E-02_EB, .252E-01_EB, .507E-01_EB, .705E-01_EB, .888E-01_EB, .100E+00_EB,  &   
.260E-02_EB, .179E-01_EB, .377E-01_EB, .546E-01_EB, .724E-01_EB, .828E-01_EB,  &   
.180E-02_EB, .123E-01_EB, .294E-01_EB, .443E-01_EB, .608E-01_EB, .686E-01_EB,  &   
.127E-02_EB, .850E-02_EB, .212E-01_EB, .378E-01_EB, .579E-01_EB, .640E-01_EB,   &  
.880E-03_EB, .680E-02_EB, .152E-01_EB, .275E-01_EB, .449E-01_EB, .521E-01_EB,  &   
.620E-02_EB, .400E-02_EB, .107E-01_EB, .214E-01_EB, .374E-01_EB, .453E-01_EB,  &   
.480E-03_EB, .298E-02_EB, .931E-02_EB, .189E-01_EB, .329E-01_EB, .403E-01_EB,  &   
.405E-03_EB, .175E-02_EB, .696E-02_EB, .152E-01_EB, .295E-01_EB, .365E-01_EB/), &  
(/6,8/))
SD(1:6,89:96) = RESHAPE ((/ & ! 2250-2425 
.321E-03_EB, .120E-02_EB, .452E-02_EB, .101E-01_EB, .252E-01_EB, .331E-01_EB, &    
.229E-03_EB, .721E-03_EB, .364E-02_EB, .930E-02_EB, .225E-01_EB, .305E-01_EB,  &   
.195E-03_EB, .544E-03_EB, .318E-02_EB, .750E-02_EB, .202E-01_EB, .284E-01_EB, &    
.154E-03_EB, .375E-03_EB, .185E-02_EB, .603E-02_EB, .175E-01_EB, .269E-01_EB, &    
.101E-03_EB, .263E-03_EB, .119E-02_EB, .480E-02_EB, .156E-01_EB, .253E-01_EB, &    
.852E-04_EB, .185E-03_EB, .909E-03_EB, .360E-02_EB, .133E-01_EB, .241E-01_EB,  &   
.763E-04_EB, .137E-03_EB, .711E-03_EB, .316E-02_EB, .122E-01_EB, .237E-01_EB,  &   
.615E-04_EB, .126E-03_EB, .610E-03_EB, .257E-02_EB, .101E-01_EB, .218E-01_EB/), &  
(/6,8/))
SD(1:6,97:104) = RESHAPE ((/ & ! 2450-2625 
.480E-04_EB, .113E-03_EB, .518E-03_EB, .201E-02_EB, .920E-02_EB, .200E-01_EB, &    
.372E-04_EB, .106E-03_EB, .435E-03_EB, .168E-02_EB, .785E-02_EB, .183E-01_EB,  &   
.355E-04_EB, .101E-03_EB, .376E-03_EB, .168E-02_EB, .669E-02_EB, .166E-01_EB, &    
.358E-04_EB, .990E-04_EB, .366E-03_EB, .167E-02_EB, .651E-02_EB, .156E-01_EB,  &   
.389E-04_EB, .102E-03_EB, .376E-03_EB, .167E-02_EB, .641E-02_EB, .152E-01_EB,  &   
.422E-04_EB, .106E-03_EB, .373E-03_EB, .168E-02_EB, .656E-02_EB, .150E-01_EB,  &   
.521E-04_EB, .111E-03_EB, .371E-03_EB, .170E-02_EB, .673E-02_EB, .152E-01_EB,  &   
.646E-04_EB, .121E-03_EB, .384E-03_EB, .179E-02_EB, .798E-02_EB, .179E-01_EB/), &  
(/6,8/)) 
SD(1:6,105:112) = RESHAPE ((/ & ! 2650-2825 
.742E-04_EB, .129E-03_EB, .479E-03_EB, .201E-02_EB, .788E-02_EB, .175E-01_EB,   &  
.953E-04_EB, .165E-03_EB, .544E-03_EB, .249E-02_EB, .945E-02_EB, .204E-01_EB,   &  
.101E-03_EB, .190E-03_EB, .761E-03_EB, .324E-02_EB, .106E-01_EB, .231E-01_EB,   &  
.147E-03_EB, .272E-03_EB, .892E-03_EB, .441E-02_EB, .125E-01_EB, .257E-01_EB,    & 
.195E-03_EB, .326E-03_EB, .100E-02_EB, .499E-02_EB, .147E-01_EB, .295E-01_EB,    & 
.261E-03_EB, .421E-03_EB, .145E-02_EB, .568E-02_EB, .161E-01_EB, .306E-01_EB,   &  
.305E-03_EB, .515E-03_EB, .195E-02_EB, .754E-02_EB, .185E-01_EB, .363E-01_EB,   &  
.362E-03_EB, .645E-03_EB, .237E-02_EB, .830E-02_EB, .205E-01_EB, .373E-01_EB/), &  
(/6,8/))
SD(1:6,113:120) = RESHAPE ((/ & ! 2850-3025 
.507E-03_EB, .850E-03_EB, .274E-02_EB, .888E-02_EB, .234E-01_EB, .431E-01_EB,     &
.799E-03_EB, .118E-02_EB, .322E-02_EB, .110E-01_EB, .262E-01_EB, .451E-01_EB,     &
.935E-03_EB, .160E-02_EB, .386E-02_EB, .126E-01_EB, .292E-01_EB, .530E-01_EB,     &
.108E-02_EB, .231E-02_EB, .451E-02_EB, .140E-01_EB, .306E-01_EB, .536E-01_EB,     &
.192E-02_EB, .271E-02_EB, .563E-02_EB, .159E-01_EB, .357E-01_EB, .629E-01_EB,     &
.263E-02_EB, .300E-02_EB, .625E-02_EB, .179E-01_EB, .385E-01_EB, .666E-01_EB,    & 
.295E-02_EB, .330E-02_EB, .701E-02_EB, .203E-01_EB, .460E-01_EB, .782E-01_EB,   &  
.310E-02_EB, .370E-02_EB, .846E-02_EB, .220E-01_EB, .519E-01_EB, .889E-01_EB/),  & 
(/6,8/))
SD(1:6,121:128) = RESHAPE ((/ & ! 3050-3225
.340E-02_EB, .400E-02_EB, .969E-02_EB, .279E-01_EB, .662E-01_EB, .109E+00_EB,     &
.730E-02_EB, .450E-02_EB, .111E-01_EB, .272E-01_EB, .676E-01_EB, .109E+00_EB,     &
.900E-02_EB, .480E-02_EB, .137E-01_EB, .372E-01_EB, .864E-01_EB, .133E+00_EB,     &
.100E-02_EB, .510E-02_EB, .162E-01_EB, .471E-01_EB, .100E+00_EB, .142E+00_EB,     &
.640E-03_EB, .550E-02_EB, .205E-01_EB, .530E-01_EB, .122E+00_EB, .168E+00_EB,     &
.160E-02_EB, .600E-02_EB, .247E-01_EB, .633E-01_EB, .135E+00_EB, .177E+00_EB,    & 
.330E-02_EB, .700E-02_EB, .283E-01_EB, .770E-01_EB, .153E+00_EB, .185E+00_EB,   &  
.410E-02_EB, .860E-02_EB, .376E-01_EB, .914E-01_EB, .166E+00_EB, .206E+00_EB/),&   
(/6,8/))
SD(1:6,129:136) = RESHAPE ((/ & ! 3250-3425
.410E-02_EB, .103E-01_EB, .514E-01_EB, .117E+00_EB, .194E+00_EB, .228E+00_EB,     &
.290E-02_EB, .129E-01_EB, .664E-01_EB, .147E+00_EB, .220E+00_EB, .254E+00_EB,     &
.220E-02_EB, .161E-01_EB, .834E-01_EB, .171E+00_EB, .237E+00_EB, .263E+00_EB,     &
.220E-02_EB, .212E-01_EB, .103E+00_EB, .201E+00_EB, .268E+00_EB, .283E+00_EB,     &
.250E-02_EB, .285E-01_EB, .135E+00_EB, .240E+00_EB, .295E+00_EB, .295E+00_EB,     &
.310E-02_EB, .385E-01_EB, .169E+00_EB, .272E+00_EB, .312E+00_EB, .301E+00_EB,     &
.420E-02_EB, .540E-01_EB, .214E+00_EB, .309E+00_EB, .329E+00_EB, .307E+00_EB,     &
.600E-02_EB, .770E-01_EB, .267E+00_EB, .343E+00_EB, .332E+00_EB, .314E+00_EB/),  & 
(/6,8/))
SD(1:6,137:144) = RESHAPE ((/ & ! 3450-3625
.940E-02_EB, .117E+00_EB, .333E+00_EB, .372E+00_EB, .344E+00_EB, .303E+00_EB,     &
.165E-01_EB, .173E+00_EB, .365E+00_EB, .385E+00_EB, .353E+00_EB, .300E+00_EB,     &
.360E-01_EB, .258E+00_EB, .438E+00_EB, .393E+00_EB, .315E+00_EB, .288E+00_EB,     &
.720E-01_EB, .375E+00_EB, .510E+00_EB, .409E+00_EB, .294E+00_EB, .271E+00_EB,     &
.133E+00_EB, .401E+00_EB, .499E+00_EB, .390E+00_EB, .281E+00_EB, .257E+00_EB,     &
.215E+00_EB, .500E+00_EB, .443E+00_EB, .341E+00_EB, .254E+00_EB, .230E+00_EB,     &
.318E+00_EB, .450E+00_EB, .346E+00_EB, .286E+00_EB, .245E+00_EB, .219E+00_EB,     &
.442E+00_EB, .400E+00_EB, .354E+00_EB, .279E+00_EB, .233E+00_EB, .216E+00_EB/),   &
(/6,8/))
SD(1:6,145:152) = RESHAPE ((/ & ! 3650-3825
.473E+00_EB, .405E+00_EB, .347E+00_EB, .281E+00_EB, .238E+00_EB, .219E+00_EB,     &
.568E+00_EB, .501E+00_EB, .423E+00_EB, .315E+00_EB, .243E+00_EB, .218E+00_EB,     &
.690E+00_EB, .708E+00_EB, .673E+00_EB, .432E+00_EB, .268E+00_EB, .189E+00_EB,     &
.617E+00_EB, .831E+00_EB, .566E+00_EB, .320E+00_EB, .194E+00_EB, .123E+00_EB,     &
.181E+01_EB, .520E+00_EB, .200E+00_EB, .131E+00_EB, .124E+00_EB, .107E+00_EB,     &
.136E+00_EB, .124E+00_EB, .120E+00_EB, .119E+00_EB, .115E+00_EB, .115E+00_EB,     &
.455E+00_EB, .298E+00_EB, .167E+00_EB, .129E+00_EB, .123E+00_EB, .112E+00_EB,     &
.760E+00_EB, .503E+00_EB, .242E+00_EB, .154E+00_EB, .129E+00_EB, .127E+00_EB/),   &
(/6,8/))
SD(1:6,153:160) = RESHAPE ((/ & ! 3850-4025
.836E+00_EB, .584E+00_EB, .277E+00_EB, .184E+00_EB, .161E+00_EB, .145E+00_EB,     &
.840E+00_EB, .728E+00_EB, .422E+00_EB, .236E+00_EB, .197E+00_EB, .167E+00_EB,     &
.505E+00_EB, .500E+00_EB, .379E+00_EB, .276E+00_EB, .227E+00_EB, .192E+00_EB,     &
.117E+00_EB, .400E+00_EB, .423E+00_EB, .315E+00_EB, .243E+00_EB, .202E+00_EB,     &
.460E-01_EB, .300E+00_EB, .358E+00_EB, .290E+00_EB, .230E+00_EB, .202E+00_EB,     &
.183E-01_EB, .205E+00_EB, .269E+00_EB, .235E+00_EB, .195E+00_EB, .192E+00_EB,     &
.730E-02_EB, .135E+00_EB, .186E+00_EB, .179E+00_EB, .159E+00_EB, .168E+00_EB,     &
.557E-02_EB, .790E-01_EB, .113E+00_EB, .124E+00_EB, .124E+00_EB, .134E+00_EB/),  & 
(/6,8/))
SD(1:6,161:168) = RESHAPE ((/ & ! 4050-4225
.283E-02_EB, .415E-01_EB, .662E-01_EB, .886E-01_EB, .103E+00_EB, .106E+00_EB,     &
.226E-02_EB, .197E-01_EB, .367E-01_EB, .594E-01_EB, .801E-01_EB, .879E-01_EB,     &
.155E-02_EB, .860E-02_EB, .211E-01_EB, .395E-01_EB, .503E-01_EB, .610E-01_EB,     &
.103E-02_EB, .521E-02_EB, .119E-01_EB, .246E-01_EB, .354E-01_EB, .480E-01_EB,     &
.821E-03_EB, .365E-02_EB, .759E-02_EB, .166E-01_EB, .258E-01_EB, .370E-01_EB,     &
.752E-03_EB, .183E-02_EB, .445E-02_EB, .100E-01_EB, .179E-01_EB, .268E-01_EB,     &
.429E-03_EB, .141E-02_EB, .354E-02_EB, .821E-02_EB, .142E-01_EB, .212E-01_EB,     &
.327E-03_EB, .902E-03_EB, .209E-02_EB, .588E-02_EB, .112E-01_EB, .172E-01_EB/),   &
(/6,8/))
SD(1:6,169:176) = RESHAPE ((/ & ! 4250-4425
.225E-03_EB, .685E-03_EB, .189E-02_EB, .512E-02_EB, .101E-01_EB, .164E-01_EB,     &
.186E-03_EB, .551E-03_EB, .156E-02_EB, .366E-02_EB, .812E-02_EB, .136E-01_EB,     &
.173E-03_EB, .472E-03_EB, .139E-02_EB, .306E-02_EB, .661E-02_EB, .115E-01_EB,     &
.138E-03_EB, .395E-03_EB, .110E-02_EB, .272E-02_EB, .587E-02_EB, .104E-01_EB,     &
.900E-04_EB, .270E-03_EB, .968E-03_EB, .222E-02_EB, .497E-02_EB, .921E-02_EB,     &
.752E-04_EB, .233E-03_EB, .744E-03_EB, .208E-02_EB, .466E-02_EB, .876E-02_EB,     &
.618E-04_EB, .175E-03_EB, .638E-03_EB, .185E-02_EB, .465E-02_EB, .914E-02_EB,     &
.504E-04_EB, .134E-03_EB, .499E-03_EB, .174E-02_EB, .455E-02_EB, .935E-02_EB/),   &
(/6,8/))
SD(1:6,177:184) = RESHAPE ((/ & ! 4450-4625
.375E-04_EB, .123E-03_EB, .485E-03_EB, .182E-02_EB, .456E-02_EB, .971E-02_EB,     &
.305E-04_EB, .892E-04_EB, .338E-03_EB, .134E-02_EB, .460E-02_EB, .104E-01_EB,     &
.257E-04_EB, .790E-04_EB, .329E-03_EB, .154E-02_EB, .477E-02_EB, .112E-01_EB,     &
.242E-04_EB, .740E-04_EB, .308E-03_EB, .135E-02_EB, .497E-02_EB, .122E-01_EB,     &
.215E-04_EB, .653E-04_EB, .282E-03_EB, .131E-02_EB, .521E-02_EB, .133E-01_EB,     &
.218E-04_EB, .660E-04_EB, .272E-03_EB, .152E-02_EB, .573E-02_EB, .148E-01_EB,     &
.215E-04_EB, .671E-04_EB, .268E-03_EB, .134E-02_EB, .607E-02_EB, .159E-01_EB,     &
.217E-04_EB, .695E-04_EB, .285E-03_EB, .161E-02_EB, .677E-02_EB, .173E-01_EB/),  & 
(/6,8/))
SD(1:6,185:192) = RESHAPE ((/ & ! 4650-4825
.219E-04_EB, .722E-04_EB, .297E-03_EB, .169E-02_EB, .783E-02_EB, .197E-01_EB,     &
.226E-04_EB, .771E-04_EB, .341E-03_EB, .236E-02_EB, .925E-02_EB, .226E-01_EB,     &
.250E-04_EB, .815E-04_EB, .387E-03_EB, .286E-02_EB, .106E-01_EB, .250E-01_EB,    &
.280E-04_EB, .845E-04_EB, .420E-03_EB, .357E-02_EB, .124E-01_EB, .276E-01_EB,     &
.351E-04_EB, .192E-03_EB, .470E-03_EB, .467E-02_EB, .166E-01_EB, .313E-01_EB,     &
.435E-04_EB, .200E-03_EB, .105E-02_EB, .566E-02_EB, .185E-01_EB, .341E-01_EB,     &
.522E-04_EB, .233E-03_EB, .129E-02_EB, .736E-02_EB, .229E-01_EB, .378E-01_EB,     &
.673E-04_EB, .306E-03_EB, .183E-02_EB, .982E-02_EB, .258E-01_EB, .404E-01_EB/),   &
(/6,8/))
SD(1:6,193:200) = RESHAPE ((/ & ! 4850-5025
.886E-04_EB, .399E-03_EB, .246E-02_EB, .128E-01_EB, .302E-01_EB, .430E-01_EB,     &
.113E-03_EB, .618E-03_EB, .346E-02_EB, .161E-01_EB, .358E-01_EB, .459E-01_EB,     &
.174E-03_EB, .825E-03_EB, .441E-02_EB, .200E-01_EB, .417E-01_EB, .493E-01_EB,     &
.265E-03_EB, .163E-02_EB, .777E-02_EB, .245E-01_EB, .450E-01_EB, .507E-01_EB,     &
.355E-03_EB, .200E-02_EB, .978E-02_EB, .317E-01_EB, .492E-01_EB, .527E-01_EB,     &
.538E-03_EB, .271E-02_EB, .167E-01_EB, .401E-01_EB, .503E-01_EB, .523E-01_EB,     &
.651E-03_EB, .301E-02_EB, .264E-01_EB, .467E-01_EB, .520E-01_EB, .526E-01_EB,     &
.987E-03_EB, .530E-02_EB, .321E-01_EB, .499E-01_EB, .523E-01_EB, .510E-01_EB/),   &
(/6,8/))
SD(1:6,201:208) = RESHAPE ((/ & ! 5050-5225
.135E-02_EB, .860E-02_EB, .389E-01_EB, .528E-01_EB, .513E-01_EB, .492E-01_EB,    &
.226E-02_EB, .130E-01_EB, .472E-01_EB, .559E-01_EB, .500E-01_EB, .469E-01_EB,     &
.431E-02_EB, .198E-01_EB, .526E-01_EB, .557E-01_EB, .480E-01_EB, .452E-01_EB,     &
.628E-02_EB, .282E-01_EB, .488E-01_EB, .495E-01_EB, .451E-01_EB, .430E-01_EB,     &
.900E-02_EB, .390E-01_EB, .471E-01_EB, .449E-01_EB, .430E-01_EB, .423E-01_EB,     &
.180E-01_EB, .462E-01_EB, .412E-01_EB, .391E-01_EB, .403E-01_EB, .415E-01_EB,     &
.348E-01_EB, .710E-01_EB, .402E-01_EB, .360E-01_EB, .384E-01_EB, .414E-01_EB,     &
.718E-01_EB, .590E-01_EB, .399E-01_EB, .360E-01_EB, .376E-01_EB, .420E-01_EB/),   &
(/6,8/))
SD(1:6,209:216) = RESHAPE ((/ & ! 5250-5425
.111E+00_EB, .368E-01_EB, .340E-01_EB, .369E-01_EB, .409E-01_EB, .454E-01_EB,     &
.329E-01_EB, .285E-01_EB, .365E-01_EB, .423E-01_EB, .461E-01_EB, .482E-01_EB,     &
.281E-01_EB, .270E-01_EB, .432E-01_EB, .505E-01_EB, .529E-01_EB, .511E-01_EB,     &
.121E+00_EB, .422E-01_EB, .589E-01_EB, .598E-01_EB, .572E-01_EB, .544E-01_EB,     &
.139E+00_EB, .105E+00_EB, .844E-01_EB, .687E-01_EB, .593E-01_EB, .560E-01_EB,     &
.774E-01_EB, .710E-01_EB, .683E-01_EB, .618E-01_EB, .556E-01_EB, .534E-01_EB,     &
.858E-01_EB, .483E-01_EB, .579E-01_EB, .547E-01_EB, .503E-01_EB, .495E-01_EB,     &
.985E-01_EB, .575E-01_EB, .589E-01_EB, .510E-01_EB, .451E-01_EB, .449E-01_EB/),   &
(/6,8/))
SD(1:6,217:224) = RESHAPE ((/ & ! 5450-5625
.996E-01_EB, .682E-01_EB, .539E-01_EB, .489E-01_EB, .454E-01_EB, .446E-01_EB,     &
.680E-01_EB, .680E-01_EB, .548E-01_EB, .495E-01_EB, .460E-01_EB, .458E-01_EB,     &
.325E-01_EB, .520E-01_EB, .515E-01_EB, .483E-01_EB, .449E-01_EB, .454E-01_EB,     &
.150E-01_EB, .350E-01_EB, .451E-01_EB, .464E-01_EB, .452E-01_EB, .449E-01_EB,     &
.620E-02_EB, .238E-01_EB, .369E-01_EB, .408E-01_EB, .414E-01_EB, .417E-01_EB,     &
.270E-02_EB, .158E-01_EB, .282E-01_EB, .339E-01_EB, .366E-01_EB, .384E-01_EB,     &
.113E-02_EB, .101E-01_EB, .203E-01_EB, .263E-01_EB, .303E-01_EB, .333E-01_EB,     &
.829E-03_EB, .590E-02_EB, .148E-01_EB, .206E-01_EB, .247E-01_EB, .295E-01_EB/),  & 
(/6,8/))
SD(1:6,225:232) = RESHAPE ((/ & ! 5650-5825
.365E-03_EB, .310E-02_EB, .969E-02_EB, .154E-01_EB, .203E-01_EB, .258E-01_EB,     &
.240E-03_EB, .130E-02_EB, .589E-02_EB, .112E-01_EB, .164E-01_EB, .222E-01_EB,     &
.158E-03_EB, .400E-03_EB, .417E-02_EB, .850E-02_EB, .134E-01_EB, .190E-01_EB,     &
.103E-03_EB, .262E-03_EB, .208E-02_EB, .594E-02_EB, .109E-01_EB, .162E-01_EB,     &
.741E-04_EB, .181E-03_EB, .142E-02_EB, .455E-02_EB, .907E-02_EB, .141E-01_EB,     &
.625E-04_EB, .135E-03_EB, .816E-03_EB, .316E-02_EB, .698E-02_EB, .121E-01_EB,     &
.499E-04_EB, .111E-03_EB, .624E-03_EB, .230E-02_EB, .551E-02_EB, .102E-01_EB,     &
.325E-04_EB, .677E-04_EB, .425E-03_EB, .124E-02_EB, .385E-02_EB, .818E-02_EB/),   &
(/6,8/))
SD(1:6,233:240) = RESHAPE ((/ & ! 5850-6025
.231E-04_EB, .563E-04_EB, .278E-03_EB, .986E-03_EB, .290E-02_EB, .672E-02_EB,    &
.165E-04_EB, .481E-04_EB, .247E-03_EB, .944E-03_EB, .253E-02_EB, .612E-02_EB,           &
.126E-04_EB, .432E-04_EB, .241E-03_EB, .886E-03_EB, .220E-02_EB, .582E-02_EB,          &
.118E-04_EB, .420E-04_EB, .235E-03_EB, .847E-03_EB, .209E-02_EB, .571E-02_EB,          &
.110E-04_EB, .408E-04_EB, .226E-03_EB, .812E-03_EB, .221E-02_EB, .604E-02_EB,         &
.101E-04_EB, .400E-04_EB, .213E-03_EB, .805E-03_EB, .239E-02_EB, .641E-02_EB,        &
.983E-05_EB, .395E-04_EB, .186E-03_EB, .801E-03_EB, .247E-02_EB, .691E-02_EB,       &
.979E-05_EB, .401E-04_EB, .193E-03_EB, .805E-03_EB, .260E-02_EB, .732E-02_EB/),    &
(/6,8/))
SD(1:6,241:248) = RESHAPE ((/ & ! 6050-6225
.976E-05_EB, .410E-04_EB, .201E-03_EB, .814E-03_EB, .285E-02_EB, .776E-02_EB,     &
.988E-05_EB, .420E-04_EB, .210E-03_EB, .832E-03_EB, .317E-02_EB, .842E-02_EB,    &
.991E-05_EB, .425E-04_EB, .219E-03_EB, .877E-03_EB, .340E-02_EB, .888E-02_EB,        &
.102E-04_EB, .435E-04_EB, .231E-03_EB, .937E-03_EB, .361E-02_EB, .929E-02_EB,       &
.110E-04_EB, .486E-04_EB, .244E-03_EB, .971E-03_EB, .402E-02_EB, .994E-02_EB,      &
.127E-04_EB, .579E-04_EB, .257E-03_EB, .111E-02_EB, .437E-02_EB, .104E-01_EB,     &
.131E-04_EB, .612E-04_EB, .277E-03_EB, .113E-02_EB, .465E-02_EB, .110E-01_EB,        &
.150E-04_EB, .783E-04_EB, .353E-03_EB, .116E-02_EB, .510E-02_EB, .116E-01_EB/),     &
(/6,8/))
SD(1:6,249:256) = RESHAPE ((/ & ! 6250-6425
.178E-04_EB, .922E-04_EB, .394E-03_EB, .157E-02_EB, .555E-02_EB, .123E-01_EB,      &
.203E-04_EB, .115E-03_EB, .481E-03_EB, .188E-02_EB, .601E-02_EB, .131E-01_EB,     &
.230E-04_EB, .145E-03_EB, .617E-03_EB, .183E-02_EB, .644E-02_EB, .139E-01_EB,      & 
.280E-04_EB, .187E-03_EB, .723E-03_EB, .202E-02_EB, .686E-02_EB, .146E-01_EB,     & 
.305E-04_EB, .209E-03_EB, .811E-03_EB, .243E-02_EB, .779E-02_EB, .157E-01_EB,     &
.455E-04_EB, .244E-03_EB, .935E-03_EB, .243E-02_EB, .844E-02_EB, .166E-01_EB,    &
.661E-04_EB, .320E-03_EB, .989E-03_EB, .288E-02_EB, .902E-02_EB, .173E-01_EB,       & 
.723E-04_EB, .397E-03_EB, .122E-02_EB, .359E-02_EB, .100E-01_EB, .184E-01_EB/),    &
(/6,8/))
SD(1:6,257:264) = RESHAPE ((/ & ! 6450-6625
.847E-04_EB, .481E-03_EB, .143E-02_EB, .429E-02_EB, .108E-01_EB, .192E-01_EB,     &
.103E-03_EB, .591E-03_EB, .174E-02_EB, .488E-02_EB, .116E-01_EB, .200E-01_EB,           &
.131E-03_EB, .703E-03_EB, .247E-02_EB, .549E-02_EB, .124E-01_EB, .205E-01_EB,          &
.165E-03_EB, .872E-03_EB, .265E-02_EB, .641E-02_EB, .131E-01_EB, .211E-01_EB,         &
.205E-03_EB, .110E-02_EB, .298E-02_EB, .749E-02_EB, .140E-01_EB, .218E-01_EB,         &
.253E-03_EB, .130E-02_EB, .346E-02_EB, .811E-02_EB, .150E-01_EB, .230E-01_EB,         &
.338E-03_EB, .150E-02_EB, .445E-02_EB, .890E-02_EB, .159E-01_EB, .237E-01_EB,        &
.437E-03_EB, .170E-02_EB, .491E-02_EB, .107E-01_EB, .170E-01_EB, .245E-01_EB/),     &
(/6,8/))
SD(1:6,265:272) = RESHAPE ((/ & ! 6650-6825
.581E-03_EB, .190E-02_EB, .537E-02_EB, .116E-01_EB, .179E-01_EB, .254E-01_EB,         &
.685E-03_EB, .220E-02_EB, .578E-02_EB, .128E-01_EB, .189E-01_EB, .263E-01_EB,        &
.900E-03_EB, .250E-02_EB, .649E-02_EB, .134E-01_EB, .195E-01_EB, .275E-01_EB,       &
.121E-02_EB, .280E-02_EB, .722E-02_EB, .142E-01_EB, .202E-01_EB, .281E-01_EB,      &
.152E-02_EB, .330E-02_EB, .813E-02_EB, .161E-01_EB, .212E-01_EB, .288E-01_EB,     &
.185E-02_EB, .370E-02_EB, .907E-02_EB, .168E-01_EB, .222E-01_EB, .292E-01_EB,    &
.220E-02_EB, .430E-02_EB, .929E-02_EB, .183E-01_EB, .233E-01_EB, .294E-01_EB,       &
.255E-02_EB, .500E-02_EB, .114E-01_EB, .195E-01_EB, .245E-01_EB, .289E-01_EB/),       &
(/6,8/))
SD(1:6,273:280) = RESHAPE ((/ & ! 6850-7025
.290E-02_EB, .580E-02_EB, .167E-01_EB, .215E-01_EB, .260E-01_EB, .291E-01_EB,        &
.320E-02_EB, .670E-02_EB, .208E-01_EB, .237E-01_EB, .274E-01_EB, .293E-01_EB,        &
.360E-02_EB, .880E-02_EB, .220E-01_EB, .253E-01_EB, .282E-01_EB, .300E-01_EB,       &
.400E-02_EB, .920E-02_EB, .238E-01_EB, .273E-01_EB, .290E-01_EB, .304E-01_EB,        &
.460E-02_EB, .108E-01_EB, .272E-01_EB, .279E-01_EB, .298E-01_EB, .310E-01_EB,       &
.530E-02_EB, .128E-01_EB, .304E-01_EB, .292E-01_EB, .297E-01_EB, .312E-01_EB,        &
.620E-02_EB, .152E-01_EB, .344E-01_EB, .303E-01_EB, .293E-01_EB, .310E-01_EB,       &
.760E-02_EB, .182E-01_EB, .341E-01_EB, .297E-01_EB, .290E-01_EB, .300E-01_EB/),    &
(/6,8/))
SD(1:6,281:288) = RESHAPE ((/ & ! 7050-7225
.980E-02_EB, .222E-01_EB, .398E-01_EB, .318E-01_EB, .291E-01_EB, .294E-01_EB,       & 
.132E-01_EB, .271E-01_EB, .402E-01_EB, .294E-01_EB, .274E-01_EB, .282E-01_EB,      & 
.190E-01_EB, .335E-01_EB, .421E-01_EB, .286E-01_EB, .262E-01_EB, .269E-01_EB,     & 
.240E-01_EB, .432E-01_EB, .431E-01_EB, .276E-01_EB, .245E-01_EB, .257E-01_EB,    & 
.288E-01_EB, .570E-01_EB, .458E-01_EB, .270E-01_EB, .228E-01_EB, .243E-01_EB,   &
.323E-01_EB, .740E-01_EB, .449E-01_EB, .261E-01_EB, .214E-01_EB, .221E-01_EB,        &
.570E-01_EB, .890E-01_EB, .435E-01_EB, .225E-01_EB, .199E-01_EB, .196E-01_EB,       &
.216E-01_EB, .680E-01_EB, .378E-01_EB, .239E-01_EB, .195E-01_EB, .192E-01_EB/),    &
(/6,8/))
SD(1:6,289:296) = RESHAPE ((/ & ! 7250-7425
.126E-01_EB, .475E-01_EB, .364E-01_EB, .238E-01_EB, .197E-01_EB, .192E-01_EB,      & 
.117E-01_EB, .369E-01_EB, .385E-01_EB, .249E-01_EB, .212E-01_EB, .204E-01_EB,     & 
.140E-01_EB, .370E-01_EB, .419E-01_EB, .272E-01_EB, .228E-01_EB, .213E-01_EB,    & 
.425E-01_EB, .418E-01_EB, .440E-01_EB, .280E-01_EB, .248E-01_EB, .229E-01_EB,   &
.640E-01_EB, .460E-01_EB, .427E-01_EB, .290E-01_EB, .263E-01_EB, .238E-01_EB,   &
.385E-01_EB, .385E-01_EB, .374E-01_EB, .259E-01_EB, .235E-01_EB, .224E-01_EB,        &
.182E-01_EB, .179E-01_EB, .282E-01_EB, .231E-01_EB, .211E-01_EB, .214E-01_EB,       &
.170E-01_EB, .810E-02_EB, .191E-01_EB, .175E-01_EB, .181E-01_EB, .194E-01_EB/),     & 
(/6,8/))
SD(1:6,297:304) = RESHAPE ((/ & ! 7450-7625
.161E-01_EB, .370E-02_EB, .105E-01_EB, .127E-01_EB, .152E-01_EB, .171E-01_EB,      & 
.145E-01_EB, .170E-02_EB, .554E-02_EB, .855E-02_EB, .113E-01_EB, .131E-01_EB,     & 
.175E-02_EB, .140E-02_EB, .385E-02_EB, .595E-02_EB, .803E-02_EB, .945E-02_EB,    &
.772E-03_EB, .751E-03_EB, .384E-02_EB, .575E-02_EB, .537E-02_EB, .594E-02_EB,       &
.491E-03_EB, .600E-03_EB, .301E-02_EB, .453E-02_EB, .380E-02_EB, .434E-02_EB,      &
.275E-03_EB, .410E-03_EB, .193E-02_EB, .366E-02_EB, .319E-02_EB, .332E-02_EB,     &
.185E-01_EB, .280E-03_EB, .131E-02_EB, .232E-02_EB, .247E-02_EB, .256E-02_EB,      &
.101E-03_EB, .160E-03_EB, .915E-03_EB, .150E-02_EB, .186E-02_EB, .197E-02_EB/),   &
(/6,8/))
SD(1:6,305:312) = RESHAPE ((/ & ! 7650-7825
.691E-04_EB, .110E-03_EB, .565E-03_EB, .114E-02_EB, .205E-02_EB, .192E-02_EB,        &  
.476E-04_EB, .750E-04_EB, .114E-02_EB, .124E-02_EB, .175E-02_EB, .187E-02_EB,         &
.305E-04_EB, .590E-04_EB, .529E-03_EB, .114E-02_EB, .160E-02_EB, .185E-02_EB,       &
.240E-04_EB, .480E-04_EB, .293E-03_EB, .842E-03_EB, .141E-02_EB, .184E-02_EB,       &
.170E-04_EB, .360E-04_EB, .122E-03_EB, .435E-03_EB, .124E-02_EB, .182E-02_EB,      &
.120E-04_EB, .240E-04_EB, .121E-03_EB, .435E-03_EB, .118E-02_EB, .187E-02_EB,     &
.810E-05_EB, .170E-04_EB, .103E-03_EB, .439E-03_EB, .126E-02_EB, .192E-02_EB,    &
.550E-05_EB, .120E-04_EB, .866E-04_EB, .367E-03_EB, .119E-02_EB, .193E-02_EB/),    &
(/6,8/))
SD(1:6,313:320) = RESHAPE ((/&  ! 7850-8025
.390E-05_EB, .900E-05_EB, .716E-04_EB, .351E-03_EB, .116E-02_EB, .194E-02_EB,        & 
.295E-05_EB, .830E-05_EB, .373E-04_EB, .254E-03_EB, .114E-02_EB, .196E-02_EB,       & 
.230E-05_EB, .800E-05_EB, .465E-04_EB, .298E-03_EB, .117E-02_EB, .201E-02_EB,      & 
.225E-05_EB, .820E-05_EB, .367E-04_EB, .252E-03_EB, .116E-02_EB, .205E-02_EB,     & 
.220E-05_EB, .840E-05_EB, .371E-04_EB, .268E-03_EB, .127E-02_EB, .211E-02_EB,    & 
.223E-05_EB, .920E-05_EB, .396E-04_EB, .273E-03_EB, .128E-02_EB, .216E-02_EB,   &
.235E-05_EB, .103E-04_EB, .415E-04_EB, .263E-03_EB, .121E-02_EB, .221E-02_EB,      &
.280E-05_EB, .125E-04_EB, .633E-04_EB, .363E-03_EB, .136E-02_EB, .231E-02_EB/),   &
(/6,8/))
SD(1:6,321:328) = RESHAPE ((/ & ! 8050-8225
.310E-05_EB, .150E-04_EB, .979E-04_EB, .492E-03_EB, .150E-02_EB, .241E-02_EB,           &
.370E-05_EB, .180E-04_EB, .120E-03_EB, .580E-03_EB, .167E-02_EB, .251E-02_EB,           &
.420E-05_EB, .200E-04_EB, .987E-04_EB, .509E-03_EB, .171E-02_EB, .257E-02_EB,           &
.510E-05_EB, .240E-04_EB, .134E-03_EB, .547E-03_EB, .173E-02_EB, .267E-02_EB,           &
.600E-05_EB, .270E-04_EB, .121E-03_EB, .534E-03_EB, .172E-02_EB, .274E-02_EB,           &
.720E-05_EB, .300E-04_EB, .204E-03_EB, .684E-03_EB, .184E-02_EB, .285E-02_EB,           &
.820E-05_EB, .330E-04_EB, .276E-03_EB, .819E-03_EB, .199E-02_EB, .297E-02_EB,           &
.100E-04_EB, .380E-04_EB, .317E-03_EB, .859E-03_EB, .214E-02_EB, .308E-02_EB/),         &
(/6,8/))
SD(1:6,329:336) = RESHAPE ((/ & ! 8250-8425
.125E-04_EB, .420E-04_EB, .240E-03_EB, .818E-03_EB, .220E-02_EB, .317E-02_EB,           &
.145E-04_EB, .500E-04_EB, .452E-03_EB, .109E-02_EB, .238E-02_EB, .293E-02_EB,           &
.175E-04_EB, .560E-04_EB, .301E-03_EB, .941E-03_EB, .243E-02_EB, .342E-02_EB,           &
.198E-04_EB, .630E-04_EB, .280E-03_EB, .107E-02_EB, .260E-02_EB, .353E-02_EB,           &
.230E-04_EB, .710E-04_EB, .276E-03_EB, .109E-02_EB, .272E-02_EB, .365E-02_EB,           &
.280E-04_EB, .830E-04_EB, .369E-03_EB, .127E-02_EB, .295E-02_EB, .377E-02_EB,           &
.330E-04_EB, .890E-04_EB, .430E-03_EB, .139E-02_EB, .306E-02_EB, .385E-02_EB,           &
.360E-04_EB, .950E-04_EB, .371E-03_EB, .135E-02_EB, .306E-02_EB, .384E-02_EB/),         &
(/6,8/))
SD(1:6,337:344) = RESHAPE ((/ & ! 8450-8625
.390E-04_EB, .980E-04_EB, .434E-03_EB, .147E-02_EB, .316E-02_EB, .385E-02_EB,           &
.400E-04_EB, .990E-04_EB, .397E-03_EB, .143E-02_EB, .318E-02_EB, .384E-02_EB,           &
.400E-04_EB, .980E-04_EB, .364E-03_EB, .141E-02_EB, .317E-02_EB, .381E-02_EB,           &
.390E-04_EB, .940E-04_EB, .390E-03_EB, .142E-02_EB, .314E-02_EB, .376E-02_EB,          &
.380E-04_EB, .900E-04_EB, .380E-03_EB, .145E-02_EB, .318E-02_EB, .375E-02_EB,         &
.380E-04_EB, .900E-04_EB, .380E-03_EB, .145E-02_EB, .318E-02_EB, .375E-02_EB,        &
.330E-04_EB, .750E-04_EB, .358E-03_EB, .138E-02_EB, .310E-02_EB, .372E-02_EB,       &
.270E-04_EB, .580E-04_EB, .382E-03_EB, .143E-02_EB, .315E-02_EB, .369E-02_EB/),    &
(/6,8/))
SD(1:6,345:352) = RESHAPE ((/ & ! 8650-8825
.240E-04_EB, .500E-04_EB, .343E-03_EB, .136E-02_EB, .306E-02_EB, .363E-02_EB,          &
.200E-04_EB, .450E-04_EB, .309E-03_EB, .134E-02_EB, .306E-02_EB, .359E-02_EB,         & 
.180E-04_EB, .400E-04_EB, .281E-03_EB, .127E-02_EB, .294E-02_EB, .341E-02_EB,        &
.170E-04_EB, .360E-04_EB, .276E-03_EB, .124E-02_EB, .290E-02_EB, .336E-02_EB,       & 
.160E-04_EB, .310E-04_EB, .272E-03_EB, .122E-02_EB, .283E-02_EB, .323E-02_EB,      &  
.140E-04_EB, .280E-04_EB, .241E-03_EB, .117E-02_EB, .273E-02_EB, .309E-02_EB,       &
.120E-04_EB, .250E-04_EB, .237E-03_EB, .115E-02_EB, .269E-02_EB, .297E-02_EB,      &
.100E-04_EB, .220E-04_EB, .218E-03_EB, .111E-02_EB, .259E-02_EB, .284E-02_EB/),   &
(/6,8/))
SD(1:6,353:360) = RESHAPE ((/ & ! 8850-9025
.920E-05_EB, .198E-04_EB, .206E-03_EB, .105E-02_EB, .246E-02_EB, .269E-02_EB,       &
.810E-05_EB, .170E-04_EB, .205E-03_EB, .100E-02_EB, .235E-02_EB, .257E-02_EB,       & 
.720E-05_EB, .160E-04_EB, .177E-03_EB, .921E-03_EB, .220E-02_EB, .245E-02_EB,      &
.650E-05_EB, .150E-04_EB, .172E-03_EB, .834E-03_EB, .205E-02_EB, .232E-02_EB,     &
.590E-05_EB, .130E-04_EB, .147E-03_EB, .735E-03_EB, .194E-02_EB, .218E-02_EB,    &
.510E-05_EB, .110E-04_EB, .120E-03_EB, .629E-03_EB, .177E-02_EB, .203E-02_EB,     &
.460E-05_EB, .950E-05_EB, .960E-04_EB, .513E-03_EB, .154E-02_EB, .180E-02_EB,      &
.420E-05_EB, .800E-05_EB, .578E-04_EB, .314E-03_EB, .123E-02_EB, .154E-02_EB/),     &
(/6,8/))
SD(1:6,361:368) = RESHAPE ((/ & ! 9050-9225
.380E-05_EB, .720E-05_EB, .529E-04_EB, .292E-03_EB, .114E-02_EB, .137E-02_EB,      &
.330E-05_EB, .660E-05_EB, .485E-04_EB, .269E-03_EB, .102E-02_EB, .122E-02_EB,      &
.290E-05_EB, .580E-05_EB, .430E-04_EB, .239E-03_EB, .896E-03_EB, .107E-02_EB,      &
.270E-05_EB, .520E-05_EB, .259E-04_EB, .193E-03_EB, .748E-03_EB, .944E-03_EB,     &
.240E-05_EB, .450E-05_EB, .316E-04_EB, .207E-03_EB, .671E-02_EB, .848E-03_EB,      &
.220E-05_EB, .400E-05_EB, .444E-05_EB, .602E-04_EB, .516E-03_EB, .750E-03_EB,     &
.190E-05_EB, .360E-05_EB, .324E-05_EB, .460E-04_EB, .439E-03_EB, .688E-03_EB,     & 
.170E-05_EB, .320E-05_EB, .180E-05_EB, .321E-04_EB, .384E-03_EB, .653E-03_EB/),  & 
(/6,8/))
SD(1:6,369:376) = RESHAPE ((/ & ! 9250-9300
.140E-05_EB, .280E-05_EB, .171E-05_EB, .344E-04_EB, .340E-03_EB, .616E-03_EB,   & 
.130E-05_EB, .250E-05_EB, .299E-05_EB, .600E-04_EB, .343E-03_EB, .619E-03_EB,  &  
.120E-05_EB, .220E-05_EB, .299E-05_EB, .600E-04_EB, .343E-03_EB, .619E-03_EB, &  
1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB,&
1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB/),&
(/6,8/))

! Intialize GAMMA Array

GAMMA = RESHAPE((/ &
!     LINE BROADENING PARAMETERS,GAMMA(I,J),
!     J=CO2,H2O,CH4,CO,O2,N2,SELF RESONANT.
!   I=     CO2  H2O  CH4   CO
!    J
.09_EB , .12_EB, .0_EB , .07_EB,&
.07_EB , .09_EB, .0_EB , .06_EB,&
!.0_EB  , .0_EB , .16_EB, .0_EB ,&
.0_EB  , .0_EB , .12_EB, .0_EB ,&
.06_EB , .10_EB, .0_EB , .06_EB,&
.055_EB, .04_EB, .0_EB , .05_EB,&
.07_EB , .09_EB, .0_EB , .06_EB, &
.01_EB , .44_EB, .0_EB , .0_EB /),(/4,7/))

! Initialize SD15 Array

!  THE FOLLOWING ARE DATA FOR THE 15.0 MICRON BAND OF CO2
!  TEMP, K=300     600      1200      1500  1800    2400    

SD15(1:6,1:8) = RESHAPE ((/  &! 500-535
.000E+00_EB, .000E+00_EB, .000E+00_EB, .105E-01_EB, .300E-01_EB, .880E-01_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .180E-01_EB, .490E-01_EB, .880E-01_EB,         & 
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .540E-01_EB, .740E-01_EB,        &  
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .560E-01_EB, .890E-01_EB,       &   
.000E+00_EB, .000E+00_EB, .000E+00_EB, .330E-01_EB, .690E-01_EB, .990E-01_EB,      &    
.000E+00_EB, .000E+00_EB, .880E-02_EB, .380E-01_EB, .720E-01_EB, .970E-01_EB,     &     
.000E+00_EB, .000E+00_EB, .110E-01_EB, .530E-01_EB, .950E-01_EB, .124E+00_EB,    &      
.000E+00_EB, .000E+00_EB, .285E-01_EB, .630E-01_EB, .990E-01_EB, .140E+00_EB/), &       
(/6,8/))
SD15(1:6,9:16) = RESHAPE ((/  &! 540-575
.000E+00_EB, .000E+00_EB, .330E-01_EB, .680E-01_EB, .103E+00_EB, .134E+00_EB,          &
.000E+00_EB, .000E+00_EB, .450E-01_EB, .920E-01_EB, .138E+00_EB, .176E+00_EB,          &
.000E+00_EB, .000E+00_EB, .490E-01_EB, .970E-01_EB, .148E+00_EB, .191E+00_EB,         & 
.000E+00_EB, .000E+00_EB, .490E-01_EB, .120E-01_EB, .188E+00_EB, .247E+00_EB,        &  
.000E+00_EB, .000E+00_EB, .480E-01_EB, .126E+00_EB, .201E+00_EB, .241E+00_EB,       &   
.000E+00_EB, .000E+00_EB, .820E-01_EB, .198E+00_EB, .270E+00_EB, .265E+00_EB,      &    
.000E+00_EB, .750E-02_EB, .690E-01_EB, .140E+00_EB, .225E+00_EB, .340E+00_EB,     &     
.000E+00_EB, .205E-01_EB, .820E-01_EB, .145E+00_EB, .236E+00_EB, .530E+00_EB/),  &      
(/6,8/))
SD15(1:6,17:24) = RESHAPE ((/ & ! 580-615
.000E+00_EB, .355E-01_EB, .117E+00_EB, .193E+00_EB, .295E+00_EB, .550E+00_EB,          &
.157E-01_EB, .520E-01_EB, .170E+00_EB, .235E+00_EB, .305E+00_EB, .410E+00_EB,          &
.150E-01_EB, .880E-01_EB, .270E+00_EB, .330E+00_EB, .440E+00_EB, .520E+00_EB,          &
.510E-01_EB, .130E+00_EB, .400E+00_EB, .530E+00_EB, .560E+00_EB, .540E+00_EB,         & 
.120E+00_EB, .165E+00_EB, .275E+00_EB, .320E+00_EB, .420E+00_EB, .560E+00_EB,        &  
.880E-01_EB, .190E+00_EB, .430E+00_EB, .540E+00_EB, .620E+00_EB, .680E+00_EB,       &   
.110E+00_EB, .350E+00_EB, .710E+00_EB, .760E+00_EB, .760E+00_EB, .690E+00_EB,      &    
.180E+00_EB, .470E+00_EB, .920E+00_EB, .970E+00_EB, .910E+00_EB, .670E+00_EB/),   &     
(/6,8/))
SD15(1:6,25:32) = RESHAPE ((/ & ! 620-655
.970E-01_EB, .265E+00_EB, .610E+00_EB, .720E+00_EB, .780E+00_EB, .730E+00_EB,          &
.175E+00_EB, .380E+00_EB, .720E+00_EB, .790E+00_EB, .830E+00_EB, .840E+00_EB,          &
.370E+00_EB, .640E+00_EB, .920E+00_EB, .960E+00_EB, .980E+00_EB, .940E+00_EB,          &
.590E+00_EB, .840E+00_EB, .107E+01_EB, .110E+01_EB, .111E+01_EB, .106E+01_EB,         & 
.940E+00_EB, .103E+01_EB, .115E+01_EB, .115E+01_EB, .115E+01_EB, .118E+01_EB,        &  
.196E+01_EB, .177E+01_EB, .146E+01_EB, .136E+01_EB, .132E+01_EB, .139E+01_EB,       &   
.345E+01_EB, .282E+01_EB, .198E+01_EB, .172E+01_EB, .156E+01_EB, .148E+01_EB,      &    
.282E+01_EB, .248E+01_EB, .200E+01_EB, .190E+01_EB, .186E+01_EB, .205E+01_EB/),   &     
(/6,8/))
SD15(1:6,33:40) = RESHAPE ((/  &! 660-695
.254E+01_EB, .234E+01_EB, .184E+01_EB, .176E+01_EB, .174E+01_EB, .203E+01_EB,          &
.142E+02_EB, .860E+01_EB, .370E+01_EB, .260E+01_EB, .196E+01_EB, .142E+01_EB,          &
.450E+01_EB, .570E+01_EB, .580E+01_EB, .520E+01_EB, .350E+01_EB, .420E+01_EB,         & 
.360E+01_EB, .310E+01_EB, .330E+01_EB, .290E+01_EB, .205E+01_EB, .200E+01_EB,        &  
.310E+01_EB, .260E+01_EB, .200E+01_EB, .196E+01_EB, .180E+01_EB, .210E+01_EB,       &   
.240E+01_EB, .250E+01_EB, .230E+01_EB, .220E+01_EB, .170E+01_EB, .194E+01_EB,      &    
.182E+01_EB, .200E+01_EB, .218E+01_EB, .205E+01_EB, .184E+01_EB, .130E+01_EB,     &     
.104E+01_EB, .135E+01_EB, .172E+01_EB, .172E+01_EB, .165E+01_EB, .130E+01_EB/),  &      
(/6,8/))
SD15(1:6,41:48) = RESHAPE ((/  &! 700-735
.550E+00_EB, .120E+01_EB, .143E+01_EB, .147E+01_EB, .148E+01_EB, .125E+01_EB,          &
.136E+01_EB, .128E+01_EB, .128E+01_EB, .135E+01_EB, .138E+01_EB, .134E+01_EB,          &
.210E+00_EB, .780E+00_EB, .127E+01_EB, .133E+01_EB, .137E+01_EB, .132E+01_EB,          &
.190E+00_EB, .780E+00_EB, .140E+01_EB, .146E+01_EB, .147E+01_EB, .142E+01_EB,         & 
.900E+00_EB, .106E+01_EB, .140E+01_EB, .150E+01_EB, .155E+01_EB, .134E+01_EB,        &  
.720E-01_EB, .300E+00_EB, .800E+00_EB, .100E+01_EB, .115E+01_EB, .126E+01_EB,       &   
.640E-01_EB, .210E+00_EB, .560E+00_EB, .720E+00_EB, .860E+00_EB, .102E+01_EB,      &    
.680E-01_EB, .210E+00_EB, .530E+00_EB, .670E+00_EB, .790E+00_EB, .101E+01_EB/),   &     
(/6,8/))
SD15(1:6,49:56) = RESHAPE ((/ & ! 740-775
.690E-01_EB, .210E+00_EB, .540E+00_EB, .690E+00_EB, .820E+00_EB, .910E+00_EB,          &
.330E-01_EB, .140E+00_EB, .390E+00_EB, .530E+00_EB, .690E+00_EB, .770E+00_EB,          &
.230E-01_EB, .780E-01_EB, .270E+00_EB, .410E+00_EB, .560E+00_EB, .890E+00_EB,          &
.300E-01_EB, .860E-01_EB, .280E+00_EB, .400E+00_EB, .520E+00_EB, .710E+00_EB,         & 
.175E-01_EB, .620E-01_EB, .225E+00_EB, .335E+00_EB, .450E+00_EB, .660E+00_EB,       &   
.105E-01_EB, .450E-01_EB, .180E+00_EB, .280E+00_EB, .380E+00_EB, .600E+00_EB,      &    
.450E-02_EB, .300E-01_EB, .148E+00_EB, .240E+00_EB, .345E+00_EB, .570E+00_EB,     &     
.000E+00_EB, .140E-01_EB, .124E+00_EB, .205E+00_EB, .285E+00_EB, .430E+00_EB/),  &      
(/6,8/))
SD15(1:6,57:64) = RESHAPE ((/ & ! 780-815
.000E+00_EB, .115E-01_EB, .110E+00_EB, .185E+00_EB, .260E+00_EB, .375E+00_EB,          &
.000E+00_EB, .135E-01_EB, .840E-01_EB, .140E+00_EB, .205E+00_EB, .335E+00_EB,         & 
.000E+00_EB, .430E-02_EB, .650E-01_EB, .120E+00_EB, .185E+00_EB, .325E+00_EB,        &  
.000E+00_EB, .000E+00_EB, .540E-01_EB, .115E+00_EB, .180E+00_EB, .315E+00_EB,       &   
.000E+00_EB, .000E+00_EB, .440E-01_EB, .950E-01_EB, .150E+00_EB, .270E+00_EB,      &    
.000E+00_EB, .000E+00_EB, .360E-01_EB, .790E-01_EB, .125E+00_EB, .205E+00_EB,     &     
.000E+00_EB, .000E+00_EB, .250E-01_EB, .650E-01_EB, .110E+00_EB, .178E+00_EB,    &      
.000E+00_EB, .000E+00_EB, .180E-01_EB, .620E-01_EB, .103E+00_EB, .153E+00_EB/), &       
(/6,8/))
SD15(1:6,65:72) = RESHAPE ((/ & ! 820-855
.000E+00_EB, .000E+00_EB, .320E-01_EB, .580E-01_EB, .860E-01_EB, .147E+00_EB,          &
.000E+00_EB, .000E+00_EB, .800E-02_EB, .510E-01_EB, .870E-01_EB, .134E+00_EB,          &
.000E+00_EB, .000E+00_EB, .600E-02_EB, .480E-01_EB, .830E-01_EB, .133E+00_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .430E-01_EB, .780E-01_EB, .118E+00_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .420E-01_EB, .700E-01_EB, .108E+00_EB,         & 
.000E+00_EB, .000E+00_EB, .000E+00_EB, .360E-01_EB, .640E-01_EB, .980E-01_EB,        &  
.000E+00_EB, .000E+00_EB, .000E+00_EB, .350E-01_EB, .610E-01_EB, .870E-01_EB,       &   
.000E+00_EB, .000E+00_EB, .000E+00_EB, .320E-01_EB, .580E-01_EB, .860E-01_EB/),    &    
(/6,8/))
SD15(1:6,73:80) = RESHAPE ((/ & ! 860-880
.000E+00_EB, .000E+00_EB, .000E+00_EB, .330E-01_EB, .560E-01_EB, .750E-01_EB,     &     
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .530E-01_EB, .750E-01_EB,    &      
.000E+00_EB, .000E+00_EB, .000E+00_EB, .290E-01_EB, .530E-01_EB, .850E-01_EB,   &       
.000E+00_EB, .000E+00_EB, .000E+00_EB, .240E-01_EB, .470E-01_EB, .900E-01_EB,  &        
.000E+00_EB, .000E+00_EB, .000E+00_EB, .220E-01_EB, .450E-01_EB, .860E-01_EB, &         
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB,&
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB,&
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB/), &
(/6,8/))

! Initialize SD7 Array

!   THE FOLLOWING DATA ARE FOR THE 7.7 MICRON BAND OF CH4
! TEMP,K= 290 600   850

SD7(1:3,1:8) = RESHAPE ((/ &
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.22_EB,&
0.16_EB, 0.20_EB, 0.47_EB,&
0.34_EB, 0.34_EB, 0.62_EB,&
0.69_EB, 0.53_EB, 0.65_EB,&
1.27_EB, 0.88_EB, 1.09_EB,&
1.68_EB, 1.38_EB, 0.87_EB/),(/3,8/))
SD7(1:3,9:16) = RESHAPE ((/&
0.55_EB, 0.28_EB, 0.40_EB,&
1.25_EB, 0.86_EB, 0.93_EB,&
0.34_EB, 0.59_EB, 0.75_EB,&
0._EB, 0.13_EB, 0.25_EB,&
0._EB, 0._EB, 0.06_EB,&
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0._EB/),(/3,8/))

! Initialize SD3 Array

!  THE FOLLOWING DATA ARE FOR THE 3.3 MICRON BAND OF CH4
! TEMP, K= 290  600   850
SD3(1:3,1:8) = RESHAPE ((/&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.06_EB,&
0.03_EB, 0.03_EB, 0.09_EB,&
0.07_EB, 0.07_EB, 0.12_EB,&
0.09_EB, 0.09_EB, 0.12_EB,&
0.14_EB, 0.15_EB, 0.22_EB/),(/3,8/))
SD3(1:3,9:16) = RESHAPE ((/&
0.18_EB, 0.22_EB, 0.28_EB,&
0.24_EB, 0.31_EB, 0.37_EB,&
0.33_EB, 0.44_EB, 0.47_EB,&
0.45_EB, 0.50_EB, 0.53_EB,&
0.59_EB, 0.62_EB, 0.62_EB,&
0.74_EB, 0.70_EB, 0.68_EB,&
0.91_EB, 0.77_EB, 0.72_EB,&
1.00_EB, 0.81_EB, 0.75_EB/),(/3,8/))
SD3(1:3,17:24) = RESHAPE ((/&
1.03_EB, 0.84_EB, 0.78_EB,&
1.03_EB, 0.84_EB, 0.78_EB,&
1.00_EB, 0.81_EB, 0.75_EB,&
0.94_EB, 0.77_EB, 0.72_EB,&
0.72_EB, 0.68_EB, 0.68_EB,&
0.52_EB, 0.63_EB, 0.63_EB,&
0.33_EB, 0.50_EB, 0.56_EB,&
0.25_EB, 0.42_EB, 0.50_EB/),(/3,8/))
SD3(1:3,25:32) = RESHAPE ((/&
0.17_EB, 0.26_EB, 0.37_EB,&
0.08_EB, 0.18_EB, 0.31_EB,&
0.04_EB, 0.11_EB, 0.22_EB,&
0._EB, 0.06_EB, 0.16_EB,&
0._EB, 0.02_EB, 0.12_EB,&
0._EB, 0._EB, 0.06_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0._EB/),(/3,8/))
!------------------------------------------------------------------------------
END SUBROUTINE RCALLOC

!==============================================================================
SUBROUTINE RCDEALLOC
!==============================================================================   
DEALLOCATE(P)
DEALLOCATE(SPECIE)
DEALLOCATE(QW)
DEALLOCATE(TTAU)
DEALLOCATE(XT)
DEALLOCATE(X)
DEALLOCATE(GC)
DEALLOCATE(LAMBDA)
DEALLOCATE(OPTICAL_THICKNESS)
DEALLOCATE(AB)
DEALLOCATE(ATOT)
DEALLOCATE(BCNT)
DEALLOCATE(GAMMA)
DEALLOCATE(SD15)
DEALLOCATE(SD)
DEALLOCATE(SD7)
DEALLOCATE(SD3)

!-------------------------DEALLOCATION Methane VARIABLES-------------------
DEALLOCATE(SD_CH4_TEMP)
DEALLOCATE(OM_BND_CH4)
DEALLOCATE(SD1_CH4)
DEALLOCATE(SD2_CH4)

!-------------------------DEALLOCATION Propane VARIABLES-------------------
DEALLOCATE(SD_C3H8_TEMP)
DEALLOCATE(Be_C3H8)
DEALLOCATE(OM_BND_C3H8)
DEALLOCATE(SD1_C3H8)
DEALLOCATE(SD2_C3H8)
DEALLOCATE(GAMMAD1_C3H8)
DEALLOCATE(GAMMAD2_C3H8)

!-------------------------DEALLOCATION Methanol VARIABLES-------------------
DEALLOCATE(SD_CH3OH_TEMP)
DEALLOCATE(Be_CH3OH)
DEALLOCATE(OM_BND_CH3OH)
DEALLOCATE(SD1_CH3OH)
DEALLOCATE(SD2_CH3OH)
DEALLOCATE(SD3_CH3OH)
DEALLOCATE(SD4_CH3OH)
DEALLOCATE(GAMMAD1_CH3OH)
DEALLOCATE(GAMMAD2_CH3OH)
DEALLOCATE(GAMMAD3_CH3OH)
DEALLOCATE(GAMMAD4_CH3OH)

!-------------------------DEALLOCATION Heptane VARIABLES-------------------
DEALLOCATE(SD_C7H16_TEMP)
DEALLOCATE(Be_C7H16)
DEALLOCATE(OM_BND_C7H16)
DEALLOCATE(SD1_C7H16)
DEALLOCATE(SD2_C7H16)
DEALLOCATE(GAMMAD1_C7H16)
DEALLOCATE(GAMMAD2_C7H16)

!-------------------------DEALLOCATION Toluene VARIABLES-------------------
DEALLOCATE(SD_C7H8_TEMP)
DEALLOCATE(Be_C7H8)
DEALLOCATE(OM_BND_C7H8)
DEALLOCATE(SD1_C7H8)
DEALLOCATE(SD2_C7H8)
DEALLOCATE(SD3_C7H8)
DEALLOCATE(SD4_C7H8)
DEALLOCATE(SD5_C7H8)
DEALLOCATE(GAMMAD1_C7H8)
DEALLOCATE(GAMMAD2_C7H8)
DEALLOCATE(GAMMAD3_C7H8)
DEALLOCATE(GAMMAD4_C7H8)
DEALLOCATE(GAMMAD5_C7H8)

!-------------------------DEALLOCATION Propylene VARIABLES-------------------
DEALLOCATE(SD_C3H6_TEMP)
DEALLOCATE(Be_C3H6)
DEALLOCATE(OM_BND_C3H6)
DEALLOCATE(SD1_C3H6)
DEALLOCATE(SD2_C3H6)
DEALLOCATE(SD3_C3H6)
DEALLOCATE(GAMMAD1_C3H6)
DEALLOCATE(GAMMAD2_C3H6)
DEALLOCATE(GAMMAD3_C3H6)

!-------------------------DEALLOCATION MMA VARIABLES-------------------
DEALLOCATE(SD_C5H8O2_TEMP)
DEALLOCATE(Be_C5H8O2)
DEALLOCATE(OM_BND_C5H8O2)
DEALLOCATE(SD1_C5H8O2)
DEALLOCATE(SD2_C5H8O2)
DEALLOCATE(SD3_C5H8O2)
DEALLOCATE(SD4_C5H8O2)
DEALLOCATE(SD5_C5H8O2)
DEALLOCATE(SD6_C5H8O2)
DEALLOCATE(GAMMAD1_C5H8O2)
DEALLOCATE(GAMMAD2_C5H8O2)
DEALLOCATE(GAMMAD3_C5H8O2)
DEALLOCATE(GAMMAD4_C5H8O2)
DEALLOCATE(GAMMAD5_C5H8O2)
DEALLOCATE(GAMMAD6_C5H8O2)

!-------------------------DEALLOCATION Ethane VARIABLES-------------------
DEALLOCATE(SD_C2H6_TEMP)
DEALLOCATE(Be_C2H6)
DEALLOCATE(OM_BND_C2H6)
DEALLOCATE(SD1_C2H6)
DEALLOCATE(SD2_C2H6)
DEALLOCATE(SD3_C2H6)
DEALLOCATE(GAMMAD1_C2H6)
DEALLOCATE(GAMMAD2_C2H6)
DEALLOCATE(GAMMAD3_C2H6)

!-------------------------DEALLOCATION Ethylene VARIABLES-------------------
DEALLOCATE(SD_C2H4_TEMP)
DEALLOCATE(Be_C2H4)
DEALLOCATE(OM_BND_C2H4)
DEALLOCATE(SD1_C2H4)
DEALLOCATE(SD2_C2H4)
DEALLOCATE(SD3_C2H4)
DEALLOCATE(SD4_C2H4)
DEALLOCATE(GAMMAD1_C2H4)
DEALLOCATE(GAMMAD2_C2H4)
DEALLOCATE(GAMMAD3_C2H4)
DEALLOCATE(GAMMAD4_C2H4)

!------------------------------------------------------------------------------   
END SUBROUTINE RCDEALLOC

!------------------------------------------------------------------------------
END MODULE RADCALV



MODULE SPECDATA

USE PRECISION_PARAMETERS
IMPLICIT NONE
INTEGER ::  I,J
INTEGER, PARAMETER :: NWATERK=183
REAL(EB) :: CPLXREF_WATER(NWATERK,2)
INTEGER, PARAMETER :: NFUELK=94
REAL(EB) :: CPLXREF_FUEL(NFUELK,3)

! Hale, G.M. and Querry, M.R., "Optical Constants of Water in the 200-nm to 200-\mu m Wavelength Region", 
! Applied Optics, 12(3), 555-63 (1973)

DATA ((CPLXREF_WATER(I,J), J = 1,2), I = 1,10)  &
/ 1.0000000E-6_EB,  2.8647890E-6_EB,&
1.0200000E-6_EB,  2.1915636E-6_EB,&
1.0400000E-6_EB,  1.3241691E-6_EB,&
1.0600000E-6_EB,  1.0122254E-6_EB,&
1.0800000E-6_EB,  1.1172677E-6_EB,&
1.1000000E-6_EB,  1.4880987E-6_EB,&
1.1200000E-6_EB,  4.6345919E-6_EB,&
1.1400000E-6_EB,  5.9874090E-6_EB,&
1.1600000E-6_EB,  8.2155782E-6_EB,&
1.1800000E-6_EB,  9.7657473E-6_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =11,20)  &
/ 1.2000000E-6_EB,  9.9312684E-6_EB,&
1.2200000E-6_EB,  9.2230290E-6_EB,&
1.2400000E-6_EB,  8.6834937E-6_EB,&
1.2600000E-6_EB,  8.9238177E-6_EB,&
1.2800000E-6_EB,  9.9821980E-6_EB,&
1.3000000E-6_EB,  1.1483029E-5_EB,&
1.3200000E-6_EB,  1.1953809E-5_EB,&
1.3400000E-6_EB,  1.2614780E-5_EB,&
1.3600000E-6_EB,  2.9978533E-5_EB,&
1.3800000E-6_EB,  6.6988316E-5_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =21,30)  &
/ 1.4000000E-6_EB,  1.3803508E-4_EB,&
1.4200000E-6_EB,  2.4995602E-4_EB,&
1.4400000E-6_EB,  3.3002369E-4_EB,&
1.4600000E-6_EB,  3.2996003E-4_EB,&
1.4800000E-6_EB,  2.5003560E-4_EB,&
1.5000000E-6_EB,  2.0996516E-4_EB,&
1.5200000E-6_EB,  1.6994565E-4_EB,&
1.5400000E-6_EB,  1.4497583E-4_EB,&
1.5600000E-6_EB,  1.2004433E-4_EB,&
1.5800000E-6_EB,  9.9957388E-5_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =31,40)  &
/ 1.6000000E-6_EB,  8.5561825E-5_EB,&
1.6200000E-6_EB,  7.5028952E-5_EB,&
1.6400000E-6_EB,  6.4992643E-5_EB,&
1.6600000E-6_EB,  5.9972898E-5_EB,&
1.6800000E-6_EB,  6.0027012E-5_EB,&
1.7000000E-6_EB,  6.0065211E-5_EB,&
1.7200000E-6_EB,  6.9942231E-5_EB,&
1.7400000E-6_EB,  8.5017388E-5_EB,&
1.7600000E-6_EB,  1.0000023E-4_EB,&
1.7800000E-6_EB,  1.1501809E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =41,50)  &
/ 1.8000000E-6_EB,  1.1502128E-4_EB,&
1.8200000E-6_EB,  1.3005838E-4_EB,&
1.8400000E-6_EB,  1.4993669E-4_EB,&
1.8600000E-6_EB,  2.1003200E-4_EB,&
1.8800000E-6_EB,  4.6497435E-4_EB,&
1.9000000E-6_EB,  1.0000183E-3_EB,&
1.9200000E-6_EB,  1.7500423E-3_EB,&
1.9400000E-6_EB,  1.8499391E-3_EB,&
1.9600000E-6_EB,  1.6500261E-3_EB,&
1.9800000E-6_EB,  1.4500559E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =51,60)  &
/ 2.0000000E-6_EB,  1.1000790E-3_EB,&
2.0200000E-6_EB,  9.0001961E-4_EB,&
2.0400000E-6_EB,  7.3003417E-4_EB,&
2.0600000E-6_EB,  6.3998112E-4_EB,&
2.0800000E-6_EB,  5.2006742E-4_EB,&
2.1000000E-6_EB,  4.5003447E-4_EB,&
2.1200000E-6_EB,  4.0505888E-4_EB,&
2.1400000E-6_EB,  3.4995785E-4_EB,&
2.1600000E-6_EB,  3.2005422E-4_EB,&
2.1800000E-6_EB,  2.9994500E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =61,70)  &
/ 2.2000000E-6_EB,  2.8904129E-4_EB,&
2.2200000E-6_EB,  2.8495578E-4_EB,&
2.2400000E-6_EB,  2.9500960E-4_EB,&
2.2600000E-6_EB,  3.1005293E-4_EB,&
2.2800000E-6_EB,  3.5997028E-4_EB,&
2.3000000E-6_EB,  4.0998313E-4_EB,&
2.3200000E-6_EB,  4.9496551E-4_EB,&
2.3400000E-6_EB,  5.9494505E-4_EB,&
2.3600000E-6_EB,  6.9994116E-4_EB,&
2.3800000E-6_EB,  8.2007768E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =71,80)  &
/ 2.4000000E-6_EB,  9.5607557E-4_EB,&
2.4200000E-6_EB,  1.1500727E-3_EB,&
2.4400000E-6_EB,  1.2999617E-3_EB,&
2.4600000E-6_EB,  1.4999176E-3_EB,&
2.4800000E-6_EB,  1.6999912E-3_EB,&
2.5000000E-6_EB,  1.8000424E-3_EB,&
2.5200000E-6_EB,  2.0500716E-3_EB,&
2.5400000E-6_EB,  2.1999478E-3_EB,&
2.5600000E-6_EB,  2.3500946E-3_EB,&
2.5800000E-6_EB,  2.7000302E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =81,90)  &
/ 2.6000000E-6_EB,  3.1699367E-3_EB,&
2.6500000E-6_EB,  6.7000889E-3_EB,&
2.7000000E-6_EB,  1.8999997E-2_EB,&
2.7500000E-6_EB,  5.9000926E-2_EB,&
2.8000000E-6_EB,  1.1500027E-1_EB,&
2.8500000E-6_EB,  1.8499960E-1_EB,&
2.9000000E-6_EB,  2.6769861E-1_EB,&
2.9500000E-6_EB,  2.9813700E-1_EB,&
3.0000000E-6_EB,  2.7215495E-1_EB,&
3.0500000E-6_EB,  2.4000020E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =91,100)  &
/ 3.1000000E-6_EB,  1.9200142E-1_EB,&
3.1500000E-6_EB,  1.3500032E-1_EB,&
3.2000000E-6_EB,  9.2401540E-2_EB,&
3.2500000E-6_EB,  6.0999713E-2_EB,&
3.3000000E-6_EB,  3.6798931E-2_EB,&
3.3500000E-6_EB,  2.6099958E-2_EB,&
3.4000000E-6_EB,  1.9500046E-2_EB,&
3.4500000E-6_EB,  1.3199993E-2_EB,&
3.5000000E-6_EB,  9.4000888E-3_EB,&
3.6000000E-6_EB,  5.1500311E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =101,110)  &
/ 3.7000000E-6_EB,  3.6000769E-3_EB,&
3.8000000E-6_EB,  3.4001225E-3_EB,&
3.9000000E-6_EB,  3.7999516E-3_EB,&
4.0000000E-6_EB,  4.5998962E-3_EB,&
4.1000000E-6_EB,  5.6118033E-3_EB,&
4.2000000E-6_EB,  6.8850428E-3_EB,&
4.3000000E-6_EB,  8.4519233E-3_EB,&
4.4000000E-6_EB,  1.0294142E-2_EB,&
4.5000000E-6_EB,  1.3392888E-2_EB,&
4.6000000E-6_EB,  1.4715466E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =111,120)  &
/ 4.7000000E-6_EB,  1.5708593E-2_EB,&
4.8000000E-6_EB,  1.5011494E-2_EB,&
4.9000000E-6_EB,  1.3686529E-2_EB,&
5.0000000E-6_EB,  1.2414086E-2_EB,&
5.1000000E-6_EB,  1.1120156E-2_EB,&
5.2000000E-6_EB,  1.0096790E-2_EB,&
5.3000000E-6_EB,  9.7848459E-3_EB,&
5.4000000E-6_EB,  1.0313240E-2_EB,&
5.5000000E-6_EB,  1.1598416E-2_EB,&
5.6000000E-6_EB,  1.4215720E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =121,130)  &
/ 5.7000000E-6_EB,  2.0320903E-2_EB,&
5.8000000E-6_EB,  3.3000777E-2_EB,&
5.9000000E-6_EB,  6.2209688E-2_EB,&
6.0000000E-6_EB,  1.0699987E-1_EB,&
6.1000000E-6_EB,  1.3101555E-1_EB,&
6.2000000E-6_EB,  8.8019050E-2_EB,&
6.3000000E-6_EB,  5.7002139E-2_EB,&
6.4000000E-6_EB,  4.4868962E-2_EB,&
6.5000000E-6_EB,  3.9207820E-2_EB,&
6.6000000E-6_EB,  3.5609327E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =131,140)  &
/ 6.7000000E-6_EB,  3.3696285E-2_EB,&
6.8000000E-6_EB,  3.2684059E-2_EB,&
6.9000000E-6_EB,  3.2176355E-2_EB,&
7.0000000E-6_EB,  3.1974228E-2_EB,&
7.1000000E-6_EB,  3.1979003E-2_EB,&
7.2000000E-6_EB,  3.2085637E-2_EB,&
7.3000000E-6_EB,  3.2182721E-2_EB,&
7.4000000E-6_EB,  3.2388031E-2_EB,&
7.5000000E-6_EB,  3.2586975E-2_EB,&
7.6000000E-6_EB,  3.2779552E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =141,150)  &
/ 7.7000000E-6_EB,  3.3088313E-2_EB,&
7.8000000E-6_EB,  3.3518031E-2_EB,&
7.9000000E-6_EB,  3.3884883E-2_EB,&
8.0000000E-6_EB,  3.4313806E-2_EB,&
8.2000000E-6_EB,  3.5106397E-2_EB,&
8.4000000E-6_EB,  3.6096341E-2_EB,&
8.6000000E-6_EB,  3.1001791E-2_EB,&
8.8000000E-6_EB,  3.8515496E-2_EB,&
9.0000000E-6_EB,  3.9892186E-2_EB,&
9.2000000E-6_EB,  4.1510792E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =151,160)  &
/ 9.4000000E-6_EB,  4.3310835E-2_EB,&
9.6000000E-6_EB,  4.5378257E-2_EB,&
9.8000000E-6_EB,  4.7883356E-2_EB,&
1.0000000E-5_EB,  5.0770427E-2_EB,&
1.0500000E-5_EB,  6.6176625E-2_EB,&
1.1000000E-5_EB,  9.6813952E-2_EB,&
1.1500000E-5_EB,  1.4202987E-1_EB,&
1.2000000E-5_EB,  1.9900734E-1_EB,&
1.2500000E-5_EB,  2.5902467E-1_EB,&
1.3000000E-5_EB,  3.0497270E-1_EB / 
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =161,170)  &
/ 1.3500000E-5_EB,  3.4302267E-1_EB,&
1.4000000E-5_EB,  3.6998750E-1_EB,&
1.4500000E-5_EB,  3.8804760E-1_EB,&
1.5000000E-5_EB,  4.0202539E-1_EB,&
1.5500000E-5_EB,  4.1394609E-1_EB,&
1.6000000E-5_EB,  4.2195159E-1_EB,&
1.6500000E-5_EB,  4.2804722E-1_EB,&
1.7000000E-5_EB,  4.2897828E-1_EB,&
1.7500000E-5_EB,  4.2906183E-1_EB,&
1.8000000E-5_EB,  4.2599412E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =171,180)  &
/ 1.8500000E-5_EB,  4.2104440E-1_EB,&
1.9000000E-5_EB,  4.1397792E-1_EB,&
1.9500000E-5_EB,  4.0407849E-1_EB,&
2.0000000E-5_EB,  3.9295355E-1_EB,&
3.0000000E-5_EB,  3.2801834E-1_EB,&
3.8000000E-5_EB,  3.6105890E-1_EB,&
5.0000000E-5_EB,  5.1407047E-1_EB,&
6.0000000E-5_EB,  5.8680428E-1_EB,&
7.0000000E-5_EB,  5.7598174E-1_EB,&
8.0000000E-5_EB,  5.4685638E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =181,NWATERK)  &
/ 9.0000000E-5_EB,  5.3571554E-1_EB,&
1.0000000E-4_EB,  5.3237328E-1_EB,&
2.0000000E-4_EB,  5.0452117E-1_EB /

! Heptane properties from
! L.A. Dombrovsky, S.S. Sazhin, S.V. Mikhalovsky, R. Wood, M.R. Heikal
! Spectral properties of diesel fuel PARTICLEs
! Fuel, Vol. 82, No. 1 (2003) pp. 15-22
DATA (CPLXREF_FUEL( 1,J), J=1,3) / 0.7_EB,   1.47_EB, 1.55E-07_EB /
DATA (CPLXREF_FUEL( 2,J), J=1,3) / 0.8_EB,   1.47_EB, 4.33E-07_EB /
DATA (CPLXREF_FUEL( 3,J), J=1,3) / 0.9_EB,   1.47_EB, 9.39E-07_EB /
DATA (CPLXREF_FUEL( 4,J), J=1,3) / 1.0_EB,   1.47_EB, 8.81E-07_EB /
DATA (CPLXREF_FUEL( 5,J), J=1,3) / 1.1_EB,   1.47_EB, 1.19E-06_EB /
DATA (CPLXREF_FUEL( 6,J), J=1,3) / 1.2_EB,   1.47_EB, 2.63E-06_EB /
DATA (CPLXREF_FUEL( 7,J), J=1,3) / 1.3_EB,   1.47_EB, 1.08E-05_EB /
DATA (CPLXREF_FUEL( 8,J), J=1,3) / 1.4_EB,   1.47_EB, 2.24E-05_EB /
DATA (CPLXREF_FUEL( 9,J), J=1,3) / 1.5_EB,   1.46_EB, 3.41E-05_EB /
DATA (CPLXREF_FUEL( 10,J), J=1,3) / 1.6_EB,  1.46_EB, 4.57E-05_EB /
DATA (CPLXREF_FUEL( 11,J), J=1,3) / 1.7_EB,  1.46_EB, 5.73E-05_EB /
DATA (CPLXREF_FUEL( 12,J), J=1,3) / 1.8_EB,  1.46_EB, 6.90E-05_EB /
DATA (CPLXREF_FUEL( 13,J), J=1,3) / 1.9_EB,  1.46_EB, 8.06E-05_EB /
DATA (CPLXREF_FUEL( 14,J), J=1,3) / 2.0_EB,  1.46_EB, 9.22E-05_EB /
DATA (CPLXREF_FUEL( 15,J), J=1,3) / 2.1_EB,  1.46_EB, 1.04E-04_EB /
DATA (CPLXREF_FUEL( 16,J), J=1,3) / 2.2_EB,  1.46_EB, 1.15E-04_EB /
DATA (CPLXREF_FUEL( 17,J), J=1,3) / 2.3_EB,  1.46_EB, 1.27E-04_EB /
DATA (CPLXREF_FUEL( 18,J), J=1,3) / 2.4_EB,  1.45_EB, 1.39E-04_EB /
DATA (CPLXREF_FUEL( 19,J), J=1,3) / 2.5_EB,  1.45_EB, 1.50E-04_EB /
DATA (CPLXREF_FUEL( 20,J), J=1,3) / 2.6_EB,  1.45_EB, 1.62E-04_EB /
DATA (CPLXREF_FUEL( 21,J), J=1,3) / 2.7_EB,  1.45_EB, 1.11E-04_EB /
DATA (CPLXREF_FUEL( 22,J), J=1,3) / 2.8_EB,  1.44_EB, 5.92E-05_EB /
DATA (CPLXREF_FUEL( 23,J), J=1,3) / 2.9_EB,  1.44_EB, 7.45E-05_EB /
DATA (CPLXREF_FUEL( 24,J), J=1,3) / 3.0_EB,  1.43_EB, 9.72E-05_EB /
DATA (CPLXREF_FUEL( 25,J), J=1,3) / 3.1_EB,  1.42_EB, 3.12E-04_EB /
DATA (CPLXREF_FUEL( 26,J), J=1,3) / 3.2_EB,  1.40_EB, 6.09E-04_EB /
DATA (CPLXREF_FUEL( 27,J), J=1,3) / 3.3_EB,  1.17_EB, 5.72E-02_EB /
DATA (CPLXREF_FUEL( 28,J), J=1,3) / 3.4_EB,  1.39_EB, 1.20E-01_EB /
DATA (CPLXREF_FUEL( 29,J), J=1,3) / 3.5_EB,  1.45_EB, 8.24E-02_EB /
DATA (CPLXREF_FUEL( 30,J), J=1,3) / 3.6_EB,  1.51_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 31,J), J=1,3) / 3.7_EB,  1.64_EB, 1.33E-03_EB /
DATA (CPLXREF_FUEL( 32,J), J=1,3) / 3.8_EB,  1.56_EB, 1.02E-03_EB /
DATA (CPLXREF_FUEL( 33,J), J=1,3) / 3.9_EB,  1.52_EB, 6.36E-04_EB /
DATA (CPLXREF_FUEL( 34,J), J=1,3) / 4.0_EB,  1.50_EB, 2.51E-04_EB /
DATA (CPLXREF_FUEL( 35,J), J=1,3) / 4.1_EB,  1.50_EB, 2.59E-04_EB /
DATA (CPLXREF_FUEL( 36,J), J=1,3) / 4.2_EB,  1.49_EB, 3.10E-04_EB /
DATA (CPLXREF_FUEL( 37,J), J=1,3) / 4.3_EB,  1.49_EB, 2.60E-04_EB /
DATA (CPLXREF_FUEL( 38,J), J=1,3) / 4.4_EB,  1.48_EB, 2.11E-04_EB /
DATA (CPLXREF_FUEL( 39,J), J=1,3) / 4.5_EB,  1.48_EB, 1.98E-04_EB /
DATA (CPLXREF_FUEL( 40,J), J=1,3) / 4.6_EB,  1.47_EB, 1.90E-04_EB /
DATA (CPLXREF_FUEL( 41,J), J=1,3) / 4.7_EB,  1.47_EB, 1.58E-04_EB /
DATA (CPLXREF_FUEL( 42,J), J=1,3) / 4.8_EB,  1.47_EB, 1.21E-04_EB /
DATA (CPLXREF_FUEL( 43,J), J=1,3) / 4.9_EB,  1.47_EB, 8.32E-05_EB /
DATA (CPLXREF_FUEL( 44,J), J=1,3) / 5.0_EB,  1.46_EB, 4.58E-05_EB /
DATA (CPLXREF_FUEL( 45,J), J=1,3) / 5.1_EB,  1.46_EB, 6.37E-05_EB /
DATA (CPLXREF_FUEL( 46,J), J=1,3) / 5.2_EB,  1.46_EB, 7.78E-05_EB /
DATA (CPLXREF_FUEL( 47,J), J=1,3) / 5.3_EB,  1.46_EB, 7.66E-05_EB /
DATA (CPLXREF_FUEL( 48,J), J=1,3) / 5.4_EB,  1.45_EB, 7.55E-05_EB /
DATA (CPLXREF_FUEL( 49,J), J=1,3) / 5.5_EB,  1.45_EB, 9.62E-05_EB /
DATA (CPLXREF_FUEL( 50,J), J=1,3) / 5.6_EB,  1.45_EB, 1.17E-04_EB /
DATA (CPLXREF_FUEL( 51,J), J=1,3) / 5.7_EB,  1.45_EB, 1.63E-04_EB /
DATA (CPLXREF_FUEL( 52,J), J=1,3) / 5.8_EB,  1.45_EB, 2.16E-04_EB /
DATA (CPLXREF_FUEL( 53,J), J=1,3) / 5.9_EB,  1.44_EB, 2.68E-04_EB /
DATA (CPLXREF_FUEL( 54,J), J=1,3) / 6.0_EB,  1.44_EB, 3.21E-04_EB /
DATA (CPLXREF_FUEL( 55,J), J=1,3) / 6.1_EB,  1.44_EB, 3.74E-04_EB /
DATA (CPLXREF_FUEL( 56,J), J=1,3) / 6.2_EB,  1.44_EB, 4.36E-04_EB /
DATA (CPLXREF_FUEL( 57,J), J=1,3) / 6.3_EB,  1.43_EB, 5.87E-04_EB /
DATA (CPLXREF_FUEL( 58,J), J=1,3) / 6.4_EB,  1.43_EB, 7.38E-04_EB /
DATA (CPLXREF_FUEL( 59,J), J=1,3) / 6.5_EB,  1.42_EB, 1.35E-03_EB /
DATA (CPLXREF_FUEL( 60,J), J=1,3) / 6.6_EB,  1.41_EB, 6.12E-03_EB /
DATA (CPLXREF_FUEL( 61,J), J=1,3) / 6.7_EB,  1.39_EB, 2.06E-02_EB /
DATA (CPLXREF_FUEL( 62,J), J=1,3) / 6.8_EB,  1.35_EB, 3.51E-02_EB /
DATA (CPLXREF_FUEL( 63,J), J=1,3) / 6.9_EB,  1.37_EB, 2.29E-02_EB /
DATA (CPLXREF_FUEL( 64,J), J=1,3) / 7.0_EB,  1.48_EB, 3.99E-03_EB /
DATA (CPLXREF_FUEL( 65,J), J=1,3) / 7.1_EB,  1.53_EB, 3.24E-03_EB /
DATA (CPLXREF_FUEL( 66,J), J=1,3) / 7.2_EB,  1.48_EB, 2.61E-03_EB /
DATA (CPLXREF_FUEL( 67,J), J=1,3) / 7.3_EB,  1.43_EB, 2.97E-03_EB /
DATA (CPLXREF_FUEL( 68,J), J=1,3) / 7.4_EB,  1.47_EB, 3.33E-03_EB /
DATA (CPLXREF_FUEL( 69,J), J=1,3) / 7.5_EB,  1.50_EB, 2.80E-03_EB /
DATA (CPLXREF_FUEL( 70,J), J=1,3) / 7.6_EB,  1.49_EB, 2.14E-03_EB /
DATA (CPLXREF_FUEL( 71,J), J=1,3) / 7.7_EB,  1.48_EB, 2.28E-03_EB /
DATA (CPLXREF_FUEL( 72,J), J=1,3) / 7.8_EB,  1.47_EB, 2.41E-03_EB /
DATA (CPLXREF_FUEL( 73,J), J=1,3) / 7.9_EB,  1.47_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 74,J), J=1,3) / 8.0_EB,  1.47_EB, 9.84E-04_EB /
DATA (CPLXREF_FUEL( 75,J), J=1,3) / 8.1_EB,  1.46_EB, 9.03E-04_EB /
DATA (CPLXREF_FUEL( 76,J), J=1,3) / 8.2_EB,  1.46_EB, 8.19E-04_EB /
DATA (CPLXREF_FUEL( 77,J), J=1,3) / 8.3_EB,  1.46_EB, 7.13E-04_EB /
DATA (CPLXREF_FUEL( 78,J), J=1,3) / 8.4_EB,  1.46_EB, 6.07E-04_EB /
DATA (CPLXREF_FUEL( 79,J), J=1,3) / 8.5_EB,  1.45_EB, 8.54E-04_EB /
DATA (CPLXREF_FUEL( 80,J), J=1,3) / 8.6_EB,  1.45_EB, 1.10E-03_EB /
DATA (CPLXREF_FUEL( 81,J), J=1,3) / 8.7_EB,  1.45_EB, 1.76E-03_EB /
DATA (CPLXREF_FUEL( 82,J), J=1,3) / 8.8_EB,  1.45_EB, 2.41E-03_EB /
DATA (CPLXREF_FUEL( 83,J), J=1,3) / 8.9_EB,  1.45_EB, 1.58E-03_EB /
DATA (CPLXREF_FUEL( 84,J), J=1,3) / 9.0_EB,  1.45_EB, 5.71E-04_EB /
DATA (CPLXREF_FUEL( 85,J), J=1,3) / 9.1_EB,  1.45_EB, 8.53E-04_EB /
DATA (CPLXREF_FUEL( 86,J), J=1,3) / 9.2_EB,  1.45_EB, 1.28E-03_EB /
DATA (CPLXREF_FUEL( 87,J), J=1,3) / 9.3_EB,  1.45_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 88,J), J=1,3) / 9.4_EB,  1.45_EB, 1.98E-03_EB /
DATA (CPLXREF_FUEL( 89,J), J=1,3) / 9.5_EB,  1.45_EB, 1.69E-03_EB /
DATA (CPLXREF_FUEL( 90,J), J=1,3) / 9.6_EB,  1.45_EB, 1.24E-03_EB /
DATA (CPLXREF_FUEL( 91,J), J=1,3) / 9.7_EB,  1.45_EB, 1.43E-03_EB /
DATA (CPLXREF_FUEL( 92,J), J=1,3) / 9.8_EB,  1.45_EB, 1.69E-03_EB /
DATA (CPLXREF_FUEL( 93,J), J=1,3) / 9.9_EB,  1.45_EB, 1.26E-03_EB /
DATA (CPLXREF_FUEL( 94,J), J=1,3) / 10.0_EB, 1.45_EB, 8.24E-04_EB /

END MODULE SPECDATA



MODULE MIEV

USE PRECISION_PARAMETERS
USE GLOBAL_CONSTANTS, ONLY: NUMBER_SPECTRAL_BANDS,NUMBER_RADIATION_ANGLES,LU_ERR
USE SPECDATA, ONLY: CPLXREF_WATER, NWATERK, CPLXREF_FUEL, NFUELK
USE RADCALV, ONLY: PLANCK
USE RADCONS
USE MEMORY_FUNCTIONS, ONLY : CHKMEMERR
USE MATH_FUNCTIONS, ONLY : INTERPOLATE1D

IMPLICIT NONE
REAL(EB), ALLOCATABLE :: RDMIE(:),  LMBDMIE(:),LMBDWGHT(:),REAL_REF_INDX(:),CMPLX_REF_INDX(:)
REAL(EB), ALLOCATABLE :: QSCA(:,:), QABS(:,:),  CHI_F(:,:)

PRIVATE 
PUBLIC MEAN_CROSS_SECTIONS

CONTAINS


SUBROUTINE MEAN_CROSS_SECTIONS(CLASS_NUMBER)

! This subroutine calculates the mean scattering and absorption
! coefficients for each radiation band and PARTICLE size group.

USE TYPES, ONLY: LAGRANGIAN_PARTICLE_CLASS_TYPE, LAGRANGIAN_PARTICLE_CLASS, TABLES_TYPE, TABLES
USE GLOBAL_CONSTANTS, ONLY: H2O_INDEX
USE MATH_FUNCTIONS, ONLY : INTERPOLATE1D
INTEGER  :: NSB,I,J,IBND,IZERO,NX,NLAMBDALOW(1),NLAMBDAHIGH(1),ND,CLASS_NUMBER,NL_DATA
REAL(EB) :: RMMAX,RMMIN,RDTMP,IB,IBSUM,AVAL,BVAL,ASUM,BSUM,B_WIEN
TYPE (LAGRANGIAN_PARTICLE_CLASS_TYPE), POINTER :: LPC=>NULL()
TYPE (TABLES_TYPE),  POINTER :: TA=>NULL()
 
LPC => LAGRANGIAN_PARTICLE_CLASS(CLASS_NUMBER) 
NSB = NUMBER_SPECTRAL_BANDS

! Physical parameters
! minimum mean radius (m)
RMMIN = 0.5_EB*1.E-6*MIE_MINIMUM_DIAMETER
IF (RMMIN < EPSILON_EB) RMMIN = 0.5E-6_EB   

! maximum mean radius (m)
RMMAX = 0.5_EB*1.E-6*MIE_MAXIMUM_DIAMETER
IF (RMMAX < EPSILON_EB) THEN  
   RMMAX = 0.5_EB*LPC%DIAMETER
   ! Allow increase of the mean radius
   RMMAX = 1.5_EB*RMMAX
ENDIF

! Other constants

B_WIEN = 2.8977685E-3_EB
 
! Calculate parameters of the PARTICLE group lookup table
 
DGROUP_A = (LOG(RMMAX)-LOG(RMMIN))/(MIE_NDG-1)
DGROUP_B = LOG(RMMAX)-DGROUP_A*MIE_NDG

! Generate the PARTICLE radii for mie table (microns)
 
RDTMP = 0.5_EB*RMMIN
NX = 0
DO WHILE (RDTMP < 2._EB*RMMAX) 
   NX = NX + 1
   RDTMP = RDTMP + MIN(1.0E6_EB,0.2_EB*RDTMP**(1._EB))
ENDDO
NRDMIE = NX 

ALLOCATE(RDMIE(1:NRDMIE),STAT=IZERO)
CALL ChkMemErr('MIEV','RDMIE',IZERO)

RDTMP = 0.5_EB*RMMIN
RDMIE(1) = RDTMP
DO NX = 2, NRDMIE
   RDTMP = RDTMP + MIN(3.0E6_EB,0.2_EB*RDTMP**(1.0_EB))
   RDMIE(NX) = RDTMP
ENDDO

! Radiative properties

NLMBDMIE = NWATERK
IF (LPC%RADIATIVE_PROPERTY_INDEX>0) THEN
   TA => TABLES(LPC%RADIATIVE_PROPERTY_INDEX)
   NL_DATA = TA%NUMBER_ROWS
ELSEIF (LPC%Y_INDEX==H2O_INDEX) THEN
   NL_DATA = NLMBDMIE
ELSEIF (LPC%FUEL) THEN
   NL_DATA = NFUELK
ELSE
   NL_DATA = 1
ENDIF

!     Allocate arrays

ALLOCATE(QSCA(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','QSCA',IZERO)
ALLOCATE(QABS(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','QABS',IZERO)
ALLOCATE(CHI_F(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','CHI_F',IZERO)
!
ALLOCATE(LMBDMIE(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','LMBDMIE',IZERO)
ALLOCATE(LMBDWGHT(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','LMBDWGHT',IZERO)
ALLOCATE(REAL_REF_INDX(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','REAL_REF_INDX',IZERO)
ALLOCATE(CMPLX_REF_INDX(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','CMPLX_REF_INDX',IZERO)

! Radiative properties

LMBDMIE(1:NLMBDMIE) = CPLXREF_WATER(1:NLMBDMIE,1)
IF (LPC%RADIATIVE_PROPERTY_INDEX > 0) THEN
   DO NX = 1,NLMBDMIE
      CALL INTERPOLATE1D(TA%TABLE_DATA(:,1)*1.0E-6_EB,TA%TABLE_DATA(:,2),LMBDMIE(NX),REAL_REF_INDX(NX))
      CALL INTERPOLATE1D(TA%TABLE_DATA(:,1)*1.0E-6_EB,TA%TABLE_DATA(:,3),LMBDMIE(NX),CMPLX_REF_INDX(NX))
   ENDDO
ELSEIF (LPC%Y_INDEX==H2O_INDEX) THEN
   REAL_REF_INDX              = 1.33_EB
   CMPLX_REF_INDX(1:NLMBDMIE) = CPLXREF_WATER(1:NLMBDMIE,2)
ELSEIF (LPC%FUEL) THEN
   DO NX = 1,NLMBDMIE
      CALL INTERPOLATE1D(CPLXREF_FUEL(:,1)*1.0E-6_EB,CPLXREF_FUEL(:,2),LMBDMIE(NX),REAL_REF_INDX(NX))
      CALL INTERPOLATE1D(CPLXREF_FUEL(:,1)*1.0E-6_EB,CPLXREF_FUEL(:,3),LMBDMIE(NX),CMPLX_REF_INDX(NX))
   ENDDO
ELSE
   REAL_REF_INDX              = LPC%REAL_REFRACTIVE_INDEX
   CMPLX_REF_INDX             = LPC%COMPLEX_REFRACTIVE_INDEX
ENDIF

CALL MIE_SCATTERING

!     Generate integration weights for lambda

IF (NLMBDMIE == 1) THEN
   LMBDWGHT(1) = 1._EB
ELSE
   LMBDWGHT(1) = 0.5_EB*(LMBDMIE(2)-LMBDMIE(1))
   DO I = 2, NLMBDMIE-1
      LMBDWGHT(I) = 0.5_EB*(LMBDMIE(I+1) - LMBDMIE(I-1))
   ENDDO
   LMBDWGHT(NLMBDMIE) = 0.5_EB*(LMBDMIE(NLMBDMIE)-LMBDMIE(NLMBDMIE-1))
ENDIF


!     Loop over all radiation bands

BANDLOOP: DO IBND = 1,NSB
   !
   IF (NSB == 1) THEN
      NLAMBDALOW = 1
      NLAMBDAHIGH = NLMBDMIE
   ELSE
      NLAMBDALOW  = MINLOC(LMBDMIE,MASK=LMBDMIE>=WL_LOW(IBND)*1.E-6)
      NLAMBDAHIGH = MAXLOC(LMBDMIE,MASK=LMBDMIE<=WL_HIGH(IBND)*1.0E-6)
   ENDIF

   !     Loop over all PARTICLE size groups


   DRGROUPLOOP: DO ND = 1, MIE_NDG

      LPC%R50(ND) = EXP(DGROUP_A*REAL(ND,EB) + DGROUP_B)

      !     Loop over wavelengths

      IBSUM = 0._EB

      DO J = NLAMBDALOW(1),NLAMBDAHIGH(1)
         IB = PLANCK(RADTMP, LMBDMIE(J)*1.0E6_EB)
         IBSUM = IBSUM + LMBDWGHT(J)*IB

         ASUM = 0._EB
         BSUM = 0._EB

         ! Properties at d32

         CALL INTERPOLATE1D(RDMIE,QSCA(:,J),LPC%R50(ND),AVAL)
         CALL INTERPOLATE1D(RDMIE,CHI_F(:,J),LPC%R50(ND),BVAL)
         BVAL = (1._EB-BVAL)
         ASUM = AVAL*BVAL
         CALL INTERPOLATE1D(RDMIE,QABS(:,J),LPC%R50(ND),BVAL)
         BSUM = BVAL

         LPC%WQSCA(ND,IBND) = LPC%WQSCA(ND,IBND) + ASUM*LMBDWGHT(J)*IB
         LPC%WQABS(ND,IBND) = LPC%WQABS(ND,IBND) + BSUM*LMBDWGHT(J)*IB
      ENDDO

      !     Normalize with blackbody radiation

      LPC%WQSCA(ND,IBND)  = LPC%WQSCA(ND,IBND)/IBSUM
      LPC%WQABS(ND,IBND)  = LPC%WQABS(ND,IBND)/IBSUM

ENDDO DRGROUPLOOP
ENDDO BANDLOOP

DEALLOCATE(RDMIE)
DEALLOCATE(QSCA)
DEALLOCATE(QABS)
DEALLOCATE(CHI_F)
DEALLOCATE(LMBDMIE)
DEALLOCATE(LMBDWGHT)
DEALLOCATE(REAL_REF_INDX)
DEALLOCATE(CMPLX_REF_INDX)

END SUBROUTINE MEAN_CROSS_SECTIONS



SUBROUTINE MIE_SCATTERING
!
!     Calculates the scattering and absorption cross sections
!     and calculates forward scattering fraction by integrating 
!     the scattering phase function.
!
! ----------------------------------------------------------------------
! -----------  SPECIFICATIONS FOR SUBROUTINE  MIEV0  ---------------
! ----------------------------------------------------------------------
INTEGER   MOMDIM
PARAMETER  ( MOMDIM = 200)
LOGICAL   ANYANG, PERFCT, PRNT( 2 )
INTEGER   IPOLZN, NMOM
REAL(EB)  GQSC, MIMCUT, PMOM( 0:MOMDIM, 4 ), SPIKE, QE, QS
REAL(EB), ALLOCATABLE :: XXX(:)
COMPLEX(EB) SFORW, SBACK, TFORW( 2 ), TBACK( 2 ), CREFIN
COMPLEX(EB), ALLOCATABLE :: S1(:), S2(:) 

! --------------- LOCAL VARIABLES --------------------------------------

INTEGER   I, J, K, NX, IZERO
INTEGER   NLAMBDA, NRA, NMIEANG2
REAL(EB)  STMP, AIJ, FTMP, XX_MAX
REAL(EB)  MUMIN1, MUMIN2,THETALIM1, THETALIM2, mudloc
REAL(EB)  mu1, mu2, nu1, nu2, mud0loc, mudPiloc, mud1, mud2, dmud 
REAL(EB),ALLOCATABLE :: XMU1(:), XNU1(:),XMU2(:), &
          ANGLE1(:), ANGLE2(:), MUD(:), MUDX(:),PWGHT(:), &
          PHSFUN(:), PFOR(:,:), MUD0(:,:), MUDPI(:,:)
! ----------------------------------------------------------------------

NRA    = NUMBER_RADIATION_ANGLES

!     MIEV-code variables

MIMCUT = 1.E-6_EB
PERFCT = .FALSE.
ANYANG = .TRUE.
!      IPOLZN = +1234
IPOLZN = 0
NMOM   = 0
PRNT   = .FALSE.

!     Limit for XX

XX_MAX = 15000.0_EB

!     Integration limits

THETALIM1 = ACOS(1._EB - 2._EB/REAL(NRA))
MUMIN1 = COS(THETALIM1)
MUMIN2 = MUMIN1**2-(1._EB-MUMIN1**2)
THETALIM2 = ACOS(MUMIN2)
NMIEANG2 = NMIEANG*2

!     Allocate local arrays

ALLOCATE(XXX(1:NRDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','XXX',IZERO)
ALLOCATE(S1(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','S1',IZERO)
ALLOCATE(S2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','S2',IZERO)
ALLOCATE(XMU1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','XMU1',IZERO)
ALLOCATE(XNU1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','XNU1',IZERO)
ALLOCATE(XMU2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','XMU2',IZERO)
ALLOCATE(MUD(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','MUD',IZERO)
ALLOCATE(MUDX(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','MUDX',IZERO)
ALLOCATE(PWGHT(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','PWGHT',IZERO)
ALLOCATE(ANGLE1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','ANGLE1',IZERO)
ALLOCATE(ANGLE2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','ANGLE2',IZERO)
ALLOCATE(PHSFUN(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','PHSFUN',IZERO)
ALLOCATE(PFOR(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','PFOR',IZERO)
ALLOCATE(MUD0(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','MUD0',IZERO)
ALLOCATE(MUDPI(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','MUDPI',IZERO)

!     Create solid angle integration arrays

DO I = 1,NMIEANG
   ANGLE1(I) = THETALIM1*REAL(I-1)/REAL(NMIEANG-1)
   ANGLE1(I) = ANGLE1(I)*(1._EB-0.99*REAL(NMIEANG-I)/REAL(NMIEANG))
ENDDO
DO I = 1,NMIEANG
   XMU1(NMIEANG-I+1) = COS(ANGLE1(I))
   XNU1(NMIEANG-I+1) = SIN(ANGLE1(I))
ENDDO

!    Create phase function ingtegration arrays

DO I = 1,NMIEANG2
   ANGLE2(I) = THETALIM2*REAL(I-1)/REAL(NMIEANG2-1)
   ANGLE2(I) = ANGLE2(I)*(1._EB-0.99*REAL(NMIEANG2-I)/REAL(NMIEANG2))
ENDDO
DO I = 1,NMIEANG2
   XMU2(NMIEANG2-I+1) = COS(ANGLE2(I))
ENDDO

!    Calculate phase function ingetration limits

DO J = 1,NMIEANG
   DO I = 1,NMIEANG
      MUD0(I,J)  = XMU1(I)*XMU1(J) + XNU1(I)*XNU1(J)
      MUDPI(I,J) = XMU1(I)*XMU1(J) - XNU1(I)*XNU1(J)
   ENDDO
ENDDO

!     Calculate phase function integration weights

mu1 = 0.7_EB
mu2 = 0.9_EB
nu1 = SQRT(1-mu1**2)
nu2 = SQRT(1-mu2**2)
mud0loc  = mu1*mu2 + nu1*nu2
mudPiloc = mu1*mu2 - nu1*nu2
mud1 = mudPiloc
mud2 = mud0loc
dmud = (mud2-mud1)/(NMIEANG2-1)
DO I = 1,NMIEANG2
   mud(I) = mud1+REAL(I-1)*dmud
ENDDO
mud(1)       = mud(1)       + 0.25_EB*dmud !empirical
mud(NMIEANG2) = mud(NMIEANG2) - 0.25_EB*dmud !empirical
DO I = 1,NMIEANG2
   MUDX(I) = (mud(I)-mud1)/(mud2-mud1)
ENDDO
DO I = 1,NMIEANG2
   PWGHT(I) = dmud/sqrt((nu1*nu2)**2-(mud(I)-mu1*mu2)**2)
ENDDO
PWGHT(2)         = 0.5_EB*PWGHT(2)
PWGHT(NMIEANG2-1) = 0.5_EB*PWGHT(NMIEANG2-1)

!     Loop over wavelength

LAMBDALOOP: DO NLAMBDA = 1, NLMBDMIE
!
   CREFIN = CMPLX( REAL_REF_INDX(NLAMBDA), CMPLX_REF_INDX(NLAMBDA) )

! Choose Perfectly reflecting sphere, if large real index is given.

   IF (REAL_REF_INDX(NLAMBDA) > 10._EB) PERFCT = .TRUE.

!     Loop over PARTICLE radius

   RADIUSLOOP: DO NX = 1, NRDMIE

      XXX(NX) = MIN(XX_MAX,2._EB*PI*RDMIE(NX)/LMBDMIE(NLAMBDA))
      CALL MIEV0( XXX(NX), CREFIN, PERFCT, MIMCUT, ANYANG,   &
                  NMIEANG2, XMU2, NMOM, IPOLZN, MOMDIM, PRNT,  &
                  QE, QS, GQSC, &
                  PMOM, SFORW, SBACK, S1, S2, TFORW, TBACK, SPIKE )

      QSCA(NX,NLAMBDA) = QS
      QABS(NX,NLAMBDA) = QE-QS

!     Calculate single drop phase function

      IF (ABS(QS)>TWO_EPSILON_EB) THEN
         DO I = 1,NMIEANG2
            PHSFUN(I) = 2._EB*(abs(S1(I))**2 + abs(S2(I))**2 )
         ENDDO
         PHSFUN = PHSFUN/(QS*XXX(NX)**2)
      ELSE
         PHSFUN = 1.0_EB
      ENDIF

!     Calculate the innermost integral of the forward scattering fraction

      PFOR = 0._EB
      DO J = 1,NMIEANG
         DO I = J,NMIEANG
            IF (ABS(MUD0(I,J)-MUDPI(I,J))<=TWO_EPSILON_EB) THEN
               CALL INTERPOLATE1D(XMU2,PHSFUN,MUD0(I,J),FTMP)
               PFOR(I,J) = PI*FTMP
            ELSE
               mud1 = MUDPI(I,J) 
               mud2 = MUD0(I,J)
               STMP = 0.0_EB
               DO K = 1,NMIEANG2
                  mudloc = mud1+MUDX(K)*(mud2-mud1)
                  CALL INTERPOLATE1D(XMU2,PHSFUN,mudloc,FTMP)
                  STMP = STMP + PWGHT(K)*FTMP
               ENDDO
               PFOR(I,J) = STMP 
            ENDIF
         ENDDO
      ENDDO

!     Calculate the two outer integrals of the forward fraction

      STMP = 0._EB
      DO J = 1,NMIEANG-1
         DO I = J+1,NMIEANG-1
            AIJ = (XMU1(I+1)-XMU1(I))*(XMU1(J+1)-XMU1(J))/2._EB
            STMP = STMP +   (2._EB*PFOR(I,J)+PFOR(I+1,J)+PFOR(I,J+1)+2._EB*PFOR(I+1,J+1))*AIJ/3._EB
         ENDDO
      ENDDO
      DO I = 1,NMIEANG-1
         AIJ = ((XMU1(I+1)-XMU1(I))**2)/2._EB
         STMP = STMP + (PFOR(I,I)+PFOR(I+1,I)+PFOR(I+1,I+1))*AIJ/3._EB
      ENDDO
      CHI_F(NX,NLAMBDA) = 2._EB*STMP/(4._EB*PI/NRA)      
   ENDDO RADIUSLOOP
ENDDO LAMBDALOOP

DEALLOCATE(XXX)
DEALLOCATE(S1)
DEALLOCATE(S2)
DEALLOCATE(XMU1)
DEALLOCATE(XNU1)
DEALLOCATE(XMU2)
DEALLOCATE(MUD)
DEALLOCATE(MUDX)
DEALLOCATE(PWGHT)
DEALLOCATE(ANGLE1)
DEALLOCATE(ANGLE2)
DEALLOCATE(PHSFUN)
DEALLOCATE(PFOR)
DEALLOCATE(MUD0)
DEALLOCATE(MUDPI)

END SUBROUTINE MIE_SCATTERING

SUBROUTINE MIEV0( XX, CREFIN, PERFCT, MIMCUT, ANYANG, NUMANG, XMU, &
                  NMOM, IPOLZN, MOMDIM, PRNT, QEXT, QSCA, GQSC, &
                  PMOM, SFORW, SBACK, S1, S2, TFORW, TBACK, &
                  SPIKE )

!     Mie scattering for a single PARTICLE and wavelength.
!     Author:  Dr. Warren J. Wiscombe (wiscombe@climate.gsfc.nasa.gov)
!         NASA Goddard Space Flight Center
!         Code 913
!         Greenbelt, MD 20771

!     REFERENCES
!     ----------
!
!     (1) Wiscombe, W., 1979: Mie Scattering Calculations--Advances
!         in Technique And Fast, Vector-Speed Computer Codes,
!         Ncar Tech Note TN-140+STR, National Center For
!         Atmospheric Research, Boulder, Colorado (out of print
!         but an updated electronic version available)
!
!     (2) Wiscombe, W., 1980: Improved Mie scattering algorithms,
!         Appl. Opt. 19, 1505-1509
!

!    Computes Mie scattering and extinction efficiencies; asymmetry
!    factor;  forward- and backscatter amplitude;  scattering
!    amplitudes vs. scattering angle for incident polarization parallel
!    and perpendicular to the plane of scattering;
!    coefficients in the Legendre polynomial expansions of either the
!    unpolarized phase function or the polarized phase matrix;
!    some quantities needed in polarized radiative transfer;  and
!    information about whether or not a resonance has been hit.
!
!    Input and output variables are described in file MIEV.doc. 
!    Many statements are accompanied by comments referring to 
!    references in MIEV.doc, notably the NCAR Mie report which is now
!    available electronically and which is referred to using the
!    shorthand (Rn), meaning Eq. (n) of the report.

!    CALLING TREE:
!
!        MIEV0
!            TESTMI
!                TSTBAD
!                MIPRNT
!                ERRMSG
!            CKINMI
!                WRTBAD
!                WRTDIM
!                ERRMSG
!            SMALL1
!            SMALL2
!            ERRMSG
!            BIGA
!                CONFRA
!                    ERRMSG
!            LPCOEF
!                LPCO1T
!                LPCO2T
!                ERRMSG
!            MIPRNT
!
!   I N P U T   V A R I A B L E S
!   -----------------------------
!
!  ( Even if an input variable is not needed for a particular
!    application, make sure it has a legitimate value that can
!    be written out and read in -- no indefinites, etc. )
!
!  XX        Mie size parameter ( 2 * pi * radius / wavelength )
!
!  CREFIN    Complex refractive index ( imag part can be + or -,
!            but internally a negative imaginary index is assumed ).
!            If imag part is - ,  scattering amplitudes as in Van
!            de Hulst are returned;  if imag part is + , complex
!            conjugates of those scattering amplitudes are returned
!            (the latter is the convention in physics).
!            ** NOTE ** In the 'PERFECT' case, scattering amplitudes
!            in the Van de Hulst (Ref. 6 above) convention will
!            automatically be returned unless  Im(CREFIN)  is
!            positive;  otherwise, CREFIN plays no role.
!
!  PERFCT    TRUE, assume refractive index is infinite and use
!            special case formulas for Mie coefficients  'a'
!            and  'b'  ( see Kerker, M., The Scattering of
!            Light and Other Electromagnetic Radiation, p. 90 ).
!            This is sometimes called the 'totally reflecting',
!            sometimes the 'perfectly conducting' case.
!            ( see CREFIN for additional information )
!
!  MIMCUT    (positive) value below which imaginary refractive
!            index is regarded as zero (computation proceeds
!            faster for zero imaginary index)
!
!  ANYANG    TRUE, any angles whatsoever may be input through
!            XMU.  FALSE, the angles are monotone increasing
!            and mirror symmetric about 90 degrees (this option
!            is advantageous because the scattering amplitudes
!            S1,S2 for the angles between 90 and 180 degrees
!            are evaluable from symmetry relations, and hence
!            are obtained with little added computational cost.)
!
!  NUMANG    No. of angles at which scattering amplitudes
!            S1,S2 are to be evaluated  ( set = 0 to skip
!            calculation of S1,S2 ).  Make sure NUMANG does
!            not exceed the parameter MAXANG in the program.
!
!  XMU(N)    Cosines of angles ( N = 1 TO NUMANG ) at which S1,S2
!            are to be evaluated.  If ANYANG = FALSE, then
!
!             (a) the angles must be monotone increasing and
!                 mirror symmetric about 90 degrees (if 90-A is
!                 an angle, then 90+A must be also)
!
!             (b) if NUMANG is odd, 90 degrees must be among
!                 the angles
!
!  NMOM       Highest Legendre moment PMOM to calculate,
!             numbering from zero ( NMOM = 0 prevents
!             calculation of PMOM )
!
!  IPOLZN     POSITIVE, Compute Legendre moments PMOM for the
!                       Mueller matrix elements determined by the
!                       digits of IPOLZN, with 1 referring to M1,
!                       2 to M2, 3 to S21, and 4 to D21 (Ref. 3).
!                       E.g., if IPOLZN = 14 then only moments for
!                       M1 and D21 will be returned.
!
!             0,        Compute Legendre moments PMOM for the
!                       unpolarized unnormalized phase function.
!
!             NEGATIVE, Compute Legendre moments PMOM for the
!                       Sekera phase quantities determined by the
!                       digits of ABS(IPOLZN), with 1 referring to
!                       R1, 2 to R2, 3 to R3, and 4 to R4 (REF. 4).
!                       E.g., if IPOLZN = -14 then only moments for
!                       R1 and R4 will be returned.
!
!             ( NOT USED IF  NMOM = 0 )
!
!  MOMDIM     Determines first dimension of PMOM, which is dimensioned
!             internally as PMOM( 0:MOMDIM, * ) (second dimension must
!             be the larger of unity and the highest digit in
!             IPOLZN; if not, serious errors will occur).
!             Must be given a value, even if  NMOM = 0.  Minimum: 1.
!
!  PRT(L)     Print flags (LOGICAL).  L = 1  prints  S1,S2, their
!             squared absolute values, and degree of polarization,
!             provided NUMANG is non-zero.   L = 2  prints all
!             output variables other than  S1,S2.
!
!
! O U T P U T   V A R I A B L E S
! -------------------------------
!
!  QEXT      (REAL) extinction efficiency factor  ( Ref. 2, Eq. 1A )
!
!  QSCA      (REAL) scattering efficiency factor  ( Ref. 2, Eq. 1B )
!
!  GQSC      (REAL) asymmetry factor times scattering efficiency
!            ( Ref. 2, Eq. 1C )  ( allows calculation of radiation
!            pressure efficiency factor  QPR = QEXT - GQSC )
!
!  =====================================================================
!  ==== NOTE --  S1, S2, SFORW, SBACK, TFORW, AND TBACK are calculated
!  ====          internally for negative imaginary refractive index;
!  ====          for positive imaginary index, their complex conjugates
!  ====          are taken before they are returned, to correspond to
!  ====          customary usage in some parts of physics ( in parti-
!  ====          cular, in papers on CAM approximations to Mie theory ).
!  =====================================================================
!
!  S1(N),    (COMPLEX) Mie scattering amplitudes at angles specified
!  S2(N)     by XMU(N) ( N=1 to NUMANG )  ( Ref. 2, Eqs. 1d-e ).
!
!  SFORW     (COMPLEX) forward-scattering amplitude S1 at
!            0 degrees.  ( S2(0 deg) = S1(0 deg) )
!
!  SBACK     (COMPLEX) backscattering amplitude S1 at
!            180 degrees.   ( S2(180 deg) = - S1(180 deg) )
!
!  TFORW(I)  (COMPLEX) values of
!
!                I=1:  T1 = ( S2 - (MU)*S1 ) / ( 1 - MU**2 )
!                I=2:  T2 = ( S1 - (MU)*S2 ) / ( 1 - MU**2 )
!
!            At angle theta = 0 ( MU = COS(theta) = 1 ), where the
!            expressions on the right-hand side are indeterminate.
!            ( these quantities are required for doing polarized
!            radiative transfer (Ref. 4, Appendix). )
!  TBACK(I)  (COMPLEX) values of  T1 (for I=1) or  T2 (for I=2) at
!            angle  theta = 180 degrees ( MU = COS(theta) = - 1 ).
!
!  SPIKE     (REAL) magnitude of the smallest denominator of
!            either Mie coefficient (a-sub-n or b-sub-n),
!            taken over all terms in the Mie series past
!            N = size parameter XX.  Values of SPIKE below
!            about 0.3 signify a ripple spike, since these
!            spikes are produced by abnormally small denominators
!            in the Mie coefficients (normal denominators are of
!            order unity or higher).  Defaults to 1.0 when not
!            on a spike.  Does not identify all resonances
!            (we are still working on that).
!
! PMOM(M,NP) (REAL) moments  M = 0 to NMOM  of unnormalized NP-th
!            phase quantity PQ  ( moments with  M > 2*NTRM  are
!            zero, where  NTRM = no. terms in Mie series =
!            XX + 4*XX**1/3 + 1 ) :
!
!              PQ( MU, NP ) = sum( M=0 to infinity ) ( (2M+1)
!                                * PMOM( M,NP ) * P-sub-M( MU ) )
!
!            WHERE  MU = COS( scattering angle )
!                   P-sub-M = M-th Legendre polynomial
!
!            and the definition of 'PQ' is as follows:
!
!            IPOLZN>0:  PQ(MU,1) = CABS( S1(MU) )**2
!                          PQ(MU,2) = CABS( S2(MU) )**2
!                          PQ(MU,3) = RE( S1(MU)*CONJG( S2(MU) ) )
!                          PQ(MU,4) = - IM( S1(MU)*CONJG( S2(MU) ) )
!                          ( called M1, M2, S21, D21 in literature )
!
!            IPOLZN=0:  PQ(MU,1) = ( CABS(S1)**2 + CABS(S2)**2 ) / 2
!                       ( the unnormalized phase function )
!
!            IPOLZN<0:  PQ(MU,1) = CABS( T1(MU) )**2
!                          PQ(MU,2) = CABS( T2(MU) )**2
!                          PQ(MU,3) = RE( T1(MU)*CONJG( T2(MU) ) )
!                          PQ(MU,4) = - IM( T1(MU)*CONJG( T2(MU) ) )
!                          ( called R1, R2, R3, R4 in literature )
!
!            The sign of the 4th phase quantity is a source of
!            confusion.  It flips if the complex conjugates of
!            S1,S2  or  T1,T2  are used, as occurs when a
!            refractive index with positive imaginary part is
!            used (see discussion below).  The definition above
!            is consistent with a negative imaginary part.
!
!            ** WARNING **  Make sure the second dimension of PMOM
!            in the calling program is at least as large as the
!            absolute value of IPOLZN.
!
!            For small enough values of XX, or large enough values
!            of M,  PMOM  will tend to underflow.  Thus, it is
!            unwise to assume the values returned are non-zero and,
!            for example, to divide some quantity by them.
!


!      I N T E R N A L   V A R I A B L E S
!      -----------------------------------

!  AN,BN           Mie coefficients a-sub-n, b-sub-n ( Ref. 1, Eq. 16 )
!  ANM1,BNM1       Mie coefficients  a-sub-(n-1),
!                     b-sub-(n-1);  used in GQSC sum
!  ANP             Coeffs. in S+ expansion ( Ref. 2, p. 1507 )
!  BNP             Coeffs. in S- expansion ( Ref. 2, p. 1507 )
!  ANPM            Coeffs. in S+ expansion ( Ref. 2, p. 1507 )
!                     when  MU  is replaced by  - MU
!  BNPM            Coeffs. in S- expansion ( Ref. 2, p. 1507 )
!                     when  MU  is replaced by  - MU
!  CALCMO(K)       TRUE, calculate moments for K-th phase quantity
!                     (derived from IPOLZN)
!  CBIGA(N)        Bessel function ratio A-sub-N (Ref. 2, Eq. 2)
!                     ( COMPLEX version )
!  CDENAN,         (COMPLEX) denominators of An,Bn
!   CDENBN
!  CIOR            Complex index of refraction with negative
!                     imaginary part (Van de Hulst convention)
!  CIORIV          1 / cIoR
!  COEFF           ( 2N + 1 ) / ( N ( N + 1 ) )
!  CSUM1,2         temporary sum variables for TFORW, TBACK
!  FN              Floating point version of loop index for
!                     Mie series summation
!  LITA,LITB(N)    Mie coefficients An, Bn, saved in arrays for
!                     use in calculating Legendre moments PMOM
!  MAXTRM          Max. possible no. of terms in Mie series
!  MM              (-1)^(n+1), where n is Mie series sum index 
!  MIM             Magnitude of imaginary refractive index
!  MRE             Real part of refractive index
!  MAXANG          Max. possible value of input variable NUMANG
!  NANGD2          (NUMANG+1)/2 ( no. of angles in 0-90 deg; ANYANG=F )
!  NOABS           TRUE, sphere non-absorbing (determined by MIMCUT)
!  NP1DN           ( N + 1 ) / N
!  NPQUAN          Highest-numbered phase quantity for which moments are
!                     to be calculated (the largest digit in IPOLZN
!                     if  IPOLZN /= 0)
!  NTRM            No. of terms in Mie series
!  PASS1           TRUE on first entry, FALSE thereafter; for self-test
!  PIN(J)          Angular function pi-sub-n ( Ref. 2, Eq. 3 )
!                     at J-th angle
!  PINM1(J)        pi-sub-(n-1) ( see PIn ) at J-th angle
!  PSINM1          Ricatti-Bessel function psi-sub-(n-1), argument XX
!  PSIN            Ricatti-Bessel function psi-sub-n of argument XX
!                     ( Ref. 1, p. 11 ff. )
!  RBIGA(N)        Bessel function ratio A-sub-N (Ref. 2, Eq. 2)
!                     ( REAL version, for when imag refrac index = 0 )
!  RIORIV          1 / Mre
!  RN              1 / N
!  RTMP            (REAL) temporary variable
!  SP(J)           S+  for J-th angle  ( Ref. 2, p. 1507 )
!  SM(J)           S-  for J-TH angle  ( Ref. 2, p. 1507 )
!  SPS(J)          S+  for (NUMANG+1-J)-th angle ( ANYANG=FALSE )
!  SMS(J)          S-  for (NUMANG+1-J)-th angle ( ANYANG=FALSE )
!  TAUN            Angular function tau-sub-n ( Ref. 2, Eq. 4 )
!                     at J-th angle
!  TCOEF           N ( N+1 ) ( 2N+1 ) (for summing TFORW,TBACK series)
!  TWONP1          2N + 1
!  YESANG          TRUE if scattering amplitudes are to be calculated
!  ZETNM1          Ricatti-Bessel function  zeta-sub-(n-1) of argument
!                     XX  ( Ref. 2, Eq. 17 )
!  ZETN            Ricatti-Bessel function  zeta-sub-n of argument XX
! ----------------------------------------------------------------------
!
IMPLICIT  NONE
!
! ----------------------------------------------------------------------
! --------  I / O SPECIFICATIONS FOR SUBROUTINE MIEV0  -----------------
! ----------------------------------------------------------------------
LOGICAL     ANYANG, PERFCT, PRNT(*)
INTEGER     IPOLZN, MOMDIM, NUMANG, NMOM
REAL(EB)    GQSC, MIMCUT, PMOM( 0:MOMDIM, * ), QEXT, QSCA, SPIKE,XMU(*), XX
COMPLEX(EB) CREFIN, SFORW, SBACK, S1(*), S2(*), TFORW(*), TBACK(*)
! ----------------------------------------------------------------------
!
!                                  ** NOTE --  MAXTRM = 10100  is neces-
!                                  ** sary to do some of the test probs,
!                                  ** but 1100 is sufficient for most
!                                  ** conceivable applications
!     .. Parameters ..

INTEGER     MAXANG
PARAMETER   ( MAXANG = 5000 )
INTEGER     MAXTRM
!      PARAMETER ( MAXTRM = 10100 )
PARAMETER   ( MAXTRM = 16000 ) ! works for FDS
REAL(EB)    ONETHR
PARAMETER   ( ONETHR = 1._EB / 3._EB )

!     .. Local Scalars ..

LOGICAL     NOABS, PASS1, YESANG, GT100
INTEGER     I, J, N, NANGD2, NPQUAN, NTRM
REAL(EB)    CHIN, CHINM1, COEFF, DENAN, DENBN, FN, MIM, MM, MRE, &
            NP1DN, PSIN, PSINM1, RATIO, RIORIV, RN, RTMP, TAUN, &
            TCOEF, TWONP1, XINV
COMPLEX(EB) AN, ANM1, ANP, ANPM, BN, BNM1, BNP, BNPM, CDENAN,&
            CDENBN, CIOR, CIORIV, CSUM1, CSUM2, ZET, ZETN, ZETNM1

!     .. Local Arrays ..

LOGICAL     CALCMO( 4 )
REAL(EB), ALLOCATABLE :: PIN(:), PINM1(:)
REAL(EB) RBIGA( MAXTRM )
COMPLEX(EB) CBIGA( MAXTRM ), LITA( MAXTRM ), LITB( MAXTRM )
COMPLEX(EB), ALLOCATABLE :: SM(:), SMS(:), SP(:), SPS(:)

SAVE      PASS1
DATA      PASS1 / .TRUE. /
!
ALLOCATE(PIN(1:NUMANG)) 
ALLOCATE(PINM1(1:NUMANG))
ALLOCATE(SM(1:NUMANG)) 
ALLOCATE(SMS(1:(NUMANG+1)/2)) 
ALLOCATE(SP(1:NUMANG)) 
ALLOCATE(SPS(1:(NUMANG+1)/2)) 

!                    ** Save some input variables and replace them
!                    ** with values needed to do the self-test

IF( PASS1 ) CALL TESTMI( .FALSE., XX, CREFIN, MIMCUT, PERFCT, &
                         ANYANG, NMOM, IPOLZN, NUMANG, XMU, QEXT, &
                         QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, &
                         TBACK, PMOM, MOMDIM )
MAIN_MIEV: DO 
!                                        ** Check input and calculate
!                                        ** certain variables from input
CALL CKINMI( NUMANG, MAXANG, XX, PERFCT, CREFIN, MOMDIM, NMOM, &
             IPOLZN, ANYANG, XMU, CALCMO, NPQUAN )

IF( PERFCT .AND. XX<=0.1_EB ) THEN
!                                            ** Use totally-reflecting
!                                            ** small-particle limit
   CALL SMALL1( XX, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, SBACK, &
                  S1, S2, TFORW, TBACK, LITA, LITB )
   NTRM = 2
ELSE
   NOABS = .TRUE.
   GT100 = .FALSE.

   IF( .NOT.PERFCT ) THEN
      CIOR = CREFIN
      IF( AIMAG(CIOR)>0.0_EB ) CIOR = CONJG( CIOR )
      MRE    = REAL( CIOR )
      MIM    = -AIMAG( CIOR )
      NOABS  = MIM<=MIMCUT
      CIORIV = 1.0_EB / CIOR
      RIORIV = 1.0_EB / MRE

      IF( XX*MAX( 1._EB, ABS(CIOR) )<=0.1_EB ) THEN
!                                    ** Use general-refractive-index
!                                    ** small-particle limit
         CALL SMALL2( XX, CIOR, MIM>MIMCUT, NUMANG, XMU, QEXT, &
                           QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, &
                           TBACK, LITA, LITB )
         NTRM = 2
         GT100 = .TRUE.
      END IF
   END IF
   GT100IF: IF (.NOT. GT100) THEN

      NANGD2 = ( NUMANG + 1 ) / 2
      YESANG = NUMANG>0
   !                             ** Number of terms in Mie series; Eq R50
      IF( XX<=8.0_EB ) THEN
      NTRM = XX + 4._EB*XX**ONETHR + 1._EB
      ELSE IF( XX<4200._EB ) THEN
      NTRM = XX + 4.05*XX**ONETHR + 2._EB
      ELSE
      NTRM = XX + 4._EB*XX**ONETHR + 2._EB
      END IF
      IF( NTRM+1 > MAXTRM )CALL ERRMSG('MIEV0--PARAMETER MaxTrm TOO SMALL',.TRUE.)
   !                            ** Calculate logarithmic derivatives of
   !                            ** J-Bessel-fcn., A-sub-(1 to NTrm)
      IF( .NOT.PERFCT ) CALL BIGA( CIOR, XX, NTRM, NOABS, YESANG, RBIGA, CBIGA )
   !                            ** Initialize Ricatti-Bessel functions
   !                            ** (psi,chi,zeta)-sub-(0,1) for upward
   !                            ** recurrence ( Eq. R19 )
      XINV   = 1.0_EB / XX
      PSINM1 = SIN( XX )
      CHINM1 = COS( XX )
      PSIN   = PSINM1*XINV - CHINM1
      CHIN   = CHINM1*XINV + PSINM1
      ZETNM1 = CMPLX( PSINM1, CHINM1 )
      ZETN   = CMPLX( PSIN, CHIN )
   !                                     ** Initialize previous coeffi-
   !                                     ** cients for GQSC series
      ANM1 = ( 0.0_EB, 0.0_EB )
      BNM1 = ( 0.0_EB, 0.0_EB )
   !                             ** Initialize angular function  pi
   !                             ** and sums for S+, S- ( Ref. 2, p. 1507 )
      IF( ANYANG ) THEN
      DO J = 1, NUMANG
   !                             ** Eq. R39
            PINM1( J ) = 0.0_EB
            PIN( J ) = 1.0_EB

               SP( J ) = ( 0.0_EB, 0.0_EB )
               SM( J ) = ( 0.0_EB, 0.0_EB )
         END DO
      ELSE
         DO J = 1, NANGD2
   !                          ** Eq. R39
            PINM1( J ) = 0.0_EB
            PIN( J ) = 1.0_EB
            SP( J ) = ( 0.0_EB, 0.0_EB )
            SM( J ) = ( 0.0_EB, 0.0_EB )
            SPS( J ) = ( 0.0_EB, 0.0_EB )
            SMS( J ) = ( 0.0_EB, 0.0_EB )
         END DO
      END IF
   !                       ** Initialize Mie sums for efficiencies, etc.
      QSCA  = 0.0_EB
      GQSC  = 0.0_EB
      SFORW = ( 0._EB, 0._EB )
      SBACK = ( 0._EB, 0._EB )
      CSUM1 = ( 0._EB, 0._EB )
      CSUM2 = ( 0._EB, 0._EB )
   !
   ! ---------  LOOP TO SUM MIE SERIES  -----------------------------------
      MM     = +1.0_EB
      SPIKE  = 1.0_EB
      DO N = 1, NTRM
   !                           ** Compute various numerical coefficients
         FN     = N
         RN     = 1.0_EB / FN
         NP1DN  = 1.0_EB + RN
         TWONP1 = 2*N + 1
         COEFF  = TWONP1 / ( FN * ( N + 1 ) )
         TCOEF  = TWONP1 * ( FN * ( N + 1 ) )
   !                          ** Calculate Mie series coefficients
         IF( PERFCT ) THEN
   !                                 ** Totally-reflecting case; Eq R/A.1,2
            AN = ( ( FN*XINV )*PSIN - PSINM1 ) / ( ( FN*XINV )*ZETN - ZETNM1 )
            BN = PSIN / ZETN
         ELSE IF( NOABS ) THEN
   !                                      ** No-absorption case; Eq (R16)
            CDENAN = ( RIORIV*RBIGA(N) + ( FN*XINV ) ) * ZETN - ZETNM1
            AN   = ( ( RIORIV*RBIGA(N) + ( FN*XINV ) ) * PSIN - PSINM1 ) / CDENAN
            CDENBN = ( MRE*RBIGA(N) + ( FN*XINV ) ) * ZETN - ZETNM1
            BN   = ( ( MRE*RBIGA(N) + ( FN*XINV ) ) * PSIN - PSINM1 ) / CDENBN
         ELSE
   !                                       ** Absorptive case; Eq (R16)
            CDENAN = ( CIORIV*CBIGA( N ) + ( FN*XINV ) )*ZETN - ZETNM1
            CDENBN =   ( CIOR*CBIGA( N ) + ( FN*XINV ) )*ZETN - ZETNM1
            AN   = ( ( CIORIV*CBIGA( N ) + ( FN*XINV ) )*PSIN - PSINM1 ) / CDENAN
            BN     = ( ( CIOR*CBIGA( N ) + ( FN*XINV ) )*PSIN - PSINM1 ) / CDENBN
   !                                         ** Eq (R7)
            QSCA   = QSCA + TWONP1*( SQ( AN ) + SQ( BN ) )
         END IF
   !                       ** Save Mie coefficients for PMOM calculation
         LITA( N ) = AN
         LITB( N ) = BN
   !
         IF( .NOT.PERFCT .AND. N>XX ) THEN
   !                                               ** Flag resonance spikes
            DENAN  = ABS( CDENAN )
            DENBN  = ABS( CDENBN )
   !                                                   ** Eq. R/B.9
            RATIO  = DENAN / DENBN
   !                                                   ** Eq. R/B.10
            IF( RATIO<=0.2_EB .OR. RATIO>=5.0_EB ) SPIKE = MIN( SPIKE, DENAN, DENBN )
         END IF
   !                                  ** Increment Mie sums for non-angle-
   !                                  ** dependent quantities
   !                                                   ** Eq. R/B.2
         SFORW = SFORW + TWONP1*( AN + BN )
   !                                                   ** Eq. R/B.5,6
         CSUM1 = CSUM1 + TCOEF *( AN - BN )
   !                                                   ** Eq. R/B.1
         SBACK = SBACK + ( MM*TWONP1 )*( AN - BN )
   !                                                   ** Eq. R/B.7,8
         CSUM2 = CSUM2 + ( MM*TCOEF ) *( AN + BN )
   !                                         ** Eq (R8)
         GQSC  = GQSC  + (FN - RN) * REAL(ANM1 * CONJG(AN) + BNM1 * CONJG(BN) ) + COEFF * REAL(AN * CONJG(BN))
         IF( YESANG ) THEN
   !                                      ** Put Mie coefficients in form
   !                                      ** needed for computing S+, S-
   !                                      ** ( Eq R10 )
         ANP = COEFF*( AN + BN )
         BNP = COEFF*( AN - BN )
   !                                      ** Increment Mie sums for S+, S-
   !                                      ** while upward recursing
   !                                      ** angular functions pi and tau
         IF( ANYANG ) THEN
   !                                         ** Arbitrary angles
   !                                              ** vectorizable loop
            DO J = 1, NUMANG
   !                                                 ** Eq. (R37b)
               RTMP = ( XMU(J) * PIN(J) ) - PINM1( J )
   !                                                 ** Eq. (R38b)
               TAUN   = FN * RTMP - PINM1( J )
   !                                                   ** Eq (R10)
               SP( J ) = SP( J ) + ANP * ( PIN( J ) + TAUN )
               SM( J ) = SM( J ) + BNP * ( PIN( J ) - TAUN )
               PINM1( J ) = PIN( J )
   !                                                 ** Eq. R37c
               PIN( J ) = ( XMU( J ) * PIN( J ) ) + NP1DN * RTMP
            END DO
         ELSE
   !                                  ** Angles symmetric about 90 degrees
            ANPM = MM*ANP
            BNPM = MM*BNP
   !                                          ** vectorizable loop
            DO J = 1, NANGD2
   !                                                 ** Eq. (R37b)
               RTMP = ( XMU(J) * PIN(J) ) - PINM1( J )
   !                                                 ** Eq. (R38b)
               TAUN = FN * RTMP - PINM1( J )
   !                                                 ** Eq (R10,12)
               SP ( J ) = SP ( J ) + ANP * ( PIN( J ) + TAUN )
               SMS( J ) = SMS( J ) + BNPM *( PIN( J ) + TAUN )
               SM ( J ) = SM ( J ) + BNP * ( PIN( J ) - TAUN )
               SPS( J ) = SPS( J ) + ANPM *( PIN( J ) - TAUN )
               PINM1( J ) = PIN( J )
         !                                                 ** Eq. R37c
               PIN( J ) = ( XMU(J) * PIN(J) ) + NP1DN * RTMP
            END DO
         END IF
         END IF
   !                          ** Update relevant quantities for next
   !                          ** pass through loop
         MM   = - MM
         ANM1 = AN
         BNM1 = BN
   !                           ** Upward recurrence for Ricatti-Bessel
   !                           ** functions ( Eq. R17 )
         ZET    = ( TWONP1*XINV ) * ZETN - ZETNM1
         ZETNM1 = ZETN
         ZETN   = ZET
         PSINM1 = PSIN
         PSIN   = REAL( ZETN )
      END DO
   ! ---------- END LOOP TO SUM MIE SERIES --------------------------------
   !
   !                                         ** Eq (R6)
      QEXT = 2._EB / XX**2*REAL( SFORW )
      IF( PERFCT .OR. NOABS ) THEN
         QSCA = QEXT
      ELSE
         QSCA = 2._EB/ XX**2 * QSCA
      END IF
      GQSC   = 4._EB/ XX**2 * GQSC
      SFORW  = 0.5_EB*SFORW
      SBACK  = 0.5_EB*SBACK
      TFORW( 1 ) =  0.5_EB*SFORW - 0.125_EB*CSUM1
      TFORW( 2 ) =  0.5_EB*SFORW + 0.125_EB*CSUM1
      TBACK( 1 ) = -0.5_EB*SBACK + 0.125_EB*CSUM2
      TBACK( 2 ) =  0.5_EB*SBACK + 0.125_EB*CSUM2
      IF( YESANG ) THEN
   !                                ** Recover scattering amplitudes
   !                                ** from S+, S- ( Eq (R11) )
         IF( ANYANG ) THEN
   !                                         ** vectorizable loop
            DO J = 1, NUMANG
   !                                                  ** Eq (R11)
               S1( J ) = 0.5_EB*( SP( J ) + SM( J ) )
               S2( J ) = 0.5_EB*( SP( J ) - SM( J ) )
            END DO
         ELSE
   !                                        ** vectorizable loop
            DO J = 1, NANGD2
   !                                                   ** Eq (R11)
               S1( J ) = 0.5_EB*( SP( J ) + SM( J ) )
               S2( J ) = 0.5_EB*( SP( J ) - SM( J ) )
            END DO
   !                                        ** vectorizable loop
            DO  J = 1, NANGD2
               S1( NUMANG + 1 - J ) = 0.5_EB*( SPS( J ) + SMS( J ) )
               S2( NUMANG + 1 - J ) = 0.5_EB*( SPS( J ) - SMS( J ) )
            END DO
         END IF
      END IF
   END IF GT100IF
   !                                 ** Calculate Legendre moments
END IF
IF( NMOM>0 ) CALL LPCOEF( NTRM, NMOM, IPOLZN, MOMDIM, CALCMO,NPQUAN, LITA, LITB, PMOM )
IF( AIMAG( CREFIN )>0.0_EB ) THEN
!                                         ** Take complex conjugates
!                                         ** of scattering amplitudes
   SFORW = CONJG( SFORW )
   SBACK = CONJG( SBACK )
   DO I = 1, 2
      TFORW( I ) = CONJG( TFORW( I ) )
      TBACK( I ) = CONJG( TBACK( I ) )
   END DO
   DO J = 1, NUMANG
      S1( J ) = CONJG( S1( J ) )
      S2( J ) = CONJG( S2( J ) )
   END DO
END IF

IF( PASS1 ) THEN
!                           ** Compare test case results with
!                           ** correct answers and abort if bad;
!                           ** otherwise restore user input and proceed
   CALL TESTMI( .TRUE., XX, CREFIN, MIMCUT, PERFCT, ANYANG, NMOM, &
                  IPOLZN, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, &
                  SBACK, S1, S2, TFORW, TBACK, PMOM, MOMDIM )
   PASS1  = .FALSE.
   CYCLE MAIN_MIEV
END IF
EXIT MAIN_MIEV
END DO MAIN_MIEV

IF( PRNT( 1 ) .OR. PRNT( 2 ) )  &
  CALL MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, &
               QSCA, GQSC, NMOM, IPOLZN, MOMDIM, CALCMO, PMOM, &
               SFORW, SBACK, TFORW, TBACK, S1, S2 )
!
DEALLOCATE(PIN)
DEALLOCATE(PINM1)
DEALLOCATE(SM) 
DEALLOCATE(SMS)
DEALLOCATE(SP) 
DEALLOCATE(SPS) 

RETURN

END SUBROUTINE MIEV0

SUBROUTINE CKINMI( NUMANG, MAXANG, XX, PERFCT, CREFIN, MOMDIM, NMOM, IPOLZN, ANYANG, XMU, CALCMO, NPQUAN )

!        Check for bad input to MIEV0 and calculate CALCMO, NPQUAN

!     Routines called :  ERRMSG, WRTBAD, WRTDIM

!     .. Scalar Arguments ..

LOGICAL     ANYANG, PERFCT
INTEGER     IPOLZN, MAXANG, MOMDIM, NMOM, NPQUAN, NUMANG
REAL(EB)    XX
COMPLEX(EB) CREFIN
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    XMU( * )
!     ..
!     .. Local Scalars ..

CHARACTER(4) :: STRING
LOGICAL     INPERR
INTEGER     I, IP, J, L

INPERR = .FALSE.

IF( NUMANG>MAXANG ) INPERR = WRTDIM( 'MaxAng', NUMANG )
IF( NUMANG<0 ) INPERR = WRTBAD( 'NUMANG' )

IF( XX<0._EB ) INPERR = WRTBAD( 'XX' )

IF( .NOT.PERFCT .AND. REAL( CREFIN )<=0._EB )INPERR = WRTBAD( 'CREFIN' )

IF( MOMDIM<0 ) INPERR = WRTBAD( 'MOMDIM' )


IF( NMOM/=0 ) THEN

   IF( NMOM<0 .OR. NMOM>MOMDIM ) INPERR = WRTBAD( 'NMOM' )
   IF( ABS( IPOLZN )>4444 ) INPERR = WRTBAD( 'IPOLZN' )

   NPQUAN = 0

   DO L = 1, 4
      CALCMO( L ) = .FALSE.
   END DO

   IF( IPOLZN/=0 ) THEN
   !                                 ** Parse out IPOLZN into its digits
   !                                 ** to find which phase quantities are
   !                                 ** to have their moments calculated
      WRITE( STRING, '(I4)' ) ABS( IPOLZN )
      DO J = 1, 4
         IP = ICHAR( STRING( J:J ) ) - ICHAR( '0' )
         IF( IP>=1 .AND. IP<=4 ) CALCMO( IP ) = .TRUE.
         IF( IP==0 .OR. ( IP>=5 .AND. IP<=9 ) ) INPERR = WRTBAD( 'IPOLZN' )
         NPQUAN = MAX( NPQUAN, IP )
      END DO
   END IF
END IF

IF( ANYANG ) THEN
!                                ** Allow for slight imperfections in
!                                ** computation of cosine
   DO I = 1, NUMANG
      IF( XMU( I )<-1.00001_EB .OR. XMU( I )>1.00001_EB ) INPERR = WRTBAD( 'XMU' )
   END DO
   ELSE
   DO I = 1, ( NUMANG + 1 ) / 2
      IF( XMU( I )<-0.00001_EB .OR. XMU( I )>1.00001_EB ) INPERR = WRTBAD( 'XMU' )
   END DO
END IF

IF( INPERR ) CALL ERRMSG( 'MIEV0--Input error(S).  Aborting...', .TRUE. )
IF( XX>20000.0_EB .OR. REAL( CREFIN )>10.0_EB .OR. ABS( AIMAG( CREFIN ) )>10.0_EB ) &
    CALL ERRMSG( 'MIEV0--XX or CREFIN outside tested range',.FALSE.)
RETURN
END SUBROUTINE CKINMI

SUBROUTINE LPCOEF( NTRM, NMOM, IPOLZN, MOMDIM, CALCMO, NPQUAN, A, B, PMOM )
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities ( Ref. 5 formulation )

!     INPUT:  NTRM                    Number terms in Mie series
!             NMOM, IPOLZN, MOMDIM    MIEV0 arguments
!             CALCMO                  Flags calculated from IPOLZN
!             NPQUAN                  Defined in MIEV0
!             A, B                    Mie series coefficients
!
!     OUTPUT: PMOM                   Legendre moments (MIEV0 argument)
!
!     Routines called :  ERRMSG, LPCO1T, LPCO2T
!
!     *** NOTES ***
!
!         (1)  Eqs. 2-5 are in error in Dave, Appl. Opt. 9,
!         1888 (1970).  Eq. 2 refers to M1, not M2;  eq. 3 refers to
!         M2, not M1.  In eqs. 4 and 5, the subscripts on the second
!         term in square brackets should be interchanged.
!
!         (2)  The general-case logic in this subroutine works correctly
!         in the two-term Mie series case, but subroutine LPCO2T
!         is called instead, for speed.
!
!         (3)  Subroutine  LPCO1T, to do the one-term case, is never
!         called within the context of MIEV0, but is included for
!         complete generality.
!
!         (4)  Some improvement in speed is obtainable by combining the
!         310- and 410-loops, if moments for both the third and fourth
!         phase quantities are desired, because the third phase quantity
!         is the real part of a complex series, while the fourth phase
!         quantity is the imaginary part of that very same series.  But
!         most users are not interested in the fourth phase quantity,
!         which is related to circular polarization, so the present
!         scheme is usually more efficient.
!
!
!           ** Definitions of local variables ***
!      AM(M)       Numerical coefficients  a-sub-m-super-l
!                     in Dave, Eqs. 1-15, as simplified in Ref. 5.
!      BI(I)       Numerical coefficients  b-sub-i-super-l
!                     in Dave, Eqs. 1-15, as simplified in Ref. 5.
!      BIDEL(I)    1/2 Bi(I) times factor capital-del in Dave
!      CM,DM()     Arrays C and D in Dave, Eqs. 16-17 (Mueller form),
!                     calculated using recurrence derived in Ref. 5
!      CS,DS()     Arrays C and D in Ref. 4, Eqs. A5-A6 (Sekera form),
!                     calculated using recurrence derived in Ref. 5
!      C,D()       Either CM,DM or CS,DS, depending on IPOLZN
!      EVENL       True for even-numbered moments;  false otherwise
!      IDEL        1 + little-del  in Dave
!      MAXTRM      Max. no. of terms in Mie series
!      MAXMOM      Max. no. of non-zero moments
!      NUMMOM      Number of non-zero moments
!      RECIP(K)    1 / K

IMPLICIT  NONE

!     .. Parameters ..

INTEGER     MAXTRM, MAXMOM, MXMOM2, MAXRCP
PARAMETER ( MAXTRM=1001, MAXMOM = 2*MAXTRM, MXMOM2 = MAXMOM / 2, MAXRCP = 4*MAXTRM + 2 )
!     ..
!     .. Scalar Arguments ..

INTEGER   IPOLZN, MOMDIM, NMOM, NPQUAN, NTRM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

LOGICAL     EVENL, PASS1
INTEGER     I, IDEL, IMAX, J, K, L, LD2, M, MMAX, NUMMOM
REAL(EB)    SUM
!     ..
!     .. Local Arrays ..

REAL(EB)    AM( 0:MAXTRM ), BI( 0:MXMOM2 ), BIDEL( 0:MXMOM2 ), RECIP( MAXRCP )
COMPLEX(EB) C( MAXTRM ), CM( MAXTRM ), CS( MAXTRM ), D( MAXTRM ), DM( MAXTRM ), DS( MAXTRM )
!     ..
!     .. Equivalences ..

EQUIVALENCE ( C, CM ), ( D, DM )
!     ..
SAVE      PASS1, RECIP
DATA      PASS1 / .TRUE. /

IF( PASS1 ) THEN
   DO  K = 1, MAXRCP
      RECIP( K ) = 1.0_EB / K
   END DO
   PASS1  = .FALSE.
END IF

DO J = 1, MAX( 1, NPQUAN )
   DO L = 0, NMOM
      PMOM( L, J ) = 0.0_EB
   END DO
END DO

IF( NTRM==1 ) THEN
   CALL LPCO1T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
   RETURN
ELSE IF( NTRM==2 ) THEN
   CALL LPCO2T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
   RETURN
END IF

IF( NTRM + 2>MAXTRM )CALL ERRMSG('LPCoef--PARAMETER MaxTrm too small',.TRUE.)
!                                     ** Calculate Mueller C, D arrays
CM( NTRM + 2 ) = ( 0._EB, 0._EB )
DM( NTRM + 2 ) = ( 0._EB, 0._EB )
CM( NTRM + 1 ) = ( 1._EB - RECIP( NTRM+1 ) ) * B( NTRM )
DM( NTRM + 1 ) = ( 1._EB - RECIP( NTRM+1 ) ) * A( NTRM )
CM( NTRM ) = ( RECIP( NTRM ) + RECIP( NTRM+1 ) ) * A( NTRM ) + ( 1._EB - RECIP( NTRM ) )*B( NTRM-1 )
DM( NTRM ) = ( RECIP( NTRM ) + RECIP( NTRM+1 ) ) * B( NTRM ) + ( 1._EB - RECIP( NTRM ) )*A( NTRM-1 )
DO K = NTRM-1, 2, -1
   CM( K ) = CM( K+2 ) - ( 1._EB + RECIP(K+1) ) * B( K+1 )+ ( RECIP(K) + RECIP(K+1) ) * A( K ) &
                        + ( 1._EB - RECIP(K) ) * B( K-1 )
   DM( K ) = DM( K+2 ) - ( 1._EB + RECIP(K+1) ) * A( K+1 )  + ( RECIP(K) + RECIP(K+1) ) * B( K ) &
                        + ( 1._EB - RECIP(K) ) * A( K-1 )
END DO

CM( 1 ) = CM( 3 ) + 1.5_EB * ( A( 1 ) - B( 2 ) )
DM( 1 ) = DM( 3 ) + 1.5_EB * ( B( 1 ) - A( 2 ) )

IF( IPOLZN>=0 ) THEN
   DO K = 1, NTRM + 2
      C( K ) = ( 2*K - 1 ) * CM( K )
      D( K ) = ( 2*K - 1 ) * DM( K )
   END DO
ELSE
!                                    ** Compute Sekera C and D arrays
   CS( NTRM + 2 ) = ( 0._EB, 0._EB )
   DS( NTRM + 2 ) = ( 0._EB, 0._EB )
   CS( NTRM + 1 ) = ( 0._EB, 0._EB )
   DS( NTRM + 1 ) = ( 0._EB, 0._EB )

   DO K = NTRM, 1, -1
      CS( K ) = CS( K+2 ) + ( 2*K + 1 ) * ( CM( K+1 ) - B( K ) )
      DS( K ) = DS( K+2 ) + ( 2*K + 1 ) * ( DM( K+1 ) - A( K ) )
   END DO

   DO K = 1, NTRM + 2
      C( K ) = ( 2*K - 1 ) * CS( K )
      D( K ) = ( 2*K - 1 ) * DS( K )
   END DO

END IF

IF( IPOLZN<0 ) NUMMOM = MIN( NMOM, 2*NTRM - 2 )
IF( IPOLZN>=0 ) NUMMOM = MIN( NMOM, 2*NTRM )

IF( NUMMOM>MAXMOM )  CALL ERRMSG('LPCoef--PARAMETER MaxTrm too small',.TRUE.)
!
!                          ** Loop over moments
L240: DO L = 0, NUMMOM
   LD2 = L / 2
   EVENL  = MOD( L, 2 )==0
!                                    ** Calculate numerical coefficients
!                                    ** a-sub-m and b-sub-i in Dave
!                                    ** double-sums for moments
   IF( L==0 ) THEN
      IDEL = 1
      DO M = 0, NTRM
         AM( M ) = 2.0_EB * RECIP( 2*M + 1 )
      END DO
      BI( 0 ) = 1.0_EB
   ELSE IF( EVENL ) THEN
      IDEL = 1
      DO M = LD2, NTRM
         AM( M ) = ( 1._EB + RECIP( 2*M - L + 1 ) ) * AM( M )
      END DO
      DO I = 0, LD2 - 1
         BI( I ) = ( 1._EB - RECIP( L - 2*I ) ) * BI( I )
      END DO
      BI( LD2 ) = ( 2._EB - RECIP( L ) ) * BI( LD2 - 1 )
   ELSE
   IDEL = 2
      DO M = LD2, NTRM
         AM( M ) = ( 1._EB - RECIP( 2*M + L + 2 ) ) * AM( M )
      END DO

      DO I = 0, LD2
         BI( I ) = ( 1._EB - RECIP( L + 2*I + 1 ) ) * BI( I )
      END DO
   END IF
!                                     ** Establish upper limits for sums
!                                     ** and incorporate factor capital-
!                                     ** del into b-sub-i
   MMAX = NTRM - IDEL
   IF( IPOLZN>=0 ) MMAX = MMAX + 1
   IMAX = MIN( LD2, MMAX - LD2 )
   IF( IMAX<0 ) EXIT L240
   DO I = 0, IMAX
      BIDEL( I ) = BI( I )
   END DO
   IF( EVENL ) BIDEL( 0 ) = 0.5_EB*BIDEL( 0 )
!                                    ** Perform double sums just for
!                                    ** phase quantities desired by user
   IF( IPOLZN==0 ) THEN
      DO I = 0, IMAX
!                                           ** vectorizable loop
         SUM = 0.0_EB
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) * ( REAL(C(M-I+1) * CONJG(C(M+I+IDEL)))+ REAL(D(M-I+1) * CONJG(D(M+I+IDEL))))
         END DO
         PMOM( L, 1 ) = PMOM( L, 1 ) + BIDEL( I ) * SUM
      END DO
      PMOM( L, 1 ) = 0.5_EB*PMOM( L, 1 )
      CYCLE L240
   END IF

   IF( CALCMO( 1 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                          ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM( M ) * REAL( C(M-I+1) * CONJG( C(M+I+IDEL) ) )
         END DO
         PMOM( L, 1 ) = PMOM( L, 1 ) + BIDEL( I ) * SUM
      END DO
   END IF

   IF( CALCMO( 2 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                           ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM( M ) * REAL( D(M-I+1) * CONJG( D(M+I+IDEL) ) )
         END DO
         PMOM( L, 2 ) = PMOM( L, 2 ) + BIDEL( I ) * SUM
      END DO
   END IF

   IF( CALCMO( 3 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                           ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) *( REAL(C(M-I+1) * CONJG(D(M+I+IDEL))) + REAL(C(M+I+IDEL) * CONJG(D(M-I+1))))
         END DO
         PMOM( L, 3 ) = PMOM( L, 3 ) + BIDEL( I ) * SUM
      END DO
      PMOM( L, 3 ) = 0.5_EB*PMOM( L, 3 )
   END IF

   IF( CALCMO( 4 ) ) THEN
      DO I = 0, IMAX
         SUM= 0.0_EB
!                                         ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) *(AIMAG(C(M-I+1) * CONJG(D(M+I+IDEL)))+ AIMAG(C(M+I+IDEL) * CONJG(D(M-I+1))))
         END DO
         PMOM( L, 4 ) = PMOM( L, 4 ) + BIDEL( I ) * SUM
      END DO

      PMOM( L, 4 ) = - 0.5_EB * PMOM( L, 4 )
   END IF

END DO L240

RETURN
END SUBROUTINE LPCOEF

SUBROUTINE LPCO1T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
!
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities in special case where
!         no. terms in Mie series = 1
!
!        INPUT:  NMOM, IPOLZN, MOMDIM     MIEV0 arguments
!                CALCMO                   Flags calculated from IPOLZN
!                A(1), B(1)               Mie series coefficients
!
!        OUTPUT: PMOM                     Legendre moments

!     .. Scalar Arguments ..

INTEGER     IPOLZN, MOMDIM, NMOM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

INTEGER     L, NUMMOM
REAL(EB)    A1SQ, B1SQ
COMPLEX(EB) A1B1C

A1SQ   = SQ( A( 1 ) )
B1SQ   = SQ( B( 1 ) )
A1B1C  = A( 1 ) * CONJG( B( 1 ) )


IF( IPOLZN<0 ) THEN
   IF( CALCMO( 1 ) ) PMOM( 0, 1 ) = 2.25_EB*B1SQ
   IF( CALCMO( 2 ) ) PMOM( 0, 2 ) = 2.25_EB*A1SQ
   IF( CALCMO( 3 ) ) PMOM( 0, 3 ) = 2.25_EB*REAL( A1B1C )
   IF( CALCMO( 4 ) ) PMOM( 0, 4 ) = 2.25_EB*AIMAG( A1B1C )
ELSE
   NUMMOM = MIN( NMOM, 2 )
   !                             ** Loop over moments
   L10: DO L = 0, NUMMOM
      IF( IPOLZN==0 ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 1.5_EB*( A1SQ + B1SQ )
         IF( L==1 ) PMOM( L, 1 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 1 ) = 0.15_EB*( A1SQ + B1SQ )
         CYCLE L10
      END IF

      IF( CALCMO( 1 ) ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 2.25_EB*( A1SQ + B1SQ / 3.)
         IF( L==1 ) PMOM( L, 1 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 1 ) = 0.3_EB*B1SQ
      END IF

      IF( CALCMO( 2 ) ) THEN
         IF( L==0 ) PMOM( L, 2 ) = 2.25_EB*( B1SQ + A1SQ / 3. )
         IF( L==1 ) PMOM( L, 2 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 2 ) = 0.3_EB*A1SQ
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 3.0_EB*REAL( A1B1C )
         IF( L==1 ) PMOM( L, 3 ) = 0.75_EB*( A1SQ + B1SQ )
         IF( L==2 ) PMOM( L, 3 ) = 0.3_EB*REAL( A1B1C )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = -1.5_EB*AIMAG( A1B1C )
         IF( L==1 ) PMOM( L, 4 ) = 0.0_EB
         IF( L==2 ) PMOM( L, 4 ) = 0.3_EB*AIMAG( A1B1C )
      END IF

   END DO L10
END IF

RETURN
END SUBROUTINE LPCO1T

SUBROUTINE LPCO2T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities in special case where
!         no. terms in Mie series = 2

!        INPUT:  NMOM, IPOLZN, MOMDIM     MIEV0 arguments
!                CALCMO                   Flags calculated from IPOLZN
!                A(1-2), B(1-2)           Mie series coefficients
!
!        OUTPUT: PMOM                     Legendre moments


!     .. Scalar Arguments ..

INTEGER     IPOLZN, MOMDIM, NMOM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

INTEGER     L, NUMMOM
REAL(EB)    A2SQ, B2SQ, PM1, PM2
COMPLEX(EB) A2C, B2C, CA, CAC, CAT, CB, CBC, CBT, CG, CH

CA   = 3.*A( 1 ) - 5.*B( 2 )
CAT  = 3.*B( 1 ) - 5.*A( 2 )
CAC  = CONJG( CA )
A2SQ = SQ( A( 2 ) )
B2SQ = SQ( B( 2 ) )
A2C  = CONJG( A( 2 ) )
B2C  = CONJG( B( 2 ) )

IF( IPOLZN<0 ) THEN
!                                   ** Loop over Sekera moments
   NUMMOM = MIN( NMOM, 2 )
   DO L = 0, NUMMOM
      IF( CALCMO( 1 ) ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 0.25_EB * ( SQ( CAT ) + (100._EB/3._EB)* B2SQ )
         IF( L==1 ) PMOM( L, 1 ) = (5._EB/3._EB)*REAL( CAT*B2C )
         IF( L==2 ) PMOM( L, 1 ) = (10._EB/3._EB)*B2SQ
      END IF

      IF( CALCMO( 2 ) ) THEN
         IF( L==0 ) PMOM( L, 2 ) = 0.25_EB * ( SQ( CA ) + (100._EB/3._EB) * A2SQ )
         IF( L==1 ) PMOM( L, 2 ) = (5._EB/3._EB)*REAL( CA*A2C )
         IF( L==2 ) PMOM( L, 2 ) = (10._EB/3._EB)*A2SQ
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 0.25_EB * REAL( CAT * CAC  + (100._EB/3._EB) * B(2) * A2C )
         IF( L==1 ) PMOM( L, 3 ) = 5._EB/6._EB* REAL( B(2)*CAC + CAT*A2C )
         IF( L==2 ) PMOM( L, 3 ) = 10._EB/3._EB* REAL( B(2)*A2C )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = -0.25_EB * AIMAG( CAT * CAC + (100._EB/3._EB)* B(2) * A2C )
         IF( L==1 ) PMOM( L, 4 ) = -5._EB/ 6._EB*  AIMAG( B(2)*CAC + CAT*A2C )
         IF( L==2 ) PMOM( L, 4 ) = -10._EB/ 3._EB* AIMAG( B(2)*A2C )
      END IF

   END DO

ELSE

   CB  = 3._EB*B( 1 ) + 5._EB*A( 2 )
   CBT = 3._EB*A( 1 ) + 5._EB*B( 2 )
   CBC = CONJG( CB )
   CG  = ( CBC*CBT + 10._EB*( CAC*A( 2 ) + B2C*CAT ) ) / 3._EB
   CH  = 2._EB*( CBC*A( 2 ) + B2C*CBT )

   !                               ** Loop over Mueller moments
   NUMMOM = MIN( NMOM, 4 )

   L20: DO L = 0, NUMMOM

      IF( IPOLZN==0 .OR. CALCMO( 1 ) ) THEN
         IF( L==0 ) PM1 = 0.25_EB*SQ( CA ) + SQ( CB ) / 12._EB + (5._EB/3._EB)*REAL( CA*B2C ) + 5._EB*B2SQ
         IF( L==1 ) PM1 = REAL( CB * ( CAC / 6._EB+ B2C ) )
         IF( L==2 ) PM1 = SQ( CB ) / 30._EB+ (20._EB/7._EB)*B2SQ + (2._EB/3._EB)*REAL( CA*B2C )
         IF( L==3 ) PM1 = (2._EB/7.) * REAL( CB*B2C )
         IF( L==4 ) PM1 = (40._EB/63._EB) * B2SQ
         IF( CALCMO( 1 ) ) PMOM( L, 1 ) = PM1
      END IF

      IF( IPOLZN==0 .OR. CALCMO( 2 ) ) THEN
         IF( L==0 ) PM2 = 0.25_EB*SQ( CAT ) + SQ( CBT ) / 12._EB + ( 5._EB/ 3._EB) * REAL( CAT*A2C ) + 5._EB*A2SQ
         IF( L==1 ) PM2 = REAL( CBT * ( CONJG( CAT ) / 6._EB+ A2C ) )
         IF( L==2 ) PM2 = SQ( CBT ) / 30._EB + ( 20._EB/7._EB) * A2SQ + ( 2._EB/3._EB) * REAL( CAT*A2C )
         IF( L==3 ) PM2 = (2._EB/7._EB) * REAL( CBT*A2C )
         IF( L==4 ) PM2 = (40._EB/63._EB) * A2SQ
         IF( CALCMO( 2 ) ) PMOM( L, 2 ) = PM2
      END IF

      IF( IPOLZN==0 ) THEN
         PMOM( L, 1 ) = 0.5_EB*( PM1 + PM2 )
         CYCLE L20
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 0.25_EB * REAL( CAC*CAT + CG + 20._EB* B2C * A(2) )
         IF( L==1 ) PMOM( L, 3 ) = REAL( CAC*CBT + CBC*CAT + 3._EB*CH ) / 12.
         IF( L==2 ) PMOM( L, 3 ) = 0.1_EB * REAL( CG + (200._EB/7._EB) * B2C * A(2) )
         IF( L==3 ) PMOM( L, 3 ) = REAL( CH ) / 14._EB
         IF( L==4 ) PMOM( L, 3 ) = 40._EB/63._EB* REAL( B2C*A(2) )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = 0.25_EB * AIMAG( CAC*CAT + CG + 20._EB* B2C * A(2) )
         IF( L==1 ) PMOM( L, 4 ) = AIMAG( CAC*CBT + CBC*CAT + 3._EB*CH ) / 12._EB
         IF( L==2 ) PMOM( L, 4 ) = 0.1_EB * AIMAG( CG + (200._EB/7._EB) * B2C * A(2) )
         IF( L==3 ) PMOM( L, 4 ) = AIMAG( CH ) / 14._EB
         IF( L==4 ) PMOM( L, 4 ) = 40._EB/63._EB* AIMAG( B2C*A(2) )
      END IF

   END DO L20

END IF

RETURN
END SUBROUTINE LPCO2T

SUBROUTINE BIGA( CIOR, XX, NTRM, NOABS, YESANG, RBIGA, CBIGA )

!        Calculate logarithmic derivatives of J-Bessel-function
!
!     Input :  CIOR, XX, NTRM, NOABS, YESANG  (defined in MIEV0)
!
!    Output :  RBIGA or CBIGA  (defined in MIEV0)
!
!    Routines called :  CONFRA
!
!
!    INTERNAL VARIABLES :
!
!       CONFRA     Value of Lentz continued fraction for CBIGA(NTRM),
!                     used to initialize downward recurrence
!
!       DOWN       = True, use down-recurrence.  False, do not.
!
!       F1,F2,F3   Arithmetic statement functions used in determining
!                     whether to use up-  or down-recurrence
!                     ( Ref. 2, Eqs. 6-8 )
!
!       MRE        Real refractive index
!       MIM        Imaginary refractive index
!
!       REZINV     1 / ( MRE * XX ); temporary variable for recurrence
!       ZINV       1 / ( CIOR * XX ); temporary variable for recurrence
!
!     .. Scalar Arguments ..

LOGICAL     NOABS, YESANG
INTEGER     NTRM
REAL(EB)    XX
COMPLEX(EB) CIOR

!     .. Array Arguments ..
REAL(EB)    RBIGA( * )
COMPLEX(EB) CBIGA( * )

!     .. Local Scalars ..
LOGICAL     DOWN
INTEGER     N
REAL(EB)    MIM, MRE, REZINV, RTMP
COMPLEX(EB) CTMP, ZINV

!                                  ** Decide whether BigA can be
!                                  ** calculated by up-recurrence
MRE = REAL( CIOR )
MIM = ABS( AIMAG( CIOR ) )
IF( MRE<1.0_EB .OR. MRE>10.0_EB .OR. MIM>10.0_EB ) THEN
   DOWN = .TRUE.
ELSE IF( YESANG ) THEN
   DOWN = .TRUE.
!                                                    ** Eq. R48
   IF( MIM*XX < F2( MRE ) ) DOWN = .FALSE.
ELSE
   DOWN = .TRUE.
!                                                    ** Eq. R48
   IF( MIM*XX < F1( MRE ) ) DOWN = .FALSE.
END IF

ZINV   = 1.0_EB / ( CIOR*XX )
REZINV = 1.0_EB / ( MRE*XX )


IF( DOWN ) THEN
!                          ** Compute initial high-order BigA using
!                          ** Lentz method ( Ref. 1, pp. 17-20 )
   CTMP = CONFRA( NTRM, ZINV )
!                                   *** Downward recurrence for BigA
   IF( NOABS ) THEN
!                                        ** No-absorption case; Eq (R23)
      RBIGA( NTRM ) = REAL( CTMP )
      DO N = NTRM, 2, -1
         RBIGA( N - 1 ) = ( N*REZINV ) - 1.0_EB / ( ( N*REZINV ) + RBIGA( N ) )
      END DO
   ELSE
!                                         ** Absorptive case; Eq (R23)
      CBIGA( NTRM ) = CTMP
      DO N = NTRM, 2, -1
         CBIGA( N-1 ) = (N*ZINV) - 1.0_EB / ( (N*ZINV) + CBIGA( N ) )
   END DO
   END IF

ELSE
!                            *** Upward recurrence for BigA
   IF( NOABS ) THEN
!                                  ** No-absorption case; Eq (R20,21)
      RTMP = SIN( MRE*XX )
      RBIGA( 1 ) = - REZINV + RTMP / ( RTMP*REZINV - COS( MRE*XX ) )

      DO N = 2, NTRM
         RBIGA( N ) = -( N*REZINV ) + 1.0_EB / ( ( N*REZINV ) - RBIGA( N - 1 ) )
      END DO

   ELSE
!                                     ** Absorptive case; Eq (R20,22)
      CTMP = EXP( - (0._EB,2._EB)*CIOR*XX )
      CBIGA( 1 ) = - ZINV + (1._EB-CTMP) /  ( ZINV * (1._EB-CTMP) - (0._EB,1._EB)*(1._EB+CTMP) )
      DO N = 2, NTRM
         CBIGA( N ) = - (N*ZINV) + 1.0_EB / ((N*ZINV) - CBIGA( N-1 ))
      END DO

END IF

END IF

CONTAINS

REAL(EB) FUNCTION F1(MRE)
REAL(EB), INTENT(IN) :: MRE
F1 = -8.0_EB + MRE**2*( 26.22_EB + MRE*( -0.4474_EB + MRE**3*( 0.00204_EB - 0.000175_EB*MRE ) ) )
END FUNCTION F1

REAL(EB) FUNCTION F2(MRE)  ! Eq. R47b
REAL(EB), INTENT(IN) :: MRE
F2 = 3.9_EB + MRE*( -10.8_EB + 13.78_EB*MRE )
END FUNCTION F2

END SUBROUTINE BIGA

COMPLEX(EB) FUNCTION CONFRA( N, ZINV )

!         Compute Bessel function ratio A-sub-N from its
!         continued fraction using Lentz method
!
!         ZINV = Reciprocal of argument of A
!
!
!    I N T E R N A L    V A R I A B L E S
!    ------------------------------------
!
!    CAK      Term in continued fraction expansion of A (Eq. R25)
!    CAPT     Factor used in Lentz iteration for A (Eq. R27)
!    CNUMER   Numerator   in capT  ( Eq. R28A )
!    CDENOM   Denominator in capT  ( Eq. R28B )
!    CDTD     Product of two successive denominators of capT factors
!                 ( Eq. R34C )
!    CNTN     Product of two successive numerators of capT factors
!                 ( Eq. R34B )
!    EPS1     Ill-conditioning criterion
!    EPS2     Convergence criterion
!    KK       Subscript k of cAk  ( Eq. R25B )
!    KOUNT    Iteration counter ( used to prevent infinite looping )
!    MAXIT    Max. allowed no. of iterations
!    MM       + 1  and - 1, alternately
! --------------------------------------------------------------------

!     .. Scalar Arguments ..

INTEGER     N
COMPLEX(EB) ZINV

!     .. Local Scalars ..

INTEGER     KK, KOUNT, MAXIT, MM
REAL(EB)    EPS1, EPS2
COMPLEX(EB) CAK, CAPT, CDENOM, CDTD, CNTN, CNUMER
!    
DATA      EPS1 / 1.E-2_EB / , EPS2 / 1.E-8_EB /
DATA      MAXIT / 10000 /
!                                 ** Eq. R25a
CONFRA = ( N + 1 ) * ZINV
MM     = - 1
KK     = 2*N + 3
!                                 ** Eq. R25b, k=2
CAK    = ( MM*KK ) * ZINV
CDENOM = CAK
CNUMER = CDENOM + 1.0_EB / CONFRA
KOUNT  = 1

L10: DO
   KOUNT = KOUNT + 1

   IF( KOUNT>MAXIT ) CALL ERRMSG('ConFra--Iteration failed to converge',.TRUE.)

   MM  = - MM
   KK  = KK + 2
   !                                 ** Eq. R25b
   CAK = ( MM*KK ) * ZINV
   !                                          ** Eq. R32
   IF( ABS( CNUMER / CAK )<=EPS1 .OR. ABS( CDENOM / CAK )<=EPS1 ) THEN

   !                                  ** Ill-conditioned case -- stride
   !                                  ** two terms instead of one

   !                                       ** Eq. R34
      CNTN   = CAK * CNUMER + 1.0_EB
      CDTD   = CAK * CDENOM + 1.0_EB
   !                                           ** Eq. R33
      CONFRA = ( CNTN / CDTD ) * CONFRA

      MM  = - MM
      KK  = KK + 2
   !                                 ** Eq. R25b
      CAK = ( MM*KK ) * ZINV
   !                                      ** Eq. R35
      CNUMER = CAK + CNUMER / CNTN
      CDENOM = CAK + CDENOM / CDTD
      KOUNT  = KOUNT + 1
      CYCLE L10

   ELSE
   !                           *** Well-conditioned case

   !                                  ** Eq. R27
      CAPT   = CNUMER / CDENOM
   !                                  ** Eq. R26
      CONFRA = CAPT * CONFRA
   !                                  ** Check for convergence; Eq. R31

      IF (      ABS( REAL (CAPT) - 1.0_EB )>=EPS2 .OR. ABS( AIMAG(CAPT) )      >=EPS2 )  THEN
   !                                        ** Eq. R30
         CNUMER = CAK + 1.0_EB / CNUMER
         CDENOM = CAK + 1.0_EB / CDENOM
         CYCLE L10
      END IF
   END IF
   EXIT L10
END DO L10

RETURN
END FUNCTION CONFRA

SUBROUTINE MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, QSCA, GQSC, NMOM, IPOLZN, MOMDIM, &
                   CALCMO, PMOM, SFORW, SBACK, TFORW, TBACK, S1, S2 )

!         Print scattering quantities of a single particle

!     .. Scalar Arguments ..
LOGICAL     PERFCT
INTEGER     IPOLZN, MOMDIM, NMOM, NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) CREFIN, SBACK, SFORW

!     .. Array Arguments ..
LOGICAL     CALCMO( * ), PRNT( * )
REAL(EB)    PMOM( 0:MOMDIM, * ), XMU( * )
COMPLEX(EB) S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..
CHARACTER   FMAT*22
INTEGER     I, J, M
REAL(EB)    FNORM, I1, I2

!     .. Intrinsic Functions ..
!     INTRINSIC AIMAG, CONJG, REAL


IF( PERFCT ) WRITE(LU_ERR, '(''1'',10X,A,1P,E11.4)' )  'Perfectly Conducting Case, size parameter =', XX

IF( .NOT.PERFCT ) WRITE(LU_ERR, '(''1'',10X,3(A,1P,E11.4))' ) &
    'Refractive Index:  Real ', REAL( CREFIN ), '  Imag ', &
    AIMAG( CREFIN ), ',   Size Parameter =', XX


IF( PRNT( 1 ) .AND. NUMANG>0 ) THEN

   WRITE(LU_ERR, '(/,A)' ) &
         '    cos(angle)  ------- S1 ---------  ------- S2 ---------' &
         // '  --- S1*conjg(S2) ---   i1=S1**2   i2=S2**2  (i1+i2)/2' &
         // '  DEG POLZN'

   DO I = 1, NUMANG
      I1 = REAL( S1( I ) )**2 + AIMAG( S1( I ) )**2
      I2 = REAL( S2( I ) )**2 + AIMAG( S2( I ) )**2
      WRITE(LU_ERR, '( I4, F10.6, 1P,10E11.3 )'   ) I, XMU(I), S1(I), S2(I), &
         S1(I)*CONJG(S2(I)),I1, I2, 0.5_EB*(I1+I2), (I2-I1)/(I2+I1)
   END DO
END IF


IF( PRNT( 2 ) ) THEN

   WRITE (LU_ERR, '(/,A,9X,A,17X,A,17X,A,/,(0P,F7.2, 1P,6E12.3) )' ) &
            '  Angle', 'S-sub-1', 'T-sub-1', 'T-sub-2', &
                  0.0_EB,     SFORW,    TFORW(1),  TFORW(2), &
               180._EB,     SBACK,    TBACK(1),  TBACK(2)
   WRITE (LU_ERR, '(/,4(A,1P,E11.4))' ) &
            ' Efficiency Factors,  extinction:', QEXT, &
                                 '   scattering:', QSCA, &
                                 '   absorption:', QEXT-QSCA, &
                              '   rad. pressure:', QEXT-GQSC
   IF( NMOM>0 ) THEN
      WRITE(LU_ERR, '(/,A)' ) ' Normalized moments of :'
      IF( IPOLZN==0 ) WRITE(LU_ERR, '(''+'',27X,A)' ) 'Phase Fcn'
      IF( IPOLZN>0 ) WRITE(LU_ERR, '(''+'',33X,A)' )  'M1           M2          S21          D21'

      IF( IPOLZN<0 ) WRITE(LU_ERR, '(''+'',33X,A)' )  'R1           R2           R3           R4'
      FNORM = 4._EB/ ( XX**2 * QSCA )
      DO M = 0, NMOM
         WRITE(LU_ERR, '(A,I4)' ) '      Moment no.', M
         DO J = 1, 4
            IF( CALCMO( J ) ) THEN
               WRITE( FMAT, '(A,I2,A)' ) '( ''+'', T', 24+(J-1)*13, ', 1P,E13.4 )'
               WRITE(LU_ERR, FMAT ) FNORM * PMOM( M, J )
            END IF
         END DO
      END DO
   END IF
END IF

RETURN
END SUBROUTINE MIPRNT

SUBROUTINE SMALL1( XX, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, TBACK, A, B )

!       Small-particle limit of Mie quantities in totally reflecting
!       limit ( Mie series truncated after 2 terms )
!
!        A,B       First two Mie coefficients, with numerator and
!                  denominator expanded in powers of XX ( a factor
!                  of XX**3 is missing but is restored before return
!                  to calling program )  ( Ref. 2, p. 1508 )

!     .. Parameters ..
REAL(EB)  TWOTHR, FIVTHR, FIVNIN
PARAMETER ( TWOTHR = 2._EB/3._EB, FIVTHR = 5._EB/3._EB, FIVNIN = 5._EB/9._EB )

!     .. Scalar Arguments ..
INTEGER     NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) SBACK, SFORW

!     .. Array Arguments ..
REAL(EB)    XMU( * )
COMPLEX(EB) A(*), B( * ), S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..
INTEGER     J
REAL(EB)    RTMP

!                                                       ** Eq. R/A.5
A( 1 ) = CMPLX( 0._EB, TWOTHR*( 1._EB - 0.2_EB*XX**2 ) ) / CMPLX( 1._EB - 0.5_EB*XX**2, TWOTHR*XX**3 )
!                                                      ** Eq. R/A.6
B( 1 ) = CMPLX( 0._EB, - ( 1._EB - 0.1_EB*XX**2 ) / 3._EB) / CMPLX( 1._EB + 0.5_EB*XX**2, - XX**3 / 3._EB)
!                                                       ** Eq. R/A.7,8
A( 2 ) = CMPLX( 0._EB,   XX**2 / 30._EB)
B( 2 ) = CMPLX( 0._EB, - XX**2 / 45._EB)
!                                                       ** Eq. R/A.9
QSCA = 6._EB* XX**4 *( SQ( A(1) ) + SQ( B(1) ) + FIVTHR*( SQ( A(2) ) + SQ( B(2) ) ) )
QEXT = QSCA
!                                                       ** Eq. R/A.10
GQSC = 6._EB* XX**4 *REAL( A(1)*CONJG( A(2) + B(1) ) + ( B(1) + FIVNIN*A(2) )*CONJG( B(2) ) )

RTMP   = 1.5_EB * XX**3
SFORW  = RTMP*( A(1) + B(1) + FIVTHR*( A(2) + B(2) ) )
SBACK  = RTMP*( A(1) - B(1) - FIVTHR*( A(2) - B(2) ) )
TFORW( 1 ) = RTMP*( B(1) + FIVTHR*( 2._EB*B(2) - A(2) ) )
TFORW( 2 ) = RTMP*( A(1) + FIVTHR*( 2._EB*A(2) - B(2) ) )
TBACK( 1 ) = RTMP*( B(1) - FIVTHR*( 2._EB*B(2) + A(2) ) )
TBACK( 2 ) = RTMP*( A(1) - FIVTHR*( 2._EB*A(2) + B(2) ) )

DO J = 1, NUMANG
!                                                    ** Eq. R/A.11,12
   S1( J ) = RTMP*( A(1) + B(1)*XMU( J ) + FIVTHR*( A(2)*XMU( J ) +  B(2)*( 2._EB*XMU( J )**2 - 1._EB) ) )
   S2( J ) = RTMP*( B(1) + A(1)*XMU( J ) + FIVTHR*( B(2)*XMU( J ) +  A(2)*( 2._EB*XMU( J )**2 - 1._EB) ) )
END DO
!                                     ** Recover actual Mie coefficients
A( 1 ) = XX**3 * A(1)
A( 2 ) = XX**3 * A(2)
B( 1 ) = XX**3 * B(1)
B( 2 ) = XX**3 * B(2)

RETURN
END SUBROUTINE SMALL1

SUBROUTINE SMALL2( XX, CIOR, CALCQE, NUMANG, XMU, QEXT, QSCA,GQSC, SFORW, SBACK, S1, S2, TFORW, TBACK,A, B )

!       Small-particle limit of Mie quantities for general refractive
!       index ( Mie series truncated after 2 terms )
!
!        A,B       First two Mie coefficients, with numerator and
!                  denominator expanded in powers of XX ( a factor
!                  of XX**3 is missing but is restored before return
!                  to calling program )

!        CIORSQ    Square of refractive index

!     .. Parameters ..
REAL(EB)    TWOTHR, FIVTHR
PARAMETER   ( TWOTHR = 2._EB/3._EB, FIVTHR = 5._EB/3._EB)

!     .. Scalar Arguments ..
LOGICAL     CALCQE
INTEGER     NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) CIOR, SBACK, SFORW

!     .. Array Arguments ..
REAL(EB)    XMU( * )
COMPLEX(EB) A(*), B(*), S1(*), S2(*), TBACK(*), TFORW( * )

!     .. Local Scalars ..
INTEGER   J
REAL(EB)  RTMP
COMPLEX(EB)   CIORSQ, CTMP


CIORSQ = CIOR**2
CTMP   = CMPLX( 0._EB, TWOTHR )*( CIORSQ - 1.0_EB )

!                                           ** Eq. R42a
A( 1 ) = CTMP*( 1._EB- 0.1_EB*XX**2 +   ( CIORSQ / 350._EB + 1._EB/280._EB)*XX**4 ) / &
          ( CIORSQ + 2._EB+ ( 1._EB- 0.7_EB*CIORSQ )*XX**2 -  &
          ( CIORSQ**2 / 175._EB- 0.275_EB*CIORSQ + 0.25_EB )*XX**4 + &
          XX**3 * CTMP * ( 1._EB- 0.1_EB*XX**2 ) )

!                                           ** Eq. R42b
B( 1 ) = ( XX**2 / 30._EB )*CTMP*( 1._EB+  ( CIORSQ / 35._EB - 1._EB/ 14._EB)*XX**2 ) /  &
         ( 1._EB- ( CIORSQ / 15._EB - 1._EB/6._EB)*XX**2 )

!                                           ** Eq. R42c

A( 2 ) = ( 0.1_EB*XX**2 )*CTMP*( 1._EB- XX**2 / 14._EB ) /  ( 2._EB*CIORSQ + 3._EB- &
         ( CIORSQ / 7._EB- 0.5_EB ) * XX**2 )

!                                           ** Eq. R40a

QSCA = (6._EB*XX**4) * ( SQ( A(1) ) + SQ( B(1) ) + FIVTHR * SQ( A(2) ) )

!                                           ** Eq. R40b
QEXT = QSCA
IF( CALCQE ) QEXT = 6._EB*XX * REAL( A(1) + B(1) + FIVTHR*A(2) )

!                                           ** Eq. R40c

GQSC = (6._EB*XX**4) * REAL( A(1)*CONJG( A(2) + B(1) ) )

RTMP   = 1.5_EB * XX**3
SFORW  = RTMP*( A(1) + B(1) + FIVTHR*A(2) )
SBACK  = RTMP*( A(1) - B(1) - FIVTHR*A(2) )
TFORW( 1 ) = RTMP*( B(1) - FIVTHR*A(2) )
TFORW( 2 ) = RTMP*( A(1) + 2._EB*FIVTHR*A(2) )
TBACK( 1 ) = TFORW(1)
TBACK( 2 ) = RTMP*( A(1) - 2._EB*FIVTHR*A(2) )


DO J = 1, NUMANG
!                                      ** Eq. R40d,e

   S1( J ) = RTMP*( A(1) + ( B(1) + FIVTHR*A(2) )*XMU( J ) )
   S2( J ) = RTMP*( B(1) + A(1)*XMU( J ) + FIVTHR*A(2)*( 2._EB*XMU( J )**2 - 1._EB) )
END DO

!                                     ** Recover actual Mie coefficients
A( 1 ) = XX**3 * A(1)
A( 2 ) = XX**3 * A(2)
B( 1 ) = XX**3 * B(1)
B( 2 ) = ( 0._EB, 0._EB)

RETURN
END SUBROUTINE SMALL2

SUBROUTINE TESTMI( COMPAR, XX, CREFIN, MIMCUT, PERFCT, ANYANG, &
                   NMOM, IPOLZN, NUMANG, XMU, QEXT, QSCA, GQSC, &
                   SFORW, SBACK, S1, S2, TFORW, TBACK, PMOM, &
                   MOMDIM )

!         Set up to run test case when  COMPAR = False;  when  = True,
!         compare Mie code test case results with correct answers
!         and abort if even one result is inaccurate.

!         The test case is :  Mie size parameter = 10
!                             refractive index   = 1.5 - 0.1 i
!                             scattering angle = 140 degrees
!                             1 Sekera moment

!         Results for this case may be found among the test cases
!         at the end of reference (1).

!         *** NOTE *** When running on some computers, esp. in single
!         precision, the Accur criterion below may have to be relaxed.
!         However, if Accur must be set larger than 10**-3 for some
!         size parameters, your computer is probably not accurate
!         enough to do Mie computations for those size parameters.

!     Routines called :  ERRMSG, MIPRNT, TSTBAD

!     .. Scalar Arguments ..

LOGICAL     ANYANG, COMPAR, PERFCT
INTEGER     IPOLZN, MOMDIM, NMOM, NUMANG
REAL(EB)    GQSC, MIMCUT, QEXT, QSCA, XX
COMPLEX(EB) CREFIN, SBACK, SFORW

!     .. Array Arguments ..

REAL(EB)    PMOM( 0:MOMDIM, * ), XMU( * )
COMPLEX(EB) S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..

LOGICAL     ANYSAV, OK, PERSAV
INTEGER     IPOSAV, M, N, NMOSAV, NUMSAV
REAL(EB)    MIMSAV, TESTGQ, TESTQE, TESTQS,XMUSAV, XXSAV
COMPLEX(EB) CRESAV, TESTS1, TESTS2, TESTSB, TESTSF

!     .. Local Arrays ..

LOGICAL     CALCMO( 4 ), PRNT( 2 )
REAL(EB)    TESTPM( 0:1 )
COMPLEX(EB) TESTTB( 2 ), TESTTF( 2 )


SAVE      XXSAV, CRESAV, MIMSAV, PERSAV, ANYSAV, NMOSAV, IPOSAV,NUMSAV, XMUSAV

DATA      TESTQE / 2.459791_EB /,&
          TESTQS / 1.235144_EB /,&
          TESTGQ / 1.139235_EB /,&
          TESTSF / ( 61.49476_EB, -3.177994_EB ) /,&
          TESTSB / ( 1.493434_EB,  0.2963657_EB ) /,&
          TESTS1 / ( -0.1548380_EB, -1.128972_EB ) /,&
          TESTS2 / ( 0.05669755_EB, 0.5425681_EB ) /,&
          TESTTF / ( 12.95238_EB, -136.6436_EB ),&
                   ( 48.54238_EB, 133.4656_EB ) /,&
          TESTTB / ( 41.88414_EB, -15.57833_EB ),&
                   ( 43.37758_EB, -15.28196_EB ) /,&
          TESTPM / 227.1975_EB, 183.6898_EB /

IF( .NOT.COMPAR ) THEN
!                                   ** Save certain user input values
   XXSAV  = XX
   CRESAV = CREFIN
   MIMSAV = MIMCUT
   PERSAV = PERFCT
   ANYSAV = ANYANG
   NMOSAV = NMOM
   IPOSAV = IPOLZN
   NUMSAV = NUMANG
   XMUSAV = XMU( 1 )
!                                   ** Reset input values for test case
   XX     = 10.0_EB
   CREFIN = ( 1.5_EB, -0.1_EB )
   MIMCUT = 0.0_EB
   PERFCT = .FALSE.
   ANYANG = .TRUE.
   NMOM   = 1
   IPOLZN = -1
   NUMANG = 1
   XMU( 1 ) = -0.7660444_EB

ELSE
!                                    ** Compare test case results with
!                                    ** correct answers and abort if bad
   OK = .TRUE.

   IF( WRONG( QEXT,TESTQE ) ) OK = TSTBAD( 'QEXT', ABS( ( QEXT - TESTQE ) / TESTQE ) )

   IF( WRONG( QSCA,TESTQS ) )OK = TSTBAD( 'QSCA', ABS( ( QSCA - TESTQS ) / TESTQS ) )

   IF( WRONG( GQSC,TESTGQ ) ) OK = TSTBAD( 'GQSC', ABS( ( GQSC - TESTGQ ) / TESTGQ ) )

   IF( WRONG( REAL( SFORW ),REAL( TESTSF ) ) .OR. WRONG( AIMAG( SFORW ),AIMAG( TESTSF ) ) ) &
         OK = TSTBAD( 'SFORW', ABS( ( SFORW - TESTSF ) / TESTSF ) )

   IF( WRONG( REAL( SBACK ),REAL( TESTSB ) ) .OR. WRONG( AIMAG( SBACK ),AIMAG( TESTSB ) ) ) &
         OK = TSTBAD( 'SBACK', ABS( ( SBACK - TESTSB ) / TESTSB ) )

   IF( WRONG( REAL( S1(1) ),REAL( TESTS1 ) ) .OR. WRONG( AIMAG( S1(1) ),AIMAG( TESTS1 ) ) ) &
         OK = TSTBAD( 'S1', ABS( ( S1(1) - TESTS1 ) / TESTS1 ) )

   IF( WRONG( REAL( S2(1) ),REAL( TESTS2 ) ) .OR. WRONG( AIMAG( S2(1) ),AIMAG( TESTS2 ) ) ) &
         OK = TSTBAD( 'S2', ABS( ( S2(1) - TESTS2 ) / TESTS2 ) )

   DO N = 1, 2
      IF( WRONG( REAL( TFORW(N) ),REAL( TESTTF(N) ) ) .OR. &
               WRONG( AIMAG( TFORW(N) ), &
               AIMAG( TESTTF(N) ) ) ) OK = TSTBAD( 'TFORW', &
               ABS( ( TFORW(N) - TESTTF(N) ) / TESTTF(N) ) ) 

      IF( WRONG( REAL( TBACK(N) ),REAL( TESTTB(N) ) ) .OR. &
               WRONG( AIMAG( TBACK(N) ), &
               AIMAG( TESTTB(N) ) ) ) OK = TSTBAD( 'TBACK', &
               ABS( ( TBACK(N) - TESTTB(N) ) / TESTTB(N) ) )
   END DO

   DO M = 0, 1
      IF ( WRONG( PMOM(M,1), TESTPM(M) ) ) OK =  TSTBAD( 'PMOM', ABS( (PMOM(M,1)-TESTPM(M)) / TESTPM(M) ) )
   END DO


   IF( .NOT.OK ) THEN
      PRNT( 1 ) = .TRUE.
      PRNT( 2 ) = .TRUE.
      CALCMO( 1 ) = .TRUE.
      CALCMO( 2 ) = .FALSE.
      CALCMO( 3 ) = .FALSE.
      CALCMO( 4 ) = .FALSE.
      CALL MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, &
                        QSCA, GQSC, NMOM, IPOLZN, MOMDIM, CALCMO, PMOM, &
                        SFORW, SBACK, TFORW, TBACK, S1, S2 )
      CALL ERRMSG( 'MIEV0 -- Self-test failed',.TRUE.)
   END IF
!                                       ** Restore user input values
   XX     = XXSAV
   CREFIN = CRESAV
   MIMCUT = MIMSAV
   PERFCT = PERSAV
   ANYANG = ANYSAV
   NMOM   = NMOSAV
   IPOLZN = IPOSAV
   NUMANG = NUMSAV
   XMU( 1 ) = XMUSAV

END IF

CONTAINS

LOGICAL FUNCTION WRONG(CALC,EXACT)
REAL(EB) ACCUR
REAL(EB), INTENT(IN) :: CALC,EXACT
DATA  ACCUR / 1.E-4_EB /
WRONG = ABS( ( CALC - EXACT ) / EXACT )>ACCUR
END FUNCTION WRONG

END SUBROUTINE TESTMI


SUBROUTINE ErrMsg( MESSAG, FATAL )
! Print out a warning or error message;  abort if error after making symbolic dump (machine-specific)
USE COMP_FUNCTIONS, ONLY: SHUTDOWN
CHARACTER :: MESSAG*(*)
LOGICAL ::  FATAL,MSGLIM
INTEGER ::  MAXMSG, NUMMSG
SAVE      MAXMSG, NUMMSG, MSGLIM
DATA      NUMMSG / 0 /,  MAXMSG / 100 /,  MSGLIM /.FALSE./
IF (FATAL) CALL SHUTDOWN(MESSAG)
NUMMSG = NUMMSG + 1
IF( MSGLIM ) RETURN
IF( NUMMSG<=MAXMSG ) THEN
   WRITE(LU_ERR, '(/,2A,/)' ) ' ****** WARNING *****  ', MESSAG
ELSE
   WRITE(LU_ERR, 9000 )
   MSGLIM = .True.
END IF
RETURN
9000 FORMAT( / , / , ' ****** TOO MANY WARNING MESSAGES --  ','They will no longer be printed *******', / , / )
END SUBROUTINE ErrMsg


LOGICAL FUNCTION WrtBad( VarNam )
!          Write names of erroneous variables and return 'TRUE'
!      INPUT :   VarNam = Name of erroneous variable to be written
!                         ( CHARACTER, any length )
CHARACTER VarNam*(*)
INTEGER   MAXMSG, NUMMSG
SAVE      NUMMSG, MAXMSG
DATA      NUMMSG / 0 /, MAXMSG / 50 /
WrtBad = .TRUE.
NUMMSG = NUMMSG + 1
WRITE(LU_ERR, '(3A)' ) ' ****  Input variable  ', VarNam,'  in error  ****'
IF( NUMMSG==MAXMSG ) CALL ErrMsg( 'Too many input errors.  Aborting...',.TRUE.)
RETURN
END FUNCTION WrtBad


LOGICAL FUNCTION WrtDim( DimNam, Minval )

! Write name of too-small symbolic dimension and the value it should be increased to;  return 'TRUE'

!      INPUT :  DimNam = Name of symbolic dimension which is too small
!                        ( CHARACTER, any length )
!               Minval = Value to which that dimension should be
!                        increased (at least)
CHARACTER :: DimNam*(*)
INTEGER ::  Minval

WRITE(LU_ERR, '(3A,I7)' ) ' ****  Symbolic dimension  ', DimNam,'  should be increased to at least ', Minval
WrtDim = .TRUE.
RETURN
END FUNCTION WrtDim


LOGICAL FUNCTION TstBad( VarNam, RelErr )
! Write name (VarNam) of variable failing self-test and its percent error from the correct value; return 'FALSE'
CHARACTER :: VarNam*(*)
REAL(EB) ::  RelErr
TstBad = .FALSE.
WRITE(LU_ERR, '(/,3A,1P,E11.2,A)' ) ' *** Output variable ', VarNam, ' differed by ', &
     100.*RelErr,' per cent from correct value.  Self-test failed.'
RETURN
END FUNCTION TstBad
 

REAL(EB) FUNCTION SQ(CTMP)
COMPLEX(EB), INTENT(IN) :: CTMP
SQ = REAL( CTMP )**2 + AIMAG( CTMP )**2
END FUNCTION SQ
 
END MODULE MIEV
