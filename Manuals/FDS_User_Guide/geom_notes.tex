\documentclass[12pt]{article}
\input{../Bibliography/commoncommands}

\begin{document}

\vspace{1.0in}
\section{Unstructured Geometry: The \texorpdfstring{{\tt GEOM}}{GEOM} Namelist Group (Table \ref{tbl:GEOM})}
\label{info:GEOM}
\subsection{Defining Surfaces}

\subsubsection{General Surfaces}
Unstructured geometric surfaces are defined using the {\tt \&GEOM}\ namelist.
These surfaces consist of a collection of triangular faces where each face consists of three vertices.
A simple form of the {\tt \&GEOM}\ namelist defining one triangular face is given by

\begin{verbatim}
&GEOM ID='triangle'
      VERTS=0.0,0.0,0.0, 1.0,0.0,0.0, 1.0,0.0,1.0,
      FACES=1,2,3
/
\end{verbatim}

\noindent where {\tt ID}\ specifies the object name, in this case {\tt triangle},
{\tt VERTS}\ specifies a list of one or more $(x,y,z)$ coordinates and {\tt FACES}\ specifies a list of vertices, 3 vertex indices for each
face. Each index ranges from 1 to the number of vertices found on this {\tt \&GEOM}\ line.

One may also define particular kinds of geometric objects,  blocks using {\tt XB}, spheres using {\tt SPHERE\_ORIGIN}\ and {\tt SPHERE\_RADIUS}
and a 2D surface using {\tt ZVALS}.
FDS generate vertices and faces to represent these objects, equivalent to what would have been defined using {\tt VERTS}\ and {\tt FACES}.

\subsubsection{Blocks}
A {\tt \&GEOM}\ namelist defining a block is given by

\begin{verbatim}
&GEOM ID='block'
      XB=0.0,1.0,0.0,1.0,0.0,1.0 /
\end{verbatim}

\noindent where {\tt XB=xmin,xmax,ymin,ymax,zmin,zmax} defines the min and max bounds of the block.
The {\tt XB}\ parameter is used in the same way as on an {\tt \&OBST}\ or {\tt \&VENT}\ line.
A block may be discretized into many parts by
specifying the {\tt IJK} parameter.  For example, {\tt IJK=8,6,4} would split the block
into 8 parts along the $x$ dimension, 6 parts along the $y$ dimension and 4 parts along
the $z$ dimension. By default, blocks are discretized
so that the block faces are consistent in size with the grid resolution.

\subsubsection{Spheres}
A {\tt \&GEOM}\ namelist defining a sphere centered at $(0,0,0)$ with radius $1$ is given by

\begin{verbatim}
&GEOM ID='sphere'
      SPHERE_ORIGIN=0.0,0.0,0.0,SPHERE_RADIUS=1.0 /
\end{verbatim}

\noindent Spheres are discretized by default so that each face is consistent in size with the grid resolution.
One may specify a {\tt N\_LEVEL}\ parameter which specifies the number of times the sphere is split.

\subsubsection{2D Surfaces}
A {\tt \&GEOM}\ namelist defining a 2D surface is given by

\begin{verbatim}
&GEOM ID='terrain'
      IJK=ivals,jvals,XB=xmin,xmax,ymin,ymax,ZVALS=..... /
\end{verbatim}

\noindent where {\tt XB}\ defines a rectangular region bounded by xmin, xmax, ymin and ymax where elevation data is defined with {\tt ZVALS}.
{\tt IJK}\ specifies how many vertices occur in this region along each dimension in this region.
In this example {\tt ivals}\ values occur along the x dimension and {\tt jval}\ values occur along the y dimension.
The {\tt ZVALS} keyword is used to specify elevations at each $(x,y)$ location.
The elevation data specified after the {\tt ZVALS}\ keyword is arranged in row major order.
The first row contains {\tt ivals} elevation values occurring at the the ymax position from xmin to xmax.
Similarly, the last row contains
{\tt ivals}\ elevation values for the ymin position again from xmin to xmax.
There are then {\tt jvals}\ rows and {\tt ivals}\ columns of elevation data.
As with the blocks and spheres, FDS uses the information
provided by these keywords to construct
vertices and triangular faces.

\subsection{Defining Solids}
Unstructured geometric solids are also defined using the {\tt \&GEOM}\ namelist.
These solids consist of a collection of tetrahedrons where each tetrahedron consists of four vertices.
A simple form of the {\tt \&GEOM}\ namelist defining one tetrahedron is given by

\begin{verbatim}
&GEOM ID='tetrahedron'
      VERTS=0.0,0.0,0.0, 1.0,0.0,0.0, 1.0,1.0,0.0,  1.0,1.0,1.0,
      VOLUS=1,2,3,4
/
\end{verbatim}

\noindent where {\tt ID}\ specifies the object name, in this case {\tt tetrahedron},
{\tt VERTS}\ specifies a list of one or more $(x,y,z)$ coordinates and {\tt VOLUS}\ specifies a list of vertices, 4 vertex indices for each
tetrahedron. Each index ranges from 1 to the number of vertices found on this {\tt \&GEOM}\ line.


\subsection{Transforming Objects}
An object may be transformed.
It  may be translated using {\tt XYZ}, scaled using {\tt SCALE} and rotated about {\tt XYZ0}\ using {\tt AZIM}\ and/or {\tt ELEV}.
For example, in the following {\tt \&GEOM}\ namelist,

\begin{verbatim}
&GEOM ID='chair'

      VERTS=X1,Y1,Z1,...,XM,YM,ZM,

      FACES=F1_1,F1_2,F1_3,...,FN_1,FN_2,FN_3,

      SCALE=sx,sy,sz,
      AZIM=az,
      ELEV=elev,

      XYZ0=x0,y0,z0,
      XYZ=x,y,z,
/
\end{verbatim}

\noindent the chair object is translated by $(x,y,z)$ by specifying {\tt XYZ=x,y,z}.
Similarly, the chair is scaled by $sx$, $sy$, $sz$ along each coordinate direction using {\tt SCALE=sx,sy,sz}.
An object may be flipped by using a negative scale factor.
An object is rotated using {\tt AZIM=az}\ and {\tt ELEV=elev}.
{\tt AZIM}\ is used to specify an azimuthal rotation angle about a vertical (z) axis centered at an origin defined by {\tt XYZ0}.
{\tt ELEV}\ specifies a rotation angle relative to a horizontal plane again containing an origin defined by {\tt XYZ0}..
An object may also be rotated about an arbitrary axis.
{\tt GAXIS} is used to specify this axis.
{\tt GROTATE}\ is used to specify the amount of rotation about this axis.
All rotation angles are specified in degrees.

\subsection{Grouping Objects}
One may group objects to form a new object.  In the following example,
{\tt chair}\ and {\tt couch}\ are objects that have been defined previously.  A new {\tt living room set}\ object
is defined by referencing {\tt chair}\ and {\tt couch}\ in the {\tt GEOM\_IDS}\ keyword.  The chair and couch
are place at a particular locations using the {\tt DXYZ}\ keyword.

{%\footnotesize
\begin{verbatim}
&GEOM ID='chair' ..... /

&GEOM ID='sofa' ...... /

&GEOM ID='living room set'

      XYZ=[0,0,0],
      AZIM=[0],
      ELEV=[0],

      GEOM_IDS(1)='chair',  DSCALE(1)=..., DAZIM(1)=..., DELEV(1)...
                            DXYZ0(1:3,1)=..., DXYZ(1:3,1)=...,
      GEOM_IDS(2)='couch',  DSCALE(2)=..., DAZIM(2)=..., DELEV(2)...
                            DXYZ0(1:3,2)=..., DXYZ(1:3,2)=...,
/
\end{verbatim}
}

\noindent Referenced objects such as {\tt chair}\ and {\tt couch} in this case must be defined in
previous {\&GEOM}\ lines.  Forward references are not permitted.
One may scale, rotate and translate objects as they are placed in the group using
{\tt DSCALE}\, for scaling, {\tt DAZIM} and {\tt DELEV} for rotation and {\tt DXYZ} for translation.

The {\tt DXYZ0}\ and {\tt DXYZ}\ keywords use two coordinates (array indices) to specify data.
The first coordinate specifies the spatial component (1 for x, 2 for y, 3 for z or 1:3 for all three).
The second coordinate specifies the object number according to its position in the {\tt GEOM\_IDS}\ array.
For example,
DXYZ(1,3) would specify the translation along the x direction for the third object in the {\tt GEOM\_IDS}\ array.

The {\tt COMPONENT\_ONLY}\ keyword if .TRUE., indicates that the object being defined is only a component found in other geometries.
It will not appear by itself in the FDS model.

\subsection{Dynamic Objects}
An object's position and orientation may change with time.
These changes are specified using various keywords that end with {\tt \_DOT}.
See Table \ref{tbl:GEOM} for a complete list of these keywords.
In the following example, {\tt AZIM\_DOT} is used to vary the azimuthal rotation angle by 1 deg/s.
Similarly, the position may be changed by using {\tt XYZ\_DOT}.
For example, {\tt XYZ\_DOT=0.0,0.0,1.0}\ would cause an object to move 1~m/s in a vertical direction.
\begin{verbatim}
&GEOM VERTS=...,FACES=....,AZIM=0.0,AZIM_DOT=1.0 /
\end{verbatim}

\vspace{\baselineskip}

\section{\texorpdfstring{{\tt GEOM}}{GEOM} (Unstructured Geometry Parameters)}

\begin{longtable}{@{\extracolsep{\fill}}|l|l|l|l|l|}
\caption[Unstructured geometry parameters ({\ct GEOM} namelist group)]{For more information see Section~\ref{info:GEOM}.}
\label{tbl:GEOM} \\
\hline
\multicolumn{5}{|c|}{{\ct GEOM} (Unstructured Geometry Parameters)} \\
\hline \hline
\endfirsthead
\caption[]{Continued} \\
\hline
\multicolumn{5}{|c|}{{\ct GEOM} (Unstructured Geometry Parameters)} \\
\hline \hline
\endhead
{\ct AZIM}         & Real                   & Section~\ref{info:GEOM}            &  deg      &    0.0                   \\ \hline
{\ct AZIM\_DOT}    & Real                   & Section~\ref{info:GEOM}            &  deg/s    &    0.0                   \\ \hline
{\ct COMPONENT\_ONLY} & LOGICAL             & Section~\ref{info:GEOM}            &           &  {\ct .FALSE.}           \\ \hline
{\ct DAZIM}        & array of Reals         & Section~\ref{info:GEOM}            &  deg      &    0.0                   \\ \hline
{\ct DELEV}        & array of Reals         & Section~\ref{info:GEOM}            &  deg      &    0.0                   \\ \hline
{\ct DSCALE}       & array of Real Triplets & Section~\ref{info:GEOM}            &           &   1.0                    \\ \hline
{\ct DXYZ0}        & array of Real Triplets & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct DXYZ}         & array of Real Triplets & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct ELEV}         & Real                   & Section~\ref{info:GEOM}            &  deg      &    0.0                   \\ \hline
{\ct ELEV\_DOT}    & Real                   & Section~\ref{info:GEOM}            &  deg/s    &    0.0                   \\ \hline
{\ct FACES}        & array of Integer Triplets     & Section~\ref{info:GEOM}     &           &    0                     \\ \hline
{\ct GAXIS}        & Real Triplet           & Section~\ref{info:GEOM}            &           &                          \\ \hline
{\ct GEOM\_IDS}    & Real                   & Section~\ref{info:GEOM}            &           &                          \\ \hline
{\ct GROTATE}      & Real Triplet           & Section~\ref{info:GEOM}            &  deg      &    0.0                   \\ \hline
{\ct GROTATE\_DOT}  & Real Triplet          & Section~\ref{info:GEOM}            & deg/s     &    0.0                   \\ \hline
{\ct ID}           & Character              & Section~\ref{info:GEOM}            &           &   {\ct 'geom'}           \\ \hline
{\ct IJK}          & Integer Triplet        & Section~\ref{info:GEOM}            &           &   0,0,0                  \\ \hline
{\ct MATL\_ID}     & Character              & Section~\ref{info:GEOM}            &           &  {\ct 'INERT'}           \\ \hline
{\ct N\_LEVELS}    & Integer                & Section~\ref{info:GEOM}            &           &   0                      \\ \hline
{\ct SCALE}        & Real Triplet           & Section~\ref{info:GEOM}            &           &   1.0,1.0,1.0            \\ \hline
{\ct SCALE\_DOT}   & Real Triplet           & Section~\ref{info:GEOM}            &  1/s      &   1.0                    \\ \hline
{\ct SPHERE\_ORIGIN}& Real Triplet          & Section~\ref{info:GEOM}            &   m       &  0.0,0.0,0.0             \\ \hline
{\ct SPHERE\_RADIUS}& Real                  & Section~\ref{info:GEOM}            &   m       &  1.0                     \\ \hline
{\ct SURF\_ID}     & Character              & Section~\ref{info:GEOM}            &           &  {\ct 'INERT'}           \\ \hline
{\ct TEXTURE\_MAPPING}& Character           & Section~\ref{info:GEOM}            &           & {\ct 'RECTANGULAR'}      \\ \hline
{\ct TEXTURE\_ORIGIN} & Real Triplet        & Section~\ref{info:GEOM}            &   m       &   0.0,0.0,0.0            \\ \hline
{\ct TEXTURE\_SCALE}& Real                  & Section~\ref{info:GEOM}            &           &   1.0                    \\ \hline
{\ct VERTS}        & array of Real Triplets & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct VOLUS}        & array of Integer Quadruplets     & Section~\ref{info:GEOM}  &           &    0                     \\ \hline
{\ct XB}           & Real sex-tuplet        & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct XYZ0}         & Real Triplet           & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct XYZ}          & Real Triplet           & Section~\ref{info:GEOM}            &   m       &   0.0                    \\ \hline
{\ct XYZ\_DOT}     & Real Triplet           & Section~\ref{info:GEOM}            &   m/s     &   0.0                    \\ \hline
{\ct ZVALS}        & Real                   & Section~\ref{info:GEOM}            &   m/s     &   0.0                    \\ \hline

\end{longtable}


\vspace{\baselineskip}

\section{Isosurface File Format}
\label{out:ISOSURFACE}

(add to FDS user's guide 20.13 when ready)

FDS generated isosurfaces are stored using a
file format described in this section.
Iso-surface files are used to store one or more surfaces where the specified {\ct QUANTITY} is a specified value.
FDS outputs iso-surface data at fixed time intervals.
These surfaces are defined in terms of vertices and triangles.
A vertex consists of an $(x,y,z)$ coordinate. A triangle consists of 3 connected vertices.
These files are written out from {\ct dump.f90} using lines equivalent to the following:
\begin{lstlisting}
! header

WRITE(LU_GEOM) ONE
WRITE(LU_GEOM) VERSION
WRITE(LU_GEOM) N_FLOATS
IF (N_FLOATS>0) WRITE(LU_GEOM) (FLOAT_HEADER(I),I=1,N_FLOATS)
WRITE(LU_GEOM) N_INTS
IF (N_INTS>0) WRITE(LU_GEOM) (INT_HEADER(I),I=1,N_INTS)

! static geometry - geometry specified once and appearing at all time steps

WRITE(LU_GEOM) N_VERT_S, N_FACE_S
IF (N_VERT_S>0)  WRITE(LU_GEOM) (Xvert_S(I),Yvert_S(I),Zvert_S(I),I=1,N_VERT_S)
IF (N_FACE_S>0)  THEN
   WRITE(LU_GEOM) (FACE1_S(I),FACE2_S(I),FACE3_S(I),I=1,N_FACE_S)
   WRITE(LU_GEOM) (SURF_S(I),I=1,N_FACE_S
ENDIF

! dynamic geometry - geometry specified and appearing for each time step

WRITE(LU_GEOM) STIME, unused
WRITE(LU_GEOM) N_VERT_D, N_FACE_D
IF (N_VERT_D>0) WRITE(LU_GEOM)(Xvert_D(I),Yvert_D(I),Zvert_D(I),I=1,N_VERT_D)
IF (N_FACE_D>0) THEN
   WRITE(LU_GEOM) (FACE1_D(I),FACE2_D(I),FACE3_D(I),I=1,N_FACE_D)
   WRITE(LU_GEOM) (SURF_D(I),I=1,N_FACE_D)
ENDIF
\end{lstlisting}

\begin{itemize}
\item {\ct ONE}\ has the value 1. Smokeview uses this number to determine whether the computer creating the geometry file and the computer viewing the geometry file use the same or different byte swap (endian) conventions for storing floating point numbers.
\item {\ct VERSION}\ currently has value 0 and indicates the version number of this file format.
\item {\ct N\_FLOATS, N\_INTS} The number of floating point and integer data items stored at the beginning of the file.
\item {\ct FLOAT\_HEADER, INT\_HEADER} Floating point and integer data stored at the beginning of the file.
\item {\ct STIME} is the FDS simulation time.
\item {\ct N\_VERT\_S, N\_FACE\_S, N\_VERT\_D, N\_FACE\_D} are the number of static and dynamic vertices, faces and volumes.
\item {\ct Xvert\_S, Yvert\_S, Zvert\_S, Xvert\_D, Yvert\_D, Zvert\_D}\ are the static and dynamic vertex coordinates.
\item {\ct FACE1\_S, FACE2\_S, FACE3\_S, FACE1\_S, FACE2\_S, FACE3\_S}\ are the static and dynamic vertex indices for each face (triangle).  The indices are numbered relative to how vertices were written out earlier.
\item {\ct SURF\_S, SURF\_D}\ are the static and dynamic SURF indices for each face (color indices for isosurface files.
\end{itemize}

\section{Geometry File Format}
\label{out:GEOMETRY}

(add to FDS user's guide 20.13 when ready)

Immersed geometric objects (generalized obstructions) are stored using a file format described in this section.
These objects are defined in terms of vertices, triangles and tetrahedrons.
A vertex consists of an $(x,y,z)$ coordinate.
A triangle consists of 3 connected vertices and a tetrahedron consists of 4 connected vertices.
The file format allows one to specify objects that change with time.
Static geometry is defined once and displayed by Smokeview unchanged at each time step.
Dynamic geometry is defined at each time step.
These files are written out from {\ct dump.f90} using lines equivalent to the following:

\begin{lstlisting}
! header

WRITE(LU_GEOM) ONE
WRITE(LU_GEOM) VERSION
WRITE(LU_GEOM) N_FLOATS
IF (N_FLOATS>0) WRITE(LU_GEOM) (FLOAT_HEADER(I),I=1,N_FLOATS)
WRITE(LU_GEOM) N_INTS
IF (N_INTS>0) WRITE(LU_GEOM) (INT_HEADER(I),I=1,N_INTS)

! static geometry - geometry specified once and appearing at all time steps

WRITE(LU_GEOM) N_VERT_S, N_FACE_S, N_VOL_S
IF (N_VERT_S>0)  THEN
   WRITE(LU_GEOM) (Xvert_S(I),Yvert_S(I),Zvert_S(I),I=1,N_VERT_S)
   WRITE(LU_GEOM) (Xtext_S(I),Ytext_S(I),I=1,N_VERT_S)
ENDIF
IF (N_FACE_S>0)  THEN
   WRITE(LU_GEOM) (FACE1_S(I),FACE2_S(I),FACE3_S(I),I=1,N_FACE_S)
   WRITE(LU_GEOM) (SURF_S(I),I=1,N_FACE_S)
ENDIF
IF (N_VOL_S>0)  THEN
   WRITE(LU_GEOM) (VOL1_S(I),VOL2_S(I),VOL3_S(I),VOL4_S(I),I=1,N_VOL_S)
   WRITE(LU_GEOM) (MATL_S(I),I=1,N_FACE_S)
ENDIF

! dynamic geometry - geometry specified and appearing for each time step

WRITE(LU_GEOM) STIME
WRITE(LU_GEOM) N_VERT_D, N_FACE_D, N_VOL_D
IF (N_VERT_D>0) THEN
   WRITE(LU_GEOM)(Xvert_D(I),Yvert_D(I),Zvert_D(I),I=1,N_VERT_D)
   WRITE(LU_GEOM)(Xtext_D(I),Ytext_D(I),I=1,N_VERT_D)
ENDIF
IF (N_FACE_D>0) THEN
   WRITE(LU_GEOM) (FACE1_D(I),FACE2_D(I),FACE3_D(I),I=1,N_FACE_D)
   WRITE(LU_GEOM) (SURF_D(I),I=1,N_FACE_D)
ENDIF
IF (N_VOL_D>0) THEN
   WRITE(LU_GEOM) (VOL1_D(I),VOL2_D(I),VOL3_D(I),VOL4_D(I),I=1,N_VOL_D)
   WRITE(LU_GEOM) (MATL_D(I),I=1,N_VOL_D)
ENDIF
              .
\end{lstlisting}

\begin{itemize}
\item {\ct ONE}\ has the value 1. Smokeview uses this number to determine whether the computer creating the geometry file and the computer viewing the geometry file use the same or different byte swap (endian) conventions for storing floating point numbers.
\item {\ct VERSION}\ currently has value 0 and indicates the version number of this file format.
\item {\ct N\_FLOATS, N\_INTS} The number of floating point and integer data items stored at the beginning of the file.
\item {\ct FLOAT\_HEADER, INT\_HEADER} Floating point and integer data stored at the beginning of the file.
\item {\ct STIME} is the FDS simulation time.
\item {\ct N\_VERT\_S, N\_FACE\_S, N\_VOL\_S, N\_VERT\_D, N\_FACE\_D, N\_VOL\_D}\ are the number of static and dynamic vertices, faces and volumes.
\item {\ct Xtext\_S, Ytext\_S, Xtext\_D, Ytext\_D}\ are the static and dynamic texture coordinates.
\item {\ct Xvert\_S, Yvert\_S, Zvert\_S, Xvert\_D, Yvert\_D, Zvert\_D}\ are the static and dynamic vertex coordinates.
\item {\ct FACE1\_S, FACE2\_S, FACE3\_S, FACE1\_S, FACE2\_S, FACE3\_S}\ are the static and dynamic vertex indices for each face (triangle).  The indices are numbered relative to how vertices were written out earlier.
\item {\ct VOL1\_S, VOL2\_S, VOL3\_S, VOL4\_S, VOL1\_D, VOL2\_D, VOL3\_D, VOL4\_D}\ are the static and dynamic vertex indices for each volume (tetrahedron).  The indices are numbered relative to how vertices were written out earlier.
\item {\ct SURF\_S, SURF\_D}\ are the static and dynamic SURF indices for each face (color indices for isosurface files).
\item {\ct MATL\_S, MATL\_D}\ are the static and dynamic MATL indices for each volume face.
\end{itemize}

\section{Some Geometry Implementation Notes}
These implementation notes will not appear as is in an FDS or Smokeview technical manual. They are written down here to help verify various geometric algorithms coded in FDS and Smokeview.

\subsection{Spheres}
Icosahedron vertex locations
\begin{eqnarray*}
v_1&=&(0,0,1)\\
v_i&=&\left(\cos\left(2\pi\frac{i-1}{5}\right)\sqrt{5/6},\sin\left(2\pi\frac{i-1}{5}\right)\sqrt{5/6},\sqrt{1/6}\right)i=2,\cdots, 6\\
v_i&=&\left(\cos\left(2\pi\frac{i-7+.5}{5}\right)\sqrt{5/6},\sin\left(2\pi\frac{i-7+.5}{5}\right)\sqrt{5/6},\sqrt{1/6}\right)i=7,\cdots, 11\\
v_{12}&=&(0,0,-1)
\end{eqnarray*}

Euler formula for relating the number vertices (V), edges (E) and faces (F) of a closed geometric surface such as the icoshedron used to discretize the sphere.
\begin{eqnarray*}
V+F-E&=&2
\end{eqnarray*}
Number of vertices, face and edges for an icosahedron.
\begin{eqnarray*}
V_0&=&12\\
F_0&=&20\\
E_0&=&30\\
\end{eqnarray*}
Recursion formulas for relating the number of vertices, faces and edges at the $n+1$'st refinement step given the corresponding number at the $n$'th refinement step.
\begin{eqnarray}
\label{eq:recursion1}
V_{n+1}&=&V_n+E_n\\
\label{eq:recursion2}
F_{n+1}&=&4 F_n\\
\label{eq:recursion3}
E_{n+1}&=&3 F_n+2 E_n
\end{eqnarray}

For $n\ge 0$ show that $V_{n+1}+F_{n+1}-E_{n+1}=2$.
Substituting $n=0$ into Eqs. (\ref{eq:recursion1}) through (\ref{eq:recursion3})  results in
\begin{eqnarray*}
V_1+F_1-E_1&=&V_0+E_0+4 F_0 -(3 F_0+2 E_0)\\
&=&12+30+80-(60+60)\\
&=&2
\end{eqnarray*}

Assuming the recursion formulas in Eqs. (\ref{eq:recursion1}) through (\ref{eq:recursion3}) and that $V_n+F_n-E_n=2$ (the induction step) results in
\begin{eqnarray*}
V_{n+1}+F_{n+1}-E_{n+1}&=&V_n+E_n+4 F_n-(3 F_n+2 E_n)\\
&=&V_n+F_n-E_n\\
&=&2
\end{eqnarray*}

Table \ref{table:refinement} gives the number of vertices, faces and edges for the 0'th through 5'th refinements.
This table will be used to verify that the sphere discretization routine, {\tt INIT\_SPHERE}, found in FDS generates the correct number of faces and vertices..
\vskip 0.1in
\par
\begin{table}
\caption{Number of vertices, faces and edges for the 0'th through 5'th icosahedron refinements}
\begin{tabular}{|c|c|c|c|}
  \hline
n& V&F&E\\
\hline
0&	12&	20&	30\\
1&	42&	80&	120\\
2&	162&	320&	480\\
3&	642&	1280&	1920\\
4&	2562&	5120&	7680\\
5&	10242&	20480&	30720\\
  \hline
\end{tabular}
\label{table:refinement}
\end{table}

Table \ref{table:facelist} gives the list of vertices for each face in
an icosahedron where the vertices are numbered as given  in
Figure \ref{figure:facelist}.
\begin{table}
\caption{Vertex list for each Icosahedron face}
\begin{center}
\begin{tabular}{ccccc}
  \hline
  (1,2,3)&   (1, 3,4)&  (1, 4, 5)&   (1, 5, 6)&   (1, 6,2)\\
  (2,11,7)&  (2,7,3)&   (3, 7,8)&  (3, 8, 4)&   (4, 8, 9)\\
  (4, 9,5)&  (5,9,10)&   (5,10,6)& (6,10,11)&   (6,11, 2)   \\
  (11,12,7)& (7,12,8)&   (8,12,9)&   (9,12,10)&   (10,12,11)   \\
  \hline
\end{tabular}
\end{center}
\label{table:facelist}
\end{table}

\begin{figure}[\figoptions]
\begin{center}
\includegraphics[width=4.0in]{../SMV_Technical_Reference_Guide/FIGURES/icosahedron_setup}
\end{center}
\caption{Schematic of icosahedron vertex locations for defining face lists}
\label{figure:facelist}
\end{figure}

\subsection{Boxes}
\subsection{2D Surfaces}

\end{document}



