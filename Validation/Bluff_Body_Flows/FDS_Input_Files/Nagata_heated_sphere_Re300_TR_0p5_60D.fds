# T. Nagata et al. Direct numerical simulation of flow around a heated/cooled isolated
# sphere up to a Reynolds number of 300 under subsonic to supersonic conditions. Int. J.
# Heat and Mass Transfer, 120:284-299, 2018.

&HEAD CHID='Nagata_heated_sphere_Re300_TR_0p5_60D', TITLE='Heated sphere Re=300, temp ratio=0.5, D/dx=60.' /

# Mesh : Total 50 + 32 : 82 meshes.
# Coarse level: 6*3*3-4 : 50 meshes.
&MESH IJK=90,60,60, XB=-4.,-1.,-3.,-1.,-3.,-1., MULT_ID='mesh' /
&MULT ID='mesh', DX=3., DY=2., DZ=2., I_LOWER_SKIP=1, I_UPPER_SKIP=4, I_UPPER=5,
J_LOWER_SKIP=1, J_UPPER_SKIP=1, J_UPPER=2,
K_LOWER_SKIP=1, K_UPPER_SKIP=1, K_UPPER=2 /

# Fine level2: 4*2*2*2 : 32 meshes.
&MESH IJK=90,60,60, XB=-4.,-2.5,-3.,-2,-3.,-2., MULT_ID='mesh2' /
&MULT ID='mesh2', DX=1.5, DY=1., DZ=1., I_LOWER=2, I_UPPER=9, J_LOWER=2, J_UPPER=3, K_LOWER=2, K_UPPER=3 /

# Time:
&TIME T_END=180.0 /

# Misc Parameters:
&DUMP SIG_FIGS=6, SIG_FIGS_EXP=4, DT_DEVC_LINE=50. /
&MISC SIMULATION_MODE='DNS', GVEC(3)=0, STRATIFICATION=F, CONSTANT_SPECIFIC_HEAT_RATIO=T /
&RADI RADIATION=F /
&PRES VELOCITY_TOLERANCE=0.0001, MAX_PRESSURE_ITERATIONS=20 /

# Species:
&SPEC ID='BACKGROUND',BACKGROUND=T, MW=24.055144069133224, DIFFUSIVITY=0.003333333333333, VISCOSITY=0.003333333333333 /

# BCs:
&SURF ID='INLET',VEL=-1. /
&VENT PBX=-4., SURF_ID='INLET'/
&VENT PBX=14., SURF_ID='OPEN' /
&VENT PBY=-3., SURF_ID='PERIODIC' /
&VENT PBY= 3., SURF_ID='PERIODIC' /
&VENT PBZ=-3., SURF_ID='PERIODIC' /
&VENT PBZ= 3., SURF_ID='PERIODIC' /

# Geom:
&SURF ID='SPHERE', COLOR='RED', TMP_FRONT=-126.575 / TR = 0.5 = (-126.575+273.15)/(20.0+273.15)
&GEOM ID='sphere', SURF_ID='SPHERE', SPHERE_ORIGIN=0,0,0, SPHERE_RADIUS=.5, N_LEVELS=3 /

# Output:
&BNDF QUANTITY='WALL PRESSURE', CELL_CENTERED=T /
&BNDF QUANTITY='VISCOUS STRESS WALL', CELL_CENTERED=T /
&BNDF QUANTITY='CONVECTIVE HEAT FLUX', CELL_CENTERED=T /

&SLCF PBY=0, QUANTITY='VELOCITY', VECTOR=T /
&SLCF PBY=0, QUANTITY='TEMPERATURE', CELL_CENTERED=.TRUE., SLICETYPE='INCLUDE_GEOM' /
&SLCF PBY=0, QUANTITY='DIVERGENCE',  CELL_CENTERED=.TRUE., SLICETYPE='INCLUDE_GEOM' /
&ISOF QUANTITY='Q CRITERION', VALUE(1)=5E-4 /

&DEVC XB=-1,1,-1,1,-1,1, QUANTITY='WALL PRESSURE', FORCE_DIRECTION=1,0,0, SURF_ID='SPHERE', STATISTICS='SURFACE INTEGRAL', ID='FPX'/
&DEVC XB=-1,1,-1,1,-1,1, QUANTITY='VISCOUS STRESS WALL', FORCE_DIRECTION=1,0,0, SURF_ID='SPHERE', STATISTICS='SURFACE INTEGRAL', ID='FMUX'/
&DEVC XB=-1,1,-1,1,-1,1, QUANTITY='CONVECTIVE HEAT FLUX', SURF_ID='SPHERE', STATISTICS='SURFACE INTEGRAL', ID='QCONV'/

# Devices: These 4 line devices will be averaged to get velocity at streamwise axis.
&DEVC XB=0.,12.,-0.0001,-0.0001,-0.0001,-0.0001, QUANTITY='U-VELOCITY', ID='vel1', POINTS=120, TIME_HISTORY=T /
&DEVC XB=0.,12., 0.0001, 0.0001,-0.0001,-0.0001, QUANTITY='U-VELOCITY', ID='vel2', POINTS=120, TIME_HISTORY=T /
&DEVC XB=0.,12.,-0.0001,-0.0001, 0.0001, 0.0001, QUANTITY='U-VELOCITY', ID='vel3', POINTS=120, TIME_HISTORY=T /
&DEVC XB=0.,12., 0.0001, 0.0001, 0.0001, 0.0001, QUANTITY='U-VELOCITY', ID='vel4', POINTS=120, TIME_HISTORY=T /

&TAIL /
