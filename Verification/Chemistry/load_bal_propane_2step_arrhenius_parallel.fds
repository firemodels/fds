&HEAD CHID='load_bal_propane_2step_arrhenius_parallel', TITLE='Test propane burning around sphere using 2step Arrhenius chemistry.' /

# 1 MESH:
#& MESH IJK=64,64,96, XB=-2.0,2.0,-2.0,2.0,0.0,6.0 /

# 2 MESHES:
#& MESH IJK=64,64,48, XB=-2.0,2.0,-2.0,2.0,0.0,3.0, MULT_ID='mesh' /
#& MULT ID='mesh', DZ=3, K_UPPER=1 /

# 6 MESHES:
&MESH IJK=32,16,16, XB=-2.0,2.0,-2.0,0.0,0.0,2.0, MULT_ID='mesh' /
&MULT ID='mesh', DY=2, DZ=2, J_UPPER=1, K_UPPER=2 /

&TIME T_END=5.0 /
&MISC STRATIFICATION=.FALSE. / 
#&PRES SOLVER='ULMAT HYPRE' /
&PRES SOLVER='ULMAT' /
&RADI RADIATION=.FALSE. /

# Vents:
&VENT MB='YMIN', SURF_ID='OPEN' /
&VENT MB='YMAX', SURF_ID='OPEN' /
&VENT MB='XMIN', SURF_ID='OPEN' /
&VENT MB='XMAX', SURF_ID='OPEN' /
&VENT MB='ZMAX', SURF_ID='OPEN' /

# Species:
&SPEC ID='NITROGEN', BACKGROUND=.TRUE./
&SPEC ID='PROPANE' /
&SPEC ID='OXYGEN' /
&SPEC ID='WATER VAPOR' /
&SPEC ID='CARBON DIOXIDE' /
&SPEC ID='CARBON MONOXIDE' /

&BACK SPEC_ID='NITROGEN','OXYGEN','WATER VAPOR','CARBON DIOXIDE' ,MASS_FRACTION=0.762470,0.230997,0.005941,0.000591 /

&REAC ID = 'R1'
      FUEL = 'PROPANE'
      A = 5e2
      E = 0.0
      SPEC_ID_NU='PROPANE','OXYGEN','CARBON MONOXIDE','WATER VAPOR'
      SPEC_ID_N_S='PROPANE','OXYGEN'
      NU= -1,-3.5,3,4
      N_S = 0.1,1.65 /

&REAC ID = 'R2'
      FUEL = 'CARBON MONOXIDE'
      A = 8e3
      E = 0.0
      SPEC_ID_NU='CARBON MONOXIDE','OXYGEN','CARBON DIOXIDE'
      SPEC_ID_N_S='OXYGEN','CARBON MONOXIDE','WATER VAPOR'
      NU= -1,-0.5,1
      N_S = 0.25,1,0.5 /

# Note: The values of A and E are not typical for a reaction and are used purely for verification.

&COMB FIXED_MIX_TIME=0.05, DO_CHEM_LOAD_BALANCE=T/

&SURF ID='BURNER', SPEC_ID(1)='PROPANE', MASS_FLUX(1)=0.06355, COLOR='RED' / HRRPUA=3200 kJ/s/m2
&SURF ID='SPHERE', COLOR='GREEN', MATL_ID='SPHERE', THICKNESS=0.1, BACKING='VOID'  /
&MATL ID='SPHERE', DENSITY=100, CONDUCTIVITY=1, SPECIFIC_HEAT=1 /

# Export Parameters:
# ------ ----------
&SLCF PBY=0, QUANTITY='VELOCITY',      VECTOR=.TRUE.        /
&SLCF PBY=0, QUANTITY='H',             CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='F_X'                                 /
&SLCF PBY=0, QUANTITY='DENSITY',       CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='DIFFUSIVITY',   CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='VISCOSITY',     CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='MASS FRACTION', SPEC_ID='PROPANE'    /
&SLCF PBY=0, QUANTITY='DIVERGENCE'     /
&SLCF PBY=0, QUANTITY='TEMPERATURE'    /
&SLCF PBY=0, QUANTITY='HRRPUV'         /

# Boundary colormap in &GEOM surface:
&BNDF QUANTITY='WALL TEMPERATURE' /

# 3D Boundary slices in cut-cell region boundary:
&SLCF QUANTITY='TEMPERATURE',   SLICETYPE='CUT_CELLS'    /

&DEVC ID='WALL-T1', XYZ=0,0,1, IOR=0, QUANTITY='WALL TEMPERATURE' /
&DEVC ID='WALL-T2', XYZ=1,0,2, IOR=0, QUANTITY='WALL TEMPERATURE' /
&DEVC ID='WALL-T3', XYZ=0,0,3, IOR=0, QUANTITY='WALL TEMPERATURE' /

# Geometries:
&OBST XB=-.5,.5,-.5,.5,0.2,.4, SURF_IDS='BURNER','INERT','INERT' /
&GEOM ID='SPHERE', SURF_ID='SPHERE', SPHERE_ORIGIN=0.,0.,2., SPHERE_RADIUS=1., N_LEVELS=3 /

&TAIL /
