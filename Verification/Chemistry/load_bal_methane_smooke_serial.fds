&HEAD CHID='load_bal_methane_smooke_serial', TITLE='Complex Geometry: Test methane burning around sphere using detailed chemistry.' /

# 1 MESH:
#& MESH IJK=64,64,96, XB=-2.0,2.0,-2.0,2.0,0.0,6.0 /

# 2 MESHES:
#& MESH IJK=64,64,48, XB=-2.0,2.0,-2.0,2.0,0.0,3.0, MULT_ID='mesh' /
#& MULT ID='mesh', DZ=3, K_UPPER=1 /

# 6 MESHES:
#&MESH IJK=32,16,16, XB=-2.0,2.0,-2.0,0.0,0.0,2.0, MULT_ID='mesh' /
#&MULT ID='mesh', DY=2, DZ=2, J_UPPER=1, K_UPPER=2 /

# 24 MESHES:
&MESH IJK=16,16,8, XB=-2.0,0.0,-2.0,0.0,0.0,1.0, MULT_ID='mesh' /
&MULT ID='mesh', DX=2, DY=2, DZ=1, I_UPPER=1, J_UPPER=1, K_UPPER=5 /

&TIME T_END=5.0 /
&MISC STRATIFICATION=.FALSE., NOISE=.FALSE. / 
#&PRES SOLVER='ULMAT HYPRE' /
&PRES SOLVER='ULMAT' /
&RADI RADIATION=.FALSE. /

# Vents:
&VENT MB='YMIN', SURF_ID='OPEN' /
&VENT MB='YMAX', SURF_ID='OPEN' /
&VENT MB='XMIN', SURF_ID='OPEN' /
&VENT MB='XMAX', SURF_ID='OPEN' /
&VENT MB='ZMAX', SURF_ID='OPEN' /

# Species:
&COMB ODE_SOLVER='CVODE',ODE_MIN_ATOL=1E-15,ODE_REL_ERROR=1E-9,ZZ_MIN_GLOBAL=1E-15,DO_CHEM_LOAD_BALANCE=F /
&CATF OTHER_FILES='../../Utilities/Input_Libraries/Chemical_Mechanisms/FDS/Methane_Smooke.fds' /
&BACK SPEC_ID='N2','O2','H2O','CO2' ,MASS_FRACTION=0.762470,0.230997,0.005941,0.000591 /

&INIT XB=-.5,.5,-.5,.5,0.4,.8, HRRPUV=1E3,RAMP_Q='R'/
&RAMP ID='R',T=0.00,F=1/
&RAMP ID='R',T=0.05,F=1/
&RAMP ID='R',T=1.95,F=1/
&RAMP ID='R',T=2.00,F=0/

&SURF ID='BURNER', SPEC_ID(1)='CH4', MASS_FLUX(1)=0.06442, COLOR='RED' / HRRPUA=3200 kJ/s/m2
&SURF ID='SPHERE', COLOR='GREEN', MATL_ID='SPHERE', THICKNESS=0.1, BACKING='VOID'  /
&MATL ID='SPHERE', DENSITY=100, CONDUCTIVITY=1, SPECIFIC_HEAT=1 /

# Export Parameters:
# ------ ----------
&SLCF PBY=0, QUANTITY='VELOCITY',      VECTOR=.TRUE.        /
&SLCF PBY=0, QUANTITY='H',             CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='F_X'                                 /
&SLCF PBY=0, QUANTITY='DENSITY',       CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='DIFFUSIVITY',   CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='VISCOSITY',     CELL_CENTERED=.TRUE. /
&SLCF PBY=0, QUANTITY='MASS FRACTION', SPEC_ID='CH4'    /
&SLCF PBY=0, QUANTITY='DIVERGENCE'     /
&SLCF PBY=0, QUANTITY='TEMPERATURE'    /
&SLCF PBY=0, QUANTITY='HRRPUV'         /

# Boundary colormap in &GEOM surface:
&BNDF QUANTITY='WALL TEMPERATURE' /

# 3D Boundary slices in cut-cell region boundary:
&SLCF QUANTITY='TEMPERATURE',   SLICETYPE='CUT_CELLS'    /

&DEVC ID='WALL-T1', XYZ=0,0,1, IOR=0, QUANTITY='WALL TEMPERATURE' /
&DEVC ID='WALL-T2', XYZ=1,0,2, IOR=0, QUANTITY='WALL TEMPERATURE' /
&DEVC ID='WALL-T3', XYZ=0,0,3, IOR=0, QUANTITY='WALL TEMPERATURE' /

# Geometries:
&OBST XB=-.5,.5,-.5,.5,0.2,.4, SURF_IDS='BURNER','INERT','INERT' /
&GEOM ID='SPHERE', SURF_ID='SPHERE', SPHERE_ORIGIN=0.,0.,2., SPHERE_RADIUS=1., N_LEVELS=3 /

&TAIL /
