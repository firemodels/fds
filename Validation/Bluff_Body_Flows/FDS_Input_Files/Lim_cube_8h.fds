# C.H. Lim, T.G. Thomas, I.P. Castro. Flow around a cube in a turbulent boundary layer:
# LES and experiment. Journal of Wind Engineering and Industrial Aerodynamics, 97:96-109, 2009.

&HEAD CHID='Lim_cube_8h', TITLE='Flow over cube Re=20,000, h/dx=8' /

&MULT ID='m1', DX=0.9, I_UPPER=4/ 5 mesh
&MESH IJK=90,90,60, XB=-2.25,-1.35,-0.45,0.45,0,0.6, MULT_ID='m1'/ single mesh case

&TIME T_END=10.0 /

&DUMP DT_DEVC=0.001/

&MISC SIMULATION_MODE='LES', GVEC(3)=0, STRATIFICATION=F, CONSTANT_SPECIFIC_HEAT_RATIO=T, BNDF_DEFAULT=F /
&RADI RADIATION=F /

&SURF ID='INLET', VEL=-1.0, PROFILE='RAMP', RAMP_V_Z='INLET PROFILE', COLOR='GREEN', TRANSPARENCY=0.5/ Re_h=20000
&SURF ID='ROUGH WALL', ROUGHNESS=0.0027, COLOR='GRAY' / ROUGHNESS=30*Z0=30*(0.09mm)

# Ramp based on Lim JFM 2007 Fig 1 data for small tunnel
# It is basically a power law with U/Uh = (z/h)**0.18, with Uh=4.5 and h=0.08
&RAMP ID='INLET PROFILE', T=0.,     F=0./
&RAMP ID='INLET PROFILE', T=0.0010, F=2.0448/
&RAMP ID='INLET PROFILE', T=0.0022, F=2.3478/
&RAMP ID='INLET PROFILE', T=0.0046, F=2.6956/
&RAMP ID='INLET PROFILE', T=0.0100, F=3.0950/
&RAMP ID='INLET PROFILE', T=0.0215, F=3.5535/
&RAMP ID='INLET PROFILE', T=0.0464, F=4.0800/
&RAMP ID='INLET PROFILE', T=0.1000, F=4.6844/
&RAMP ID='INLET PROFILE', T=0.2154, F=5.2785/
&RAMP ID='INLET PROFILE', T=0.4642, F=5.2785/
&RAMP ID='INLET PROFILE', T=0.6000, F=5.2785/

&VENT PBX=-2.25, SURF_ID='INLET', N_EDDY=100, L_EDDY=0.064, VEL_RMS=0.81/ u'=18% U_h, Lu=0.8h
&VENT PBX= 2.25, SURF_ID='OPEN' /
&VENT PBZ= 0.00, SURF_ID='ROUGH WALL' /

# Geom:
&SURF ID='CUBE', COLOR='BLUE' /
! &GEOM XB=0,0.08,-0.04,0.04,0,0.08, SURF_ID='CUBE', BNDF_GEOM=T /
&OBST XB=0,0.08,-0.04,0.04,0,0.08, SURF_ID='CUBE', BNDF_OBST=T /

&PROP ID='U_INF', CHARACTERISTIC_VELOCITY=4.5 /
&BNDF QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', CELL_CENTERED=T /
&BNDF QUANTITY='FRICTION VELOCITY', CELL_CENTERED=T /

&SLCF PBX=-2.249, QUANTITY='VELOCITY', VECTOR=T /
&SLCF PBX= 0.04, QUANTITY='VELOCITY', VECTOR=T /

&SLCF PBY=0.0001, QUANTITY='VELOCITY', VECTOR=T /
&SLCF PBY=0.0001, QUANTITY='TEMPERATURE', CELL_CENTERED=T /
&SLCF PBY=0.0001, QUANTITY='PRESSURE', CELL_CENTERED=T /
&SLCF PBY=0.0001, QUANTITY='H', CELL_CENTERED=T /

&SLCF PBZ=0.08, QUANTITY='VELOCITY', VECTOR=T /

# Pressure coefficients
&DEVC XB=-0.001,-0.001,  0,0, 0.005,  0.075,  IOR=-1, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_FRONT'/
&DEVC XB= 0.005, 0.075,  0,0, 0.0801, 0.0801, IOR= 3, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_TOP'/
&DEVC XB= 0.0801,0.0801, 0,0, 0.005,  0.075,  IOR= 1, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_REAR'/

&DEVC XB=0.04,0.04,-0.0401,-0.0401, 0.005,  0.075,  IOR=-2, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_SIDE1'/
&DEVC XB=0.04,0.04,-0.035,  0.035,  0.0801, 0.0801, IOR= 3, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_CROSS_TOP'/
&DEVC XB=0.04,0.04, 0.0401, 0.0401, 0.005,  0.075,  IOR= 2, QUANTITY='PRESSURE COEFFICIENT', PROP_ID='U_INF', POINTS=10, ID='CP_SIDE2'/

# For frequency spectra
&DEVC XB=-1,-1,0,0,0.08,0.08, QUANTITY='U-VELOCITY', ID='U'/

# Mean inlet profile
&DEVC XB=-2,-2,0,0,0.002,0.156, POINTS=39, QUANTITY='U-VELOCITY', ID='U_INLET_1'/
&DEVC XB=-1,-1,0,0,0.002,0.156, POINTS=39, QUANTITY='U-VELOCITY', ID='U_INLET_2', HIDE_COORDINATES=T/

# Mean streamwise velocity above cube
&DEVC XB=0.000,0.000,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U0'/
&DEVC XB=0.008,0.008,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U1', HIDE_COORDINATES=T/
&DEVC XB=0.016,0.016,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U2', HIDE_COORDINATES=T/
&DEVC XB=0.024,0.024,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U3', HIDE_COORDINATES=T/
&DEVC XB=0.032,0.032,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U4', HIDE_COORDINATES=T/
&DEVC XB=0.040,0.040,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U5', HIDE_COORDINATES=T/
&DEVC XB=0.048,0.048,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U6', HIDE_COORDINATES=T/
&DEVC XB=0.056,0.056,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U7', HIDE_COORDINATES=T/
&DEVC XB=0.064,0.064,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U8', HIDE_COORDINATES=T/
&DEVC XB=0.072,0.072,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U9', HIDE_COORDINATES=T/
&DEVC XB=0.080,0.080,0,0,0.002,0.078, POINTS=19, QUANTITY='U-VELOCITY', ID='U10', HIDE_COORDINATES=T/

&TAIL /
