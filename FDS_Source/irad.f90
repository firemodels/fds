!------------------------------------------------------------------------------
! This file contains 4 modules
! 1 - RADCONS
! 2 - RADCALV
! 3 - SPECDATA
! 4 - MIEV
!------------------------------------------------------------------------------


MODULE RADCONS
!------------------------------------------------------------------------------
! Radiation Parameters

USE PRECISION_PARAMETERS
IMPLICIT NONE

REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: DLN
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: BBFRAC, WL_LOW, WL_HIGH
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: DLX, DLY, DLZ, DLB, RSA

INTEGER, ALLOCATABLE, DIMENSION(:,:) :: DLM
INTEGER, ALLOCATABLE, DIMENSION(:)   :: NRP

REAL(EB) :: RADTMP, PATH_LENGTH, RADIATIVE_FRACTION
REAL(EB) :: DGROUP_A, DGROUP_B, WEIGH_CYL
REAL(EB) :: DPHI0, FOUR_SIGMA, RPI_SIGMA, LTSTEP, RTMPMAX, RTMPMIN
REAL(EB) :: MIE_MINIMUM_DIAMETER,MIE_MAXIMUM_DIAMETER

INTEGER :: TIME_STEP_INCREMENT,NMIEANG
INTEGER :: NRDMIE, NLMBDMIE, MIE_NDG
INTEGER :: NRT,NCO,UIIDIM,NLAMBDAT,NKAPPAT,NKAPPAZ

LOGICAL :: WIDE_BAND_MODEL, CH4_BANDS

INTEGER :: N_RADCAL_SPECIES,RADCAL_SPECIES_INDEX(11),N_KAPPA_T=44,N_KAPPA_Y=50
REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: Z2RADCAL_SPECIES
REAL(EB), ALLOCATABLE, DIMENSION(:,:,:,:) :: RADCAL_SPECIES2KAPPA
CHARACTER(30) :: RADCAL_SPECIES(11)='null'


!------------------------------------------------------------------------------
!
!     BBFRAC    Fraction of blackbody radiation
!     DLX       Mean X-component of the control angle ray vector
!     DLY       Mean Y-component of the control angle ray vector
!     DLZ       Mean Z-component of the control angle ray vector
!     DLB       Mean Bottom-component of rayn vector (cylindrical case)
!     DLM       Mirroring indexes
!     DLN       Wall normal matrix
!     DPHI0     Opening angle of the cylindrical domain
!     E_WALL    Wall emissivity
!     ILW       Radiation intensities on solid mirrors and mesh interfaces.
!               Intensity integrals (band specific or angle increment) for solid and open walls
!     INRAD_W   Incident radiative heat flux on a cell (QRADIN = E_WALL*INRAD_W)
!     R50       Array of PARTICLE radii corresponding to the median diameters 
!               of the distributions used in the generation of WQABS and WQSCA arrays.
!     MIE_NDG   Number of PARTICLE radii in WQABS and WQSCA arrays
!     NLMBDMIE  Number of wave lengths in Mie calculations
!     NMIEANG   Number of angle bins in forward scattering integration
!     NUMBER_RADIATION_ANGLES
!     NRA       Total number of radiation control angles
!     NRDMIE    Number of PARTICLE radii in Mie calculations
!     NRT       Number of radiation theta angles
!     NRP       Number of radiation phi angles on each theta band
!     NUMBER_SPECTRA_BANDS
!     NSB       Number of spectral bands (1=gray, 6=wide band, 9=wide band w. CH4)
!     OUTRAD_W  Emitted intensity from a wall (OUTRAD_W = QRADOUT/PI)
!     PHIUP     Upper limit of solid angle component PHI
!     PHILOW    Lower limit of solid angle component PHI
!     RADTMP    Radiation temperature for absorption properties (Mie)
!     QRADIN    Absorbed radiative heat flux into a surface cell (solid wall or open)
!     QRADOUT   Emitted radiative heat flux from a surface (solid wall or open) 
!     RSA       Array of solid angles
!     RTMPMAX   Maximum temperature for tabulation of radiative properties
!     RTMPMIN   Minimum temperature for tabulation of radiative properties
!     THETAUP   Upper limit of solid angle component THETA
!     THETALOW  Lower limit of solid angle component THETA
!     UII       Integrated intensity
!     UIID      Parts of UII  if WIDE_BAND_MODEL = TRUE, UIID contains the band specific intensity
!                             if WIDE_BAND_MODEL/= TRUE, UIID contains the ANGLE_INCREMENTs of intensity
!     WEIGH_CYL In cylindrical coordinates, all intensities represent two actual control angles
!     WL_LOW    Lower wavelength limit of the spectral bands
!     WL_HIGH   Upper wavelength limit of the spectral bands
!     WQABS     Absorption efficiency factor array 
!     WQSCA     Scattering efficiency factor array
!
!     PATH_LENGTH             Mean path length for the gray gas abs. coef.
!     ANGLE_INCREMENT         How many angles are skipped on each update
!     TIME_STEP_INCREMENT     How often is the radiation solver called
!
!------------------------------------------------------------------------------

END MODULE RADCONS



MODULE RADCALV

!------------------------------------------------------------------------------
! VARIABLES
! OMMIN : (REAL) MINIMUM WAVE NUMBER IN SPECTRUM, CM-1
! OMMAX : (REAL) MAXIMUM WAVE NUMBER IN SPECTRUM, CM-1
! NOM   : (INTEGER) NUMBER OF WAVELENGTH INTERVALS
! GC    : (REAL) COLLISION BROADENED HALF-WIDTH
! LAMBDA: (REAL) WAVELENGTH, IN MICROMETER 
!------------------------------------------------------------------------------
! Module wrapper for RadCal subroutine

USE PRECISION_PARAMETERS
USE GLOBAL_CONSTANTS, ONLY: AL2O3
IMPLICIT NONE

PRIVATE
CHARACTER(255), PARAMETER :: iradid='$Id$'
CHARACTER(255), PARAMETER :: iradrev='$Revision$'
CHARACTER(255), PARAMETER :: iraddate='$Date$'

! RADCAL MODULE PUBLIC VARIABLES
PUBLIC OMMAX, OMMIN, DD, SPECIE, SVF, P, RCT

! RADCAL MODULE PUBLIC PROCEDURES
PUBLIC RCALLOC, INIT_RADCAL, RADCAL, PLANCK, RCDEALLOC, GET_REV_irad

! RADCAL MODULE PUBLIC VARIABLES DEFINITION
REAL(EB), ALLOCATABLE, DIMENSION(:)   :: SPECIE, P

REAL(EB) :: OMMIN, OMMAX, RCT, DD, SVF
!-------------------------------------------------

REAL(EB), ALLOCATABLE, DIMENSION(:,:) :: GAMMA, SD15, SD, SD7, SD3,    &
                                         SD1_CH4, SD2_CH4, OM_BND_CH4  ! FOR METHANE NEW DATA 

INTEGER :: N_TEMP_C3H6,   N_BAND_C3H6
INTEGER :: N_TEMP_C3H8,   N_BAND_C3H8
INTEGER :: N_TEMP_C7H16,  N_BAND_C7H16
INTEGER :: N_TEMP_C7H8,   N_BAND_C7H8
INTEGER :: N_TEMP_CH4,    N_BAND_CH4
INTEGER :: N_TEMP_CH3OH,  N_BAND_CH3OH
INTEGER :: N_TEMP_C5H8O2, N_BAND_C5H8O2
INTEGER :: N_TEMP_C2H6,   N_BAND_C2H6
INTEGER :: N_TEMP_C2H4,   N_BAND_C2H4

INTEGER :: I_MODEL_C3H6   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C3H8   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C7H16  ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C7H8   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CH3OH  ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C5H8O2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C2H6   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_C2H4   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

INTEGER :: I_MODEL_CO2   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_H2O   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CO    ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 
INTEGER :: I_MODEL_CH4   ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C3H6_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C3H8_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C7H16_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C7H8_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_CH3OH_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C5H8O2_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C2H6_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_C2H4_TEMP
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: SD_CH4_TEMP

REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C3H6
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C3H8
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C7H16
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C7H8
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_CH3OH
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C5H8O2
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C2H6
REAL(EB), ALLOCATABLE, DIMENSION(:)    :: Be_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: OM_BND_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C3H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C3H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C7H16

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD5_C7H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_CH3OH

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD5_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD6_C5H8O2

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C2H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD1_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD2_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD3_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: SD4_C2H4

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C3H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C3H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C3H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C3H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C7H16
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C7H16

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C7H8
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD5_C7H8

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_CH3OH
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_CH3OH

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD5_C5H8O2
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD6_C5H8O2

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C2H6
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C2H6

REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD1_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD2_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD3_C2H4
REAL(EB), ALLOCATABLE, TARGET, DIMENSION(:,:)  :: GAMMAD4_C2H4

REAL(EB), DIMENSION(:,:), POINTER, PRIVATE :: KAPPA_D, GAMMA_D
REAL(EB), DIMENSION(:),   POINTER, PRIVATE :: BAND_OMEGA

REAL(EB), ALLOCATABLE, DIMENSION(:) :: QW, TTAU, XT, AB, LAMBDA, ATOT, BCNT, &
                                       OPTICAL_THICKNESS, GC, X

REAL(EB) :: TWALL

REAL(EB), PARAMETER :: SIGMA     = 5.670400E-8_EB

INTEGER :: NOM

CONTAINS

!==============================================================================
SUBROUTINE GET_REV_irad(MODULE_REV,MODULE_DATE)
!==============================================================================
! Variables passed in

 INTEGER, INTENT(INOUT) :: MODULE_REV
 CHARACTER(255),INTENT(INOUT) :: MODULE_DATE
!------------------------------------------------------------------------------

 WRITE(MODULE_DATE,'(A)') iradrev(INDEX(iradrev,':')+2:LEN_TRIM(iradrev)-2)
 READ (MODULE_DATE,'(I5)') MODULE_REV
 WRITE(MODULE_DATE,'(A)') iraddate

!------------------------------------------------------------------------------
END SUBROUTINE GET_REV_irad


!==============================================================================
SUBROUTINE INIT_RADCAL
!==============================================================================
! 
 USE RADCONS, ONLY: RADTMP
!------------------------------------------------------------------------------

 TWALL = RADTMP

 IF(OMMAX<1100._EB) THEN 
    NOM=INT((OMMAX-OMMIN)/5._EB)
 ELSEIF(OMMIN>5000._EB) THEN
    NOM=INT((OMMAX-OMMIN)/50._EB)
 ELSEIF(OMMIN<1100._EB.AND.OMMAX>5000._EB) THEN
    NOM=INT((1100._EB-OMMIN)/5._EB)+INT((5000._EB-1100._EB)/25._EB) +INT((OMMAX-5000._EB)/50._EB)
 ELSEIF(OMMIN<1100._EB) THEN
    NOM=INT((1100._EB-OMMIN)/5._EB)+INT((OMMAX-1100._EB)/25._EB)
 ELSEIF(OMMAX>5000._EB) THEN
    NOM=INT((5000._EB-OMMIN)/25._EB)+INT((OMMAX-5000._EB)/50._EB)
 ELSE
    NOM=INT((OMMAX-OMMIN)/25._EB)
 ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE INIT_RADCAL


!==============================================================================
SUBROUTINE RADCAL(AMEAN,AP0,RADCAL_ID)
!==============================================================================
!
! VARIABLES PASSED IN
!-------- 
! RADCAL_ID: CHARACTER(30): RADCAL FUEL PROPERTIES
!
! VARIABLES PASSED OUT
!-------
! AMEAN : (REAL) EFFECTIVE ABSORPTION COEFFICIENT IN UNIFORM MEDIUM
! AP0   : (REAL) PLANCK MEAN ABSORPTION COEFFCIENT IN UNIFORM MEDIUM
!
! LOCAL
!------
! A_COLLISION : (REAL) Collision broadened fine structure parameter
!               (line_half_width/line_spacing)
! A_DOPPLER :   (REAL) Doppler broadened fine structure parameter
!               (line_half_width/line_spacing)
! AZOTEMP   : (REAL) RATIO REFERENCE TEMPERATURE (273K) OVER LOCAL TEMPERATURE
! DOM   : (REAL) INCREMENT OF WAVENUMBER
! OMEGA : (REAL) WAVENUMBER
! OPTICAL_THICKNESS: (REAL) OPTICAL THICKNESS OF THE ith SPECIES,  UNITS: cmSTP
! PTOT  : (REAL) TOTAL PRESSURE IN ATM
! TEMP4 : (REAL) LOCAL TEMPERATURE RAISED TO THE POWER 4
! 
! X_COLLISION: (REAL) ! OPTICAL DEPTH FOR A PURE COLLISION CURVE OF GROWTH
! X_DOPPLER  : (REAL) ! OPTICAL DEPTH FOR A PURE DOPPLER CURVE OF GROWTH
! X_PARTICLE : (REAL) ! OPTICAL DEPTH FOR PARTICLE
! 
! SPECIES: CO2: 5 BANDS (4 Modeled, 1 Tabulated)
!          H2O: 5 BANDS (5 Tabulated)
!          CO: 1 BANDS (Modeled)
!          old CH4: 3 BANDS (1 Modeled, 2 Tabulated)
!          New CH4: 3 BANDS (1 Modeled, 2 Tabulated)
!          C3H8:    2 BANDS (2 Tabulated)
!          C3H6:    
!          C7H16:
!          C7H8:
!          MMA:
!          CH3OH:
!------------------------------------------------------------------------------
USE RADCONS, ONLY:RPI_SIGMA

! VARIABLES PASSED IN
CHARACTER(30),INTENT(IN):: RADCAL_ID

! VARIABLES PASSED OUT
REAL (EB), INTENT(OUT) :: AMEAN, AP0

! LOCALS

REAL(EB) :: AZORCT, RCT4, PTOT, TEMP

REAL(EB) :: X_PARTICLE, X_DOPPLER, X_COLLISION
 
REAL(EB) :: DOM, ABGAS, RSL, RSS,                  &
            OMEGA, WAVE_LENGTH, Q, LTERM,          & 
            DAMBDA, SDWEAK, A_COLLISION, A_DOPPLER

 REAL(EB) :: TAU, TAUS, XTOT, XSTAR
             
! REAL(EB) :: AIWALL

 INTEGER :: I_MODEL ! MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

 INTEGER :: I, II, KK, NM, KMAX, KMIN

! [NOTE: THE TOTAL INTENSITY CALCULATED IS THAT WHICH LEAVES INTERVAL J=1.
! P(I,J) IS PARTIAL PRESSURE, ATM, OF SPECIES I IN  INTERVAL J.
! I=1,2,3,4,5, OR 6 IMPLIES SPECIES IS CO2, H2O, FUEL, CO, O2, OR N2, RESP.]

AZORCT = 273._EB/RCT
RCT4   = RCT**4

! COMPUTE TOTAL PRESSURE
PTOT   = SUM(P(1:6))

!---------------------------------------------------------------------------------------
! COMPUTE SPECIES OPTICAL THICKNESS AND COLLISION BROADENING
! (CALCULATION PROCEEDS IN ACCORDANCE WITH THE SLG MODEL, TABLE 5-18, IN NASA SP-3080._EB)

DO I = 1, 4  ! LOOP OVER CO2(I=1), H2O(I=2), FUEL(I=3), CO(I=4) 
   OPTICAL_THICKNESS(I) = AZORCT*P(I)*100._EB*DD ! COMPUTE OPTICAL THICKNESS FOR THE ith SPECIES

! Compute collisional broadening half-width at half height, EQ 5-34 NASA REPORT SP-3080
   GC(I) = 0.0_EB

! INCLUDE NON-RESONANT FOREIGN AND SELF-BROADENING COLLISIONS
   DO II=1,6
      GC(I)=GC(I)+GAMMA(I,II)*P(II)*SQRT(AZORCT)
   ENDDO

! INCLUDE RESONANT SELF-BROADENING COLLISIONS
   GC(I)=GC(I)+GAMMA(I,7)*P(I)*AZORCT          
ENDDO

! LOOP SPECTRUM COMPUTES EACH SPECTRAL CONTRIBUTION, LOOP OVER EACH WAVE NUMBER INTERVALS
DOM    = 5.0_EB
OMEGA  = OMMIN-DOM
NM     = NOM-1

LSPECTRUM: DO KK = 1, NOM

   OMEGA=OMEGA+DOM
   IF(OMEGA>1100._EB) OMEGA = OMEGA+20._EB
   IF(OMEGA>5000._EB) OMEGA = OMEGA+25._EB

   LAMBDA(KK) = 10000._EB/OMEGA  ! COMPUTE LAMBDA (WAVELENGTH) IN microMETER
   ABGAS      = 0._EB
 
! LOOP SPECIES COMPUTES THE CONTRIBUTION OF EACH SPECIES TO TAU
! IF SPECIE(I) IS SET TO 0., THAT PARTICULAR RADIATING SPECIES IS NOT PRESENT.  THE SPECIES CONSIDERED ARE
!          I   SPECIES
!          1     CO2
!          2     H2O
!          3     FUEL (CH4, C3H8, C7H16, CH3OH, ...)
!          4     CO
!          5     PARTICULATES

   LSPECIES: DO I=1,4

      I_MODEL = 1 ! ENFORCE GOODY MODEL WHEN NOT SPECIFIED  

      IF(SPECIE(I) <= TWO_EPSILON_EB) THEN
         A_COLLISION = 1.0_EB
         A_DOPPLER   = 1.0_EB
         X(I)        = TWO_EPSILON_EB
         CYCLE LSPECIES
      ELSE
         TEMP  = RCT
         SELECT CASE (I)
            CASE (1)
               CALL CO2(OMEGA,TEMP,GC(1),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
            CASE (2)
               CALL H2O(OMEGA,TEMP,GC(2),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
            CASE (3)
               SELECT CASE(RADCAL_ID)
                  CASE('METHANE_OLD') ; CALL CH4_OLD(OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('METHANE')     ; CALL CH4(    OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('PROPANE')     ; CALL C3H8(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('N-HEPTANE')   ; CALL C7H16(  OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('METHANOL')    ; CALL CH3OH(  OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('TOLUENE')     ; CALL C7H8(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('PROPYLENE')   ; CALL C3H6(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('MMA')         ; CALL C5H8O2( OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('ETHANE')      ; CALL C2H6(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE('ETHYLENE')    ; CALL C2H4(   OMEGA,TEMP,P(3),PTOT,SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
                  CASE DEFAULT        ; CALL CH4(    OMEGA,TEMP,P(3),PTOT,GC(3),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
               END SELECT                 
            CASE (4)
               CALL CO(OMEGA,TEMP,GC(4),SDWEAK,A_COLLISION,A_DOPPLER,I_MODEL)
         END SELECT

         XSTAR = SDWEAK*OPTICAL_THICKNESS(I) ! OPTICAL DEPTH FOR THE WEAK LINE LIMIT.  SP-3080 EQ. 5-27
         ABGAS = XSTAR/DD+ABGAS

         IF (XSTAR >= 1.E-10_EB) THEN
!------------------------------------------------------------------------------
! COMPUTE THE OPTICAL DEPTH FOR THE Ith SPECIES USING RANDOM BAND MODEL
! COMPOSED OF LINES OF DOPPLER-LORENTZ SHAPE WITH:
! RANDOM DISTRIBUTION OF EITHER EQUAL STRENGTH LINES FOR DOPPLER OR DECAYING
! USE APPROPRIATE MODEL FOR LORENTZ LINE (ELSASSER,GOODY,MALKMUS)
! COMPUTE OPTICAL DEPTH FOR PURE DOPPLER CURVE OF GROWTH 

            X_DOPPLER = GROWTH_DOPPLER(XSTAR,A_DOPPLER,I_MODEL)
 
! LORENTZ OPTICAL DEPTH 
! COMPUTE OPTICAL DEPTH FOR PURE COLLISION CURVE OF GROWTH 
            SELECT CASE (I_MODEL)
                CASE(1)  ! GOODY MODEL
                    X_COLLISION = GOODY(XSTAR,A_COLLISION)
                CASE(2)  ! MALKMUS MODEL
                    X_COLLISION = MALKMUS(XSTAR,A_COLLISION)
                CASE(3)  ! ELSASSER MODEL
                    X_COLLISION = ELSASSER(XSTAR,A_COLLISION)
                CASE DEFAULT
                    X_COLLISION = GOODY(XSTAR,A_COLLISION)
            END SELECT

! COMPUTE OPTICAL DEPTH
            X(I) = COMBINED_LINES(X_COLLISION, X_DOPPLER, XSTAR)

         ELSE ! XSTAR < 1.E-10_EB very weak line
            X(I) = XSTAR
         ENDIF ! CONDITION (XSTAR >= 1.E-10_EB)

      ENDIF ! CONDITION (P(I)<=TWO_EPSILON_EB)

   END DO LSPECIES

! DETERMINE OPTICAL DEPTH OF SOOT

   IF (SPECIE(5)<=TWO_EPSILON_EB) THEN
      X_PARTICLE = 0._EB
   ELSE
      CALL POD(OMEGA, X_PARTICLE)
   ENDIF

   AB(KK) = ABGAS+X_PARTICLE/DD

! Evaluate the combined spectral transmissivity and radiance

   XTOT = SUM(X(1:4))+X_PARTICLE

   TAU  = EXP(-XTOT)
   
   XT(KK)  = XTOT
   TTAU(KK)= TAU
   QW(KK)  = (1.0_EB-TAU)*PLANCK(RCT,LAMBDA(KK))+TTAU(KK)*PLANCK(TWALL,LAMBDA(KK))

ENDDO LSPECTRUM
     
! INTEGRATE THE RADIANCE OVER THE SPECTRUM

Q = QW(1)*(LAMBDA(1)-LAMBDA(2))

DO KK = 2,NM
   Q = Q+QW(KK)*0.5_EB*(LAMBDA(KK-1)-LAMBDA(KK+1))
ENDDO

Q = Q+QW(NOM)*(LAMBDA(NOM-1)-LAMBDA(NOM))

!------------------------------------------------------------------------------
! SOOT CONTRIBUTION
! DETERMINE SOOT RADIANCE FOR SHORT AND LONG WAVELENGTHS.
     
RSL    = 0._EB
RSS    = 0._EB

IF(.NOT.(SPECIE(5)<=TWO_EPSILON_EB .AND. TWALL<=TWO_EPSILON_EB)) THEN

   KMAX = INT(OMMIN)
   KMIN = INT(OMMAX)

SHORT: DO KK = 5, KMAX, 5 ! LOOP OVER LONG WAVELENGTHS

      OMEGA       = REAL(KK,EB)
      WAVE_LENGTH = 10000._EB/OMEGA
      DAMBDA      = 10000._EB/(OMEGA-2.5_EB)-10000._EB/(OMEGA+2.5_EB)

      CALL POD(OMEGA,X_PARTICLE)  
      TAUS = EXP(-X_PARTICLE)
      RSL  = RSL + TAUS*PLANCK(TWALL,WAVE_LENGTH)*DAMBDA-(TAUS-1._EB)*PLANCK(RCT,WAVE_LENGTH)*DAMBDA

   ENDDO SHORT

LONG: DO KK = KMIN, 25000, 100 ! LOOP OVER SHORT WAVELENGTHS
      OMEGA       = REAL(KK,EB)
      WAVE_LENGTH = 10000._EB/OMEGA
      DAMBDA      = 10000._EB/(OMEGA-50._EB)-10000._EB/(OMEGA+50._EB)

      CALL POD(OMEGA,X_PARTICLE)
      TAUS = DEXP(-X_PARTICLE)
      RSS  = RSS + TAUS*PLANCK(TWALL,WAVE_LENGTH)*DAMBDA-(TAUS-1._EB)*PLANCK(RCT,WAVE_LENGTH)*DAMBDA
   ENDDO LONG

ENDIF

! ADD THE CONTRIBUTION OF SOOT OVER LARGER WAVE LENGTH DOMAIN
Q = Q + RSS + RSL

! COMPUTE AMEAN
IF(ABS(TWALL-RCT)<=SPACING(TWALL) .OR. TWALL<=TWO_EPSILON_EB) THEN
   LTERM  = MAX(1E-20_EB,(Q/RPI_SIGMA-RCT4)/(-RCT4))
ELSE
   LTERM  = MAX(1E-20_EB,(Q/RPI_SIGMA-RCT4)/(TWALL**4-RCT4))   
ENDIF

AMEAN  = -1._EB/DD*DLOG(LTERM)

! THE FOLLOWING SECTION COMPUTES THE MEAN ABSORPTION COEFFICIENTS IF THE SYSTEM IS HOMOGENEOUS (IE., NPT=1).
! INTEGRATE AP0*PLANCK OVER LAMBDA

AP0 = AB(1)*0.5_EB*(LAMBDA(1)-LAMBDA(2))*PLANCK(RCT,LAMBDA(1))

DO KK = 2, NM
   AP0 = AP0 + AB(KK)*0.5_EB*(LAMBDA(KK-1)-LAMBDA(KK+1))*PLANCK(RCT,LAMBDA(KK))
ENDDO

AP0 = AP0 + AB(NOM)*0.5_EB*(LAMBDA(NM)-LAMBDA(NOM))*PLANCK(RCT,LAMBDA(NOM))

! DIVIDE BY SIGMA*PI*TEMP**4 TO GET FINAL COEFFICIENT AP0 

AP0 = AP0/(RPI_SIGMA*RCT4)

!------------------------------------------------------------------------------
END SUBROUTINE RADCAL

!==============================================================================
FUNCTION GROWTH_DOPPLER(XSTAR,A_DOPPLER,I_MODEL) RESULT(X_DOPPLER)
!==============================================================================
! THIS FUNCTION COMPUTES THE DOPPLER CURVE OF GROWTH.
! TWO CASES
! 1) EQUALLY INTENSE, RANDOMLY SPACED DOPPLER LINE (I_MODEL =1 or 3)
! 2) GEOMETRICALLY DECAYING STRENGTH, RANDOMLY SPACED DOPPLER LINE (I_MODEL=2)
!
! VARIABLES IN:
! XSTAR: OPTICAL PATHLENGTH * LINE STRENGTH
! A_DOPPLER: DOPPLER FINE STRUCTURE PARAMETER
! I_MODEL: MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
!
! VARIABLE OUT
! X_DOPPLER

! VARIABLES IN:
REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_DOPPLER
INTEGER, INTENT(IN)  :: I_MODEL

! VARIABLE OUT
REAL :: X_DOPPLER

! SOURCE: ! SP-3080, CHAP 3.2.5 e and f. SEE page 105.

SELECT CASE(I_MODEL)
   CASE(1) ! GOODY MODEL: EQUALLY INTENSE, RANDOMLY SPACED DOPPLER LINE 
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
   CASE(2) ! MALKMUS: GEOMETRICALLY DECAYING STRENGTH, RANDOMLY SPACED DOPPLER LINE
       X_DOPPLER = 0.937_EB*A_DOPPLER*(DLOG(1.0_EB+(1.07_EB*XSTAR/A_DOPPLER)**(0.6666_EB)))* &
                                  SQRT(DLOG(1.0_EB+(1.07_EB*XSTAR/A_DOPPLER)**(0.6666_EB)))
   CASE(3)
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
   CASE DEFAULT
       X_DOPPLER = 1.7_EB*A_DOPPLER*SQRT(DLOG(1._EB+(0.58824_EB*XSTAR/A_DOPPLER)**2)) 
END SELECT
!------------------------------------------------------------------------------
END FUNCTION GROWTH_DOPPLER

!==============================================================================
FUNCTION COMBINED_LINES(X_COLLISION, X_DOPPLER, XSTAR) RESULT(OPTICAL_DEPTH)
!==============================================================================
! COMPUTE THE COMBINED COLLISION AND DOPPLER OPTICAL DEPTHS AND 
! THE OPTICAL DEPTH BASED ON EXPRESSION GIVEN IN SP-3080 EQ 5-26 (p220)
!
! VARIABLES IN:
! X_COLLISION : LORENZ CURVE OF GROWTH
! X_DOPPLER: DOPPLER CURVE OF GROWTH
! XSTAR: OPTICAL PATHLENGTH * LINE STRENGTH
!
! VARIABLE OUT
! OPTICAL_DEPTH

! VARIABLES PASSED IN
REAL(EB), INTENT(IN) :: X_COLLISION
REAL(EB), INTENT(IN) :: X_DOPPLER
REAL(EB), INTENT(IN) :: XSTAR

! VARIABLE PASSED OUTPUT
REAL(EB) :: OPTICAL_DEPTH

! LOCAL VARIABLES
REAL(EB) :: Y_DOPPLER, Y_COLLISION, Y_COMBINED

! COMPUTE THE COMBINED COLLISION AND DOPPLER OPTICAL DEPTHS Y_COMBINED

Y_DOPPLER   = 1._EB-(X_DOPPLER/XSTAR)**2
Y_COLLISION = 1._EB-(X_COLLISION/XSTAR)**2
 
! SP-3080 EQ. 5-26
Y_COMBINED = MAX(1._EB/Y_COLLISION**2+1._EB/Y_DOPPLER**2-1._EB,1._EB)

! FINALLY COMPUTE OPTICAL DEPTH
! SP-3080 EQ. 5-25
 OPTICAL_DEPTH = XSTAR*SQRT(1._EB-(Y_COMBINED**(-0.5_EB))) 

!------------------------------------------------------------------------------
END FUNCTION COMBINED_LINES

!==============================================================================
FUNCTION GOODY(XSTAR,A_COLLISION) RESULT(X_GOODY)
!==============================================================================

! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE GOODY STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_GOODY
  
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_GOODY

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_GOODY = XSTAR
ELSEIF(XSTAR>1.0E+5_EB) THEN ! STRONG LINE LIMIT
   X_GOODY = SQRT(4.0_EB*XSTAR*A_COLLISION)
ELSE             ! FORMULATION TO AVOID DIVISION BY ZERO
                 !X_GOODY = XSTAR/SQRT(1._EB+0.25_EB*XSTAR/A_COLLISION)
   X_GOODY = SQRT(A_COLLISION)*XSTAR/SQRT(A_COLLISION+0.25_EB*XSTAR)
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION GOODY

!==============================================================================
FUNCTION MALKMUS(XSTAR,A_COLLISION) RESULT(X_MALKMUS)
!==============================================================================
!
! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE MALKMUS STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_MALKMUS
  
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_MALKMUS

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_MALKMUS = XSTAR
ELSEIF(XSTAR>1.0E+5_EB) THEN ! STRONG LINE LIMIT
   X_MALKMUS = SQRT(4.0_EB*XSTAR*A_COLLISION)
ELSE             ! FORMULATION TO AVOID DIVISION BY ZERO
                 !X_GOODY = XSTAR/SQRT(1._EB+0.25_EB*XSTAR/A_COLLISION)
   X_MALKMUS = SQRT(4.0_EB*A_COLLISION**2+4.0_EB*A_COLLISION*XSTAR)-2.0_EB*A_COLLISION
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION MALKMUS

!==============================================================================
FUNCTION ELSASSER(XSTAR,A_COLLISION) RESULT(X_ELSASSER)
!==============================================================================
! FUNCTION COMPUTES THE EQUIVALENT LINE WIDTH OVER THE AVERAGE LINE SPACING
! USING THE ELSASSER STATISTICAL MODEL
! 
! VARIABLES IN:
! XSTAR       : OPTICAL PATHLENGTH * LINE STRENGTH
! A_COLLISION : FINE STRUCTURE PARAMETER
!
! RETURNS X_ELSASSER
!
IMPLICIT NONE

REAL(EB), INTENT(IN) :: XSTAR
REAL(EB), INTENT(IN) :: A_COLLISION

REAL(EB)  :: X_ELSASSER

! LOCAL VARIABLES

REAL(EB) :: SPECTRAL_ABSORPTIVITY
REAL(EB) :: XX
REAL(EB) :: ENN
REAL(EB) :: ARG 
REAL(EB) :: ARGNEW
REAL(EB) :: X_COLLISION

INTEGER :: MM
INTEGER :: N
! THE FOLLOWING LOOP COMPUTES THE OPTICAL DEPTH, X_COLLISION, FOR METHANE USING 
! THE GODSON EQUATION AND AN APPROXIMATION TO THE LADENBERG-REICHE
! FUNCTION AS RECOMMENDED BY BROSMER AND TIEN (JQSRT 33,P 521), EQ. 2, PAGE 523 
! THIS ASSUMES THE ELSASSER MODEL
! THE ERROR FUNCTION IS FOUND FROM ITS SERIES EXPANSION.
! 

X_COLLISION = GOODY(XSTAR,A_COLLISION)

IF (XSTAR<1.0E-10_EB) THEN ! WEAK LINE LIMIT
   X_ELSASSER = X_COLLISION
ELSE
    SPECTRAL_ABSORPTIVITY = X_COLLISION
    XX  = .5_EB*SQRTPI*X_COLLISION

    IF(XX<=3._EB) THEN
        ENN = 1._EB
        DO N = 1,30
            ENN = ENN*REAL(N,EB)  ! ENN = N!
            MM  = 2*N+1
            ARG = 1.128379_EB*(-1._EB)**N*((.88622693_EB*X_COLLISION)**MM)/(REAL(MM,EB)*ENN)
! THIS CORRESPONDS TO ERR(SQRT(PI)/2*X_COLLISION) = ERR(XX)
            ARGNEW=ARG+SPECTRAL_ABSORPTIVITY
! IF(ABS(ARG/ARGNEW)<.000001)N=30
            SPECTRAL_ABSORPTIVITY=ARGNEW
        ENDDO

    ELSE
        SPECTRAL_ABSORPTIVITY=1._EB-DEXP(-XX**2)/(SQRTPI*XX)
    ENDIF

    IF (SPECTRAL_ABSORPTIVITY>=1._EB) SPECTRAL_ABSORPTIVITY=.9999999_EB
! GET METHANE OPTICAL DEPTH
! BROSMER AND TIEN ASSUME SPECTRAL_ABSORPTIVITY = ERF(0.5*SQRTPI*X_STAR)
 
    X_ELSASSER=-DLOG(1.0_EB-SPECTRAL_ABSORPTIVITY)
ENDIF

RETURN
!------------------------------------------------------------------------------
END FUNCTION ELSASSER

!==============================================================================
SUBROUTINE CO2(OMEGA,TEMP,GC1,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER I,J,K,L
REAL(EB) OMEGA,TEMP,GC1,SDWEAK,GDINV,GDDINV,AA,BB,CC,QQ,EE,FF,GG, &
         SMINUS,SPLUS,SDSTRG,GD,OM1,OM2,OM3,T0,Q2,BE,COM1, &
         COM2,COM3,X13,X23,X33,XBAR,OM12,ALPHA,OMPRIM,V3,GAM, &
         OMVV3,DELTA,V,OMVBAR,F1,F2,UNFLO1,UNFLO2,UNFLO3,TEST, &
         VBAR1,OMA,OMB,TTEMP,TT,T1,TW,WW,TEMP1,TEMP2,TEMP3,WM, &
         DINV,A,B,D,G,W1,DINV1,DINV2,DINV3,Q2OT,T0OT,Q2OT0

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CO2 

IF(OMEGA>5725._EB) THEN
   SDWEAK = 0._EB
   GDINV  = 1._EB
   GDDINV = 1._EB
ELSE
   WM = 44._EB
! COMPUTE DOPPLER BROADENING HALF-WIDTHS SP-3080 EQ: 5-35
   GD = 5.94E-6_EB*OMEGA*SQRT(TEMP/(273._EB*WM))

   IF(OMEGA>4550._EB) THEN
! CONTRIBUTION TO 2.0 MICRON BAND FROM:
! (000)-(041)
! (000)-(121),
! (000)-(201) TRANSITIONS.

      OM1 = 1354.91_EB ! (100)
      OM2 = 673.0_EB   ! (010)
      OM3 = 2396.49_EB ! (001)

! BAND CENTER 

      BCNT(1) = 4860.5_EB ! (000)-(041)
      BCNT(2) = 4983.5_EB ! (000)-(121)
      BCNT(3) = 5109.0_EB ! (000)-(201)

      T0   = 300._EB
      Q2   = 1.4388_EB
      T0OT = T0/TEMP
      Q2OT = -Q2/TEMP

      BE   = 0.391635_EB ! ROTATIONAL CONSTANT

! COMPUTE THE ASSOCIATED TRANSITION WAVENUMBERS

      COM1 = 4._EB*OM2+OM3      ! (000)-(041)
      COM2 = OM1+2._EB*OM2+OM3  ! (000)-(121)
      COM3 = 2._EB*OM1+OM3      ! (000)-(201)


! COMPUTE THE INTEGRATED INTENSITY OF THE BAND
! 0.272: INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(1) = 4860.5_EB ((041)-(000)) AT T=300K
! 1.01 : INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(2) = 4983.5_EB ((121)-(000)) AT T=300K
! 0.426: INTEGRATED INTENSITY (IN CM-2-ATM-1) OF BAND BCNT(3) = 5109  _EB ((201)-(000)) AT T=300K
! VALUES FROM PENNER AND VARANASI JQSRT VOL 4 pp 799-806


      ATOT(1) = 0.272_EB*T0OT*(1._EB-EXP(Q2OT*COM1))/(1._EB-EXP(Q2OT*OM2))**4/(1._EB-EXP(Q2OT*OM3))
!  NOTE: [(1._EB-EXP(Q2OT*OM2))**4*(1._EB-EXP(Q2OT*OM3))] IS THE ROVIBRATIONAL PARTITION FUNCTION
!  EQ 2 IN PENNER AND VARANASI JQSRT VOL 4 pp 799-806

      ATOT(2) = 1.01_EB*T0OT*(1._EB-EXP(Q2OT*COM2))/(1._EB-EXP(Q2OT*OM1))/(1._EB-EXP(Q2OT*OM2))**2/ &
              (1._EB-EXP(Q2OT*OM3))

      ATOT(3) = 0.426_EB*T0OT*(1._EB-EXP(Q2OT*COM3))/(1._EB-EXP(Q2OT*OM1))**2/(1._EB-EXP(Q2OT*OM3))

      SDWEAK  = 0.0_EB

! COMPUTE THE LINE STRENGTH USING EQ 11-44 FROM PENNER IN QUANTITATIVE MOLECULAR SPECTROMETRY, 1955
! SDWEAK = SUM(ATOT*PROPABILITY) 
! JUST OVERLAPPING SPECTRAL LINE
      DO K=1,3
         SDWEAK = SDWEAK+ATOT(K)*(-Q2OT)/(4._EB*BE)*ABS(OMEGA-BCNT(K))*EXP(Q2OT/(4._EB*BE)*(OMEGA-BCNT(K))**2)
      ENDDO

      DINV   = 1._EB/(4._EB*BE)
      GDINV  = GC1*DINV
      GDDINV = GD*DINV
!***EXPRESS S/D AT STP, AS IS IN NASA SP-3080
      SDWEAK=SDWEAK*TEMP/273._EB
   ELSEIF((OMEGA<=4550._EB).AND.(OMEGA>3800._EB)) THEN
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
   ELSEIF((OMEGA<=3800._EB).AND.(OMEGA>3050._EB)) THEN
      B=.391635_EB
      A=.0030875_EB
      X13=-19.37_EB
      X23=-12.53_EB
      X33=-12.63_EB
      OM1=1354.91_EB
      OM2=673._EB
      OM3=2396.49_EB
      T0=300._EB
      T0OT = T0/TEMP
      Q2=1.4388_EB
      Q2OT = -Q2/TEMP
      Q2OT0 = -Q2/T0
      XBAR=.5_EB*(.5_EB*X13+X23)
      OM12=.5_EB*(.5_EB*OM1+OM2)
      SDWEAK=0._EB
      SDSTRG=0._EB
      IF(OMEGA<=2395._EB) THEN
         ALPHA=2700._EB
         OMPRIM=OM3
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(OM3*Q2OT0))*(1._EB-EXP(OM12*Q2OT0))**3*(1._EB+EXP(OM12*Q2OT0))*(1._EB-EXP(OMPRIM*Q2OT0)))
         BB=(1._EB-EXP(Q2OT*OMEGA))*(1._EB-EXP(Q2OT*OM3))*(1._EB-EXP(OM12*Q2OT))**3*(1._EB+EXP(OM12*Q2OT)) &
           *(1._EB-EXP(Q2OT*OMPRIM))
         CC=AA*BB*OMEGA*T0/TEMP**2
         L202: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            L201: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1._EB)*G*EXP(-(V3*OM3+V*OM12)*Q2OT)
               GAM=B-A*(V3+1._EB)
               OMVV3=OM3+.5_EB*X13+X23+2._EB*X33+XBAR*V+2._EB*X33*V3
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L202
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2OT))
               F1=GAM-D/2
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78.) CYCLE L202
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78.) CYCLE L202
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78.) THEN
                  SPLUS=0.
               ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
               ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001) CYCLE L202
               SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L201
         ENDDO L202
         IF(SDWEAK<=TWO_EPSILON_EB) THEN
            SDWEAK=0._EB
            GDINV=1._EB
            GDDINV=1._EB
         ELSE
            DINV=SDSTRG*SDSTRG/SDWEAK
            GDINV=GC1*DINV
            GDDINV=GD*DINV
!***  EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
            SDWEAK=SDWEAK*TEMP/273.
         ENDIF
      ELSE
!CALCULATE ABSORPTION COEF. AND LINE SPACING PARAMETER FOR 2.7 MICRON BAND
         L=1
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(021) AND (010)-(031) TRANS.
         ALPHA=28.5_EB
         OMPRIM=2._EB*OM2+OM3
         L120: DO
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(OM3*Q2OT0))*(1._EB-EXP(OM12*Q2OT0))**3*(1._EB+EXP(OM12*Q2OT0))*(1._EB-EXP(OMPRIM*Q2OT0)))
         BB=(1._EB-EXP(Q2OT*OMEGA))*(1._EB-EXP(Q2OT*OM3))* (1._EB-EXP(OM12*Q2OT))**3*(1._EB+EXP(OM12*Q2OT)) &
           *(1._EB-EXP(Q2OT*OMPRIM))
         CC=AA*BB*OMEGA*T0/TEMP**2
         L102: DO J=1,20
         V=FLOAT(J-1)
         IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
         IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
         VBAR1=-1._EB+(V+3._EB)*(V+4._EB)/(V+2.)/6._EB
         IF(J/2*2==J)VBAR1=-1._EB+(V+5._EB)/6._EB
         L101: DO K=1,10
         V3=FLOAT(K-1)
         QQ=(V3+1)*G*EXP((V3*OM3+V*OM12)*Q2OT)*(VBAR1+1._EB)
         GAM=B-A*(V3+1._EB)
         IF(L==2) THEN
            OMVV3=3728._EB-5._EB*V-47._EB*V3
            IF(V<=TWO_EPSILON_EB) OMVV3=3715._EB-47._EB*V3
         ELSE
            OMVV3=3598._EB-18._EB*V-47._EB*V3
            IF(V<=TWO_EPSILON_EB) OMVV3=3613._EB-47._EB*V3
         ENDIF
         DELTA=A*(OMEGA-OMVV3)
         IF(GAM*GAM<=DELTA) CYCLE L102
         D=2._EB*SQRT(GAM*GAM-DELTA)
         OMVBAR=OMVV3*(1._EB-EXP(OMVV3*Q2OT))
         F1=GAM-D/2._EB
         F2=GAM+D/2._EB
         EE=Q2*GAM/(A*A*TEMP)
         UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
         IF(UNFLO1<=-78._EB) CYCLE L102
         UNFLO2=EE*2._EB*GAM*F1
         IF(UNFLO2>=78._EB) CYCLE L102
         FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
         SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
         UNFLO3=EE*2._EB*GAM*F2
         IF(UNFLO3>=78._EB) THEN
            SPLUS=0._EB
         ELSE
            SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
         ENDIF
         GG=SDWEAK
         SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
         TEST=(SDWEAK-GG)/SDWEAK
         IF(TEST<.0001_EB) CYCLE L102
         SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
         ENDDO L101
         ENDDO L102
         IF(L==2) EXIT L120
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(101) AND (010)-(111) TRANS.
         ALPHA=42.3_EB
         OMPRIM=OM1+OM3
         L=2
      ENDDO L120
!CALCULATE ABSORPTION COEF AND LINE SPACING PARAMETER FOR 4.3 MICRON BAND
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
      ELSE
         DINV=SDSTRG*SDSTRG/SDWEAK
         GDINV=GC1*DINV
         GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
         SDWEAK=SDWEAK*TEMP/273.
      ENDIF
   ENDIF
ELSEIF((OMEGA<=3050._EB).AND.(OMEGA>2474.)) THEN
   SDWEAK=0._EB
   GDINV=1._EB
   GDDINV=1._EB
ELSEIF((OMEGA<=2474.).AND.(OMEGA>1975.)) THEN
   B=.391635_EB
   A=.0030875_EB
   X13=-19.37_EB
   X23=-12.53_EB
   X33=-12.63_EB
   OM1=1354.91_EB
   OM2=673._EB
   OM3=2396.49_EB
   T0=300._EB
   Q2=1.4388_EB
   XBAR=.5_EB*(.5_EB*X13+X23)
   OM12=.5_EB*(.5_EB*OM1+OM2)
   SDWEAK=0._EB
   SDSTRG=0._EB
   IF(OMEGA<=2395._EB) THEN
         ALPHA=2700._EB
         OMPRIM=OM3
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(-OM3*Q2/T0))*(1._EB-EXP(-OM12*Q2 /T0))**3*(1._EB+EXP(-OM12*Q2/T0))*(1._EB-EXP(-OMPRIM*Q2/T0)))
         BB=(1._EB-EXP(-Q2*OMEGA/TEMP))*(1._EB-EXP(-Q2*OM3/TEMP))*(1._EB-EXP(-OM12*Q2/TEMP))**3*(1._EB+EXP(-OM12*Q2/TEMP)) &
           *(1._EB-EXP(-Q2*OMPRIM/TEMP))
         CC=AA*BB*OMEGA/TEMP*T0/TEMP
         L202A: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            L201A: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1._EB)*G*EXP(-(V3*OM3+V*OM12)*Q2/TEMP)
               GAM=B-A*(V3+1._EB)
               OMVV3=OM3+.5_EB*X13+X23+2._EB*X33+XBAR*V+2._EB*X33*V3
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L202A
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2/TEMP))
               F1=GAM-D/2._EB
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78.) CYCLE L202A
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78.) CYCLE L202A
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78._EB) THEN
                  SPLUS=0._EB
                  ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
                  ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001_EB) CYCLE L202A
               SDSTRG=SQRT(0.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L201A
         ENDDO L202A
         IF(SDWEAK<=TWO_EPSILON_EB) THEN
            SDWEAK=0._EB
            GDINV=1._EB
            GDDINV=1._EB
         ELSE
            DINV=SDSTRG*SDSTRG/SDWEAK
            GDINV=GC1*DINV
            GDDINV=GD*DINV
!***  EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
            SDWEAK=SDWEAK*TEMP/273._EB
         ENDIF
      ELSE
!CALCULATE ABSORPTION COEF. AND LINE SPACING PARAMETER FOR 2.7 MICRON BAND
         L=1
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(021) AND (010)-(031) TRANS.
         ALPHA=28.5_EB
         OMPRIM=2._EB*OM2+OM3
         L120A: DO
         AA=ALPHA*B*Q2/(A*(1._EB-EXP(-OM3*Q2/T0))*(1._EB-EXP(-OM12*Q2 /T0))**3*(1._EB+EXP(-OM12*Q2/T0))*(1._EB-EXP(-OMPRIM*Q2/T0)))
         BB=(1._EB-EXP(-Q2*OMEGA/TEMP))*(1._EB-EXP(-Q2*OM3/TEMP))* (1._EB-EXP(-OM12*Q2/TEMP))**3*(1._EB+EXP(-OM12*Q2/TEMP)) &
           *(1._EB-EXP(-Q2*OMPRIM/TEMP))
         CC=AA*BB*OMEGA/TEMP*T0/TEMP
         L102A: DO J=1,20
            V=FLOAT(J-1)
            IF(J/2*2==J)G=(V+1._EB)*(V+3._EB)/4._EB
            IF(J/2*2/=J)G=(V+2._EB)*(V+2._EB)/4._EB
            VBAR1=-1._EB+(V+3._EB)*(V+4._EB)/(V+2._EB)/6._EB
            IF(J/2*2==J)VBAR1=-1._EB+(V+5._EB)/6._EB
            L101A: DO K=1,10
               V3=FLOAT(K-1)
               QQ=(V3+1)*G*EXP(-(V3*OM3+V*OM12)*Q2/TEMP)*(VBAR1+1._EB)
               GAM=B-A*(V3+1._EB)
               IF(L==2) THEN
                  OMVV3=3728._EB-5._EB*V-47._EB*V3
                  IF(V<=TWO_EPSILON_EB)OMVV3=3715._EB-47._EB*V3
                  ELSE
                  OMVV3=3598._EB-18._EB*V-47._EB*V3
                  IF(V<=TWO_EPSILON_EB)OMVV3=3613._EB-47._EB*V3
               ENDIF
               DELTA=A*(OMEGA-OMVV3)
               IF(GAM*GAM<=DELTA) CYCLE L102A
               D=2._EB*SQRT(GAM*GAM-DELTA)
               OMVBAR=OMVV3*(1._EB-EXP(-OMVV3*Q2/TEMP))
               F1=GAM-D/2._EB
               F2=GAM+D/2._EB
               EE=Q2*GAM/(A*A*TEMP)
               UNFLO1=EE*DELTA*(1._EB+.5_EB*A/GAM)
               IF(UNFLO1<=-78._EB) CYCLE L102A
               UNFLO2=EE*2._EB*GAM*F1
               IF(UNFLO2>=78._EB) CYCLE L102A
               FF=EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
               SMINUS=CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
               UNFLO3=EE*2._EB*GAM*F2
               IF(UNFLO3>=78._EB) THEN
                  SPLUS=0._EB
                  ELSE
                  SPLUS=CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
               ENDIF
               GG=SDWEAK
               SDWEAK=(SMINUS+SPLUS)/D+SDWEAK
               TEST=(SDWEAK-GG)/SDWEAK
               IF(TEST<.0001) CYCLE L102A
               SDSTRG=SQRT(.5_EB*G)*(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
            ENDDO L101A
         ENDDO L102A
         IF(L==2) EXIT L120A
!CONTRIBUTION TO 2.7 MICRON BAND FROM (000)-(101) AND (010)-(111) TRANS.
         ALPHA=42.3_EB
         OMPRIM=OM1+OM3
         L=2
      ENDDO L120A
!CALCULATE ABSORPTION COEF AND LINE SPACING PARAMETER FOR 4.3 MICRON BAND
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
         ELSE
         DINV=SDSTRG*SDSTRG/SDWEAK
         GDINV=GC1*DINV
         GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
         SDWEAK=SDWEAK*TEMP/273._EB
         ENDIF
      ENDIF
   ELSEIF((OMEGA<=1975._EB).AND.(OMEGA>1100._EB)) THEN
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
   ELSEIF((OMEGA<=1100._EB).AND.(OMEGA>880._EB)) THEN
!CONTRIBUTION TO 10.0 MICRON BAND FROM (100)-(001) AND (020)-(001) TRANS.
      OM1=1354.91_EB
      OM2=673._EB
      OM3=2396.49_EB
      Q2=1.4388_EB
      BCNT(1)=960.8_EB
      BCNT(2)=1063.6_EB
      OMA=OM3
      OMB=(OM1+2._EB*OM2)/2._EB
      T0=300._EB
      ATOT(1)=0.0219_EB
      ATOT(2)=0.0532_EB
      BE=0.391635_EB
      DO K=1,2
         ATOT(K)=T0/TEMP*ATOT(K)*EXP(Q2*OMB*(1._EB/T0-1._EB/TEMP)) *(1._EB-EXP(-Q2*(OMA-OMB)/TEMP))/(1._EB-EXP(-Q2*OMA/TEMP)) &
                   /(1._EB-EXP(-OMB*Q2/TEMP))
      ENDDO
      SDWEAK=0._EB
      DO I=1,2
         SDWEAK=SDWEAK+ATOT(I)*Q2/(4._EB*BE*TEMP)*ABS(OMEGA-BCNT(I))  *EXP(-Q2/(4._EB*BE*TEMP)*(OMEGA-BCNT(I))**2)
      ENDDO
      DINV=1._EB/4._EB/BE
      GDINV=GC1*DINV
      GDDINV=GD*DINV
!***EXPRESS S/D AT STP, AS IS IN NASA SP-3080
      SDWEAK=SDWEAK*TEMP/273.
   ELSEIF((OMEGA<=880._EB).AND.(OMEGA>500._EB))  THEN
!CONTRIBUTION TO 15.0 MICRON BAND FROM (000)-(010) TRANS.
      TTEMP=TEMP
      J=(OMEGA-495._EB)/5._EB
      W1=495._EB+5._EB*REAL(J,EB)
      WW=(OMEGA-W1)/5
      IF(TEMP>=2400._EB) TEMP = 2399.99_EB
      IF(TEMP < 300._EB) TEMP =  300.00_EB
      I = TEMP/300._EB
      SELECT CASE(I)
         CASE(3)
            I=2
            TT=(TEMP-600._EB)/600._EB
         CASE(6:7) 
            I=5
            TT=(TEMP-1800._EB)/600._EB
         CASE DEFAULT
            T1=REAL(I,EB)*300._EB
            TT=(TEMP-T1)/300._EB
            IF (I>=4) I=I-1     
      END SELECT
      TW=TT*WW
      SDWEAK=SD15(I,J)*(1._EB-TT-WW+TW)+SD15(I+1,J)*(TT-TW)  +SD15(I,J+1)*(WW-TW)+SD15(I+1,J+1)*TW
      IF(SDWEAK<=TWO_EPSILON_EB) THEN
         SDWEAK=0._EB
         GDINV=1._EB
         GDDINV=1._EB
         ELSE
!CALCULATE LINE SPACING PARAMETER FOR 15.0 MICRON BAND
         DINV1=1.2_EB
         DINV2=8.0_EB
         DINV3=30.0_EB
         TEMP1=300.0_EB
         TEMP2=550.0_EB
         TEMP3=830.0_EB
         DINV=DINV1*(TEMP-TEMP2)*(TEMP-TEMP3)/(TEMP1-TEMP2)  /(TEMP1-TEMP3)+DINV2*(TEMP-TEMP1)*(TEMP-TEMP3)&
                  /(TEMP2-TEMP1)/(TEMP2-TEMP3)+DINV3*(TEMP-TEMP1)  *(TEMP-TEMP2)/(TEMP3-TEMP1)/(TEMP3-TEMP2)
         GDINV=GC1*DINV
         GDDINV=GD*DINV
         ENDIF
         TEMP = TTEMP  ! Line added by Jason Floyd, Aug 30, 2002
   ELSE
      SDWEAK=0._EB
      GDINV=1._EB
      GDDINV=1._EB
      ENDIF
   ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CO2

!==============================================================================
SUBROUTINE H2O(OMEGA,TEMP,GC2,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER, INTENT(OUT) :: I_MODEL

INTEGER I,J
REAL(EB) OMEGA,TEMP,GC2,SDWEAK,GDINV,GDDINV,WM,W1,WW,T1,TT,TW, D,B,DINV,TTEMP,GD

I_MODEL = I_MODEL_H2O

IF (OMEGA>=9300..OR.OMEGA<50._EB) THEN
   SDWEAK=0._EB
   GDINV=1._EB
   GDDINV=1._EB
ELSE
   WM   = 18._EB
   GD   = 5.94E-6_EB*OMEGA*SQRT(TEMP/(273._EB*WM))
   J    = (OMEGA-25._EB)/25._EB
   TTEMP= TEMP

   IF(TEMP>=2500._EB) TEMP = 2499.99_EB
   IF(TEMP<300._EB)   TEMP = 300._EB

   I = TEMP/500._EB +1

   IF(I==2.AND.TEMP<600._EB) I=1

   W1 = 25._EB+25._EB*FLOAT(J)
   WW = (OMEGA-W1)/25._EB

   IF(I>2) THEN
      T1=FLOAT(I-1)*500._EB
      TT=(TEMP-T1)/500._EB
   ELSE
      IF(I==1) TT=(TEMP-300._EB)/300._EB
      IF(I==2) TT=(TEMP-600._EB)/400._EB
   ENDIF

   TW     = TT*WW
   SDWEAK = SD(I,J)*(1._EB-TT-WW+TW)+SD(I+1,J)*(TT-TW)+SD(I,J+1) *(WW-TW)+SD(I+1,J+1)*TW
   D      = -2.294_EB+.3004E-02_EB*TEMP-.366E-06_EB*TEMP**2
   B      = SIN(.0036_EB*OMEGA-8.043_EB)
   DINV   = EXP(.7941_EB*B+D)
!     DINV=EXP(0.00106*TEMP-1.21)
   GDINV  = GC2*DINV
   GDDINV = GD*DINV
   TEMP   = TTEMP
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE H2O


!==============================================================================
SUBROUTINE CO(OMEGA,TEMP,GC4,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

INTEGER J
REAL(EB) OMEGA,TEMP,GC4,SDWEAK,GDINV,GDDINV,AA,BB,CC,QQ,EE,FF,GG, &
         SMINUS,SPLUS,SDSTRG,B,ALPHA,A,OME,WX,WY,OMPRIM,T0, &
         Q2,WM,GD,V,GAM,OMV,DELTA,D,OMVBAR,F1,F2,TEST,DINV,Q2OT,TOAZ

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CO

IF(OMEGA<1600._EB .OR. OMEGA>2400._EB) THEN
   SDWEAK = 0._EB
   GDINV  = 1._EB
   GDDINV = 1._EB
ELSE
   B     = 1.93139_EB
   ALPHA = 260._EB
   A     = .017485_EB
   OME   = 2170.21_EB
   WX    = 13.461_EB
   WY    = .0308_EB
   OMPRIM= OME-2._EB*WX+3.25_EB*WY

   T0 = 300._EB
   Q2 = 1.4388_EB

   TOAZ = TEMP/273._EB
   Q2OT = Q2/TEMP

   WM     = 28._EB
! DOPPLER BROADENING HALF-WIDTH
   GD     = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM)
   SDWEAK = 1.E-99_EB
   SDSTRG = 1.E-99_EB

   AA = ALPHA*B*Q2/(A*(1._EB-EXP(-OMPRIM*Q2/T0))**2)
   BB = (1._EB-EXP(-OMEGA*Q2OT))*(1._EB-EXP(-OMPRIM*Q2OT))**2
   CC = AA*BB*OMEGA*T0/TEMP**2

   L101: DO J=1,20
      V    = FLOAT(J-1)
      QQ   = (V+1._EB)*EXP(-V*OME*Q2OT)
      GAM  = B-A*(V+1._EB)
      OMV  = OME-2._EB*(V+1._EB)*WX+(3._EB*(V+1._EB)*(V+1._EB)+.25_EB)*WY
      DELTA= A*(OMEGA-OMV)

      IF(GAM**2<=DELTA) EXIT L101

      D      = 2._EB*SQRT(GAM*GAM-DELTA)
      OMVBAR = OMV*(1._EB-EXP(-OMV*Q2OT))
      F1     = GAM-0.5_EB*D
      F2     = GAM+0.5_EB*D
      EE     = Q2*GAM/(A*A*TEMP)
      
      FF     = EXP(EE*DELTA*(1._EB+.5_EB*A/GAM))
      SMINUS = CC*QQ/OMVBAR*ABS(F1)*FF*EXP(-EE*2._EB*GAM*F1)
      SPLUS  = CC*QQ/OMVBAR*ABS(F2)*FF*EXP(-EE*2._EB*GAM*F2)
      GG     = SDWEAK
      SDWEAK = (SMINUS+SPLUS)/D+SDWEAK
      TEST   = (SDWEAK-GG)/SDWEAK
      
      IF(TEST<.0001_EB) EXIT L101

      SDSTRG=(SQRT(SMINUS)+SQRT(SPLUS))/D+SDSTRG
   ENDDO L101

   DINV   = SDSTRG*SDSTRG/SDWEAK
   GDINV  = GC4*DINV
   GDDINV = GD*DINV
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CO


!==============================================================================
SUBROUTINE POD(OMEGA,X_PARTICLE)
!==============================================================================
! POD CALCULATES PARTICLE OPTICAL DEPTH, X_PARTICLE, OF THE VOLUME FRACTION OF 
! SOOT PARTICLES IN GAS CLOUD.  
! RIN AND RIK ARE THE REAL AND IMAGINARY PARTS OF THE INDEX OF REFRACTION.
! THE PARTICLES ARE ASSUMED TO BE IN THE RAYLEIGH LIMIT.
! VARIABLES PASSED IN:

REAL(EB), INTENT(IN) :: OMEGA

! VARIBLES PASSED OUT: X_PARTICLE: PARTICLE OPTICAL DEPTH

REAL(EB), INTENT(OUT) :: X_PARTICLE

! LOCALS

REAL(EB) ABCO,FF_FAC,FF,LAMBDA!,RIN,RIK

LAMBDA=10000._EB/OMEGA
 
! ABSORPTION COEF. IS BASED UPON MEASUREMENTS OF WIDMANN AND MULHOLLAND

IF (AL2O3) THEN
   IF (RCT > 2570._EB) THEN
      FF_FAC = 0.017_EB
   ELSEIF (RCT < 500._EB) THEN
      FF_FAC = 5.E-6_EB
   ELSE
      FF_FAC = 0.00073_EB     
   ENDIF
ELSE
   FF_FAC = 8.9_EB
ENDIF

FF         = FF_FAC/LAMBDA
ABCO       = FF*SVF*1.E6_EB
X_PARTICLE = ABCO*DD
!------------------------------------------------------------------------------
END SUBROUTINE POD


!==============================================================================
SUBROUTINE CH4_OLD(OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
INTEGER I,J
REAL(EB) OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,BE,Q2, &
      WM,GD,OM1,OM2,OM3,OM4,COM1,COM2,COM3,COM4,DINV,PE,W1,SDB, &
      SDA,SDC,Q2OT,AZOT,TOAZ

INTEGER, INTENT(OUT) :: I_MODEL

I_MODEL = I_MODEL_CH4

IF(OMEGA>5000._EB .OR. OMEGA<1125._EB) THEN

   SDWEAK=0.0_EB
   GDINV=1._EB
   GDDINV=1._EB

ELSE

   BE=5.2412_EB
   Q2=1.4388_EB
   WM=16._EB
   Q2OT = -Q2/TEMP
   AZOT = 273._EB/TEMP
   TOAZ = TEMP/273._EB

   GD=5.94E-6_EB*OMEGA*SQRT(TOAZ)/4._EB

   IF(OMEGA>=3400._EB) THEN

! CONTRIBUTION TO 2.4 MICRON BAND FROM (0000)-(0110), (0000)-(0011),
! (0000)-(1001), AND (0000)-(0102) TRANS.  THE INTEGRATED BAND INTENSITIES
! OF VINCENT-GEISSE (ANNALES DE PHYSIQUE SER.12, V. 10, 1955) HAVE
! BEEN MULTIPLIED BY A FACTOR OF 4 AND THE LINE SPACING IS THAT
! OF V4 FROM GRAY AND PENNER (JQSRT V. 5, 1965).

      OM1=2914.2_EB
      OM2=1526.0_EB
      OM3=3020.3_EB
      OM4=1306.2_EB

      BCNT(1)=4123.0_EB
      BCNT(2)=4216.3_EB
      BCNT(3)=4313.2_EB
      BCNT(4)=4546.0_EB

      COM1=OM2+2._EB*OM4
      COM2=OM1+OM4
      COM3=OM3+OM4
      COM4=OM2+OM3

      ATOT(1)=0.64_EB*AZOT*(1._EB-EXP(Q2OT*COM1))/((1._EB-EXP(Q2OT*OM2))*(1._EB-EXP(Q2OT*OM4))**2)
      ATOT(2)=17.6_EB*AZOT*(1._EB-EXP(Q2OT*COM2))/((1._EB-EXP(Q2OT*OM1))*(1._EB-EXP(Q2OT*OM4)))
      ATOT(3)=14.8_EB*AZOT*(1._EB-EXP(Q2OT*COM3))/((1._EB-EXP(Q2OT*OM3))*(1._EB-EXP(Q2OT*OM4)))
      ATOT(4)=5.04_EB*AZOT*(1._EB-EXP(Q2OT*COM4))/((1._EB-EXP(Q2OT*OM2))*(1._EB-EXP(Q2OT*OM3)))

      DINV=1._EB/5.74_EB
      GDINV=GC3*DINV
      GDDINV=GD*DINV
      SDWEAK=0.0_EB

      DO I=1,4
         SDWEAK=SDWEAK+2._EB*(OMEGA-BCNT(I))**2*(-Q2OT*BE)*SQRT(-Q2OT*BE)*ATOT(I)/SQRTPI*DINV**3*EXP(Q2OT*BE*DINV**2 &
         *(OMEGA-BCNT(I))**2)
      ENDDO
      SDWEAK=SDWEAK*TOAZ
   ELSE
      PE=PTOT+.3_EB*PCH4

      IF(OMEGA>=2625._EB) THEN
! CONTRIBUTION TO 3.3 MICRON BAND FROM (0000)-(0010) TRANS.
! REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521

         GDINV  = .00734_EB*PE*SQRT(AZOT)*EXP(1.02_EB*(TOAZ-1._EB))
         GDDINV = GD/9.4_EB

         J  = (OMEGA-2600._EB)/25._EB
         W1 = 2600._EB+25._EB*FLOAT(J)
         SDB= SD3(2,J)+(OMEGA-W1)/25._EB*(SD3(2,J+1)-SD3(2,J))

         IF(TEMP>600._EB) THEN
            SDC=SD3(3,J)+(OMEGA-W1)/25._EB*(SD3(3,J+1)-SD3(3,J))
            SDWEAK=SDB+(TEMP-600._EB)/250._EB*(SDC-SDB)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ELSE
            SDA=SD3(1,J)+(OMEGA-W1)/25._EB*(SD3(1,J+1)-SD3(1,J))
            SDWEAK=SDA+(TEMP-290._EB)/310._EB*(SDB-SDA)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ENDIF

      ELSEIF(OMEGA>1450._EB) THEN

         SDWEAK=0.0_EB
         GDINV=1._EB
         GDDINV=1._EB

      ELSE
! CONTRIBUTION TO 7.7 MICRON BAND FROM (0000)-(0001) TRANS.
! REFER TO BROSMER AND TIEN, JQSRT V. 33, P. 521.
         GDINV  = .0243_EB*PE*(TOAZ)**.8_EB
         GDDINV = GD/5.1_EB

         J   = (OMEGA-1100._EB)/25._EB
         W1  = 1100._EB+25._EB*FLOAT(J)
         SDB = SD7(2,J)+(OMEGA-W1)/25._EB*(SD7(2,J+1)-SD7(2,J))

         IF(TEMP>600._EB) THEN
            SDC = SD7(3,J)+(OMEGA-W1)/25._EB*(SD7(3,J+1)-SD7(3,J))
            SDWEAK = SDB+(TEMP-600._EB)/250._EB*(SDC-SDB)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ELSE
            SDA = SD7(1,J)+(OMEGA-W1)/25._EB*(SD7(1,J+1)-SD7(1,J))
            SDWEAK = SDA+(TEMP-290._EB)/310._EB*(SDB-SDA)
            IF(SDWEAK<0._EB)SDWEAK=0._EB
         ENDIF
      ENDIF
   ENDIF
ENDIF
!------------------------------------------------------------------------------
END SUBROUTINE CH4_OLD


!==============================================================================
SUBROUTINE CH4(OMEGA,TEMP,PCH4,PTOT,GC3,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE METHANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
!
! BAND #1: 1150 cm-1 - 1600 cm-1 
! BAND #2: 2700 cm-1 - 3250 cm-1 
! BAND #3: 3400 cm-1 - 5000 cm-1
! 
! VARIABLES PASSED IN
! OMEGA: (REAL) WAVENUMBER IN CM-1
! TEMP : (REAL) TEMPERATURE IN K
! PCH4 : (REAL) PARTIAL PRESSURE OF METHANE IN ATM
! PTOT : (REAL) TOTAL PRESSURE IN ATM
! GC3  : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER
! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! BE_CH4             : (REAL) ROTATIONAL CONSTANT FOR CH4 [CM^-1]
! DINV_CH4           : INVERSE LINE SPACING [CM]

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PCH4, PTOT, GC3
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT)  :: I_MODEL

REAL(EB) :: GD, PRESSURE_EFFECTIVE, Q2OT, AZOT, TOAZ, FACT1
REAL(EB) :: DINV_CH4

REAL(EB), PARAMETER :: Q2     = 1.4388_EB ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_CH4 = 16.0425_EB

!LINE SPACING D2_CH4=5.74 CM^-1 FOR THE V4 FUNDAMENTAL OF METHANE GRAY & PENNER,612
!FOOTNOTE AT BOTTOM
REAL(EB), PARAMETER :: BE_CH4 = 5.248_EB   ! ROTATIONAL CONSTANTS [CM^-1]

REAL(EB), DIMENSION(4), PARAMETER :: &
                 OM_CH4  = (/2914.2_EB, 1526.0_EB, 3020.3_EB, 1306.2_EB/),                                               &
                 COM_CH4 = (/1526.0_EB+2._EB*1306.2_EB, 2914.2_EB+1306.2_EB, 3020.3_EB+1306.2_EB, 1526.0_EB+3020.3_EB/), &
                 S2_CH4  = (/0.64_EB,17.6_EB,14.8_EB,5.04_EB/)

INTEGER I

I_MODEL = I_MODEL_CH4

! INITIALIZE OUTPUT

SDWEAK = 0.0_EB  !SPECTRAL ABSORPTION COEFFICIENT. 
GDINV  = 1._EB   !LINE WIDTH TO LINE SPACING RATIO: FINE STRUCTURE PARAMETER
GDDINV = 1._EB   !LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING FINE STRUCTURE PARAMETER

! INITIALIZE SOME COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPLLER HALF-WIDTH. EQ 5-35
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_CH4) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE EFFECTIVE PRESSURE. BROSMER & TIEN,524 EQ. 7 (SPECIFIC TO METHANE)
PRESSURE_EFFECTIVE = PTOT+.3_EB*PCH4

!------------------------------------------------------------------------------
! COMPUTED PROPERTIES 2.4 MICRON BAND, BAND #3: 3400 cm-1 - 5000 cm-1
IF((OM_BND_CH4(N_BAND_CH4,1)<=OMEGA).AND.(OMEGA<=OM_BND_CH4(N_BAND_CH4,2))) THEN

! CONTRIBUTION OF THE V1+V4 COMBINAISON BAND (2.4 MICRON)
! CONTRIBUTION TO 2.4 MICRON BAND FROM
! (0000)-(0102)
! (0000)-(1001)
! (0000)-(0011)
! (0000)-(0110) TRANSITIONS
! THE INTEGRATED BAND INTENSITIES (S2_CH4)
! OF VINCENT-GEISSE (ANNALES DE PHYSIQUE SER.12, V. 10, 1955) HAVE
! BEEN MULTIPLIED BY A FACTOR OF 4 
! THE LINE SPACING (1/DINV_CH4) IS THAT
! OF V4 FROM GRAY AND PENNER (JQSRT V. 5, 1965).                 

   ATOT(1) = S2_CH4(1)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(1)))/((1._EB-EXP(Q2OT*OM_CH4(2)))*(1._EB-EXP(Q2OT*OM_CH4(4)))**2)
   ATOT(2) = S2_CH4(2)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(2)))/((1._EB-EXP(Q2OT*OM_CH4(1)))*(1._EB-EXP(Q2OT*OM_CH4(4))))
   ATOT(3) = S2_CH4(3)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(3)))/((1._EB-EXP(Q2OT*OM_CH4(3)))*(1._EB-EXP(Q2OT*OM_CH4(4))))
   ATOT(4) = S2_CH4(4)*AZOT*(1._EB-EXP(Q2OT*COM_CH4(4)))/((1._EB-EXP(Q2OT*OM_CH4(2)))*(1._EB-EXP(Q2OT*OM_CH4(3))))

   DINV_CH4 = 1._EB/5.74_EB
   FACT1  = Q2OT*BE_CH4*DINV_CH4**2

   DO I=1,4
      SDWEAK = SDWEAK+(OMEGA-COM_CH4(I))**2*ATOT(I)*EXP(FACT1*(OMEGA-COM_CH4(I))**2)
   ENDDO

! EQ 6 IN GRAY AND PENNER JQSRT, VOL 5, PAGE 611-620, 1965
   SDWEAK=SDWEAK*2._EB*(-Q2OT*BE_CH4)*SQRT(-Q2OT*BE_CH4)/SQRTPI*DINV_CH4**3

!***EXPRESS S/D AT STANDARD TEMPERATURE AND PRESSURE, AS IS IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
   GDINV  = GC3*DINV_CH4
   GDDINV = GD*DINV_CH4 

!------------------------------------------------------------------------------
! TABULATED PROPERTIES
ELSE IF((OM_BND_CH4(2,1)<=OMEGA).AND.(OMEGA<OM_BND_CH4(2,2))) THEN
      
!------------------------------------------------------------------------------
! CONTRIBUTION TO 3.3 MICRON BAND, BAND #2: 2700 cm-1 - 3250 cm-1
! (0000)-(0010) TRANSITION (V3 FUNDAMENTAL)
! 9.4 IS THE AVERAGE LINE POSITION FOR THE 3.3 MICRON BAND (CM^-1)
! SOURCE: BROSMER & TIEN, JQSRT V. 33, P. 525 (SPECIFIC TO METHANE)

   DINV_CH4 = 1._EB/9.4_EB

   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH4_TEMP,OM_BND_CH4(2,:),SD2_CH4)
! LINE SHAPE PARAMETER BROSMER & TIEN, JQSRT V. 33, P. 525 EQ. 10 (SPECIFIC TO METHANE)
   GDINV  = .00734_EB*PRESSURE_EFFECTIVE*SQRT(AZOT)*EXP(1.02_EB*(TOAZ-1._EB)) 
   GDDINV = GD*DINV_CH4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ 
ELSE IF((OM_BND_CH4(1,1)<=OMEGA).AND.(OMEGA<OM_BND_CH4(1,2))) THEN
!------------------------------------------------------------------------------
! CONTRIBUTION TO 7.7 MICRON BAND, BAND #1: 1150 cm-1 - 1600 cm-1 
! (0000)-(0001) TRANSITION (V4 FUNDAMENTAL)
! 5.1 (CM-1) IS THE AVERAGE LINE POSITION FOR THE 7.7 MICRON BAND 
! SOURCE: BROSMER & TIEN, JQSRT V. 33, P. 525 (SPECIFIC TO METHANE)

   DINV_CH4 = 1._EB/5.1_EB

   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH4_TEMP,OM_BND_CH4(1,:),SD1_CH4)
! LINE SHAPE PARAMETER BROSMER & TIEN, JQSRT V. 33, 525 EQ. 11 (SPECIFIC TO METHANE)
   GDINV  = .0243_EB*PRESSURE_EFFECTIVE*(TOAZ)**.8_EB
   GDDINV = GD*DINV_CH4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ 
ENDIF 

!------------------------------------------------------------------------------
END SUBROUTINE CH4

!==============================================================================
SUBROUTINE C3H6(OMEGA,TEMP,PC3H6,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE PROPYLENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 3 BANDS FOR Propylene
!
! BAND #1: 1250 cm-1 - 1950 cm-1 
! BAND #2: 2700 cm-1 - 3200 cm-1 
! BAND #3: 700 cm-1 - 1150 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC3H6 : (REAL) PARTIAL PRESSURE OF PROPYLENE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C3H6         : INVERSE LINE SPACING [CM] FOR PROPYLENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC3H6, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C3H6 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C3H6  = 42.0797_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C3H6
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C3H6) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! MODEL PROPYLENE AS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! PROPYLENE BELONGS TO GROUP Cs
DINV_C3H6 = 1._EB/(2._EB*0.312_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! PROPYLENE HAS THREE BANDS
! BAND #1: 775 cm-1 - 1150 cm-1 
! BAND #2: 1225 cm-1 - 1975 cm-1 
! BAND #3: 2650 cm-1 - 3275 cm-1  

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C3H6
   IF ((OM_BND_C3H6(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C3H6(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C3H6(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 775 cm-1 - 1150 cm-1 
   KAPPA_D => SD1_C3H6
   GAMMA_D => GAMMAD1_C3H6
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1225 cm-1 - 1975 cm-1 
   KAPPA_D => SD2_C3H6
   GAMMA_D => GAMMAD2_C3H6
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2650 cm-1 - 3275 cm-1 
   KAPPA_D => SD3_C3H6
   GAMMA_D => GAMMAD3_C3H6
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C3H6(I_BAND)-1.0_EB)*PC3H6 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H6_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H6_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C3H6
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C3H6

!==============================================================================
SUBROUTINE C3H8(OMEGA,TEMP,PC3H8,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE PROPANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 2 BANDS FOR Propane

! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC3H8 : (REAL) PARTIAL PRESSURE OF PROPANE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C3H8         : INVERSE LINE SPACING [CM] FOR PROPANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC3H8, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C3H8 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C3H8  = 44.0956_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C3H8
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C3H8) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! PROPANE IS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! PROPANE BELONGS TO GROUP C2v
DINV_C3H8 = 1._EB/(2._EB*0.28173_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! PROPANE HAS THREE BANDS
! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C3H8
   IF ((OM_BND_C3H8(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C3H8(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C3H8(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 1175 cm-1 - 1675 cm-1 
   KAPPA_D => SD1_C3H8
   GAMMA_D => GAMMAD1_C3H8
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 2550 cm-1 - 3375 cm-1 
   KAPPA_D => SD2_C3H8
   GAMMA_D => GAMMAD2_C3H8
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C3H8(I_BAND)-1.0_EB)*PC3H8 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H8_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C3H8_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C3H8
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C3H8

!==============================================================================
SUBROUTINE C7H16(OMEGA,TEMP,PC7H16,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE HEPTANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 2 BANDS FOR HEPTANE

! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC7H16 : (REAL) PARTIAL PRESSURE OF HEPTANE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C7H16         : INVERSE LINE SPACING [CM] FOR HEPTANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC7H16, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C7H16 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C7H16 = 100.2019_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C7H16
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C7H16) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! n_HEPTANE IS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
! n-Heptane BELONGS TO GROUP C2v
DINV_C7H16=1._EB/(2.0_EB*0.024_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! HEPTANE HAS THREE BANDS
! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C7H16
   IF ((OM_BND_C7H16(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C7H16(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C7H16(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 1175 cm-1 - 1675 cm-1 
   KAPPA_D => SD1_C7H16
   GAMMA_D => GAMMAD1_C7H16
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 2550 cm-1 - 3375 cm-1 
   KAPPA_D => SD2_C7H16
   GAMMA_D => GAMMAD2_C7H16
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C7H16(I_BAND)-1.0_EB)*PC7H16 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H16_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H16_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C7H16
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C7H16

!==============================================================================
SUBROUTINE C7H8(OMEGA,TEMP,PC7H8,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE TOLUENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 5 BANDS FOR TOLUENE

! BAND #1: 700 cm-1 - 825 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PC7H8 : (REAL) PARTIAL PRESSURE OF TOLUENE
! PTOT   : (REAL) TOTAL PRESSURE
! GC3    : (REAL) collisional broadening half-width at half heigh
! 
! VRAIBLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C7H8         : INVERSE LINE SPACING [CM] FOR TOLUENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC7H8, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C7H8 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C7H8  = 92.1384_EB ! NIST WEBBOOK DATA

INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C7H8
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C7H8) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! TOLUENE BELONGS TO GROUP CS 
! TOLUENE IS MODEL AS A PROLATE SYMMETRIC TOP. THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B. RECALL THAT ROTATIONAL_CONSTANT B = ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE.  USING EXPERIMENTAL VALUES  

DINV_C7H8=1._EB/(2.0_EB*0.084_EB)


! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! TOLUENE HAS 5 BANDS
! BAND #1: 700 cm-1 - 825 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C7H8
   IF ((OM_BND_C7H8(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C7H8(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C7H8(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 700 cm-1 - 825 cm-1 
   KAPPA_D => SD1_C7H8
   GAMMA_D => GAMMAD1_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 975 cm-1 - 1175 cm-1 
   KAPPA_D => SD2_C7H8
   GAMMA_D => GAMMAD2_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1275 cm-1 - 1675 cm-1 
   KAPPA_D => SD3_C7H8
   GAMMA_D => GAMMAD3_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 1650 cm-1 - 2075 cm-1 
   KAPPA_D => SD4_C7H8
   GAMMA_D => GAMMAD4_C7H8
ELSEIF(IN_BAND.AND.(I_BAND==5)) THEN ! BAND #5: 2675 cm-1 - 3225 cm-1 
   KAPPA_D => SD5_C7H8
   GAMMA_D => GAMMAD5_C7H8
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C7H8(I_BAND)-1.0_EB)*PC7H8 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H8_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C7H8_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C7H8
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C7H8


!==============================================================================
SUBROUTINE CH3OH(OMEGA,TEMP,PCH3OH,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE Methanol OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 4 BANDS FOR Methanol

! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1
!
! VARIABLES PASSED IN
! OMEGA  : (REAL) WAVENUMBER IN CM-1
! TEMP   : (REAL) TEMPERATURE IN K
! PCH3OH : (REAL) PARTIAL PRESSURE OF Methanol
! PTOT   : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_CH3OH         : INVERSE LINE SPACING [CM] FOR Methanol

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PCH3OH, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_CH3OH 

REAL(EB), PARAMETER :: Q2       = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_CH3OH = 32.0419_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_CH3OH
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_CH3OH) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! Methanol Belongs to point group Cs. For now THE LINE SPACING IS APPROXIMATED TO
! 2*ROTATIONAL_CONSTANT B SINCE ROTATIONAL_CONSTANT B ~ ROTATIONAL_CONSTANT C
! ROTATIONAL_CONSTANT_B OBTAINED FROM CCCBDV WEBSITE, USING EXPERIMENTAL VALUES  
DINV_CH3OH=1._EB/(2.0_EB*0.82338_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! Methanol HAS 4 BANDS
! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_CH3OH
   IF ((OM_BND_CH3OH(I,1)<=OMEGA).AND.(OMEGA<OM_BND_CH3OH(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_CH3OH(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN   ! BAND #1: 825 cm-1 - 1150 cm-1 
   KAPPA_D => SD1_CH3OH
   GAMMA_D => GAMMAD1_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1125 cm-1 - 1700 cm-1 
   KAPPA_D => SD2_CH3OH
   GAMMA_D => GAMMAD2_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2600 cm-1 - 3225 cm-1 
   KAPPA_D => SD3_CH3OH
   GAMMA_D => GAMMAD3_CH3OH
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 3525 cm-1 - 3850 cm-1 
   KAPPA_D => SD4_CH3OH
   GAMMA_D => GAMMAD4_CH3OH
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_CH3OH(I_BAND)-1.0_EB)*PCH3OH 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH3OH_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_CH3OH_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_CH3OH
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE CH3OH

!==============================================================================
SUBROUTINE C5H8O2(OMEGA,TEMP,PC5H8O2,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE MMA OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 6 BANDS FOR MMA
! BAND #1: 750 cm-1 - 900 cm-1 
! BAND #2: 875 cm-1 - 1075 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1
!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC5H8O2 : (REAL) PARTIAL PRESSURE OF MMA
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C5H8O2         : INVERSE LINE SPACING [CM] FOR MMA

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC5H8O2, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C5H8O2 

REAL(EB), PARAMETER :: Q2        = 1.4388_EB   ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C5H8O2 = 100.1158_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C5H8O2
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C5H8O2) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! MMA Belongs to point group ? FOR NOW USING DATA FROM Acetylacetone (C5H8O2)
DINV_C5H8O2=1._EB/(2.0_EB*0.067_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 6 BANDS FOR MMA
! BAND #1: 750 cm-1 - 900 cm-1 
! BAND #2: 875 cm-1 - 1075 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C5H8O2
   IF ((OM_BND_C5H8O2(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C5H8O2(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C5H8O2(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1: 750 cm-1 - 900 cm-1
   KAPPA_D => SD1_C5H8O2
   GAMMA_D => GAMMAD1_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 875 cm-1 - 1075 cm-1
   KAPPA_D => SD2_C5H8O2
   GAMMA_D => GAMMAD2_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1050 cm-1 - 1275 cm-1
   KAPPA_D => SD3_C5H8O2
   GAMMA_D => GAMMAD3_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 1250 cm-1 - 1575 cm-1 
   KAPPA_D => SD4_C5H8O2
   GAMMA_D => GAMMAD4_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==5)) THEN ! BAND #5: 1550 cm-1 - 1975 cm-1 
   KAPPA_D => SD5_C5H8O2
   GAMMA_D => GAMMAD5_C5H8O2
ELSEIF(IN_BAND.AND.(I_BAND==6)) THEN ! BAND #6: 2650 cm-1 - 3275 cm-1 
   KAPPA_D => SD6_C5H8O2
   GAMMA_D => GAMMAD6_C5H8O2
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C5H8O2(I_BAND)-1.0_EB)*PC5H8O2 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C5H8O2_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C5H8O2_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C5H8O2
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C5H8O2

!==============================================================================
SUBROUTINE C2H6(OMEGA,TEMP,PC2H6,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE ETHANE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 3 BANDS FOR Ethane
! BAND #1: 750 cm-1 - 1100 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC2H6   : (REAL) PARTIAL PRESSURE OF ETHANE
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C2H6         : INVERSE LINE SPACING [CM] FOR ETHANE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC2H6, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C2H6 

REAL(EB), PARAMETER :: Q2      = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C2H6 = 30.0690_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C2H6
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C2H6) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! ETHANE Belongs to point group D3d with Rotational Constant A = 2.51967 cm-1
! B = 0.68341 cm-1, and C = 0.68341 cm-1.
DINV_C2H6=1._EB/(2.0_EB*0.68341_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 3 BANDS FOR Ethane
! BAND #1: 750 cm-1 - 1100 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C2H6
   IF ((OM_BND_C2H6(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C2H6(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C2H6(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1:  750 cm-1 - 1100 cm-1
   KAPPA_D => SD1_C2H6
   GAMMA_D => GAMMAD1_C2H6
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1250 cm-1 - 1700 cm-1 
   KAPPA_D => SD2_C2H6
   GAMMA_D => GAMMAD2_C2H6
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 2550 cm-1 - 3375 cm-1
   KAPPA_D => SD3_C2H6
   GAMMA_D => GAMMAD3_C2H6
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C2H6(I_BAND)-1.0_EB)*PC2H6 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H6_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H6_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C2H6
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C2H6

!==============================================================================
SUBROUTINE C2H4(OMEGA,TEMP,PC2H4,PTOT,SDWEAK,GDINV,GDDINV,I_MODEL)
!==============================================================================
! COMPUTE ETHYLENE OPTICAL PROPERTIES USING SINGLE LINE GROUP
! 
! ABSORPTION BANDS: 
! THERE ARE 4 BANDS FOR Ethylene
! BAND #1: 800 cm-1  - 1250 cm-1 
! BAND #2: 1325 cm-1 - 1575 cm-1 
! BAND #3: 1775 cm-1 - 2050 cm-1 
! BAND #4: 2825 cm-1 - 3350 cm-1 
!
! VARIABLES PASSED IN
! OMEGA   : (REAL) WAVENUMBER IN CM-1
! TEMP    : (REAL) TEMPERATURE IN K
! PC2H4 : (REAL) PARTIAL PRESSURE OF ETHYLENE
! PTOT    : (REAL) TOTAL PRESSURE
! 
! VARIABLES PASSED OUT
! SDWEAK : (REAL) SPECTRAL ABSORPTION COEFFICIENT
! GDINV  : (REAL) LINE WIDTH TO LINE SPACING RATIO, FINE STRUCTURE PARAMETER
! GDDINV : (REAL) LINE WIDTH TO LINE SPACING RATIO FOR DOPPLER BORADENING,
!                 FINE STRUCTURE PARAMETER
! I_MODEL: (INTEGER) MODEL USED FOR SNB FITTING: 1: GOODY, 2 MALKMUS, 3 ELSASSER

! LOCALS
! PRESSURE_EFFECTIVE : (REAL) EFFECTIVE PRESSURE, (FORMELY PE)
! DINV_C2H4          : INVERSE LINE SPACING [CM] FOR ETHYLENE

REAL(EB), INTENT(IN)  :: OMEGA, TEMP, PC2H4, PTOT
REAL(EB), INTENT(OUT) :: SDWEAK, GDINV, GDDINV

INTEGER, INTENT(OUT) :: I_MODEL

REAL(EB) :: Q2OT, AZOT, TOAZ
REAL(EB) :: GD, PRESSURE_EFFECTIVE
REAL(EB) :: DINV_C2H4 

REAL(EB), PARAMETER :: Q2      = 1.4388_EB  ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
REAL(EB), PARAMETER :: WM_C2H4 = 28.0532_EB ! NIST WEBBOOK DATA
INTEGER :: I_BAND, I

LOGICAL :: IN_BAND ! TRUE IF OMEGA IS WITHIN SOME TABULATED BAND, FALSE OTHERWISE

! GET MODEL FOR SNB FITTING

I_MODEL = I_MODEL_C2H4
I_BAND  = 0
IN_BAND = .FALSE.

! NULLIFY POINTERS IF ASSOCIATED
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

! SET INITIAL VALUES TO SDWEAK, GDINV, GDDINV - VALUES ARE RETURNED IF OMEGA IS NOT
! WITHIN ABSOPRTION BANDS
SDWEAK = 0.0_EB
GDINV  = 1._EB 
GDDINV = 1._EB 

! COMPUTE THERMAL COEFFICIENTS
Q2OT = -Q2/TEMP       
AZOT = 273._EB/TEMP
TOAZ = TEMP/273._EB

! COMPUTE DOPPLER BROADENING HALF WIDTH GD
GD   = 5.94E-6_EB*OMEGA*SQRT(TOAZ/WM_C2H4) !DOPPLER HALF WIDTH [CM^-1]. NASA,222

! COMPUTE AVERAGE LINE SPACING
! ETHYLENE Belongs to point group D2h with Rotational Constant A = 4.828 cm-1
! B = 1.0012 cm-1, and C = 0.8282 cm-1. We make the assumption B ~ C
DINV_C2H4 = 1._EB/(2.0_EB*1.0012_EB)

! IF OMEGA IS WITHIN ABSOPRTION BAND, THEN COMPUTE SDWEAK FROM TABULATED DATA
! THERE ARE 4 BANDS FOR Ethylene
! BAND #1: 800 cm-1  - 1250 cm-1 
! BAND #2: 1325 cm-1 - 1575 cm-1 
! BAND #3: 1775 cm-1 - 2050 cm-1 
! BAND #4: 2825 cm-1 - 3350 cm-1 

! GET THE INDEX OF THE BAND
BAND: DO I = 1, N_BAND_C2H4
   IF ((OM_BND_C2H4(I,1)<=OMEGA).AND.(OMEGA<OM_BND_C2H4(I,2))) THEN
     IN_BAND = .TRUE.
     I_BAND  = I
     BAND_OMEGA => OM_BND_C2H4(I_BAND,:) 
     EXIT BAND
   ENDIF
ENDDO BAND

IF (IN_BAND.AND.(I_BAND==1)) THEN    ! BAND #1: 800 cm-1  - 1250 cm-1 
   KAPPA_D => SD1_C2H4
   GAMMA_D => GAMMAD1_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==2)) THEN ! BAND #2: 1325 cm-1 - 1575 cm-1 
   KAPPA_D => SD2_C2H4
   GAMMA_D => GAMMAD2_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==3)) THEN ! BAND #3: 1775 cm-1 - 2050 cm-1
   KAPPA_D => SD3_C2H4
   GAMMA_D => GAMMAD3_C2H4
ELSEIF(IN_BAND.AND.(I_BAND==4)) THEN ! BAND #4: 2825 cm-1 - 3350 cm-1
   KAPPA_D => SD4_C2H4
   GAMMA_D => GAMMAD4_C2H4
ENDIF

! COMPUTE PROPERTIES
IF (IN_BAND) THEN
   PRESSURE_EFFECTIVE = PTOT+(Be_C2H4(I_BAND)-1.0_EB)*PC2H4 
   SDWEAK = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H4_TEMP,BAND_OMEGA,KAPPA_D)
   GDINV  = GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_C2H4_TEMP,BAND_OMEGA,GAMMA_D)
   GDINV  = GDINV*PRESSURE_EFFECTIVE
   GDDINV = GD*DINV_C2H4
!***EXPRESS S/D AT STP, AS IS K IN NASA SP-3080
   SDWEAK = SDWEAK*TOAZ
ENDIF

! NULLIFY POINTERS
IF (ASSOCIATED(BAND_OMEGA))  NULLIFY(BAND_OMEGA)
IF (ASSOCIATED(KAPPA_D))     NULLIFY(KAPPA_D)
IF (ASSOCIATED(GAMMA_D))     NULLIFY(GAMMA_D)

RETURN
!------------------------------------------------------------------------------
END SUBROUTINE C2H4


!==============================================================================
REAL(EB) FUNCTION GET_SPECTRAL_ABSORPTION(OMEGA,TEMP,SD_TEMP,BOUNDS,ABSORPTION_DATA)
!==============================================================================
! RETURNS INTERPOLATED VALUES OF SPECTRAL ABSORPTION
! NOTE ASSUMED SHAPE
!
! Input:
! OMEGA  : WAVENUMBER, UNIT = 1/cm
! TEMP   : GAS TEMPERATURE, UNIT = KELVIN
! SD_TEMP: VECTOR OF TEMPERATURE MEASUREMENTS, DIMENSION(*) UNIT = KELVIN
! BOUNDS : VECTOR OF WAVENUMBER BOUNDS AND SPACING FOR A GIVEN BAND, DIMENSIONS(3)
! ABSORPTION_DATA: ARRAY OF SPECIES SPECTRAL MEASUREMENTS, DIMENSIONS(*,*)
!                 NOTE = FIRST DIMENSION EQUALS TO DIMENSION OF SD_TEMP
!
! ACTION PERFORMED: BILINEAR INTERPOLATION OF ABSORPTION_DATA
!------------------------------------------------------------------------------
! Variables passed in

 REAL(EB), INTENT(IN) :: OMEGA
 REAL(EB), INTENT(IN) :: TEMP
 REAL(EB), DIMENSION(:), INTENT(IN)   :: SD_TEMP, BOUNDS
 REAL(EB), DIMENSION(:,:), INTENT(IN) :: ABSORPTION_DATA 

 REAL(EB) :: DELTA_T
 REAL(EB) :: DELTA_W
 REAL(EB) :: W1
 REAL(EB) :: OMEGA_MIN, OMEGA_MAX, DELTA_OMEGA
 REAL(EB) :: TTEMP
 REAL(EB) :: INTERPOLATED_VALUE

 INTEGER :: N_TEMP, N_BOUNDS, N_ABS_DATA1, N_ABS_DATA2
 INTEGER :: I_OMEGA, I_TEMP

! CVL NEED TO LINK MODULE THAT DEFINES ERRMSG
! PART OF THE CODE COMMENTED FOR NOW
!  CHARACTER(255) MESSAG
!  LOGICAL FATAL

 N_TEMP      = UBOUND(SD_TEMP,1)  ! GET NUMBER OF TEMPERATURE MEASUREMENTS
 N_BOUNDS    = UBOUND(BOUNDS,1)   ! GET NUMBER OF ELEMENTS IN BOUNDS. SHOULD BE 3
 N_ABS_DATA1 = UBOUND(ABSORPTION_DATA,1) ! GET NUMBER OF TEMPERATURE DATA
 N_ABS_DATA2 = UBOUND(ABSORPTION_DATA,2) ! GET NUMBER OF WAVENUMBER DATA


! ! CVL NEED TO LINK MODULE THAT DEFINES ERRMSG
! ! PART OF THE CODE COMMENTED FOR NOW
! !-----------------------------TEST DIMENSIONS OF BOUNDS AND ABSORPTION_DATA----
! ! N_BOUNDS SHOULD BE 3
! 
!  IF (N_BOUNDS/=3) THEN 
!     MESSAG='ERROR IN RADCAL. N_BOUNDS SHOULD BE EQUAL TO 3'
!     FATAL = .TRUE.
!     CALL ERRMSG( trim(MESSAG), FATAL )
!  ENDIF
! 
! ! N_ABS_DATA1 SHOULD BE EQUAL TO N_TEMP
! 
!  IF (N_ABS_DATA1/=N_TEMP) THEN 
!     MESSAG='ERROR IN RADCAL. FIRST DIMENSION OF ABSORPTION_DATA SHOULD BE EQUAL TO N_TEMP'
!     FATAL = .TRUE.
!     CALL ERRMSG( trim(MESSAG), FATAL )
!  ENDIF

!------------------------------------------------------------------------------
 OMEGA_MIN   = BOUNDS(1)
 OMEGA_MAX   = BOUNDS(2)
 DELTA_OMEGA = BOUNDS(3)
 
! BOUNDS TTEMP SO THAT MIN(SD_TEMP) <= TTEMP <= MAX(SD_TEMP)
! IF TTEMP < MIN(SD_TEMP) THEN TTEMP := MIN(SD_TEMP)
! IF MAX(SD_TEMP) < TTEMP THEN TTEMP := MAX(SD_TEMP)
 TTEMP       = MIN(MAXVAL(SD_TEMP),MAX(TEMP,MINVAL(SD_TEMP)))  

 IF (TTEMP <= MINVAL(SD_TEMP)) THEN
    I_TEMP  = 1
    DELTA_T = 0._EB
 ELSE IF (TTEMP >= MAXVAL(SD_TEMP)) THEN
    I_TEMP  = N_TEMP-1
    DELTA_T = 1.0_EB
 ELSE
! FIND INDEX I_TEMP SUCH THAT SD_TEMP(I_TEMP)<TTEMP<=SD_TEMP(I_TEMP+1)
    DO I_TEMP = 1, N_TEMP-1
       IF ((SD_TEMP(I_TEMP)<TTEMP).AND.(TTEMP<=SD_TEMP(I_TEMP+1))) EXIT
    ENDDO

    DELTA_T = (TTEMP-SD_TEMP(I_TEMP))/(SD_TEMP(I_TEMP+1)-SD_TEMP(I_TEMP))
 ENDIF

 IF ((OMEGA_MIN<=OMEGA).AND.(OMEGA<=OMEGA_MAX)) THEN 

    IF(OMEGA<OMEGA_MAX) THEN
! FIND I_OMEGA SUCH THAT OMEGA(I_OMEGA)<=OMEGA<OMEGA(I_OMEGA+1)
       I_OMEGA = FLOOR((OMEGA-OMEGA_MIN)/DELTA_OMEGA)+1
       I_OMEGA = MIN(I_OMEGA,N_ABS_DATA2-1)
       W1      = OMEGA_MIN+DELTA_OMEGA*(REAL(I_OMEGA-1,EB))
       DELTA_W = (OMEGA-W1)/DELTA_OMEGA
    ELSE
! CASE I_OMEGA = OMEGA_MAX => ASSUME THEN THAT I_OMEGA = N_ABS_DATA2 -1 
       I_OMEGA = N_ABS_DATA2 - 1
       W1      = OMEGA_MIN+DELTA_OMEGA*(REAL(I_OMEGA-1,EB))
       DELTA_W = (OMEGA-W1)/DELTA_OMEGA
    ENDIF

! PERFORM BILINEAR INTERPOLATION TO OBTAIN VALUES OF SDWEAK
    INTERPOLATED_VALUE = (1._EB-DELTA_W)*((1._EB-DELTA_T)*ABSORPTION_DATA(I_TEMP,I_OMEGA)+ & 
                         ABSORPTION_DATA(I_TEMP+1,I_OMEGA)*DELTA_T) +                      &
                         DELTA_W*(ABSORPTION_DATA(I_TEMP,I_OMEGA+1)*(1._EB-DELTA_T)+       &
                         ABSORPTION_DATA(I_TEMP+1,I_OMEGA+1)*DELTA_T)

 ELSE
    INTERPOLATED_VALUE = 0._EB
 ENDIF

! ENSURE POSITIVITY
 GET_SPECTRAL_ABSORPTION = MAX(0._EB,INTERPOLATED_VALUE)
!------------------------------------------------------------------------------
 END FUNCTION GET_SPECTRAL_ABSORPTION


!==============================================================================
REAL(EB) FUNCTION PLANCK(TEMP,LAMBDA)
!==============================================================================
! COMPUTES BLACKBODY FUNCTION IN UNITS OF W/M-2/MICRON/SR
! Input:
! TEMP: TEMPERATURE, UNIT = KELVIN
! LAMBDA: WAVELENGTH, UNIT = MicroMETERS
!------------------------------------------------------------------------------
! Variables passed in
 REAL (EB), INTENT(IN):: TEMP, LAMBDA

! local variables
 REAL (EB), PARAMETER :: Q1 = 1.19088E8_EB ! Q1 = 2*SPEED_OF_LIGHT^2*PLANCK_CNST
 REAL (EB), PARAMETER :: Q2 = 14388._EB    ! Q2 = SPEED_OF_LIGHT*PLANCK_CNS/BOLTZMANN
 REAL (EB) :: C   ! C = LAMBDA * TEMP

 IF(ABS(TEMP)<TWO_EPSILON_EB) THEN
    PLANCK = 0._EB
 ELSE
    C = TEMP * LAMBDA
    IF (Q2/C > 38._EB) THEN
       PLANCK = 0._EB
    ELSE
       PLANCK=Q1*(LAMBDA**(-5))/(EXP(Q2/C)-1._EB)
   END IF
 ENDIF
!------------------------------------------------------------------------------
END FUNCTION PLANCK

!==============================================================================
SUBROUTINE RCALLOC
!==============================================================================

ALLOCATE(P(6))
ALLOCATE(SPECIE(5))
ALLOCATE(QW(600))
ALLOCATE(TTAU(600))
ALLOCATE(XT(600))
ALLOCATE(X(4))
ALLOCATE(GC(4))
ALLOCATE(LAMBDA(600))
ALLOCATE(OPTICAL_THICKNESS(4))
ALLOCATE(AB(600))
ALLOCATE(ATOT(4))
ALLOCATE(BCNT(4))
ALLOCATE(GAMMA(4,7))
ALLOCATE(SD15(6,80))
ALLOCATE(SD(6,376))
ALLOCATE(SD7(3,16))
ALLOCATE(SD3(3,32))


I_MODEL_CO2 = 1 ! GOODY MODEL
I_MODEL_CO  = 1 ! GOODY MODEL
I_MODEL_H2O = 1 ! GOODY MODEL

!-------------------------Methane DATA-------------------


! THERE ARE 2 BANDS FOR Methane

! BAND #1: 1150 cm-1 - 1600 cm-1 
! BAND #2: 2700 cm-1 - 3250 cm-1 
! BAND #3: 3400 cm-1 - 5000 cm-1

N_TEMP_CH4 = 23
N_BAND_CH4 = 3

I_MODEL_CH4 = 3 ! ELSASSER MODEL

ALLOCATE(SD_CH4_TEMP(N_TEMP_CH4)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Methane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., THEN THE BAND IS CALCULATED AND NOT TABULATED.

ALLOCATE(OM_BND_CH4(N_BAND_CH4,3)) 

OM_BND_CH4 = RESHAPE((/ &
    1150._EB, 2700._EB, 3400._EB,&
    1600._EB, 3250._EB, 5000._EB,&
      25._EB,   25._EB,    0._EB/),(/N_BAND_CH4,3/)) 

SD_CH4_TEMP = (/ &
    300._EB, 350._EB, 400._EB, 450._EB, 500._EB, 550._EB,&
    600._EB, 650._EB, 700._EB, 750._EB, 800._EB, 850._EB,&
    900._EB, 950._EB, 1000._EB, 1050._EB, 1100._EB, 1150._EB,&
    1200._EB, 1250._EB, 1300._EB, 1350._EB, 1400._EB/)

ALLOCATE(SD1_CH4(N_TEMP_CH4,19)) 

! BAND #1: 1150 cm-1 - 1600 cm-1 

SD1_CH4(1:23,1:8) = RESHAPE((/ &  ! 1150-1325 cm-1
    2.674955E-03_EB, 4.122616E-03_EB, 6.116504E-03_EB, 8.394889E-03_EB, 1.066588E-02_EB, 1.270929E-02_EB, &
    1.431368E-02_EB, 1.543500E-02_EB, 1.607798E-02_EB, 1.623394E-02_EB, 1.594103E-02_EB, 1.537005E-02_EB, &
    1.456109E-02_EB, 1.356591E-02_EB, 1.253062E-02_EB, 1.145338E-02_EB, 1.037156E-02_EB, 9.319748E-03_EB, &
    8.296535E-03_EB, 7.359273E-03_EB, 6.512254E-03_EB, 5.764075E-03_EB, 5.034367E-03_EB,  &
    1.056047E-02_EB, 1.689522E-02_EB, 2.382293E-02_EB, 3.013931E-02_EB, 3.518013E-02_EB, 3.873081E-02_EB, &
    4.056505E-02_EB, 4.099451E-02_EB, 4.031689E-02_EB, 3.867720E-02_EB, 3.630281E-02_EB, 3.360423E-02_EB, &
    3.072697E-02_EB, 2.769650E-02_EB, 2.480529E-02_EB, 2.203561E-02_EB, 1.945492E-02_EB, 1.710571E-02_EB, &
    1.490918E-02_EB, 1.297063E-02_EB, 1.127359E-02_EB, 9.806206E-03_EB, 8.433200E-03_EB,  &
    6.535368E-02_EB, 8.634735E-02_EB, 1.035285E-01_EB, 1.149338E-01_EB, 1.211259E-01_EB, 1.231160E-01_EB, &
    1.212403E-01_EB, 1.167139E-01_EB, 1.104665E-01_EB, 1.027695E-01_EB, 9.409726E-02_EB, 8.537322E-02_EB, &
    7.679556E-02_EB, 6.836183E-02_EB, 6.060003E-02_EB, 5.339354E-02_EB, 4.679438E-02_EB, 4.089038E-02_EB, &
    3.545789E-02_EB, 3.072468E-02_EB, 2.660506E-02_EB, 2.306236E-02_EB, 1.979016E-02_EB,  &
    2.797310E-01_EB, 2.878774E-01_EB, 2.844637E-01_EB, 2.718418E-01_EB, 2.544158E-01_EB, 2.351542E-01_EB, &
    2.144282E-01_EB, 1.940107E-01_EB, 1.744123E-01_EB, 1.554283E-01_EB, 1.374171E-01_EB, 1.210226E-01_EB, &
    1.060935E-01_EB, 9.238361E-02_EB, 8.033186E-02_EB, 6.960028E-02_EB, 6.015950E-02_EB, 5.186871E-02_EB, &
    4.448682E-02_EB, 3.815557E-02_EB, 3.272683E-02_EB, 2.816055E-02_EB, 2.399102E-02_EB,  &
    6.055294E-01_EB, 5.085203E-01_EB, 4.314546E-01_EB, 3.661128E-01_EB, 3.120083E-01_EB, 2.675996E-01_EB, &
    2.295433E-01_EB, 1.976798E-01_EB, 1.706085E-01_EB, 1.470613E-01_EB, 1.263463E-01_EB, 1.086762E-01_EB, &
    9.339644E-02_EB, 7.991483E-02_EB, 6.850499E-02_EB, 5.859531E-02_EB, 5.007218E-02_EB, 4.275497E-02_EB, &
    3.636644E-02_EB, 3.094626E-02_EB, 2.637845E-02_EB, 2.255529E-02_EB, 1.911152E-02_EB,  &
    7.291248E-01_EB, 6.247580E-01_EB, 5.567927E-01_EB, 5.047634E-01_EB, 4.622435E-01_EB, 4.253591E-01_EB, &
    3.901550E-01_EB, 3.566718E-01_EB, 3.248608E-01_EB, 2.936112E-01_EB, 2.628808E-01_EB, 2.344160E-01_EB, &
    2.078641E-01_EB, 1.829068E-01_EB, 1.606407E-01_EB, 1.403181E-01_EB, 1.221762E-01_EB, 1.060864E-01_EB, &
    9.154534E-02_EB, 7.892764E-02_EB, 6.808643E-02_EB, 5.882322E-02_EB, 5.031768E-02_EB,  &
    1.503577E+00_EB, 1.216438E+00_EB, 1.009787E+00_EB, 8.445781E-01_EB, 7.110515E-01_EB, 6.021463E-01_EB, &
    5.099874E-01_EB, 4.327438E-01_EB, 3.680691E-01_EB, 3.125303E-01_EB, 2.644163E-01_EB, 2.242054E-01_EB, &
    1.897708E-01_EB, 1.602130E-01_EB, 1.354708E-01_EB, 1.143770E-01_EB, 9.654761E-02_EB, 8.152145E-02_EB, &
    6.854917E-02_EB, 5.774320E-02_EB, 4.875464E-02_EB, 4.129146E-02_EB, 3.467888E-02_EB,  &
    1.113787E+00_EB, 8.666106E-01_EB, 6.937600E-01_EB, 5.636603E-01_EB, 4.651973E-01_EB, 3.899245E-01_EB, &
    3.293625E-01_EB, 2.804438E-01_EB, 2.403481E-01_EB, 2.062563E-01_EB, 1.767199E-01_EB, 1.518103E-01_EB, &
    1.304026E-01_EB, 1.116263E-01_EB, 9.571162E-02_EB, 8.192030E-02_EB, 7.003835E-02_EB, 5.986022E-02_EB, &
    5.092725E-02_EB, 4.337782E-02_EB, 3.700459E-02_EB, 3.164349E-02_EB, 2.682395E-02_EB/),(/23,8/))

SD1_CH4(1:23,9:16) = RESHAPE((/ &  ! 1350-1525 cm-1
    5.859637E-01_EB, 5.741640E-01_EB, 5.446284E-01_EB, 5.016955E-01_EB, 4.533548E-01_EB, 4.052375E-01_EB, &
    3.578427E-01_EB, 3.138042E-01_EB, 2.741405E-01_EB, 2.379703E-01_EB, 2.050667E-01_EB, 1.765003E-01_EB, &
    1.515652E-01_EB, 1.294551E-01_EB, 1.106049E-01_EB, 9.430003E-02_EB, 8.028460E-02_EB, 6.831086E-02_EB, &
    5.788843E-02_EB, 4.905327E-02_EB, 4.167658E-02_EB, 3.549325E-02_EB, 2.997796E-02_EB,  &
    5.143640E-02_EB, 7.394302E-02_EB, 9.480931E-02_EB, 1.108135E-01_EB, 1.211319E-01_EB, 1.262273E-01_EB, &
    1.262909E-01_EB, 1.227527E-01_EB, 1.167145E-01_EB, 1.087709E-01_EB, 9.943737E-02_EB, 9.002538E-02_EB, &
    8.060527E-02_EB, 7.137067E-02_EB, 6.299760E-02_EB, 5.512164E-02_EB, 4.801455E-02_EB, 4.169764E-02_EB, &
    3.593587E-02_EB, 3.095498E-02_EB, 2.664278E-02_EB, 2.295572E-02_EB, 1.959682E-02_EB,  &
    7.616134E-03_EB, 9.957002E-03_EB, 1.281279E-02_EB, 1.589717E-02_EB, 1.894916E-02_EB, 2.174268E-02_EB, &
    2.395920E-02_EB, 2.555557E-02_EB, 2.648904E-02_EB, 2.671274E-02_EB, 2.629477E-02_EB, 2.540283E-02_EB, &
    2.418621E-02_EB, 2.265546E-02_EB, 2.101542E-02_EB, 1.928221E-02_EB, 1.752831E-02_EB, 1.582992E-02_EB, &
    1.416926E-02_EB, 1.261250E-02_EB, 1.121041E-02_EB, 9.951538E-03_EB, 8.728757E-03_EB,  &
    1.277402E-02_EB, 1.327177E-02_EB, 1.322108E-02_EB, 1.267471E-02_EB, 1.186190E-02_EB, 1.093562E-02_EB, &
    9.920972E-03_EB, 8.920419E-03_EB, 7.971129E-03_EB, 7.057028E-03_EB, 6.197372E-03_EB, 5.429023E-03_EB, &
    4.732635E-03_EB, 4.092017E-03_EB, 3.548360E-03_EB, 3.062048E-03_EB, 2.633809E-03_EB, 2.263255E-03_EB, &
    1.935254E-03_EB, 1.656795E-03_EB, 1.416023E-03_EB, 1.215289E-03_EB, 1.031774E-03_EB,  &
    8.014464E-03_EB, 7.194752E-03_EB, 6.553713E-03_EB, 6.000398E-03_EB, 5.531684E-03_EB, 5.121393E-03_EB, &
    4.722456E-03_EB, 4.343916E-03_EB, 3.983544E-03_EB, 3.621247E-03_EB, 3.268422E-03_EB, 2.936068E-03_EB, &
    2.617151E-03_EB, 2.322363E-03_EB, 2.051315E-03_EB, 1.804840E-03_EB, 1.578471E-03_EB, 1.378963E-03_EB, &
    1.197596E-03_EB, 1.036958E-03_EB, 9.007021E-04_EB, 7.820103E-04_EB, 6.693842E-04_EB,  &
    2.792665E-03_EB, 2.575454E-03_EB, 2.537125E-03_EB, 2.578233E-03_EB, 2.648059E-03_EB, 2.713453E-03_EB, &
    2.741224E-03_EB, 2.722787E-03_EB, 2.662395E-03_EB, 2.559402E-03_EB, 2.415338E-03_EB, 2.254521E-03_EB, &
    2.077537E-03_EB, 1.891657E-03_EB, 1.708933E-03_EB, 1.533948E-03_EB, 1.367874E-03_EB, 1.212162E-03_EB, &
    1.064882E-03_EB, 9.339250E-04_EB, 8.169687E-04_EB, 7.180516E-04_EB, 6.220503E-04_EB,  &
    8.239408E-04_EB, 8.207289E-04_EB, 8.769232E-04_EB, 9.471812E-04_EB, 1.013068E-03_EB, 1.072041E-03_EB, &
    1.109555E-03_EB, 1.125480E-03_EB, 1.120373E-03_EB, 1.094883E-03_EB, 1.043855E-03_EB, 9.887558E-04_EB, &
    9.221581E-04_EB, 8.517148E-04_EB, 7.786200E-04_EB, 7.086512E-04_EB, 6.363394E-04_EB, 5.709486E-04_EB, &
    5.037963E-04_EB, 4.478632E-04_EB, 3.933607E-04_EB, 3.461225E-04_EB, 3.036065E-04_EB,  &
    1.787674E-02_EB, 1.651301E-02_EB, 1.538618E-02_EB, 1.427021E-02_EB, 1.321135E-02_EB, 1.220556E-02_EB, &
    1.120017E-02_EB, 1.022271E-02_EB, 9.293408E-03_EB, 8.381487E-03_EB, 7.491250E-03_EB, 6.673691E-03_EB, &
    5.914957E-03_EB, 5.201979E-03_EB, 4.566356E-03_EB, 3.988961E-03_EB, 3.472458E-03_EB, 3.017625E-03_EB, &
    2.605493E-03_EB, 2.248445E-03_EB, 1.941774E-03_EB, 1.676885E-03_EB, 1.438512E-03_EB/),(/23,8/))

SD1_CH4(1:23,17:19) = RESHAPE((/ &  ! 1550-1600 cm-1
    3.842192E-03_EB, 4.909077E-03_EB, 5.876585E-03_EB, 6.637230E-03_EB, 7.159498E-03_EB, 7.449619E-03_EB, &
    7.502474E-03_EB, 7.374704E-03_EB, 7.105819E-03_EB, 6.720456E-03_EB, 6.241450E-03_EB, 5.729337E-03_EB, &
    5.213056E-03_EB, 4.685851E-03_EB, 4.183214E-03_EB, 3.714659E-03_EB, 3.276286E-03_EB, 2.879051E-03_EB, &
    2.508044E-03_EB, 2.182116E-03_EB, 1.899894E-03_EB, 1.653926E-03_EB, 1.423668E-03_EB,  &
    1.587677E-03_EB, 1.446538E-03_EB, 1.552901E-03_EB, 1.804439E-03_EB, 2.128742E-03_EB, 2.458565E-03_EB, &
    2.743898E-03_EB, 2.955974E-03_EB, 3.088835E-03_EB, 3.134690E-03_EB, 3.095698E-03_EB, 3.002805E-03_EB, &
    2.862955E-03_EB, 2.683299E-03_EB, 2.486550E-03_EB, 2.282038E-03_EB, 2.073847E-03_EB, 1.873143E-03_EB, &
    1.674361E-03_EB, 1.489429E-03_EB, 1.321804E-03_EB, 1.173554E-03_EB, 1.026702E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB/),(/23,3/))

ALLOCATE(SD2_CH4(N_TEMP_CH4,23)) 

! BAND #2: 2700 cm-1 - 3250 cm-1 

SD2_CH4(1:23,1:8) = RESHAPE((/ &  ! 2700-2875 cm-1
    1.217530E-02_EB, 1.117112E-02_EB, 1.018335E-02_EB, 9.113159E-03_EB, 8.069237E-03_EB, 7.089143E-03_EB, &
    6.164984E-03_EB, 5.339743E-03_EB, 4.605161E-03_EB, 3.952813E-03_EB, 3.369126E-03_EB, 2.873535E-03_EB, &
    2.442004E-03_EB, 2.069306E-03_EB, 1.752468E-03_EB, 1.483929E-03_EB, 1.255931E-03_EB, 1.056565E-03_EB, &
    8.920522E-04_EB, 7.508758E-04_EB, 6.317838E-04_EB, 5.352971E-04_EB, 4.530464E-04_EB,  &
    2.513916E-02_EB, 2.114376E-02_EB, 1.780513E-02_EB, 1.491293E-02_EB, 1.247243E-02_EB, 1.043356E-02_EB, &
    8.698933E-03_EB, 7.256269E-03_EB, 6.066735E-03_EB, 5.057876E-03_EB, 4.209670E-03_EB, 3.508303E-03_EB, &
    2.922322E-03_EB, 2.428483E-03_EB, 2.028794E-03_EB, 1.689558E-03_EB, 1.409261E-03_EB, 1.176715E-03_EB, &
    9.788265E-04_EB, 8.167162E-04_EB, 6.823326E-04_EB, 5.730157E-04_EB, 4.786727E-04_EB,  &
    2.557782E-02_EB, 2.133345E-02_EB, 1.832454E-02_EB, 1.586992E-02_EB, 1.378920E-02_EB, 1.202910E-02_EB, &
    1.045539E-02_EB, 9.073223E-03_EB, 7.878108E-03_EB, 6.813401E-03_EB, 5.858711E-03_EB, 5.036798E-03_EB, &
    4.322566E-03_EB, 3.689893E-03_EB, 3.157259E-03_EB, 2.690401E-03_EB, 2.292743E-03_EB, 1.951361E-03_EB, &
    1.658405E-03_EB, 1.405787E-03_EB, 1.195120E-03_EB, 1.018165E-03_EB, 8.624014E-04_EB,  &
    3.267234E-02_EB, 2.794974E-02_EB, 2.414894E-02_EB, 2.075791E-02_EB, 1.780983E-02_EB, 1.531517E-02_EB, &
    1.312860E-02_EB, 1.127375E-02_EB, 9.704346E-03_EB, 8.352011E-03_EB, 7.159191E-03_EB, 6.165400E-03_EB, &
    5.304681E-03_EB, 4.552437E-03_EB, 3.918329E-03_EB, 3.371374E-03_EB, 2.897155E-03_EB, 2.490584E-03_EB, &
    2.139129E-03_EB, 1.834560E-03_EB, 1.579448E-03_EB, 1.362473E-03_EB, 1.164728E-03_EB,  &
    4.729257E-02_EB, 4.020146E-02_EB, 3.655117E-02_EB, 3.486375E-02_EB, 3.451183E-02_EB, 3.486976E-02_EB, &
    3.526911E-02_EB, 3.549943E-02_EB, 3.539419E-02_EB, 3.477334E-02_EB, 3.359574E-02_EB, 3.209631E-02_EB, &
    3.033091E-02_EB, 2.826035E-02_EB, 2.617425E-02_EB, 2.398793E-02_EB, 2.182750E-02_EB, 1.975692E-02_EB, &
    1.770980E-02_EB, 1.581216E-02_EB, 1.409330E-02_EB, 1.256203E-02_EB, 1.106706E-02_EB,  &
    3.967221E-02_EB, 3.764359E-02_EB, 3.949747E-02_EB, 4.277841E-02_EB, 4.623172E-02_EB, 4.903094E-02_EB, &
    5.058120E-02_EB, 5.097742E-02_EB, 5.029388E-02_EB, 4.863988E-02_EB, 4.605751E-02_EB, 4.308689E-02_EB, &
    3.983596E-02_EB, 3.638363E-02_EB, 3.298206E-02_EB, 2.967115E-02_EB, 2.650179E-02_EB, 2.356866E-02_EB, &
    2.077236E-02_EB, 1.827032E-02_EB, 1.605444E-02_EB, 1.411180E-02_EB, 1.226114E-02_EB,  &
    7.223868E-02_EB, 8.544183E-02_EB, 9.962661E-02_EB, 1.104863E-01_EB, 1.171420E-01_EB, 1.196787E-01_EB, &
    1.182118E-01_EB, 1.139658E-01_EB, 1.078438E-01_EB, 1.002471E-01_EB, 9.161471E-02_EB, 8.298437E-02_EB, &
    7.452297E-02_EB, 6.622584E-02_EB, 5.857678E-02_EB, 5.147962E-02_EB, 4.505849E-02_EB, 3.932179E-02_EB, &
    3.408714E-02_EB, 2.948172E-02_EB, 2.551286E-02_EB, 2.211846E-02_EB, 1.897647E-02_EB,  &
    1.759866E-01_EB, 2.015363E-01_EB, 2.180490E-01_EB, 2.232613E-01_EB, 2.203020E-01_EB, 2.118597E-01_EB, &
    1.990075E-01_EB, 1.841205E-01_EB, 1.683887E-01_EB, 1.521963E-01_EB, 1.360646E-01_EB, 1.209307E-01_EB, &
    1.069128E-01_EB, 9.382435E-02_EB, 8.206146E-02_EB, 7.155641E-02_EB, 6.219310E-02_EB, 5.392479E-02_EB, &
    4.648837E-02_EB, 4.008493E-02_EB, 3.458414E-02_EB, 2.988156E-02_EB, 2.558176E-02_EB/),(/23,8/))

SD2_CH4(1:23,9:16) = RESHAPE((/ &  ! 2900-3075 cm-1
    3.311709E-01_EB, 3.344762E-01_EB, 3.267663E-01_EB, 3.099531E-01_EB, 2.886161E-01_EB, 2.659881E-01_EB, &
    2.423456E-01_EB, 2.191913E-01_EB, 1.973904E-01_EB, 1.764196E-01_EB, 1.564157E-01_EB, 1.382986E-01_EB, &
    1.218590E-01_EB, 1.067421E-01_EB, 9.331013E-02_EB, 8.132822E-02_EB, 7.068471E-02_EB, 6.139407E-02_EB, &
    5.297295E-02_EB, 4.571219E-02_EB, 3.948284E-02_EB, 3.416733E-02_EB, 2.931231E-02_EB,  &
    8.235613E-01_EB, 7.238968E-01_EB, 6.324968E-01_EB, 5.466365E-01_EB, 4.712117E-01_EB, 4.058971E-01_EB, &
    3.486088E-01_EB, 2.993153E-01_EB, 2.575278E-01_EB, 2.209771E-01_EB, 1.890168E-01_EB, 1.618217E-01_EB, &
    1.384064E-01_EB, 1.180022E-01_EB, 1.008139E-01_EB, 8.601549E-02_EB, 7.332027E-02_EB, 6.253544E-02_EB, &
    5.308446E-02_EB, 4.515135E-02_EB, 3.847721E-02_EB, 3.288247E-02_EB, 2.786602E-02_EB,  &
    6.821008E-01_EB, 5.401363E-01_EB, 4.353503E-01_EB, 3.533680E-01_EB, 2.892836E-01_EB, 2.389427E-01_EB, &
    1.981961E-01_EB, 1.653239E-01_EB, 1.387030E-01_EB, 1.163771E-01_EB, 9.777404E-02_EB, 8.236369E-02_EB, &
    6.949908E-02_EB, 5.853014E-02_EB, 4.942064E-02_EB, 4.176497E-02_EB, 3.531768E-02_EB, 2.985698E-02_EB, &
    2.516886E-02_EB, 2.128060E-02_EB, 1.802439E-02_EB, 1.532867E-02_EB, 1.292454E-02_EB,  &
    5.823907E-01_EB, 4.331161E-01_EB, 3.353248E-01_EB, 2.655224E-01_EB, 2.144294E-01_EB, 1.761169E-01_EB, &
    1.472744E-01_EB, 1.241615E-01_EB, 1.057407E-01_EB, 9.045740E-02_EB, 7.745806E-02_EB, 6.667193E-02_EB, &
    5.744892E-02_EB, 4.942743E-02_EB, 4.263289E-02_EB, 3.676096E-02_EB, 3.166692E-02_EB, 2.731256E-02_EB, &
    2.343114E-02_EB, 2.014747E-02_EB, 1.734533E-02_EB, 1.497211E-02_EB, 1.281431E-02_EB,  &
    3.210821E+00_EB, 2.793045E+00_EB, 2.475891E+00_EB, 2.198508E+00_EB, 1.954455E+00_EB, 1.740419E+00_EB, &
    1.543274E+00_EB, 1.366589E+00_EB, 1.208668E+00_EB, 1.063917E+00_EB, 9.309610E-01_EB, 8.135837E-01_EB, &
    7.091172E-01_EB, 6.150707E-01_EB, 5.334009E-01_EB, 4.611724E-01_EB, 3.980142E-01_EB, 3.431784E-01_EB, &
    2.944666E-01_EB, 2.526486E-01_EB, 2.171496E-01_EB, 1.870189E-01_EB, 1.596229E-01_EB,  &
    3.517151E-01_EB, 2.541996E-01_EB, 1.936159E-01_EB, 1.517283E-01_EB, 1.221750E-01_EB, 1.004308E-01_EB, &
    8.351777E-02_EB, 7.016371E-02_EB, 5.949379E-02_EB, 5.053966E-02_EB, 4.298934E-02_EB, 3.667062E-02_EB, &
    3.130112E-02_EB, 2.669085E-02_EB, 2.279490E-02_EB, 1.946235E-02_EB, 1.660600E-02_EB, 1.417075E-02_EB, &
    1.204697E-02_EB, 1.025668E-02_EB, 8.756988E-03_EB, 7.490243E-03_EB, 6.351877E-03_EB,  &
    7.921358E-01_EB, 6.055366E-01_EB, 4.798618E-01_EB, 3.867414E-01_EB, 3.174199E-01_EB, 2.642038E-01_EB, &
    2.216893E-01_EB, 1.874171E-01_EB, 1.594862E-01_EB, 1.359448E-01_EB, 1.159382E-01_EB, 9.908354E-02_EB, &
    8.473452E-02_EB, 7.233655E-02_EB, 6.187191E-02_EB, 5.286391E-02_EB, 4.518233E-02_EB, 3.863453E-02_EB, &
    3.288079E-02_EB, 2.803528E-02_EB, 2.394608E-02_EB, 2.051761E-02_EB, 1.743587E-02_EB,  &
    1.334409E+00_EB, 1.095178E+00_EB, 9.120448E-01_EB, 7.631562E-01_EB, 6.425576E-01_EB, 5.444728E-01_EB, &
    4.621443E-01_EB, 3.938260E-01_EB, 3.368579E-01_EB, 2.880892E-01_EB, 2.459378E-01_EB, 2.104005E-01_EB, &
    1.799327E-01_EB, 1.535802E-01_EB, 1.314063E-01_EB, 1.121907E-01_EB, 9.581696E-02_EB, 8.185813E-02_EB, &
    6.964125E-02_EB, 5.934825E-02_EB, 5.067442E-02_EB, 4.339843E-02_EB, 3.686411E-02_EB/),(/23,8/))

SD2_CH4(1:23,17:23) = RESHAPE((/ &  ! 3100-3250 cm-1
    9.674073E-01_EB, 9.013091E-01_EB, 8.256467E-01_EB, 7.423397E-01_EB, 6.619262E-01_EB, 5.879801E-01_EB, &
    5.191373E-01_EB, 4.573467E-01_EB, 4.022801E-01_EB, 3.523929E-01_EB, 3.072101E-01_EB, 2.674592E-01_EB, &
    2.326179E-01_EB, 2.012004E-01_EB, 1.742107E-01_EB, 1.505433E-01_EB, 1.298551E-01_EB, 1.119451E-01_EB, &
    9.604141E-02_EB, 8.242372E-02_EB, 7.089244E-02_EB, 6.110245E-02_EB, 5.221546E-02_EB,  &
    3.658653E-01_EB, 4.184364E-01_EB, 4.441884E-01_EB, 4.457809E-01_EB, 4.319013E-01_EB, 4.088715E-01_EB, &
    3.793819E-01_EB, 3.474065E-01_EB, 3.151904E-01_EB, 2.830904E-01_EB, 2.516607E-01_EB, 2.228145E-01_EB, &
    1.964195E-01_EB, 1.718178E-01_EB, 1.502324E-01_EB, 1.307846E-01_EB, 1.135071E-01_EB, 9.842138E-02_EB, &
    8.481592E-02_EB, 7.309981E-02_EB, 6.307130E-02_EB, 5.451710E-02_EB, 4.669207E-02_EB,  &
    8.373191E-02_EB, 1.229238E-01_EB, 1.573970E-01_EB, 1.825905E-01_EB, 1.975753E-01_EB, 2.040052E-01_EB, &
    2.024706E-01_EB, 1.957505E-01_EB, 1.855755E-01_EB, 1.726368E-01_EB, 1.580202E-01_EB, 1.433211E-01_EB, &
    1.287520E-01_EB, 1.144879E-01_EB, 1.013973E-01_EB, 8.925648E-02_EB, 7.818868E-02_EB, 6.826146E-02_EB, &
    5.920229E-02_EB, 5.129713E-02_EB, 4.441206E-02_EB, 3.851923E-02_EB, 3.306979E-02_EB,  &
    1.457007E-02_EB, 2.736439E-02_EB, 4.340085E-02_EB, 6.002981E-02_EB, 7.506875E-02_EB, 8.727601E-02_EB, &
    9.581284E-02_EB, 1.007875E-01_EB, 1.027285E-01_EB, 1.017913E-01_EB, 9.839048E-02_EB, 9.365514E-02_EB, &
    8.789001E-02_EB, 8.123320E-02_EB, 7.449732E-02_EB, 6.766345E-02_EB, 6.100922E-02_EB, 5.470686E-02_EB, &
    4.865358E-02_EB, 4.309088E-02_EB, 3.810993E-02_EB, 3.369467E-02_EB, 2.945916E-02_EB,  &
    1.191095E-03_EB, 1.552045E-03_EB, 2.059789E-03_EB, 2.649547E-03_EB, 3.236595E-03_EB, 3.762561E-03_EB, &
    4.165025E-03_EB, 4.448429E-03_EB, 4.600555E-03_EB, 4.628224E-03_EB, 4.534948E-03_EB, 4.374710E-03_EB, &
    4.151710E-03_EB, 3.880527E-03_EB, 3.599880E-03_EB, 3.300161E-03_EB, 2.998249E-03_EB, 2.715486E-03_EB, &
    2.425276E-03_EB, 2.164309E-03_EB, 1.929373E-03_EB, 1.713087E-03_EB, 1.506010E-03_EB,  &
    4.538291E-04_EB, 4.599393E-04_EB, 4.587246E-04_EB, 4.526653E-04_EB, 4.375098E-04_EB, 4.167315E-04_EB, &
    3.918634E-04_EB, 3.644121E-04_EB, 3.335314E-04_EB, 3.072189E-04_EB, 2.753771E-04_EB, 2.453914E-04_EB, &
    2.183408E-04_EB, 1.968316E-04_EB, 1.704817E-04_EB, 1.507858E-04_EB, 1.319531E-04_EB, 1.134243E-04_EB, &
    9.801919E-05_EB, 8.900765E-05_EB, 7.481087E-05_EB, 6.511635E-05_EB, 5.390619E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB/),(/23,7/))

!-------------------------Propane DATA-------------------
!
! THERE ARE 2 BANDS FOR Propane
!
! BAND #1: 1175 cm-1 - 1675 cm-1 
! BAND #2: 2550 cm-1 - 3375 cm-1 

N_TEMP_C3H8 = 7
N_BAND_C3H8 = 2
I_MODEL_C3H8 = 2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C3H8_TEMP(N_TEMP_C3H8)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Propane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C3H8(N_BAND_C3H8,3)) 
ALLOCATE(Be_C3H8(N_BAND_C3H8)) 

OM_BND_C3H8 = RESHAPE((/ &
    1175._EB, 2550._EB, &
    1675._EB, 3375._EB, &
     25._EB, 25._EB/),(/N_BAND_C3H8,3/)) 

SD_C3H8_TEMP = (/ &
    295._EB, 396._EB, 435._EB, 513._EB, 578._EB, 790._EB,&
    1009._EB/)

Be_C3H8 = (/ &
    0.100_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C3H8(N_TEMP_C3H8,21)) 

! BAND #1: 1175 cm-1 - 1675 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 34.7222 % 
! GAMMA_D: 49.0947 % 

SD1_C3H8(1:7,1:8) = RESHAPE((/ &  ! 1175-1350 cm-1
    3.061246E-02_EB, 5.468162E-03_EB, 4.535096E-03_EB, 1.046397E-02_EB, 5.462376E-04_EB, 9.401943E-05_EB, &
    1.460697E-03_EB,  &
    1.666997E-02_EB, 3.576107E-03_EB, 2.948678E-03_EB, 9.649042E-02_EB, 3.187108E-04_EB, 7.845752E-04_EB, &
    1.853946E-03_EB,  &
    1.423474E-04_EB, 5.481133E-05_EB, 1.388234E-04_EB, 7.644231E-03_EB, 3.737679E-04_EB, 6.913047E-04_EB, &
    5.929778E-03_EB,  &
    0.000000E+00_EB, 8.214331E-05_EB, 1.221727E-04_EB, 2.404070E-03_EB, 2.720370E-03_EB, 6.967878E-03_EB, &
    9.158061E-04_EB,  &
    2.019530E-05_EB, 6.710262E-04_EB, 9.294304E-05_EB, 8.291894E-03_EB, 6.899431E-04_EB, 5.610029E-03_EB, &
    5.958747E-03_EB,  &
    1.920909E-02_EB, 8.075090E-03_EB, 1.124781E-02_EB, 5.407313E-02_EB, 1.329603E-02_EB, 1.680452E-02_EB, &
    1.836758E-02_EB,  &
    1.709026E-01_EB, 3.317137E-02_EB, 3.250425E-02_EB, 1.858467E-02_EB, 2.161986E-02_EB, 1.252729E-02_EB, &
    1.347756E-02_EB,  &
    3.137570E-01_EB, 5.773470E-02_EB, 5.876628E-02_EB, 6.864844E-01_EB, 4.312289E-02_EB, 1.901564E-02_EB, &
    3.388962E-02_EB/),(/7,8/))

SD1_C3H8(1:7,9:16) = RESHAPE((/ &  ! 1375-1550 cm-1
    5.429846E-01_EB, 8.525852E-02_EB, 7.804670E-02_EB, 3.506082E-02_EB, 5.140926E-02_EB, 1.935146E-02_EB, &
    4.287251E-02_EB,  &
    5.054451E-01_EB, 9.643203E-02_EB, 9.350503E-02_EB, 3.919677E+00_EB, 6.846340E-02_EB, 2.415069E-02_EB, &
    8.838251E-02_EB,  &
    3.728643E-01_EB, 8.009749E-02_EB, 8.007778E-02_EB, 4.500145E-02_EB, 6.516205E-02_EB, 2.370825E-02_EB, &
    4.770195E-02_EB,  &
    8.915920E-01_EB, 1.472314E-01_EB, 1.385649E-01_EB, 5.807780E-02_EB, 8.707294E-02_EB, 2.682134E-02_EB, &
    4.631391E-02_EB,  &
    1.205024E+00_EB, 1.785171E-01_EB, 1.565110E-01_EB, 6.635188E-02_EB, 9.588348E-02_EB, 2.390061E-02_EB, &
    4.156375E-02_EB,  &
    6.747543E-01_EB, 9.922118E-02_EB, 9.660990E-02_EB, 4.635835E-02_EB, 6.147438E-02_EB, 1.510372E-02_EB, &
    2.870206E-02_EB,  &
    1.819060E-01_EB, 2.834060E-02_EB, 3.311457E-02_EB, 2.208654E-02_EB, 2.609634E-02_EB, 8.492394E-03_EB, &
    1.732025E-02_EB,  &
    1.517646E-02_EB, 3.464741E-04_EB, 5.581158E-03_EB, 3.195902E-02_EB, 8.185139E-03_EB, 7.256795E-03_EB, &
    1.304571E-02_EB/),(/7,8/))

SD1_C3H8(1:7,17:21) = RESHAPE((/ &  ! 1575-1675 cm-1
    4.229573E-04_EB, 7.135442E-03_EB, 6.031150E-04_EB, 1.042106E-02_EB, 2.964736E-03_EB, 0.000000E+00_EB, &
    1.593706E-03_EB,  &
    1.208541E-04_EB, 0.000000E+00_EB, 4.702956E-03_EB, 5.267382E-04_EB, 1.720903E-03_EB, 1.229044E-03_EB, &
    9.885882E-03_EB,  &
    3.221371E-05_EB, 9.693848E-03_EB, 8.532444E-04_EB, 1.229716E-04_EB, 3.587224E-04_EB, 6.246106E-04_EB, &
    9.720172E-03_EB,  &
    3.668077E-05_EB, 2.639014E-05_EB, 9.037509E-04_EB, 6.794475E-05_EB, 3.815762E-04_EB, 4.897104E-04_EB, &
    3.358337E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C3H8(N_TEMP_C3H8,21)) 

! BAND #1: 1175 cm-1 - 1675 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 34.7222 % 
! GAMMA_D: 49.0947 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C3H8(1:7,1:8) = RESHAPE((/ &  ! 1175-1350 cm-1
    2.200610E-06_EB, 9.369926E-07_EB, 7.386045E-07_EB, 8.295460E-07_EB, 4.316697E-10_EB, 4.964466E-10_EB, &
    5.822330E-10_EB,  &
    6.239113E-07_EB, 4.862982E-07_EB, 5.889630E-07_EB, 8.800709E-06_EB, 1.121313E-08_EB, 1.148089E-07_EB, &
    9.620873E-08_EB,  &
    9.989563E-10_EB, 1.140454E-09_EB, 4.457191E-07_EB, 2.969845E-06_EB, 4.406761E-08_EB, 2.722885E-07_EB, &
    2.458405E-06_EB,  &
    0.000000E+00_EB, 1.250885E-09_EB, 4.737442E-07_EB, 4.619356E-06_EB, 1.413136E-07_EB, 2.675162E-07_EB, &
    3.889186E-07_EB,  &
    5.132674E-10_EB, 1.698431E-08_EB, 7.965120E-11_EB, 2.597723E-06_EB, 8.010501E-08_EB, 1.783028E-06_EB, &
    9.980052E-06_EB,  &
    1.104365E-06_EB, 2.324581E-06_EB, 5.382074E-06_EB, 1.190648E-05_EB, 5.934911E-06_EB, 1.103260E-05_EB, &
    1.478700E-05_EB,  &
    6.457316E-05_EB, 3.518177E-05_EB, 3.445535E-05_EB, 1.877707E-05_EB, 1.668337E-05_EB, 8.049646E-06_EB, &
    9.475329E-06_EB,  &
    2.014002E-04_EB, 1.075244E-04_EB, 1.085861E-04_EB, 7.829911E-05_EB, 5.748965E-05_EB, 2.448541E-05_EB, &
    4.639615E-05_EB/),(/7,8/))

GAMMAD1_C3H8(1:7,9:16) = RESHAPE((/ &  ! 1375-1550 cm-1
    5.756917E-04_EB, 2.290644E-04_EB, 1.911786E-04_EB, 5.813788E-05_EB, 8.589792E-05_EB, 2.847395E-05_EB, &
    7.447991E-05_EB,  &
    5.139631E-04_EB, 2.934383E-04_EB, 2.750113E-04_EB, 1.749708E-04_EB, 1.529329E-04_EB, 3.856938E-05_EB, &
    6.558844E-05_EB,  &
    2.837295E-04_EB, 2.074052E-04_EB, 2.096017E-04_EB, 9.452548E-05_EB, 1.365922E-04_EB, 2.865773E-05_EB, &
    6.654432E-05_EB,  &
    1.549251E-03_EB, 6.915697E-04_EB, 6.043086E-04_EB, 1.496926E-04_EB, 2.562661E-04_EB, 3.836598E-05_EB, &
    7.210927E-05_EB,  &
    2.732938E-03_EB, 1.010483E-03_EB, 7.747940E-04_EB, 1.983026E-04_EB, 2.890511E-04_EB, 3.859945E-05_EB, &
    4.936264E-05_EB,  &
    9.015009E-04_EB, 3.353955E-04_EB, 3.136481E-04_EB, 9.820136E-05_EB, 1.262424E-04_EB, 2.206450E-05_EB, &
    2.921582E-05_EB,  &
    7.648696E-05_EB, 3.694629E-05_EB, 4.528337E-05_EB, 2.803191E-05_EB, 2.826579E-05_EB, 6.929540E-06_EB, &
    9.176036E-06_EB,  &
    8.888856E-07_EB, 1.082399E-09_EB, 2.931676E-06_EB, 9.275610E-06_EB, 2.648446E-06_EB, 2.136632E-06_EB, &
    3.863813E-06_EB/),(/7,8/))

GAMMAD1_C3H8(1:7,17:21) = RESHAPE((/ &  ! 1575-1675 cm-1
    4.396056E-08_EB, 8.168254E-07_EB, 3.037055E-07_EB, 3.093033E-06_EB, 3.079724E-07_EB, 0.000000E+00_EB, &
    2.241041E-06_EB,  &
    1.738862E-09_EB, 0.000000E+00_EB, 3.006789E-07_EB, 3.035419E-08_EB, 1.140893E-07_EB, 8.612950E-07_EB, &
    3.519053E-06_EB,  &
    4.220986E-10_EB, 3.952639E-08_EB, 7.566066E-10_EB, 1.410521E-09_EB, 3.273728E-09_EB, 3.605234E-08_EB, &
    1.219235E-07_EB,  &
    1.078542E-10_EB, 3.479618E-10_EB, 2.371164E-10_EB, 3.314283E-10_EB, 8.845889E-11_EB, 1.014645E-09_EB, &
    5.931468E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C3H8(N_TEMP_C3H8,34)) 

! BAND #2: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 37.9654 % 
! GAMMA_D: 62.3504 % 

SD2_C3H8(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    4.940954E-04_EB, 0.000000E+00_EB, 1.595625E-04_EB, 3.405036E-05_EB, 4.421091E-04_EB, 5.778123E-05_EB, &
    9.291568E-04_EB,  &
    1.365462E-02_EB, 1.540509E-03_EB, 1.461763E-03_EB, 2.724152E-03_EB, 9.752976E-04_EB, 4.514591E-04_EB, &
    6.191351E-03_EB,  &
    4.407892E-02_EB, 5.006855E-03_EB, 5.846650E-03_EB, 1.802886E-02_EB, 3.541295E-03_EB, 1.860108E-04_EB, &
    2.321735E-02_EB,  &
    6.077749E-02_EB, 9.453675E-03_EB, 8.370260E-03_EB, 3.893469E-02_EB, 5.107394E-03_EB, 6.916673E-03_EB, &
    4.551824E-03_EB,  &
    8.263936E-02_EB, 1.169452E-02_EB, 1.002763E-02_EB, 2.992379E-03_EB, 4.315693E-03_EB, 8.009705E-03_EB, &
    3.684659E-03_EB,  &
    7.695956E-02_EB, 7.968222E-03_EB, 6.788851E-03_EB, 6.015838E-02_EB, 5.702043E-03_EB, 6.202728E-04_EB, &
    5.529250E-03_EB,  &
    4.263757E-02_EB, 5.543500E-03_EB, 6.527492E-03_EB, 9.260309E-02_EB, 6.462484E-03_EB, 2.877220E-01_EB, &
    1.729043E-02_EB,  &
    9.491281E-02_EB, 1.524451E-02_EB, 1.627356E-02_EB, 8.378269E-03_EB, 1.646877E-02_EB, 4.899515E-03_EB, &
    1.930187E-02_EB/),(/7,8/))

SD2_C3H8(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    1.754034E-01_EB, 3.104680E-02_EB, 3.118538E-02_EB, 1.011826E+00_EB, 2.660163E-02_EB, 3.560661E-01_EB, &
    3.355690E-02_EB,  &
    1.687628E-01_EB, 3.664962E-02_EB, 3.634994E-02_EB, 8.846245E-01_EB, 3.384423E-02_EB, 1.171568E+00_EB, &
    5.043065E-02_EB,  &
    2.030210E-01_EB, 4.191977E-02_EB, 4.273541E-02_EB, 3.242915E+00_EB, 4.484866E-02_EB, 5.471754E-01_EB, &
    7.534041E-02_EB,  &
    3.579954E-01_EB, 8.140411E-02_EB, 8.416864E-02_EB, 3.953642E-02_EB, 8.429207E-02_EB, 9.398554E-01_EB, &
    1.196203E-01_EB,  &
    1.010734E+00_EB, 2.146615E-01_EB, 2.271490E-01_EB, 1.012112E-01_EB, 2.193594E-01_EB, 3.182987E+00_EB, &
    2.057040E-01_EB,  &
    3.778657E+00_EB, 6.356188E-01_EB, 5.987707E-01_EB, 2.267703E-01_EB, 4.386072E-01_EB, 5.763945E+00_EB, &
    2.857634E-01_EB,  &
    5.270947E+00_EB, 9.041520E-01_EB, 8.463503E-01_EB, 3.258656E-01_EB, 6.370107E-01_EB, 8.163279E+00_EB, &
    4.100743E-01_EB,  &
    5.618376E+00_EB, 1.114691E+00_EB, 1.082308E+00_EB, 4.357192E-01_EB, 8.677233E-01_EB, 1.046642E+01_EB, &
    5.087833E-01_EB/),(/7,8/))

SD2_C3H8(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.067125E+01_EB, 1.791869E+00_EB, 1.679529E+00_EB, 6.245505E-01_EB, 1.190363E+00_EB, 1.244225E+01_EB, &
    5.712585E-01_EB,  &
    1.330976E+01_EB, 2.089738E+00_EB, 1.856815E+00_EB, 6.591656E-01_EB, 1.203828E+00_EB, 1.188007E+01_EB, &
    5.122383E-01_EB,  &
    5.688813E+00_EB, 1.052030E+00_EB, 9.494996E-01_EB, 3.713571E-01_EB, 6.934724E-01_EB, 7.373337E+00_EB, &
    3.794078E-01_EB,  &
    7.405538E-01_EB, 2.344175E-01_EB, 2.297779E-01_EB, 1.119114E-01_EB, 2.312867E-01_EB, 3.576838E+00_EB, &
    2.179157E-01_EB,  &
    8.970579E-02_EB, 3.888908E-02_EB, 4.597343E-02_EB, 2.861425E-02_EB, 6.688966E-02_EB, 2.282990E+00_EB, &
    1.220027E-01_EB,  &
    5.958016E-02_EB, 1.986182E-02_EB, 2.616301E-02_EB, 1.708727E-02_EB, 3.713189E-02_EB, 5.788366E-01_EB, &
    8.573836E-02_EB,  &
    7.158930E-02_EB, 1.979145E-02_EB, 2.429708E-02_EB, 1.492564E-02_EB, 3.267137E-02_EB, 1.053130E+00_EB, &
    6.884668E-02_EB,  &
    1.084365E-01_EB, 2.032911E-02_EB, 2.297580E-02_EB, 1.367623E-02_EB, 2.758158E-02_EB, 5.047029E-01_EB, &
    6.297091E-02_EB/),(/7,8/))

SD2_C3H8(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    1.094380E-01_EB, 2.546709E-02_EB, 2.692285E-02_EB, 1.285546E-02_EB, 2.542899E-02_EB, 2.717878E+01_EB, &
    4.223126E-02_EB,  &
    1.596221E-01_EB, 2.690507E-02_EB, 2.805173E-02_EB, 1.154865E-02_EB, 2.256735E-02_EB, 5.636149E-03_EB, &
    8.198999E-02_EB,  &
    1.456550E-01_EB, 2.274893E-02_EB, 2.121349E-02_EB, 1.066670E-02_EB, 1.735101E-02_EB, 7.541549E-02_EB, &
    2.995330E-02_EB,  &
    9.427165E-02_EB, 1.152468E-02_EB, 1.177258E-02_EB, 2.320583E-01_EB, 1.021699E-02_EB, 1.068780E-02_EB, &
    2.072124E-02_EB,  &
    4.558562E-02_EB, 4.547378E-03_EB, 3.236364E-03_EB, 5.840609E-01_EB, 6.083799E-03_EB, 3.452505E-03_EB, &
    1.386988E-02_EB,  &
    4.222578E-04_EB, 6.759764E-04_EB, 3.360055E-04_EB, 4.695538E-03_EB, 1.084561E-03_EB, 8.643269E-04_EB, &
    5.315431E-02_EB,  &
    9.369469E-05_EB, 4.333324E-05_EB, 1.280467E-03_EB, 2.530103E-04_EB, 5.452036E-03_EB, 1.157250E-03_EB, &
    2.232507E-01_EB,  &
    7.179882E-05_EB, 3.433959E-04_EB, 1.242587E-05_EB, 9.375040E-05_EB, 4.139027E-04_EB, 1.497287E-03_EB, &
    3.122748E-02_EB/),(/7,8/))

SD2_C3H8(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    2.529210E-05_EB, 1.632213E-04_EB, 2.626990E-04_EB, 2.655142E-04_EB, 1.301091E-04_EB, 3.199658E-04_EB, &
    2.313568E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C3H8(N_TEMP_C3H8,34)) 

! BAND #2: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 37.9654 % 
! GAMMA_D: 62.3504 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C3H8(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    1.308470E-10_EB, 0.000000E+00_EB, 1.358459E-09_EB, 1.139135E-10_EB, 2.999724E-10_EB, 3.144700E-10_EB, &
    2.361454E-09_EB,  &
    2.416506E-07_EB, 1.128775E-07_EB, 8.208584E-08_EB, 1.953173E-08_EB, 4.856552E-08_EB, 1.535210E-08_EB, &
    4.660924E-07_EB,  &
    3.691199E-06_EB, 1.504112E-06_EB, 1.322813E-06_EB, 3.160685E-07_EB, 4.169858E-07_EB, 6.906229E-08_EB, &
    1.680135E-06_EB,  &
    1.022489E-05_EB, 3.897759E-06_EB, 2.644205E-06_EB, 1.855076E-06_EB, 8.169295E-07_EB, 3.137954E-07_EB, &
    9.966696E-07_EB,  &
    1.509256E-05_EB, 5.091042E-06_EB, 3.735910E-06_EB, 6.004728E-07_EB, 7.372695E-07_EB, 3.628679E-07_EB, &
    1.015857E-06_EB,  &
    9.412069E-06_EB, 2.804745E-06_EB, 2.283294E-06_EB, 1.991853E-06_EB, 1.046659E-06_EB, 3.283340E-07_EB, &
    1.967941E-06_EB,  &
    2.868094E-06_EB, 1.585063E-06_EB, 1.930551E-06_EB, 1.720630E-06_EB, 1.657469E-06_EB, 2.098184E-06_EB, &
    7.269104E-06_EB,  &
    1.791680E-05_EB, 8.853612E-06_EB, 9.317118E-06_EB, 3.552645E-06_EB, 8.617626E-06_EB, 2.918306E-06_EB, &
    2.701902E-05_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    6.279723E-05_EB, 3.419008E-05_EB, 3.256080E-05_EB, 2.374328E-05_EB, 2.308546E-05_EB, 2.091804E-05_EB, &
    3.340270E-05_EB,  &
    6.257443E-05_EB, 4.566125E-05_EB, 4.354390E-05_EB, 3.628312E-05_EB, 3.636733E-05_EB, 3.708160E-05_EB, &
    7.227846E-05_EB,  &
    9.158437E-05_EB, 5.837611E-05_EB, 5.887636E-05_EB, 4.877073E-05_EB, 6.187858E-05_EB, 8.399676E-05_EB, &
    1.613695E-04_EB,  &
    2.601853E-04_EB, 2.108423E-04_EB, 2.211531E-04_EB, 7.420042E-05_EB, 2.192753E-04_EB, 2.566033E-04_EB, &
    4.000777E-04_EB,  &
    1.918469E-03_EB, 1.487761E-03_EB, 1.639546E-03_EB, 5.016159E-04_EB, 1.500905E-03_EB, 1.182242E-03_EB, &
    1.268267E-03_EB,  &
    3.066824E-02_EB, 1.499512E-02_EB, 1.303660E-02_EB, 2.604747E-03_EB, 6.520248E-03_EB, 3.001735E-03_EB, &
    2.457549E-03_EB,  &
    7.120941E-02_EB, 3.496769E-02_EB, 2.953297E-02_EB, 5.653993E-03_EB, 1.500047E-02_EB, 6.761026E-03_EB, &
    5.315625E-03_EB,  &
    8.430461E-02_EB, 6.112336E-02_EB, 5.628887E-02_EB, 1.087569E-02_EB, 3.154823E-02_EB, 1.278105E-02_EB, &
    8.641428E-03_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.276783E+00_EB, 3.561536E-01_EB, 2.550698E-01_EB, 2.590293E-02_EB, 7.406518E-02_EB, 1.994557E-02_EB, &
    1.129761E-02_EB,  &
    3.839785E-01_EB, 1.560884E+00_EB, 4.464163E-01_EB, 2.956669E-02_EB, 7.657310E-02_EB, 1.651348E-02_EB, &
    8.661004E-03_EB,  &
    7.146454E-02_EB, 5.146428E-02_EB, 3.929724E-02_EB, 7.458410E-03_EB, 1.836600E-02_EB, 6.171143E-03_EB, &
    4.499366E-03_EB,  &
    9.908210E-04_EB, 1.727484E-03_EB, 1.672076E-03_EB, 6.000514E-04_EB, 1.710484E-03_EB, 1.146850E-03_EB, &
    1.353061E-03_EB,  &
    1.054334E-05_EB, 4.944609E-05_EB, 6.842999E-05_EB, 4.065432E-05_EB, 1.420118E-04_EB, 1.896942E-04_EB, &
    4.124649E-04_EB,  &
    3.727361E-06_EB, 1.511627E-05_EB, 2.325066E-05_EB, 1.447927E-05_EB, 4.498303E-05_EB, 6.436841E-05_EB, &
    2.158245E-04_EB,  &
    5.179303E-06_EB, 1.436221E-05_EB, 2.048837E-05_EB, 1.111926E-05_EB, 3.306370E-05_EB, 3.840022E-05_EB, &
    1.637217E-04_EB,  &
    1.345971E-05_EB, 1.430684E-05_EB, 1.773330E-05_EB, 9.036709E-06_EB, 2.381975E-05_EB, 2.340321E-05_EB, &
    1.247833E-04_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    2.509654E-05_EB, 2.074675E-05_EB, 2.287073E-05_EB, 7.830276E-06_EB, 1.974085E-05_EB, 1.031713E-05_EB, &
    6.103494E-05_EB,  &
    4.921418E-05_EB, 2.512602E-05_EB, 2.478267E-05_EB, 6.654765E-06_EB, 1.592114E-05_EB, 2.374007E-06_EB, &
    4.876544E-05_EB,  &
    3.151835E-05_EB, 1.725354E-05_EB, 1.500067E-05_EB, 5.485594E-06_EB, 9.677540E-06_EB, 3.347977E-06_EB, &
    1.962289E-05_EB,  &
    1.198739E-05_EB, 4.894568E-06_EB, 4.912116E-06_EB, 4.819843E-06_EB, 3.334217E-06_EB, 1.004437E-06_EB, &
    1.522744E-05_EB,  &
    1.145510E-06_EB, 6.716382E-07_EB, 6.841492E-07_EB, 1.623415E-06_EB, 4.755639E-07_EB, 7.142275E-08_EB, &
    1.111090E-05_EB,  &
    1.021676E-09_EB, 2.090984E-08_EB, 7.730384E-09_EB, 8.770614E-08_EB, 1.249430E-07_EB, 6.493712E-08_EB, &
    6.866959E-06_EB,  &
    4.523378E-10_EB, 5.364602E-10_EB, 4.322526E-10_EB, 1.270512E-09_EB, 1.712712E-09_EB, 2.140022E-08_EB, &
    8.246849E-06_EB,  &
    7.497125E-10_EB, 1.201004E-09_EB, 1.234581E-09_EB, 6.689520E-10_EB, 1.195035E-09_EB, 2.550863E-08_EB, &
    1.403269E-06_EB/),(/7,8/))

GAMMAD2_C3H8(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    1.494322E-10_EB, 5.440816E-10_EB, 7.259134E-10_EB, 4.471940E-10_EB, 1.984777E-10_EB, 4.190036E-09_EB, &
    1.778035E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!-------------------------Heptane DATA-------------------


! THERE ARE 2 BANDS FOR Heptane

! BAND #1: 1100 cm-1 - 1800 cm-1 
! BAND #2: 2550 cm-1 - 3275 cm-1 

N_TEMP_C7H16 = 7
N_BAND_C7H16 = 2
I_MODEL_C7H16 = 2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C7H16_TEMP(N_TEMP_C7H16)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Heptane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C7H16(N_BAND_C7H16,3)) 
ALLOCATE(Be_C7H16(N_BAND_C7H16)) 

OM_BND_C7H16 = RESHAPE((/ &
    1100._EB, 2550._EB, &
    1800._EB, 3275._EB, &
     25._EB, 25._EB/),(/N_BAND_C7H16,3/)) 

SD_C7H16_TEMP = (/ &
    293._EB, 400._EB, 450._EB, 490._EB, 593._EB, 794._EB,&
    1000._EB/)

Be_C7H16 = (/ &
    3.000_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C7H16(N_TEMP_C7H16,29)) 

! BAND #1: 1100 cm-1 - 1800 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 35.1191 % 
! GAMMA_D: 41.9772 % 

SD1_C7H16(1:7,1:8) = RESHAPE((/ &  ! 1100-1275 cm-1
    1.802538E-04_EB, 2.459997E-04_EB, 0.000000E+00_EB, 5.404997E-04_EB, 2.696810E-04_EB, 1.819681E-04_EB, &
    1.242335E-04_EB,  &
    3.296644E-05_EB, 5.440465E-04_EB, 4.446501E-03_EB, 4.801199E-05_EB, 2.237718E-04_EB, 1.088163E-04_EB, &
    6.074715E-02_EB,  &
    3.391086E-04_EB, 0.000000E+00_EB, 1.792136E-04_EB, 4.225634E-04_EB, 1.023556E-04_EB, 9.934246E-04_EB, &
    1.447789E-01_EB,  &
    5.388221E-05_EB, 0.000000E+00_EB, 1.331355E-04_EB, 4.665144E-05_EB, 1.832905E-04_EB, 1.773920E-04_EB, &
    8.804696E-02_EB,  &
    1.818276E-03_EB, 2.130647E-03_EB, 4.285564E-01_EB, 1.173527E-01_EB, 4.871006E-04_EB, 1.278000E-02_EB, &
    2.289201E-02_EB,  &
    1.472873E-01_EB, 1.035403E-02_EB, 8.565466E-03_EB, 7.682118E-03_EB, 4.220849E-02_EB, 1.856307E-02_EB, &
    1.845063E-01_EB,  &
    1.113212E-01_EB, 1.510288E-02_EB, 9.700541E-03_EB, 9.995548E-03_EB, 1.515615E-02_EB, 2.927992E-02_EB, &
    4.877940E-01_EB,  &
    1.849135E-01_EB, 2.798060E-02_EB, 2.656979E-02_EB, 1.745004E-02_EB, 1.703263E-02_EB, 1.071276E-01_EB, &
    2.360137E-01_EB/),(/7,8/))

SD1_C7H16(1:7,9:16) = RESHAPE((/ &  ! 1300-1475 cm-1
    2.173146E-01_EB, 4.000557E-02_EB, 3.866222E-02_EB, 2.783131E-02_EB, 2.399909E-02_EB, 2.530053E-01_EB, &
    2.197251E-01_EB,  &
    2.528469E-01_EB, 5.544545E-02_EB, 5.542132E-02_EB, 4.800144E-02_EB, 4.681368E-02_EB, 1.149630E+00_EB, &
    2.052635E-01_EB,  &
    5.530974E-01_EB, 1.188518E-01_EB, 1.133289E-01_EB, 9.795906E-02_EB, 9.058620E-02_EB, 4.807181E+01_EB, &
    5.000082E-01_EB,  &
    2.173291E+00_EB, 3.491305E-01_EB, 3.031754E-01_EB, 2.398428E-01_EB, 2.052549E-01_EB, 6.168007E-01_EB, &
    2.663066E-01_EB,  &
    1.152427E+00_EB, 2.244753E-01_EB, 2.050192E-01_EB, 1.664983E-01_EB, 1.370443E-01_EB, 1.118549E+00_EB, &
    3.411468E-01_EB,  &
    3.085838E-01_EB, 8.451805E-02_EB, 9.696269E-02_EB, 9.111674E-02_EB, 8.943570E-02_EB, 6.611844E-01_EB, &
    2.383835E-01_EB,  &
    2.527505E+00_EB, 4.483945E-01_EB, 3.996236E-01_EB, 3.284093E-01_EB, 2.799161E-01_EB, 1.761531E+00_EB, &
    2.999542E-01_EB,  &
    4.099586E+00_EB, 6.040290E-01_EB, 4.905432E-01_EB, 3.792493E-01_EB, 2.861679E-01_EB, 1.225946E+00_EB, &
    2.734981E-01_EB/),(/7,8/))

SD1_C7H16(1:7,17:24) = RESHAPE((/ &  ! 1500-1675 cm-1
    4.744631E-01_EB, 1.230066E-01_EB, 1.293911E-01_EB, 1.061664E-01_EB, 9.502816E-02_EB, 3.749679E-01_EB, &
    2.175617E-01_EB,  &
    1.624171E-01_EB, 4.084623E-02_EB, 5.386962E-02_EB, 4.121055E-02_EB, 1.955982E-02_EB, 8.332311E-02_EB, &
    1.639335E-01_EB,  &
    1.154601E-01_EB, 3.575034E-02_EB, 3.107322E-02_EB, 1.924275E-02_EB, 9.599478E-03_EB, 3.139904E-02_EB, &
    3.567299E-01_EB,  &
    7.678609E-05_EB, 2.856377E-03_EB, 9.498065E-03_EB, 3.471444E-02_EB, 8.459777E-03_EB, 1.681014E-02_EB, &
    4.437363E-02_EB,  &
    5.354392E-04_EB, 1.535331E-03_EB, 8.920187E-03_EB, 7.721419E-03_EB, 6.042576E-04_EB, 2.677983E-02_EB, &
    5.414075E-02_EB,  &
    3.719587E-04_EB, 1.120568E-03_EB, 9.802924E-04_EB, 6.637237E-03_EB, 2.513717E-04_EB, 1.524688E-02_EB, &
    4.779943E-02_EB,  &
    5.900408E-04_EB, 4.608894E-06_EB, 0.000000E+00_EB, 1.918125E-03_EB, 0.000000E+00_EB, 2.437159E-04_EB, &
    5.740281E-02_EB,  &
    8.300682E-04_EB, 2.438537E-04_EB, 5.003153E-04_EB, 1.502219E-04_EB, 2.001818E-03_EB, 1.827211E-04_EB, &
    5.779517E-02_EB/),(/7,8/))

SD1_C7H16(1:7,25:29) = RESHAPE((/ &  ! 1700-1800 cm-1
    3.524440E-04_EB, 3.514934E-04_EB, 0.000000E+00_EB, 5.527841E-04_EB, 1.591819E-04_EB, 9.724419E-04_EB, &
    3.193981E-02_EB,  &
    3.682232E-04_EB, 1.981383E-04_EB, 0.000000E+00_EB, 6.923624E-02_EB, 1.188269E-03_EB, 2.704121E-03_EB, &
    4.497807E-02_EB,  &
    3.928309E-04_EB, 3.823412E-04_EB, 0.000000E+00_EB, 1.332172E-03_EB, 2.846406E-04_EB, 1.861525E-04_EB, &
    3.775098E-02_EB,  &
    2.679784E-04_EB, 1.827014E-03_EB, 2.252048E-03_EB, 7.676760E-05_EB, 0.000000E+00_EB, 1.738702E-04_EB, &
    1.260141E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C7H16(N_TEMP_C7H16,29)) 

! BAND #1: 1100 cm-1 - 1800 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 35.1191 % 
! GAMMA_D: 41.9772 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C7H16(1:7,1:8) = RESHAPE((/ &  ! 1100-1275 cm-1
    3.401522E-10_EB, 1.134207E-10_EB, 0.000000E+00_EB, 3.185388E-10_EB, 1.113224E-10_EB, 7.283404E-11_EB, &
    1.280880E-10_EB,  &
    2.513311E-10_EB, 1.868944E-09_EB, 1.353396E-09_EB, 3.287289E-10_EB, 6.606025E-10_EB, 3.866373E-10_EB, &
    5.844448E-06_EB,  &
    7.297769E-10_EB, 0.000000E+00_EB, 9.215245E-10_EB, 1.599236E-10_EB, 4.783467E-10_EB, 5.672122E-10_EB, &
    1.746661E-05_EB,  &
    1.692601E-10_EB, 0.000000E+00_EB, 6.654802E-09_EB, 4.145401E-10_EB, 7.900039E-10_EB, 4.382333E-10_EB, &
    1.140068E-05_EB,  &
    5.744340E-10_EB, 1.301164E-09_EB, 6.319440E-08_EB, 8.783419E-08_EB, 1.366379E-08_EB, 1.735818E-07_EB, &
    2.335711E-05_EB,  &
    1.102772E-06_EB, 4.916702E-07_EB, 5.242663E-07_EB, 3.099694E-07_EB, 9.659502E-07_EB, 4.798497E-07_EB, &
    3.018740E-05_EB,  &
    1.833831E-06_EB, 9.114696E-07_EB, 8.899857E-07_EB, 8.774625E-07_EB, 2.125588E-06_EB, 1.516513E-06_EB, &
    5.086503E-05_EB,  &
    4.888828E-06_EB, 3.649171E-06_EB, 3.750508E-06_EB, 3.684238E-06_EB, 2.415671E-06_EB, 5.747079E-06_EB, &
    4.724549E-05_EB/),(/7,8/))

GAMMAD1_C7H16(1:7,9:16) = RESHAPE((/ &  ! 1300-1475 cm-1
    1.200985E-05_EB, 7.285927E-06_EB, 7.612424E-06_EB, 7.654516E-06_EB, 6.577217E-06_EB, 1.018089E-05_EB, &
    5.855824E-05_EB,  &
    1.318664E-05_EB, 1.350019E-05_EB, 1.390876E-05_EB, 1.516059E-05_EB, 1.870035E-05_EB, 2.472813E-05_EB, &
    5.466397E-05_EB,  &
    7.187541E-05_EB, 5.527156E-05_EB, 5.526041E-05_EB, 5.365609E-05_EB, 6.641583E-05_EB, 5.066205E-05_EB, &
    8.121484E-05_EB,  &
    9.547468E-04_EB, 4.803503E-04_EB, 3.846840E-04_EB, 2.830857E-04_EB, 2.186205E-04_EB, 1.136195E-04_EB, &
    1.023854E-04_EB,  &
    2.810264E-04_EB, 1.936382E-04_EB, 1.739795E-04_EB, 1.481120E-04_EB, 1.238937E-04_EB, 6.703200E-05_EB, &
    1.335244E-04_EB,  &
    2.121621E-05_EB, 3.211010E-05_EB, 3.860382E-05_EB, 4.682950E-05_EB, 5.904987E-05_EB, 5.870366E-05_EB, &
    9.064765E-05_EB,  &
    1.341227E-03_EB, 7.983163E-04_EB, 6.752026E-04_EB, 5.251336E-04_EB, 4.078977E-04_EB, 2.225849E-04_EB, &
    9.924441E-05_EB,  &
    3.583422E-03_EB, 1.489891E-03_EB, 1.030833E-03_EB, 7.220638E-04_EB, 4.389504E-04_EB, 1.748322E-04_EB, &
    9.081205E-05_EB/),(/7,8/))

GAMMAD1_C7H16(1:7,17:24) = RESHAPE((/ &  ! 1500-1675 cm-1
    5.343414E-05_EB, 5.591551E-05_EB, 6.954431E-05_EB, 4.701526E-05_EB, 5.677366E-05_EB, 2.986218E-05_EB, &
    5.426886E-05_EB,  &
    5.449179E-06_EB, 8.668779E-06_EB, 1.206452E-05_EB, 7.902714E-06_EB, 6.237424E-06_EB, 6.308225E-06_EB, &
    3.651223E-05_EB,  &
    3.704640E-06_EB, 4.171271E-06_EB, 4.514548E-06_EB, 1.982938E-06_EB, 1.429114E-06_EB, 1.503805E-06_EB, &
    3.617359E-05_EB,  &
    1.555251E-10_EB, 2.969699E-07_EB, 5.131038E-07_EB, 3.682783E-06_EB, 5.179115E-07_EB, 1.503159E-06_EB, &
    3.700458E-05_EB,  &
    3.884659E-10_EB, 6.456455E-07_EB, 2.544935E-07_EB, 3.255853E-06_EB, 4.376653E-10_EB, 3.419187E-06_EB, &
    2.770813E-05_EB,  &
    6.568513E-10_EB, 9.010654E-10_EB, 4.349971E-10_EB, 1.004051E-06_EB, 6.778991E-10_EB, 9.736690E-07_EB, &
    2.984452E-05_EB,  &
    1.940564E-10_EB, 5.211149E-10_EB, 0.000000E+00_EB, 9.754520E-09_EB, 0.000000E+00_EB, 1.149767E-09_EB, &
    2.323627E-05_EB,  &
    2.560761E-10_EB, 8.594040E-10_EB, 2.176473E-10_EB, 7.720864E-10_EB, 1.114367E-09_EB, 5.579049E-10_EB, &
    1.980757E-05_EB/),(/7,8/))

GAMMAD1_C7H16(1:7,25:29) = RESHAPE((/ &  ! 1700-1800 cm-1
    7.996593E-10_EB, 1.321978E-09_EB, 0.000000E+00_EB, 4.615372E-10_EB, 8.605142E-10_EB, 6.091567E-10_EB, &
    6.872193E-06_EB,  &
    7.861506E-10_EB, 5.716612E-10_EB, 0.000000E+00_EB, 7.499561E-10_EB, 7.470171E-10_EB, 2.219136E-10_EB, &
    1.431493E-05_EB,  &
    2.543978E-10_EB, 1.241091E-09_EB, 0.000000E+00_EB, 3.109305E-10_EB, 8.351696E-10_EB, 4.774195E-10_EB, &
    5.599086E-06_EB,  &
    2.456334E-10_EB, 5.154460E-10_EB, 1.374484E-10_EB, 2.180757E-10_EB, 0.000000E+00_EB, 5.980339E-11_EB, &
    6.538788E-07_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,5/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C7H16(N_TEMP_C7H16,30)) 

! BAND #2: 2550 cm-1 - 3275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 26.5996 % 
! GAMMA_D: 52.8747 % 

SD2_C7H16(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    4.228861E-03_EB, 2.640722E-03_EB, 1.391630E-03_EB, 2.544291E-03_EB, 2.509000E-03_EB, 2.568556E-04_EB, &
    5.477293E-05_EB,  &
    4.391213E-02_EB, 1.143100E-02_EB, 1.081098E-02_EB, 1.292159E-02_EB, 1.141537E-02_EB, 1.040501E-02_EB, &
    5.968673E-03_EB,  &
    2.092778E-01_EB, 2.753279E-02_EB, 2.376927E-02_EB, 2.206841E-02_EB, 1.667734E-02_EB, 0.000000E+00_EB, &
    5.563855E-02_EB,  &
    1.890522E-01_EB, 3.081324E-02_EB, 2.279368E-02_EB, 2.314149E-02_EB, 1.316845E-02_EB, 6.493616E-02_EB, &
    1.527974E-02_EB,  &
    3.663045E-01_EB, 3.819975E-02_EB, 2.599877E-02_EB, 2.826155E-02_EB, 1.767386E-02_EB, 1.174723E-01_EB, &
    1.284219E-01_EB,  &
    2.951531E-01_EB, 4.504316E-02_EB, 3.038961E-02_EB, 3.516789E-02_EB, 1.232425E-02_EB, 4.140651E-02_EB, &
    5.196972E-02_EB,  &
    3.585075E-01_EB, 5.031442E-02_EB, 3.399826E-02_EB, 3.767091E-02_EB, 1.680666E-02_EB, 1.049880E-01_EB, &
    5.505195E-02_EB,  &
    4.500725E-01_EB, 7.148971E-02_EB, 5.276860E-02_EB, 5.385610E-02_EB, 2.933988E-02_EB, 2.070886E-01_EB, &
    1.774684E-01_EB/),(/7,8/))

SD2_C7H16(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    4.998327E-01_EB, 8.230660E-02_EB, 6.752810E-02_EB, 6.833406E-02_EB, 4.024473E-02_EB, 4.268531E-01_EB, &
    4.464977E-02_EB,  &
    5.174761E-01_EB, 7.714327E-02_EB, 6.627481E-02_EB, 6.755718E-02_EB, 5.182098E-02_EB, 5.694181E-01_EB, &
    4.947515E-02_EB,  &
    6.704199E-01_EB, 1.233056E-01_EB, 1.131467E-01_EB, 1.111810E-01_EB, 9.013990E-02_EB, 8.381668E-01_EB, &
    6.025012E-02_EB,  &
    1.276653E+00_EB, 2.360273E-01_EB, 2.282694E-01_EB, 2.185940E-01_EB, 1.970786E-01_EB, 1.068104E+00_EB, &
    9.818676E-02_EB,  &
    5.905678E+00_EB, 9.316870E-01_EB, 8.570884E-01_EB, 7.544397E-01_EB, 6.377258E-01_EB, 2.400421E+00_EB, &
    1.697720E-01_EB,  &
    1.533964E+01_EB, 2.342867E+00_EB, 2.047559E+00_EB, 1.720007E+00_EB, 1.366887E+00_EB, 4.188619E+00_EB, &
    2.318428E-01_EB,  &
    1.321033E+01_EB, 2.250425E+00_EB, 2.081815E+00_EB, 1.815571E+00_EB, 1.569374E+00_EB, 5.496143E+00_EB, &
    3.685003E-01_EB,  &
    2.427878E+01_EB, 3.866808E+00_EB, 3.509570E+00_EB, 2.996579E+00_EB, 2.517273E+00_EB, 8.451973E+00_EB, &
    5.106384E-01_EB/),(/7,8/))

SD2_C7H16(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    2.671752E+01_EB, 4.435326E+00_EB, 4.018002E+00_EB, 3.420676E+00_EB, 2.839181E+00_EB, 8.887497E+00_EB, &
    4.700717E-01_EB,  &
    3.133823E+01_EB, 4.261124E+00_EB, 3.586189E+00_EB, 2.926683E+00_EB, 2.221684E+00_EB, 5.988602E+00_EB, &
    3.579354E-01_EB,  &
    2.587468E+00_EB, 5.646127E-01_EB, 5.416749E-01_EB, 4.977268E-01_EB, 4.575968E-01_EB, 1.720369E+00_EB, &
    2.569877E-01_EB,  &
    9.491951E-01_EB, 2.037878E-01_EB, 1.839815E-01_EB, 1.835397E-01_EB, 1.451683E-01_EB, 7.259891E-01_EB, &
    2.090774E-01_EB,  &
    5.963017E-01_EB, 1.313729E-01_EB, 1.127359E-01_EB, 1.160902E-01_EB, 7.118113E-02_EB, 4.124772E-01_EB, &
    1.613801E-01_EB,  &
    1.002926E+00_EB, 8.967348E-02_EB, 7.458029E-02_EB, 7.960230E-02_EB, 3.130568E-02_EB, 2.744955E-01_EB, &
    1.169768E-01_EB,  &
    3.737580E-01_EB, 6.590710E-02_EB, 5.559480E-02_EB, 5.983725E-02_EB, 2.239605E-02_EB, 3.091616E-01_EB, &
    1.027827E-01_EB,  &
    3.008841E-02_EB, 4.941067E-02_EB, 4.563150E-02_EB, 4.516117E-02_EB, 1.218204E-02_EB, 7.268112E-01_EB, &
    1.069658E-01_EB/),(/7,8/))

SD2_C7H16(1:7,25:30) = RESHAPE((/ &  ! 3150-3275 cm-1
    5.237585E+00_EB, 4.511782E-02_EB, 4.022927E-02_EB, 3.708933E-02_EB, 9.837374E-03_EB, 6.321009E-02_EB, &
    7.448266E-02_EB,  &
    4.286831E-01_EB, 4.926834E-02_EB, 3.998101E-02_EB, 3.644480E-02_EB, 2.708625E-01_EB, 4.278299E-02_EB, &
    5.032087E-02_EB,  &
    2.609288E-01_EB, 4.081136E-02_EB, 2.740934E-02_EB, 2.357711E-02_EB, 4.283081E-02_EB, 2.244627E-02_EB, &
    4.786632E-02_EB,  &
    3.116754E-02_EB, 1.931590E-02_EB, 9.287026E-03_EB, 1.385742E-02_EB, 7.275528E-03_EB, 1.060777E-03_EB, &
    2.558235E-02_EB,  &
    1.466533E-03_EB, 2.230522E-03_EB, 1.854865E-03_EB, 3.065009E-03_EB, 2.605753E-03_EB, 3.084956E-04_EB, &
    2.876258E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C7H16(N_TEMP_C7H16,30)) 

! BAND #2: 2550 cm-1 - 3275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 26.5996 % 
! GAMMA_D: 52.8747 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C7H16(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    1.348331E-10_EB, 3.531544E-08_EB, 8.326697E-09_EB, 2.655197E-08_EB, 3.632785E-08_EB, 1.807627E-10_EB, &
    3.095291E-11_EB,  &
    8.480510E-08_EB, 6.820431E-07_EB, 4.756144E-07_EB, 6.421609E-07_EB, 8.548154E-07_EB, 5.543056E-08_EB, &
    2.478079E-07_EB,  &
    3.125653E-06_EB, 3.210884E-06_EB, 2.315284E-06_EB, 2.178376E-06_EB, 1.307235E-06_EB, 0.000000E+00_EB, &
    1.309331E-06_EB,  &
    4.557677E-06_EB, 4.151084E-06_EB, 2.366851E-06_EB, 2.426158E-06_EB, 1.575921E-06_EB, 4.186335E-07_EB, &
    5.948051E-07_EB,  &
    5.165379E-06_EB, 6.217477E-06_EB, 3.186011E-06_EB, 3.168819E-06_EB, 2.073901E-06_EB, 7.420000E-07_EB, &
    3.164858E-06_EB,  &
    7.696963E-06_EB, 8.687231E-06_EB, 4.665252E-06_EB, 4.934950E-06_EB, 1.396976E-06_EB, 9.723624E-07_EB, &
    1.793749E-06_EB,  &
    7.455392E-06_EB, 1.120365E-05_EB, 5.333310E-06_EB, 5.922133E-06_EB, 3.907746E-06_EB, 3.275589E-06_EB, &
    2.238958E-06_EB,  &
    2.030157E-05_EB, 2.284500E-05_EB, 1.245948E-05_EB, 1.295308E-05_EB, 7.032296E-06_EB, 7.172413E-06_EB, &
    4.930035E-06_EB/),(/7,8/))

GAMMAD2_C7H16(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    2.814957E-05_EB, 3.113554E-05_EB, 2.026458E-05_EB, 2.064552E-05_EB, 1.459627E-05_EB, 1.532829E-05_EB, &
    3.999790E-06_EB,  &
    1.484011E-05_EB, 2.801676E-05_EB, 1.986049E-05_EB, 2.301017E-05_EB, 1.904246E-05_EB, 3.197964E-05_EB, &
    4.892848E-06_EB,  &
    6.015419E-05_EB, 7.060056E-05_EB, 5.521213E-05_EB, 6.088643E-05_EB, 5.319866E-05_EB, 8.532193E-05_EB, &
    8.991098E-06_EB,  &
    2.554628E-04_EB, 2.493938E-04_EB, 2.234112E-04_EB, 2.313731E-04_EB, 2.081414E-04_EB, 2.745810E-04_EB, &
    1.845314E-05_EB,  &
    7.078578E-03_EB, 3.995539E-03_EB, 3.329653E-03_EB, 2.846997E-03_EB, 2.126974E-03_EB, 1.496453E-03_EB, &
    5.120513E-05_EB,  &
    7.564761E-02_EB, 3.203975E-02_EB, 2.318052E-02_EB, 1.761326E-02_EB, 1.058814E-02_EB, 4.922094E-03_EB, &
    1.043962E-04_EB,  &
    4.913122E-02_EB, 2.894993E-02_EB, 2.411893E-02_EB, 1.979061E-02_EB, 1.441913E-02_EB, 8.758161E-03_EB, &
    2.504481E-04_EB,  &
    3.803067E-01_EB, 1.339955E-01_EB, 9.904160E-02_EB, 7.335831E-02_EB, 4.641303E-02_EB, 2.199518E-02_EB, &
    4.650258E-04_EB/),(/7,8/))

GAMMAD2_C7H16(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    7.183985E-01_EB, 2.231708E-01_EB, 1.554100E-01_EB, 1.094731E-01_EB, 6.391766E-02_EB, 2.482713E-02_EB, &
    3.998535E-04_EB,  &
    8.600754E-01_EB, 1.862652E-01_EB, 1.057807E-01_EB, 6.895255E-02_EB, 3.302475E-02_EB, 1.001791E-02_EB, &
    2.264266E-04_EB,  &
    1.123411E-03_EB, 1.374636E-03_EB, 1.305686E-03_EB, 1.257887E-03_EB, 1.077632E-03_EB, 7.877202E-04_EB, &
    1.313070E-04_EB,  &
    1.286407E-04_EB, 1.838213E-04_EB, 1.499805E-04_EB, 1.625395E-04_EB, 1.377786E-04_EB, 1.394976E-04_EB, &
    8.632184E-05_EB,  &
    4.791101E-05_EB, 8.223524E-05_EB, 5.840148E-05_EB, 6.750772E-05_EB, 5.009397E-05_EB, 5.524780E-05_EB, &
    5.299784E-05_EB,  &
    1.317555E-05_EB, 4.147851E-05_EB, 2.632425E-05_EB, 3.465111E-05_EB, 2.427979E-05_EB, 2.943086E-05_EB, &
    2.967663E-05_EB,  &
    5.720300E-06_EB, 2.519957E-05_EB, 1.491408E-05_EB, 2.093267E-05_EB, 7.432774E-06_EB, 2.088867E-05_EB, &
    2.218485E-05_EB,  &
    7.996445E-07_EB, 1.672230E-05_EB, 9.966229E-06_EB, 1.377183E-05_EB, 4.514442E-06_EB, 1.185593E-05_EB, &
    2.455327E-05_EB/),(/7,8/))

GAMMAD2_C7H16(1:7,25:30) = RESHAPE((/ &  ! 3150-3275 cm-1
    7.307000E-06_EB, 1.403313E-05_EB, 7.444071E-06_EB, 9.556373E-06_EB, 3.076433E-06_EB, 4.782645E-06_EB, &
    1.318876E-05_EB,  &
    1.200645E-05_EB, 1.472389E-05_EB, 6.913147E-06_EB, 7.635960E-06_EB, 2.723336E-06_EB, 2.186689E-06_EB, &
    5.833701E-06_EB,  &
    8.956475E-06_EB, 8.668422E-06_EB, 3.163702E-06_EB, 3.996880E-06_EB, 1.179220E-06_EB, 5.907996E-07_EB, &
    4.164110E-06_EB,  &
    2.804393E-07_EB, 2.243053E-06_EB, 8.575563E-07_EB, 1.180553E-06_EB, 1.441333E-07_EB, 1.298762E-07_EB, &
    1.198500E-06_EB,  &
    1.012214E-08_EB, 5.436795E-08_EB, 2.364270E-08_EB, 4.226664E-08_EB, 1.914455E-08_EB, 3.879707E-10_EB, &
    3.156423E-07_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!-------------------------Toluene DATA-------------------


! THERE ARE 5 BANDS FOR Toluene

! BAND #1: 700 cm-1 - 825 cm-1 
! BAND #2: 975 cm-1 - 1175 cm-1 
! BAND #3: 1275 cm-1 - 1675 cm-1 
! BAND #4: 1650 cm-1 - 2075 cm-1 
! BAND #5: 2675 cm-1 - 3225 cm-1 

N_TEMP_C7H8 = 7
N_BAND_C7H8 = 5
I_MODEL_C7H8 = 2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C7H8_TEMP(N_TEMP_C7H8)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Toluene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C7H8(N_BAND_C7H8,3)) 
ALLOCATE(Be_C7H8(N_BAND_C7H8)) 

OM_BND_C7H8 = RESHAPE((/ &
    700._EB,  975._EB, 1275._EB, 1650._EB, 2675._EB, &
    825._EB, 1175._EB, 1675._EB, 2075._EB, 3225._EB, &
     25._EB, 25._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C7H8,3/)) 

SD_C7H8_TEMP = (/ &
    300._EB, 396._EB, 440._EB, 477._EB, 587._EB, 795._EB,&
    999._EB/)

Be_C7H8 = (/ &
    0.100_EB, 0.100_EB, 0.100_EB, 0.100_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C7H8(N_TEMP_C7H8,6)) 

! BAND #1: 700 cm-1 - 825 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 50.7126 % 
! GAMMA_D: 26.076 % 

SD1_C7H8(1:7,1:6) = RESHAPE((/ &  ! 700-825 cm-1
    1.183404E+00_EB, 1.280818E+00_EB, 5.556911E-01_EB, 6.410332E-01_EB, 5.148513E-01_EB, 4.385652E-01_EB, &
    4.754417E-01_EB,  &
    5.058690E+00_EB, 6.679869E+00_EB, 1.805053E+00_EB, 9.014174E+00_EB, 1.665850E+00_EB, 1.125691E+00_EB, &
    1.152489E+00_EB,  &
    1.464745E+00_EB, 1.676956E+00_EB, 6.593809E-01_EB, 1.350587E+00_EB, 6.715912E-01_EB, 5.409767E-01_EB, &
    1.387180E+00_EB,  &
    3.145209E-02_EB, 1.005157E-02_EB, 1.146566E-02_EB, 2.736493E-02_EB, 3.695640E-02_EB, 5.604909E-02_EB, &
    6.864320E-02_EB,  &
    4.947149E-03_EB, 4.700734E-05_EB, 2.703487E-04_EB, 3.115834E-05_EB, 6.143520E-04_EB, 8.702885E-05_EB, &
    1.963670E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C7H8(N_TEMP_C7H8,6)) 

! BAND #1: 700 cm-1 - 825 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 50.7126 % 
! GAMMA_D: 26.076 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C7H8(1:7,1:6) = RESHAPE((/ &  ! 700-825 cm-1
    6.301837E-03_EB, 4.631070E-03_EB, 3.325631E-03_EB, 3.888138E-03_EB, 3.318625E-03_EB, 2.003340E-03_EB, &
    1.117202E-03_EB,  &
    2.001321E-01_EB, 9.068028E-02_EB, 4.617608E-02_EB, 5.376059E-02_EB, 3.569672E-02_EB, 1.915564E-02_EB, &
    1.078657E-02_EB,  &
    9.344734E-03_EB, 6.756769E-03_EB, 4.821946E-03_EB, 5.911995E-03_EB, 4.961747E-03_EB, 3.600320E-03_EB, &
    1.670504E-03_EB,  &
    1.256706E-05_EB, 7.867119E-06_EB, 1.190651E-05_EB, 1.636844E-05_EB, 2.366374E-05_EB, 4.308874E-05_EB, &
    1.973862E-05_EB,  &
    3.963325E-07_EB, 6.563474E-10_EB, 1.128757E-09_EB, 7.312080E-08_EB, 7.236913E-08_EB, 2.422879E-10_EB, &
    2.737119E-09_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C7H8(N_TEMP_C7H8,9)) 

! BAND #2: 975 cm-1 - 1175 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 39.9898 % 
! GAMMA_D: 28.785 % 

SD2_C7H8(1:7,1:8) = RESHAPE((/ &  ! 975-1150 cm-1
    1.159879E-04_EB, 1.518393E-03_EB, 1.944060E-04_EB, 3.363585E-04_EB, 4.147005E-05_EB, 7.597773E-05_EB, &
    2.534051E-04_EB,  &
    1.429172E-02_EB, 1.780265E-02_EB, 1.393871E-02_EB, 1.608875E-02_EB, 1.148755E-02_EB, 1.413997E-02_EB, &
    1.192716E-02_EB,  &
    2.972854E-01_EB, 2.791336E-01_EB, 1.250473E-01_EB, 6.212734E-02_EB, 1.122263E-01_EB, 6.107749E-02_EB, &
    4.007657E-02_EB,  &
    2.670426E-01_EB, 1.472015E-01_EB, 1.189362E-01_EB, 4.848414E-01_EB, 1.174972E-01_EB, 8.975680E-02_EB, &
    3.461087E-02_EB,  &
    3.333089E-01_EB, 2.649758E-01_EB, 1.351678E-01_EB, 1.115162E+00_EB, 1.332456E-01_EB, 9.778267E-02_EB, &
    4.793037E-02_EB,  &
    2.169681E-01_EB, 1.089519E-01_EB, 8.131619E-02_EB, 4.061073E-02_EB, 6.545524E-02_EB, 3.972954E-02_EB, &
    6.995365E-03_EB,  &
    2.927780E-02_EB, 2.615722E-02_EB, 1.815600E-02_EB, 2.189800E-02_EB, 1.264526E-02_EB, 3.955209E-03_EB, &
    2.099253E-03_EB,  &
    1.563110E-04_EB, 3.416241E-05_EB, 1.028671E-03_EB, 9.988797E-05_EB, 1.147214E-04_EB, 4.809614E-05_EB, &
    7.121044E-05_EB/),(/7,8/))

SD2_C7H8(1:7,9:9) = RESHAPE((/ &  ! 1175-1175 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C7H8(N_TEMP_C7H8,9)) 

! BAND #2: 975 cm-1 - 1175 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 39.9898 % 
! GAMMA_D: 28.785 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C7H8(1:7,1:8) = RESHAPE((/ &  ! 975-1150 cm-1
    3.854775E-10_EB, 2.839037E-07_EB, 6.435454E-10_EB, 4.950427E-10_EB, 4.715047E-10_EB, 1.927803E-09_EB, &
    8.243574E-08_EB,  &
    4.886453E-06_EB, 4.197579E-06_EB, 2.522111E-06_EB, 2.689866E-06_EB, 2.662567E-06_EB, 6.573463E-06_EB, &
    1.404522E-05_EB,  &
    5.512447E-04_EB, 3.153489E-04_EB, 1.990636E-04_EB, 1.742065E-04_EB, 1.753758E-04_EB, 7.473389E-05_EB, &
    1.320045E-04_EB,  &
    4.565596E-04_EB, 2.377580E-04_EB, 1.718382E-04_EB, 1.956532E-04_EB, 1.917338E-04_EB, 1.224002E-04_EB, &
    6.250805E-05_EB,  &
    6.922925E-04_EB, 4.315977E-04_EB, 2.442433E-04_EB, 2.425250E-04_EB, 2.148278E-04_EB, 1.524545E-04_EB, &
    8.343134E-05_EB,  &
    3.192644E-04_EB, 1.503806E-04_EB, 9.368373E-05_EB, 7.362317E-05_EB, 6.187069E-05_EB, 3.701971E-05_EB, &
    8.964668E-06_EB,  &
    1.156855E-05_EB, 1.529904E-05_EB, 6.860961E-06_EB, 4.586573E-06_EB, 2.800411E-06_EB, 4.948274E-07_EB, &
    8.423074E-07_EB,  &
    4.537885E-10_EB, 2.858621E-08_EB, 1.508723E-07_EB, 5.707056E-10_EB, 5.881694E-10_EB, 3.910907E-10_EB, &
    2.795819E-10_EB/),(/7,8/))

GAMMAD2_C7H8(1:7,9:9) = RESHAPE((/ &  ! 1175-1175 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C7H8(N_TEMP_C7H8,17)) 

! BAND #3: 1275 cm-1 - 1675 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 48.0443 % 
! GAMMA_D: 27.1153 % 

SD3_C7H8(1:7,1:8) = RESHAPE((/ &  ! 1275-1450 cm-1
    1.249082E-04_EB, 1.102125E-03_EB, 3.615354E-04_EB, 4.137932E-05_EB, 3.764262E-03_EB, 3.540948E-04_EB, &
    1.211942E-04_EB,  &
    1.788006E-04_EB, 7.312259E-03_EB, 2.322858E-03_EB, 6.084979E-03_EB, 1.260860E-02_EB, 4.527399E-03_EB, &
    3.461457E-03_EB,  &
    3.093450E-03_EB, 8.497953E-03_EB, 4.296474E-02_EB, 1.015836E-02_EB, 2.161287E-02_EB, 1.509998E-02_EB, &
    2.121351E-02_EB,  &
    2.912571E+00_EB, 1.038918E-01_EB, 4.451313E-02_EB, 2.626960E-02_EB, 3.462160E-02_EB, 3.394949E-02_EB, &
    2.466615E-02_EB,  &
    2.026016E-01_EB, 4.142628E-01_EB, 8.856475E-02_EB, 1.079173E-01_EB, 7.296833E-02_EB, 5.948070E-02_EB, &
    2.329203E-02_EB,  &
    1.815579E-01_EB, 1.593011E-01_EB, 8.722358E-02_EB, 7.492544E-02_EB, 6.811549E-02_EB, 5.434670E-02_EB, &
    2.132793E-02_EB,  &
    1.802281E-01_EB, 1.464611E-01_EB, 9.553886E-02_EB, 1.023701E-01_EB, 8.739058E-02_EB, 8.595610E-02_EB, &
    6.801516E-02_EB,  &
    5.005577E-01_EB, 4.108856E-01_EB, 2.052265E-01_EB, 2.711206E-01_EB, 1.587535E-01_EB, 1.285627E-01_EB, &
    8.471236E-02_EB/),(/7,8/))

SD3_C7H8(1:7,9:16) = RESHAPE((/ &  ! 1475-1650 cm-1
    6.674517E-01_EB, 1.305089E+00_EB, 2.911724E-01_EB, 6.477927E-01_EB, 2.825485E-01_EB, 2.478642E-01_EB, &
    1.363368E-01_EB,  &
    1.601478E+00_EB, 1.380328E+00_EB, 5.375713E-01_EB, 1.045905E+00_EB, 4.135343E-01_EB, 2.807576E-01_EB, &
    1.838585E-01_EB,  &
    3.631317E-01_EB, 2.354214E-01_EB, 1.876211E-01_EB, 2.404411E-01_EB, 1.372349E-01_EB, 1.115940E-01_EB, &
    7.384654E-02_EB,  &
    1.156692E-01_EB, 9.113501E-02_EB, 1.003659E-01_EB, 8.704725E-02_EB, 7.101831E-02_EB, 7.623347E-02_EB, &
    6.740793E-02_EB,  &
    1.571090E-01_EB, 4.078547E-02_EB, 1.281487E-01_EB, 4.246912E-02_EB, 1.129164E-01_EB, 1.296721E-01_EB, &
    9.391411E-02_EB,  &
    9.639363E-01_EB, 1.188722E-01_EB, 3.304871E-01_EB, 1.198078E+00_EB, 2.535187E-01_EB, 1.868618E-01_EB, &
    1.687577E-01_EB,  &
    5.494262E-01_EB, 7.722661E-02_EB, 1.734219E-01_EB, 5.484008E-02_EB, 7.926798E-02_EB, 4.310216E-02_EB, &
    1.425963E-02_EB,  &
    6.689974E-03_EB, 1.802067E-03_EB, 5.229664E-03_EB, 9.002052E-03_EB, 9.212082E-05_EB, 1.616732E-04_EB, &
    4.536212E-05_EB/),(/7,8/))

SD3_C7H8(1:7,17:17) = RESHAPE((/ &  ! 1675-1675 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C7H8(N_TEMP_C7H8,17)) 

! BAND #3: 1275 cm-1 - 1675 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 48.0443 % 
! GAMMA_D: 27.1153 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C7H8(1:7,1:8) = RESHAPE((/ &  ! 1275-1450 cm-1
    4.044947E-10_EB, 2.962521E-07_EB, 4.524009E-09_EB, 5.803741E-09_EB, 1.544456E-07_EB, 6.062153E-08_EB, &
    1.772612E-08_EB,  &
    1.094543E-09_EB, 3.205188E-06_EB, 1.845659E-06_EB, 1.045659E-06_EB, 3.099931E-06_EB, 7.434376E-07_EB, &
    8.131593E-06_EB,  &
    5.864610E-08_EB, 3.699316E-06_EB, 4.852187E-06_EB, 2.557000E-06_EB, 6.919367E-06_EB, 4.247212E-06_EB, &
    1.069138E-05_EB,  &
    1.165822E-05_EB, 1.651109E-05_EB, 1.795929E-05_EB, 1.595755E-05_EB, 1.725843E-05_EB, 1.356882E-05_EB, &
    2.169679E-05_EB,  &
    2.005620E-04_EB, 1.373875E-04_EB, 9.510162E-05_EB, 9.648611E-05_EB, 7.793904E-05_EB, 4.801867E-05_EB, &
    1.260268E-05_EB,  &
    1.976330E-04_EB, 1.270165E-04_EB, 9.353940E-05_EB, 8.678463E-05_EB, 7.258865E-05_EB, 3.697938E-05_EB, &
    1.413956E-05_EB,  &
    2.303101E-04_EB, 1.697287E-04_EB, 1.238846E-04_EB, 1.195652E-04_EB, 1.206667E-04_EB, 1.024901E-04_EB, &
    4.500738E-05_EB,  &
    1.400424E-03_EB, 7.458086E-04_EB, 5.112588E-04_EB, 5.142435E-04_EB, 3.600370E-04_EB, 2.216810E-04_EB, &
    1.683630E-04_EB/),(/7,8/))

GAMMAD3_C7H8(1:7,9:16) = RESHAPE((/ &  ! 1475-1650 cm-1
    2.247983E-03_EB, 1.411799E-03_EB, 9.969568E-04_EB, 1.154124E-03_EB, 1.042580E-03_EB, 8.011156E-04_EB, &
    3.723578E-04_EB,  &
    1.409293E-02_EB, 6.499785E-03_EB, 3.601567E-03_EB, 3.783312E-03_EB, 2.327190E-03_EB, 1.095219E-03_EB, &
    5.046594E-04_EB,  &
    9.645118E-04_EB, 6.577029E-04_EB, 4.838656E-04_EB, 4.188548E-04_EB, 3.148629E-04_EB, 1.934350E-04_EB, &
    1.293872E-04_EB,  &
    2.425255E-04_EB, 1.699456E-04_EB, 1.508849E-04_EB, 1.240329E-04_EB, 1.053655E-04_EB, 1.037937E-04_EB, &
    1.010065E-04_EB,  &
    1.447161E-04_EB, 9.594941E-05_EB, 1.044570E-04_EB, 1.019618E-04_EB, 1.670525E-04_EB, 2.144414E-04_EB, &
    1.242627E-04_EB,  &
    1.838745E-03_EB, 8.492823E-04_EB, 7.000107E-04_EB, 8.682527E-04_EB, 6.055914E-04_EB, 2.757537E-04_EB, &
    9.737210E-05_EB,  &
    1.064444E-03_EB, 3.143243E-04_EB, 2.214424E-04_EB, 1.622479E-04_EB, 9.560424E-05_EB, 2.979667E-05_EB, &
    4.112045E-06_EB,  &
    2.275640E-06_EB, 1.772877E-07_EB, 6.696143E-07_EB, 3.705611E-07_EB, 2.967870E-10_EB, 6.357096E-10_EB, &
    1.049357E-10_EB/),(/7,8/))

GAMMAD3_C7H8(1:7,17:17) = RESHAPE((/ &  ! 1675-1675 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C7H8(N_TEMP_C7H8,18)) 

! BAND #4: 1650 cm-1 - 2075 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 60.7346 % 
! GAMMA_D: 32.7069 % 

SD4_C7H8(1:7,1:8) = RESHAPE((/ &  ! 1650-1825 cm-1
    2.178905E-03_EB, 2.037706E-04_EB, 8.748980E-04_EB, 1.907325E-04_EB, 2.729714E-05_EB, 1.270023E-05_EB, &
    6.794535E-04_EB,  &
    5.005464E-02_EB, 6.011079E-03_EB, 4.858847E-03_EB, 2.273066E-02_EB, 1.871059E-04_EB, 7.039876E-05_EB, &
    1.029889E-04_EB,  &
    1.057066E-02_EB, 5.387448E-03_EB, 1.109545E-02_EB, 5.343513E-03_EB, 1.771469E-03_EB, 4.567024E-04_EB, &
    1.572925E-03_EB,  &
    3.144107E-02_EB, 2.084399E-03_EB, 2.731347E-04_EB, 6.294723E-03_EB, 1.072397E-02_EB, 6.053612E-03_EB, &
    2.244586E-02_EB,  &
    2.226950E-02_EB, 2.408140E-02_EB, 9.127360E-04_EB, 1.902109E-02_EB, 1.088979E-02_EB, 1.476200E-02_EB, &
    2.204492E-02_EB,  &
    5.736109E-02_EB, 3.381055E-02_EB, 2.026903E-04_EB, 1.481977E-02_EB, 4.154343E-02_EB, 5.934228E-02_EB, &
    3.738257E-02_EB,  &
    3.788935E-01_EB, 2.271532E-02_EB, 1.352907E-02_EB, 1.482736E-01_EB, 5.307025E-02_EB, 1.207871E-01_EB, &
    3.168265E-02_EB,  &
    2.265295E-02_EB, 4.131933E-02_EB, 2.612084E-02_EB, 6.414140E-04_EB, 7.876086E-02_EB, 8.666037E-03_EB, &
    2.920426E-02_EB/),(/7,8/))

SD4_C7H8(1:7,9:16) = RESHAPE((/ &  ! 1850-2025 cm-1
    8.800524E-02_EB, 1.064410E-02_EB, 8.952199E-03_EB, 8.372676E+00_EB, 6.308145E-02_EB, 1.448167E-02_EB, &
    4.114265E-02_EB,  &
    1.223004E-01_EB, 4.368465E-03_EB, 0.000000E+00_EB, 1.191646E-02_EB, 4.741746E-02_EB, 4.575004E-03_EB, &
    3.246000E-02_EB,  &
    1.849048E-02_EB, 7.727300E-03_EB, 1.315128E-02_EB, 9.591982E-02_EB, 0.000000E+00_EB, 9.893008E-03_EB, &
    3.047436E-02_EB,  &
    9.269125E-02_EB, 1.363057E-02_EB, 8.231661E-03_EB, 2.310042E-02_EB, 6.516357E-02_EB, 2.345986E-01_EB, &
    3.389766E-02_EB,  &
    3.480749E-01_EB, 3.622576E-02_EB, 8.713673E-02_EB, 5.140865E-01_EB, 6.175075E-02_EB, 6.565769E-01_EB, &
    2.390288E-02_EB,  &
    1.193294E-03_EB, 1.595366E-02_EB, 2.805636E-02_EB, 5.476385E-04_EB, 1.066503E-02_EB, 3.991367E-03_EB, &
    1.811852E-02_EB,  &
    4.247589E-03_EB, 1.285163E-02_EB, 3.900214E-03_EB, 6.231463E-03_EB, 6.840878E-04_EB, 4.318546E-03_EB, &
    1.520125E-02_EB,  &
    4.131345E-04_EB, 1.391015E-04_EB, 2.212849E-03_EB, 1.618493E-03_EB, 2.822500E-03_EB, 0.000000E+00_EB, &
    1.965446E-02_EB/),(/7,8/))

SD4_C7H8(1:7,17:18) = RESHAPE((/ &  ! 2050-2075 cm-1
    8.091086E-05_EB, 8.583670E-05_EB, 2.875902E-04_EB, 1.619108E-04_EB, 7.361714E-05_EB, 1.750674E-04_EB, &
    1.925516E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C7H8(N_TEMP_C7H8,18)) 

! BAND #4: 1650 cm-1 - 2075 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 60.7346 % 
! GAMMA_D: 32.7069 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C7H8(1:7,1:8) = RESHAPE((/ &  ! 1650-1825 cm-1
    3.365476E-06_EB, 2.374045E-09_EB, 3.870069E-08_EB, 2.217963E-09_EB, 2.724055E-10_EB, 4.040964E-11_EB, &
    5.840681E-10_EB,  &
    1.169506E-05_EB, 4.310385E-07_EB, 9.070351E-07_EB, 6.051322E-07_EB, 1.067442E-09_EB, 3.328956E-10_EB, &
    1.579208E-09_EB,  &
    1.143931E-05_EB, 1.246672E-06_EB, 2.160928E-06_EB, 1.313996E-06_EB, 7.016361E-07_EB, 3.164672E-08_EB, &
    5.071457E-07_EB,  &
    2.913482E-05_EB, 1.229189E-05_EB, 5.587621E-06_EB, 6.003824E-06_EB, 3.079311E-06_EB, 7.283932E-07_EB, &
    6.049069E-06_EB,  &
    1.629526E-05_EB, 4.838933E-06_EB, 1.977803E-06_EB, 7.298866E-06_EB, 3.575804E-06_EB, 2.896867E-06_EB, &
    1.344628E-05_EB,  &
    5.249479E-05_EB, 1.472065E-05_EB, 1.114346E-05_EB, 2.429161E-05_EB, 2.978526E-05_EB, 3.264578E-05_EB, &
    3.681100E-05_EB,  &
    1.689352E-04_EB, 8.145686E-05_EB, 4.593606E-05_EB, 8.199802E-05_EB, 4.869126E-05_EB, 3.243234E-05_EB, &
    3.014657E-05_EB,  &
    3.110975E-05_EB, 1.575235E-05_EB, 1.173705E-05_EB, 1.011924E-05_EB, 2.045739E-05_EB, 1.979183E-05_EB, &
    2.546460E-05_EB/),(/7,8/))

GAMMAD4_C7H8(1:7,9:16) = RESHAPE((/ &  ! 1850-2025 cm-1
    7.380996E-05_EB, 6.503510E-05_EB, 4.026652E-05_EB, 6.326658E-05_EB, 5.028194E-05_EB, 2.713626E-05_EB, &
    4.438672E-05_EB,  &
    5.708197E-05_EB, 1.697748E-05_EB, 0.000000E+00_EB, 2.739888E-05_EB, 2.032613E-05_EB, 1.219274E-05_EB, &
    1.597744E-05_EB,  &
    1.279858E-05_EB, 4.581744E-06_EB, 1.680926E-06_EB, 2.936985E-06_EB, 0.000000E+00_EB, 1.189454E-05_EB, &
    2.734644E-05_EB,  &
    3.421323E-05_EB, 3.002996E-05_EB, 2.567242E-05_EB, 3.872570E-05_EB, 5.137269E-05_EB, 4.429549E-05_EB, &
    2.867846E-05_EB,  &
    2.433743E-04_EB, 8.169961E-05_EB, 6.440898E-05_EB, 7.839423E-05_EB, 4.996555E-05_EB, 2.112610E-05_EB, &
    1.496941E-05_EB,  &
    6.595371E-06_EB, 3.487076E-06_EB, 2.168862E-06_EB, 5.928482E-06_EB, 4.485136E-07_EB, 8.492125E-07_EB, &
    5.787365E-06_EB,  &
    2.740201E-06_EB, 2.606766E-07_EB, 5.115045E-07_EB, 6.664663E-07_EB, 2.331586E-07_EB, 1.977779E-08_EB, &
    2.855170E-06_EB,  &
    3.011351E-07_EB, 4.473335E-09_EB, 8.793465E-08_EB, 1.057069E-07_EB, 4.611919E-08_EB, 0.000000E+00_EB, &
    2.464221E-06_EB/),(/7,8/))

GAMMAD4_C7H8(1:7,17:18) = RESHAPE((/ &  ! 2050-2075 cm-1
    3.535012E-10_EB, 2.134703E-10_EB, 8.212981E-10_EB, 4.932634E-10_EB, 4.017612E-10_EB, 6.467267E-10_EB, &
    1.798331E-07_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD5_C7H8(N_TEMP_C7H8,23)) 

! BAND #5: 2675 cm-1 - 3225 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 47.652 % 
! GAMMA_D: 25.1406 % 

SD5_C7H8(1:7,1:8) = RESHAPE((/ &  ! 2675-2850 cm-1
    8.320246E-05_EB, 1.224705E-04_EB, 9.260825E-04_EB, 1.187334E-04_EB, 1.687468E-04_EB, 5.081470E-05_EB, &
    9.969233E-05_EB,  &
    2.101934E-04_EB, 1.296723E-04_EB, 4.693696E-04_EB, 2.235794E-04_EB, 4.809493E-04_EB, 4.027136E-03_EB, &
    7.664359E-03_EB,  &
    5.409533E-04_EB, 0.000000E+00_EB, 7.626514E-04_EB, 4.807566E-04_EB, 9.111993E-03_EB, 1.248360E-02_EB, &
    2.884136E-02_EB,  &
    2.335959E-04_EB, 1.116951E-05_EB, 3.603749E-04_EB, 4.008804E-04_EB, 2.091081E-02_EB, 1.892004E-02_EB, &
    3.213296E-02_EB,  &
    3.807208E-04_EB, 1.000182E-03_EB, 4.965153E-03_EB, 1.163272E-03_EB, 1.008677E-02_EB, 1.752594E-02_EB, &
    2.065285E-02_EB,  &
    5.030591E-03_EB, 4.391870E-03_EB, 1.297745E-02_EB, 3.170449E-03_EB, 2.093600E-02_EB, 3.205232E-02_EB, &
    5.980853E-02_EB,  &
    4.009677E-02_EB, 2.922794E-02_EB, 3.546247E-02_EB, 1.530707E-02_EB, 4.630989E-02_EB, 6.153209E-02_EB, &
    8.718831E-02_EB,  &
    2.134351E-01_EB, 2.055984E-01_EB, 1.297089E-01_EB, 5.782266E-02_EB, 1.352101E-01_EB, 1.240171E-01_EB, &
    1.263681E-01_EB/),(/7,8/))

SD5_C7H8(1:7,9:16) = RESHAPE((/ &  ! 2875-3050 cm-1
    9.941627E-01_EB, 1.202074E+00_EB, 3.821520E-01_EB, 3.195397E+00_EB, 3.094292E-01_EB, 2.313255E-01_EB, &
    1.890107E-01_EB,  &
    9.136992E-01_EB, 9.795384E-01_EB, 3.977409E-01_EB, 2.122744E+00_EB, 3.696588E-01_EB, 3.114869E-01_EB, &
    2.788749E-01_EB,  &
    1.702149E+00_EB, 3.076040E+00_EB, 7.157891E-01_EB, 3.343151E+00_EB, 5.783366E-01_EB, 4.354417E-01_EB, &
    3.307255E-01_EB,  &
    1.629107E+00_EB, 1.974331E+00_EB, 6.036176E-01_EB, 2.067222E+00_EB, 4.339120E-01_EB, 3.040509E-01_EB, &
    2.383098E-01_EB,  &
    7.979109E-01_EB, 6.285515E-01_EB, 3.136239E-01_EB, 5.911337E-01_EB, 2.324883E-01_EB, 2.003064E-01_EB, &
    2.018119E-01_EB,  &
    1.002835E+00_EB, 1.096904E+00_EB, 3.784700E-01_EB, 1.184573E+00_EB, 4.106393E-01_EB, 3.976965E-01_EB, &
    3.728026E-01_EB,  &
    2.800765E+00_EB, 7.614166E+00_EB, 1.057783E+00_EB, 3.808209E+00_EB, 9.677710E-01_EB, 6.959857E-01_EB, &
    5.263260E-01_EB,  &
    3.023353E+00_EB, 6.126153E+00_EB, 1.093977E+00_EB, 3.808674E+00_EB, 9.702671E-01_EB, 7.499529E-01_EB, &
    6.031495E-01_EB/),(/7,8/))

SD5_C7H8(1:7,17:23) = RESHAPE((/ &  ! 3075-3225 cm-1
    2.244352E+00_EB, 4.295763E+00_EB, 8.957071E-01_EB, 3.154955E+00_EB, 8.172594E-01_EB, 6.223989E-01_EB, &
    4.790608E-01_EB,  &
    1.251651E+00_EB, 2.234184E+00_EB, 4.776871E-01_EB, 1.664814E+00_EB, 3.993896E-01_EB, 2.847750E-01_EB, &
    1.948646E-01_EB,  &
    3.146415E-01_EB, 3.135762E-01_EB, 1.302605E-01_EB, 3.198883E-01_EB, 9.457060E-02_EB, 6.772974E-02_EB, &
    4.658580E-02_EB,  &
    1.294626E-02_EB, 1.670360E-02_EB, 2.174437E-02_EB, 1.158633E-02_EB, 1.759903E-02_EB, 1.575246E-02_EB, &
    7.465614E-03_EB,  &
    1.045655E-02_EB, 4.669806E-03_EB, 9.728208E-03_EB, 2.023140E-03_EB, 2.847513E-03_EB, 6.244293E-03_EB, &
    1.743616E-04_EB,  &
    8.691517E-04_EB, 9.432260E-04_EB, 8.470338E-04_EB, 1.212820E-04_EB, 4.736017E-04_EB, 1.014494E-03_EB, &
    1.519213E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD5_C7H8(N_TEMP_C7H8,23)) 

! BAND #5: 2675 cm-1 - 3225 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 47.652 % 
! GAMMA_D: 25.1406 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD5_C7H8(1:7,1:8) = RESHAPE((/ &  ! 2675-2850 cm-1
    4.908451E-10_EB, 7.124699E-10_EB, 9.917848E-10_EB, 5.438372E-10_EB, 7.442797E-10_EB, 2.867781E-10_EB, &
    4.973147E-10_EB,  &
    1.787650E-09_EB, 1.121395E-09_EB, 1.674910E-09_EB, 4.960818E-10_EB, 1.102057E-08_EB, 3.619856E-07_EB, &
    3.809784E-07_EB,  &
    5.670374E-10_EB, 0.000000E+00_EB, 1.662764E-09_EB, 8.920394E-10_EB, 2.212971E-06_EB, 3.756250E-06_EB, &
    3.450445E-06_EB,  &
    2.674645E-09_EB, 9.779671E-10_EB, 2.039227E-08_EB, 2.195357E-08_EB, 8.078259E-06_EB, 7.837878E-06_EB, &
    6.858912E-06_EB,  &
    1.944109E-09_EB, 1.369331E-08_EB, 1.598543E-07_EB, 8.805821E-08_EB, 2.672773E-06_EB, 6.507249E-06_EB, &
    8.451824E-06_EB,  &
    5.700468E-07_EB, 8.620854E-07_EB, 1.913835E-06_EB, 1.107296E-06_EB, 8.253893E-06_EB, 1.740524E-05_EB, &
    2.071834E-05_EB,  &
    1.488398E-05_EB, 1.656409E-05_EB, 1.548699E-05_EB, 1.192057E-05_EB, 3.597016E-05_EB, 5.846320E-05_EB, &
    7.054377E-05_EB,  &
    2.591649E-04_EB, 2.322396E-04_EB, 2.000158E-04_EB, 1.569886E-04_EB, 2.456111E-04_EB, 2.197421E-04_EB, &
    2.142335E-04_EB/),(/7,8/))

GAMMAD5_C7H8(1:7,9:16) = RESHAPE((/ &  ! 2875-3050 cm-1
    4.851622E-03_EB, 2.587042E-03_EB, 1.704776E-03_EB, 1.613584E-03_EB, 1.210208E-03_EB, 7.067048E-04_EB, &
    4.317784E-04_EB,  &
    4.220205E-03_EB, 2.722821E-03_EB, 1.855001E-03_EB, 1.960766E-03_EB, 1.692641E-03_EB, 1.265075E-03_EB, &
    8.774216E-04_EB,  &
    1.446280E-02_EB, 8.263508E-03_EB, 5.916128E-03_EB, 5.603671E-03_EB, 4.156313E-03_EB, 2.405546E-03_EB, &
    1.393628E-03_EB,  &
    1.316636E-02_EB, 6.097463E-03_EB, 4.235574E-03_EB, 3.587648E-03_EB, 2.393277E-03_EB, 1.195172E-03_EB, &
    7.278311E-04_EB,  &
    3.290089E-03_EB, 1.571176E-03_EB, 1.157519E-03_EB, 9.509883E-04_EB, 7.129856E-04_EB, 5.236927E-04_EB, &
    5.195441E-04_EB,  &
    5.163254E-03_EB, 2.774183E-03_EB, 1.685935E-03_EB, 2.127640E-03_EB, 2.103922E-03_EB, 2.020906E-03_EB, &
    1.694476E-03_EB,  &
    4.185971E-02_EB, 2.497554E-02_EB, 1.385888E-02_EB, 1.719540E-02_EB, 1.182796E-02_EB, 6.286015E-03_EB, &
    3.589006E-03_EB,  &
    5.149365E-02_EB, 2.722024E-02_EB, 1.514346E-02_EB, 1.747260E-02_EB, 1.199051E-02_EB, 7.185369E-03_EB, &
    4.595671E-03_EB/),(/7,8/))

GAMMAD5_C7H8(1:7,17:23) = RESHAPE((/ &  ! 3075-3225 cm-1
    2.719689E-02_EB, 1.596021E-02_EB, 9.917645E-03_EB, 1.127072E-02_EB, 8.400481E-03_EB, 5.009486E-03_EB, &
    2.803447E-03_EB,  &
    7.824843E-03_EB, 4.223161E-03_EB, 2.746937E-03_EB, 2.822141E-03_EB, 2.023999E-03_EB, 1.044103E-03_EB, &
    5.059872E-04_EB,  &
    5.554856E-04_EB, 3.015552E-04_EB, 2.047619E-04_EB, 1.773952E-04_EB, 1.289706E-04_EB, 6.570244E-05_EB, &
    2.963397E-05_EB,  &
    3.746120E-06_EB, 4.566149E-06_EB, 4.704064E-06_EB, 1.938192E-06_EB, 5.287206E-06_EB, 4.473229E-06_EB, &
    1.546485E-06_EB,  &
    2.360564E-06_EB, 8.725911E-07_EB, 1.197964E-06_EB, 1.490069E-07_EB, 8.467688E-07_EB, 5.992430E-07_EB, &
    5.476941E-10_EB,  &
    3.399574E-08_EB, 1.666383E-08_EB, 6.260324E-08_EB, 2.561252E-10_EB, 1.568270E-08_EB, 3.179959E-08_EB, &
    1.831326E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!-------------------------Methanol DATA-------------------
! THERE ARE 4 BANDS FOR Methanol

! BAND #1: 825 cm-1 - 1150 cm-1 
! BAND #2: 1125 cm-1 - 1700 cm-1 
! BAND #3: 2600 cm-1 - 3225 cm-1 
! BAND #4: 3525 cm-1 - 3850 cm-1 

N_TEMP_CH3OH = 7
N_BAND_CH3OH = 4
I_MODEL_CH3OH = 2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_CH3OH_TEMP(N_TEMP_CH3OH)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Methanol ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_CH3OH(N_BAND_CH3OH,3)) 
ALLOCATE(Be_CH3OH(N_BAND_CH3OH)) 

OM_BND_CH3OH = RESHAPE((/ &
    825._EB, 1125._EB, 2600._EB, 3525._EB, &
    1150._EB, 1700._EB, 3225._EB, 3850._EB, &
     25._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_CH3OH,3/)) 

SD_CH3OH_TEMP = (/ &
    293._EB, 396._EB, 443._EB, 483._EB, 570._EB, 804._EB,&
    1000._EB/)

Be_CH3OH = (/ &
    3.000_EB, 0.100_EB, 0.395_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #1: 825 cm-1 - 1150 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 16.1823 % 
! GAMMA_D: 35.2635 % 

SD1_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 825-1000 cm-1
    7.208103E-05_EB, 1.641675E-04_EB, 1.005994E-04_EB, 1.146982E-04_EB, 9.592346E-05_EB, 1.392408E-04_EB, &
    1.993262E-03_EB,  &
    2.350918E-04_EB, 1.614311E-04_EB, 2.695845E-04_EB, 8.142889E-04_EB, 1.760304E-04_EB, 2.285981E-03_EB, &
    4.471051E-03_EB,  &
    4.323770E-04_EB, 0.000000E+00_EB, 4.918704E-04_EB, 5.141651E-03_EB, 6.975675E-04_EB, 3.562376E-02_EB, &
    1.040949E-01_EB,  &
    7.336815E-03_EB, 3.825541E-03_EB, 7.722097E-03_EB, 1.260196E-02_EB, 1.099240E-02_EB, 1.039305E-01_EB, &
    4.219985E-01_EB,  &
    5.114516E-02_EB, 6.135816E-02_EB, 6.994475E-02_EB, 1.412108E-01_EB, 8.543695E-02_EB, 2.528138E-01_EB, &
    2.571113E-01_EB,  &
    1.346342E-01_EB, 2.245677E-01_EB, 2.865548E-01_EB, 4.018590E-01_EB, 2.630854E-01_EB, 7.729624E-01_EB, &
    1.791979E-02_EB,  &
    9.203292E-01_EB, 1.155707E+00_EB, 1.201664E+00_EB, 1.354115E+00_EB, 6.488930E-01_EB, 1.384151E+00_EB, &
    1.155852E-01_EB,  &
    4.409507E+00_EB, 3.188911E+00_EB, 2.689462E+00_EB, 2.657736E+00_EB, 1.023592E+00_EB, 1.738429E+00_EB, &
    1.905748E+00_EB/),(/7,8/))

SD1_CH3OH(1:7,9:14) = RESHAPE((/ &  ! 1025-1150 cm-1
    5.798348E+00_EB, 3.568496E+00_EB, 3.000227E+00_EB, 2.891949E+00_EB, 1.108480E+00_EB, 1.850618E+00_EB, &
    1.573839E-01_EB,  &
    6.627077E+00_EB, 3.966815E+00_EB, 3.239857E+00_EB, 3.130571E+00_EB, 1.187739E+00_EB, 2.014848E+00_EB, &
    1.540910E-01_EB,  &
    2.430187E+00_EB, 2.293599E+00_EB, 2.139079E+00_EB, 2.227373E+00_EB, 9.368689E-01_EB, 1.615588E+00_EB, &
    1.163041E+01_EB,  &
    2.674496E-01_EB, 1.747358E-01_EB, 1.942367E-01_EB, 2.630535E-01_EB, 1.522208E-01_EB, 2.964216E-01_EB, &
    3.410374E-01_EB,  &
    1.060515E-01_EB, 6.829944E-02_EB, 5.998181E-02_EB, 7.684988E-02_EB, 2.215500E-02_EB, 4.025119E-02_EB, &
    1.027654E-01_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #1: 825 cm-1 - 1150 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 16.1823 % 
! GAMMA_D: 35.2635 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 825-1000 cm-1
    3.342390E-10_EB, 2.998512E-10_EB, 1.361653E-10_EB, 1.810521E-10_EB, 3.462467E-10_EB, 6.883294E-10_EB, &
    7.917136E-07_EB,  &
    7.321709E-10_EB, 1.792471E-09_EB, 8.748980E-10_EB, 1.164254E-09_EB, 4.180565E-10_EB, 7.393173E-08_EB, &
    1.641915E-06_EB,  &
    5.595452E-10_EB, 0.000000E+00_EB, 9.339766E-10_EB, 1.581837E-07_EB, 1.330800E-08_EB, 7.435645E-06_EB, &
    1.173404E-05_EB,  &
    1.591477E-07_EB, 7.668581E-08_EB, 2.833891E-07_EB, 1.496765E-06_EB, 2.824115E-06_EB, 5.401210E-05_EB, &
    8.840407E-05_EB,  &
    4.604619E-06_EB, 2.819335E-06_EB, 1.229091E-05_EB, 2.699249E-05_EB, 5.577876E-05_EB, 1.380746E-04_EB, &
    1.766386E-04_EB,  &
    3.569371E-05_EB, 1.152942E-04_EB, 1.780076E-04_EB, 3.039172E-04_EB, 5.829793E-04_EB, 1.158846E-03_EB, &
    2.828933E-04_EB,  &
    1.546542E-03_EB, 2.761958E-03_EB, 2.970040E-03_EB, 3.593207E-03_EB, 4.284481E-03_EB, 3.630437E-03_EB, &
    9.070206E-04_EB,  &
    4.463819E-02_EB, 2.359087E-02_EB, 1.631236E-02_EB, 1.461174E-02_EB, 1.137484E-02_EB, 5.167704E-03_EB, &
    1.010433E-03_EB/),(/7,8/))

GAMMAD1_CH3OH(1:7,9:14) = RESHAPE((/ &  ! 1025-1150 cm-1
    7.292624E-02_EB, 2.750911E-02_EB, 1.877271E-02_EB, 1.644103E-02_EB, 1.333107E-02_EB, 6.525798E-03_EB, &
    1.394302E-03_EB,  &
    1.294076E-01_EB, 3.822564E-02_EB, 2.402923E-02_EB, 2.053807E-02_EB, 1.580413E-02_EB, 8.046901E-03_EB, &
    1.536893E-03_EB,  &
    1.033643E-02_EB, 1.072580E-02_EB, 9.430472E-03_EB, 9.525708E-03_EB, 9.158283E-03_EB, 4.982336E-03_EB, &
    1.512285E-03_EB,  &
    1.124880E-04_EB, 7.840612E-05_EB, 8.000357E-05_EB, 9.476624E-05_EB, 1.116610E-04_EB, 2.005898E-04_EB, &
    2.211777E-04_EB,  &
    1.768503E-05_EB, 1.181434E-05_EB, 9.478284E-06_EB, 9.556177E-06_EB, 1.057809E-05_EB, 1.129983E-05_EB, &
    3.217772E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_CH3OH(N_TEMP_CH3OH,24)) 

! BAND #2: 1125 cm-1 - 1700 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 31.9183 % 
! GAMMA_D: 38.7237 % 

SD2_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 1125-1300 cm-1
    9.553178E-02_EB, 5.578951E-02_EB, 4.824322E-02_EB, 2.582691E-01_EB, 1.993446E-02_EB, 4.930136E-01_EB, &
    4.432337E-02_EB,  &
    1.730400E-01_EB, 9.308205E-02_EB, 9.823349E-02_EB, 7.596136E-02_EB, 3.604804E-02_EB, 1.004966E-01_EB, &
    3.108820E-01_EB,  &
    1.482325E-01_EB, 1.217422E-01_EB, 1.244871E-01_EB, 2.070520E-01_EB, 3.590929E-01_EB, 2.152647E-01_EB, &
    8.752994E-01_EB,  &
    2.250588E-01_EB, 2.054244E-01_EB, 2.071260E-01_EB, 2.499514E-01_EB, 1.482084E-01_EB, 1.985596E-01_EB, &
    3.258538E-01_EB,  &
    2.932056E-01_EB, 2.512922E-01_EB, 2.416106E-01_EB, 2.837194E-01_EB, 1.628932E-01_EB, 2.122613E-01_EB, &
    2.715037E-01_EB,  &
    3.581325E-01_EB, 3.095124E-01_EB, 2.986022E-01_EB, 3.299177E-01_EB, 1.769074E-01_EB, 2.571572E-01_EB, &
    3.097938E-01_EB,  &
    3.970191E-01_EB, 3.468038E-01_EB, 3.310259E-01_EB, 3.719361E-01_EB, 1.961521E-01_EB, 2.616668E-01_EB, &
    2.915744E-01_EB,  &
    5.905043E-01_EB, 4.033104E-01_EB, 3.526749E-01_EB, 3.546580E-01_EB, 1.865182E-01_EB, 2.611766E-01_EB, &
    4.242552E-01_EB/),(/7,8/))

SD2_CH3OH(1:7,9:16) = RESHAPE((/ &  ! 1325-1500 cm-1
    7.920356E-01_EB, 4.851310E-01_EB, 4.118573E-01_EB, 3.876370E-01_EB, 1.887580E-01_EB, 2.198912E-01_EB, &
    3.328420E-02_EB,  &
    8.760769E-01_EB, 5.481011E-01_EB, 4.572671E-01_EB, 4.255866E-01_EB, 2.005837E-01_EB, 2.236060E-01_EB, &
    1.899308E-02_EB,  &
    7.190145E-01_EB, 4.921213E-01_EB, 4.150818E-01_EB, 4.032193E-01_EB, 1.887592E-01_EB, 1.797961E-01_EB, &
    1.382513E-01_EB,  &
    5.572673E-01_EB, 4.035528E-01_EB, 3.494781E-01_EB, 3.336825E-01_EB, 1.708170E-01_EB, 1.755448E-01_EB, &
    5.097550E-01_EB,  &
    4.741543E-01_EB, 3.024065E-01_EB, 2.484457E-01_EB, 2.511903E-01_EB, 1.341481E-01_EB, 1.598097E-01_EB, &
    3.279684E-01_EB,  &
    4.313340E-01_EB, 2.897512E-01_EB, 2.391541E-01_EB, 2.354898E-01_EB, 1.310023E-01_EB, 1.604567E-01_EB, &
    2.048890E-01_EB,  &
    4.463121E-01_EB, 2.828314E-01_EB, 2.254597E-01_EB, 2.191827E-01_EB, 1.187635E-01_EB, 1.136219E-01_EB, &
    1.083582E-02_EB,  &
    3.683692E-01_EB, 1.808298E-01_EB, 1.406050E-01_EB, 1.566797E-01_EB, 1.128260E-01_EB, 1.186903E-01_EB, &
    1.257192E-01_EB/),(/7,8/))

SD2_CH3OH(1:7,17:24) = RESHAPE((/ &  ! 1525-1700 cm-1
    2.863606E-01_EB, 1.495186E-01_EB, 1.184145E-01_EB, 1.376622E-01_EB, 1.095647E-01_EB, 4.289686E-02_EB, &
    1.275777E-01_EB,  &
    4.420390E-01_EB, 9.288312E-02_EB, 6.761917E-02_EB, 1.343514E+01_EB, 2.574148E-02_EB, 1.462481E-02_EB, &
    3.000645E-02_EB,  &
    8.251740E-02_EB, 1.167393E-01_EB, 8.630829E-02_EB, 7.657557E-02_EB, 5.352816E-02_EB, 3.303913E-02_EB, &
    1.633236E-02_EB,  &
    1.428555E-02_EB, 1.022935E-01_EB, 8.299424E-02_EB, 3.877862E-02_EB, 3.813063E-02_EB, 5.946507E-02_EB, &
    1.136108E-01_EB,  &
    3.000183E-03_EB, 5.554352E-02_EB, 4.437872E-02_EB, 2.367561E-02_EB, 3.105481E-02_EB, 5.656542E-03_EB, &
    1.416351E-02_EB,  &
    7.993734E-04_EB, 5.878204E-03_EB, 7.248798E-03_EB, 2.275428E-03_EB, 6.299048E-02_EB, 1.238284E-05_EB, &
    4.049331E-03_EB,  &
    1.838307E-04_EB, 8.390670E-05_EB, 2.390127E-04_EB, 2.709989E-05_EB, 6.007901E-03_EB, 5.338105E-05_EB, &
    1.154741E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,8/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_CH3OH(N_TEMP_CH3OH,24)) 

! BAND #2: 1125 cm-1 - 1700 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 31.9183 % 
! GAMMA_D: 38.7237 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 1125-1300 cm-1
    1.122616E-05_EB, 7.347835E-06_EB, 6.849671E-06_EB, 8.667523E-06_EB, 1.123979E-05_EB, 1.671610E-05_EB, &
    1.615341E-05_EB,  &
    2.837013E-05_EB, 2.017932E-05_EB, 2.324218E-05_EB, 1.831392E-05_EB, 2.791094E-05_EB, 6.283092E-05_EB, &
    5.178217E-05_EB,  &
    2.560040E-05_EB, 3.364197E-05_EB, 3.870098E-05_EB, 4.491552E-05_EB, 6.569532E-05_EB, 1.125735E-04_EB, &
    1.285986E-04_EB,  &
    8.071151E-05_EB, 9.808412E-05_EB, 1.000477E-04_EB, 1.036941E-04_EB, 1.349921E-04_EB, 9.510294E-05_EB, &
    1.790742E-04_EB,  &
    1.348360E-04_EB, 1.413515E-04_EB, 1.313790E-04_EB, 1.337021E-04_EB, 1.728383E-04_EB, 1.199363E-04_EB, &
    2.609414E-04_EB,  &
    2.131460E-04_EB, 2.109018E-04_EB, 1.947606E-04_EB, 1.936419E-04_EB, 2.363096E-04_EB, 1.370602E-04_EB, &
    2.644426E-04_EB,  &
    2.767840E-04_EB, 2.655371E-04_EB, 2.420102E-04_EB, 2.510624E-04_EB, 3.074505E-04_EB, 1.883549E-04_EB, &
    2.827066E-04_EB,  &
    6.340916E-04_EB, 3.559546E-04_EB, 2.747394E-04_EB, 2.478024E-04_EB, 2.795447E-04_EB, 1.743122E-04_EB, &
    2.276122E-04_EB/),(/7,8/))

GAMMAD2_CH3OH(1:7,9:16) = RESHAPE((/ &  ! 1325-1500 cm-1
    1.182337E-03_EB, 5.100226E-04_EB, 3.630868E-04_EB, 2.898656E-04_EB, 2.834600E-04_EB, 1.363786E-04_EB, &
    1.313242E-04_EB,  &
    1.424556E-03_EB, 6.490110E-04_EB, 4.504111E-04_EB, 3.536685E-04_EB, 3.336199E-04_EB, 1.345578E-04_EB, &
    9.563212E-05_EB,  &
    9.279469E-04_EB, 5.219391E-04_EB, 3.806273E-04_EB, 3.062133E-04_EB, 2.943263E-04_EB, 1.026225E-04_EB, &
    7.600047E-05_EB,  &
    5.489453E-04_EB, 3.503111E-04_EB, 2.708601E-04_EB, 2.105084E-04_EB, 2.212699E-04_EB, 7.578907E-05_EB, &
    5.588413E-05_EB,  &
    3.845631E-04_EB, 2.055417E-04_EB, 1.457959E-04_EB, 1.145979E-04_EB, 1.260519E-04_EB, 8.725918E-05_EB, &
    2.552363E-05_EB,  &
    3.093736E-04_EB, 1.766911E-04_EB, 1.353095E-04_EB, 1.052527E-04_EB, 1.232668E-04_EB, 9.897909E-05_EB, &
    8.092462E-05_EB,  &
    3.188447E-04_EB, 1.687109E-04_EB, 1.168446E-04_EB, 9.016669E-05_EB, 1.030200E-04_EB, 6.834642E-05_EB, &
    5.399346E-05_EB,  &
    1.446790E-04_EB, 6.757001E-05_EB, 4.782782E-05_EB, 3.826841E-05_EB, 5.217945E-05_EB, 2.834423E-05_EB, &
    7.159255E-05_EB/),(/7,8/))

GAMMAD2_CH3OH(1:7,17:24) = RESHAPE((/ &  ! 1525-1700 cm-1
    9.426024E-05_EB, 4.835279E-05_EB, 3.385591E-05_EB, 2.653130E-05_EB, 3.666594E-05_EB, 1.278091E-05_EB, &
    4.859977E-05_EB,  &
    3.254808E-05_EB, 1.699079E-05_EB, 1.253117E-05_EB, 1.108842E-05_EB, 1.468058E-05_EB, 2.274033E-06_EB, &
    8.565696E-06_EB,  &
    9.734215E-06_EB, 2.412349E-05_EB, 1.613252E-05_EB, 1.144648E-05_EB, 1.905187E-05_EB, 3.225728E-06_EB, &
    3.796418E-06_EB,  &
    2.258168E-06_EB, 1.854317E-05_EB, 1.202693E-05_EB, 5.261252E-06_EB, 1.251103E-05_EB, 9.724359E-06_EB, &
    1.169413E-05_EB,  &
    2.366736E-07_EB, 5.464688E-06_EB, 3.432234E-06_EB, 1.538834E-06_EB, 4.903107E-06_EB, 2.710469E-07_EB, &
    9.045370E-07_EB,  &
    1.584211E-09_EB, 8.214051E-08_EB, 6.282665E-08_EB, 2.230988E-08_EB, 1.099670E-06_EB, 2.456247E-11_EB, &
    4.445699E-07_EB,  &
    3.010677E-10_EB, 2.342505E-10_EB, 8.867137E-11_EB, 9.078205E-11_EB, 3.104256E-07_EB, 2.865656E-10_EB, &
    3.195104E-08_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,8/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_CH3OH(N_TEMP_CH3OH,26)) 

! BAND #3: 2600 cm-1 - 3225 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 6.7758 % 
! GAMMA_D: 31.9367 % 

SD3_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 2600-2775 cm-1
    1.424836E-03_EB, 8.984741E-05_EB, 8.929512E-05_EB, 4.192359E-04_EB, 9.638566E-05_EB, 6.639504E-05_EB, &
    1.187250E-05_EB,  &
    1.981487E-04_EB, 1.816856E-04_EB, 2.069933E-04_EB, 2.556095E-04_EB, 1.600538E-04_EB, 2.023937E-04_EB, &
    2.604460E-02_EB,  &
    1.184042E-04_EB, 6.128530E-04_EB, 7.444412E-04_EB, 1.823249E-04_EB, 5.074434E-04_EB, 3.811236E-03_EB, &
    2.782142E-02_EB,  &
    4.275246E-04_EB, 9.409137E-05_EB, 1.724565E-02_EB, 2.116903E-04_EB, 2.291120E-03_EB, 8.402696E-03_EB, &
    1.618071E-02_EB,  &
    6.890107E-04_EB, 9.040522E-04_EB, 1.578102E-03_EB, 8.129624E-04_EB, 1.454252E-03_EB, 3.523116E-02_EB, &
    3.699139E-02_EB,  &
    8.371305E-03_EB, 5.993374E-03_EB, 1.877069E-02_EB, 1.780616E-02_EB, 7.981108E-03_EB, 3.514211E-01_EB, &
    5.953055E-02_EB,  &
    6.523348E-02_EB, 3.910369E-02_EB, 4.724073E-02_EB, 5.986466E-02_EB, 3.240939E-02_EB, 2.328077E-01_EB, &
    6.292928E-02_EB,  &
    1.498667E-01_EB, 1.395963E-01_EB, 1.425858E-01_EB, 1.653385E-01_EB, 8.708205E-02_EB, 3.305077E-01_EB, &
    8.211679E-02_EB/),(/7,8/))

SD3_CH3OH(1:7,9:16) = RESHAPE((/ &  ! 2800-2975 cm-1
    5.497138E-01_EB, 4.889250E-01_EB, 4.602175E-01_EB, 4.788975E-01_EB, 2.130693E-01_EB, 4.947067E-01_EB, &
    9.627226E-02_EB,  &
    1.380956E+00_EB, 9.340963E-01_EB, 7.925702E-01_EB, 7.481279E-01_EB, 3.004446E-01_EB, 5.608775E-01_EB, &
    1.113129E-01_EB,  &
    1.771766E+00_EB, 1.154030E+00_EB, 9.748272E-01_EB, 9.218501E-01_EB, 3.680244E-01_EB, 6.316300E-01_EB, &
    1.240816E-01_EB,  &
    2.030763E+00_EB, 1.487109E+00_EB, 1.268101E+00_EB, 1.229638E+00_EB, 4.922786E-01_EB, 8.449980E-01_EB, &
    1.221861E-01_EB,  &
    2.039131E+00_EB, 1.510237E+00_EB, 1.316029E+00_EB, 1.304140E+00_EB, 5.373243E-01_EB, 9.394210E-01_EB, &
    1.237753E-01_EB,  &
    3.249644E+00_EB, 2.145661E+00_EB, 1.781124E+00_EB, 1.699627E+00_EB, 6.529373E-01_EB, 1.002001E+00_EB, &
    1.055988E-01_EB,  &
    3.558351E+00_EB, 2.246460E+00_EB, 1.855586E+00_EB, 1.739840E+00_EB, 6.637361E-01_EB, 9.706013E-01_EB, &
    1.138271E-01_EB,  &
    3.701592E+00_EB, 2.396731E+00_EB, 1.980053E+00_EB, 1.856516E+00_EB, 7.066435E-01_EB, 1.031082E+00_EB, &
    1.193371E-01_EB/),(/7,8/))

SD3_CH3OH(1:7,17:24) = RESHAPE((/ &  ! 3000-3175 cm-1
    2.334210E+00_EB, 1.640727E+00_EB, 1.427505E+00_EB, 1.355477E+00_EB, 5.412247E-01_EB, 8.428918E-01_EB, &
    9.355752E-02_EB,  &
    1.423926E+00_EB, 1.054645E+00_EB, 9.174147E-01_EB, 8.714307E-01_EB, 3.613690E-01_EB, 5.958454E-01_EB, &
    6.064380E-02_EB,  &
    6.680308E-01_EB, 5.941660E-01_EB, 5.425640E-01_EB, 5.304965E-01_EB, 2.256969E-01_EB, 3.955811E-01_EB, &
    5.953625E-02_EB,  &
    2.528265E-01_EB, 2.833198E-01_EB, 2.735958E-01_EB, 2.758215E-01_EB, 1.290188E-01_EB, 2.544834E-01_EB, &
    3.883561E-02_EB,  &
    5.682158E-02_EB, 1.033193E-01_EB, 1.133569E-01_EB, 1.108822E-01_EB, 5.838640E-02_EB, 1.922860E-01_EB, &
    2.132383E-02_EB,  &
    1.245110E-02_EB, 2.044452E-02_EB, 5.648607E-02_EB, 2.152521E-02_EB, 2.080130E-02_EB, 3.795750E-02_EB, &
    2.209393E-03_EB,  &
    2.606449E-03_EB, 5.913180E-04_EB, 2.458845E-03_EB, 6.900341E-04_EB, 3.326648E-03_EB, 2.963759E-03_EB, &
    2.724491E-02_EB,  &
    1.624337E-04_EB, 7.175142E-05_EB, 2.599574E-04_EB, 4.876706E-04_EB, 4.449658E-04_EB, 1.220753E-03_EB, &
    3.689314E-02_EB/),(/7,8/))

SD3_CH3OH(1:7,25:26) = RESHAPE((/ &  ! 3200-3225 cm-1
    2.338395E-06_EB, 7.446614E-05_EB, 1.552569E-04_EB, 3.883726E-04_EB, 5.763418E-05_EB, 7.514595E-05_EB, &
    1.652283E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_CH3OH(N_TEMP_CH3OH,26)) 

! BAND #3: 2600 cm-1 - 3225 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 6.7758 % 
! GAMMA_D: 31.9367 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 2600-2775 cm-1
    3.154414E-10_EB, 1.139062E-10_EB, 2.397572E-10_EB, 5.931327E-10_EB, 1.363867E-10_EB, 1.097454E-10_EB, &
    6.061780E-13_EB,  &
    1.449751E-09_EB, 1.045854E-09_EB, 1.490264E-09_EB, 1.541026E-09_EB, 1.577024E-09_EB, 1.266547E-09_EB, &
    2.657266E-06_EB,  &
    7.734699E-10_EB, 7.614595E-10_EB, 1.476924E-09_EB, 7.321508E-10_EB, 1.197842E-09_EB, 3.867229E-08_EB, &
    4.172849E-06_EB,  &
    1.274160E-09_EB, 7.754832E-10_EB, 1.702402E-09_EB, 1.338421E-09_EB, 4.491959E-10_EB, 5.935370E-07_EB, &
    1.122319E-05_EB,  &
    1.164936E-09_EB, 4.922137E-10_EB, 2.384609E-08_EB, 7.156592E-09_EB, 4.971770E-08_EB, 5.451357E-06_EB, &
    3.371501E-05_EB,  &
    1.791852E-07_EB, 1.676412E-07_EB, 7.462075E-07_EB, 4.092049E-07_EB, 9.176180E-07_EB, 3.003909E-05_EB, &
    8.334492E-05_EB,  &
    8.296067E-06_EB, 4.742770E-06_EB, 6.729095E-06_EB, 6.233506E-06_EB, 1.090043E-05_EB, 7.465159E-05_EB, &
    1.073835E-04_EB,  &
    5.368432E-05_EB, 4.715249E-05_EB, 4.928543E-05_EB, 5.672093E-05_EB, 7.820141E-05_EB, 2.068903E-04_EB, &
    1.602490E-04_EB/),(/7,8/))

GAMMAD3_CH3OH(1:7,9:16) = RESHAPE((/ &  ! 2800-2975 cm-1
    6.195573E-04_EB, 5.276379E-04_EB, 4.635172E-04_EB, 4.717430E-04_EB, 4.689755E-04_EB, 5.250503E-04_EB, &
    2.459887E-04_EB,  &
    3.938313E-03_EB, 1.890533E-03_EB, 1.350804E-03_EB, 1.162612E-03_EB, 9.262115E-04_EB, 7.072021E-04_EB, &
    3.145155E-04_EB,  &
    6.460824E-03_EB, 2.878806E-03_EB, 2.027075E-03_EB, 1.748880E-03_EB, 1.392084E-03_EB, 8.935631E-04_EB, &
    3.637133E-04_EB,  &
    8.767959E-03_EB, 4.783143E-03_EB, 3.477699E-03_EB, 3.132097E-03_EB, 2.526867E-03_EB, 1.553328E-03_EB, &
    4.821426E-04_EB,  &
    8.748420E-03_EB, 4.913445E-03_EB, 3.734400E-03_EB, 3.483590E-03_EB, 3.029614E-03_EB, 1.925108E-03_EB, &
    5.619726E-04_EB,  &
    2.450061E-02_EB, 1.029868E-02_EB, 6.958678E-03_EB, 6.012827E-03_EB, 4.545339E-03_EB, 2.196035E-03_EB, &
    5.060871E-04_EB,  &
    3.028399E-02_EB, 1.146506E-02_EB, 7.535754E-03_EB, 6.347086E-03_EB, 4.689240E-03_EB, 2.118693E-03_EB, &
    4.704564E-04_EB,  &
    3.357075E-02_EB, 1.320899E-02_EB, 8.696300E-03_EB, 7.326688E-03_EB, 5.358107E-03_EB, 2.325462E-03_EB, &
    4.693358E-04_EB/),(/7,8/))

GAMMAD3_CH3OH(1:7,17:24) = RESHAPE((/ &  ! 3000-3175 cm-1
    1.193707E-02_EB, 5.893357E-03_EB, 4.332179E-03_EB, 3.823523E-03_EB, 3.078855E-03_EB, 1.532756E-03_EB, &
    4.038445E-04_EB,  &
    4.142955E-03_EB, 2.325250E-03_EB, 1.748013E-03_EB, 1.582463E-03_EB, 1.333448E-03_EB, 7.223584E-04_EB, &
    1.098399E-04_EB,  &
    9.056046E-04_EB, 7.080209E-04_EB, 5.970507E-04_EB, 5.773622E-04_EB, 5.222673E-04_EB, 3.125689E-04_EB, &
    9.715108E-05_EB,  &
    1.386948E-04_EB, 1.514944E-04_EB, 1.537099E-04_EB, 1.581839E-04_EB, 1.717770E-04_EB, 1.159149E-04_EB, &
    3.793160E-05_EB,  &
    9.823558E-06_EB, 1.715227E-05_EB, 2.486216E-05_EB, 2.671530E-05_EB, 3.805703E-05_EB, 3.430519E-05_EB, &
    1.889208E-05_EB,  &
    1.315774E-06_EB, 4.053631E-07_EB, 3.250838E-06_EB, 1.533134E-06_EB, 5.335099E-06_EB, 6.864336E-06_EB, &
    3.476629E-06_EB,  &
    4.554347E-08_EB, 8.721610E-09_EB, 1.276834E-07_EB, 9.958207E-09_EB, 2.978216E-07_EB, 1.880925E-07_EB, &
    2.273255E-06_EB,  &
    1.256398E-09_EB, 5.965841E-10_EB, 3.692862E-09_EB, 1.213027E-09_EB, 2.621284E-08_EB, 1.202310E-08_EB, &
    1.825653E-08_EB/),(/7,8/))

GAMMAD3_CH3OH(1:7,25:26) = RESHAPE((/ &  ! 3200-3225 cm-1
    1.702721E-10_EB, 7.792111E-11_EB, 3.241685E-10_EB, 5.304963E-10_EB, 2.641979E-10_EB, 8.000992E-11_EB, &
    1.643905E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #4: 3525 cm-1 - 3850 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 8.4009 % 
! GAMMA_D: 31.2432 % 

SD4_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 3525-3700 cm-1
    4.835148E-04_EB, 8.726244E-05_EB, 1.262016E-04_EB, 1.030730E-04_EB, 1.682706E-04_EB, 3.752625E-05_EB, &
    6.496012E-05_EB,  &
    5.227284E-04_EB, 4.423438E-03_EB, 2.751063E-03_EB, 2.290449E-03_EB, 2.786463E-04_EB, 1.642574E-04_EB, &
    4.204390E-03_EB,  &
    6.747272E-03_EB, 3.431220E-02_EB, 2.879176E-02_EB, 1.968090E-02_EB, 9.428462E-03_EB, 9.050074E-03_EB, &
    6.330011E-03_EB,  &
    2.768331E-02_EB, 5.675963E-02_EB, 4.749470E-02_EB, 5.906393E-02_EB, 2.457648E-02_EB, 1.866569E-02_EB, &
    1.857718E-02_EB,  &
    1.892822E-01_EB, 1.786866E-01_EB, 1.619923E-01_EB, 1.997604E-01_EB, 7.772765E-02_EB, 1.691578E-01_EB, &
    2.310846E-02_EB,  &
    7.102286E-01_EB, 4.906453E-01_EB, 4.087452E-01_EB, 4.127070E-01_EB, 1.472082E-01_EB, 2.421792E-01_EB, &
    1.461746E-02_EB,  &
    9.899633E-01_EB, 5.620635E-01_EB, 4.429768E-01_EB, 4.167648E-01_EB, 1.385594E-01_EB, 2.243564E-01_EB, &
    1.091122E-02_EB,  &
    1.050782E+00_EB, 5.887425E-01_EB, 4.367059E-01_EB, 4.099024E-01_EB, 1.396374E-01_EB, 2.109750E-01_EB, &
    1.384771E-02_EB/),(/7,8/))

SD4_CH3OH(1:7,9:14) = RESHAPE((/ &  ! 3725-3850 cm-1
    6.427705E-01_EB, 4.682507E-01_EB, 3.747881E-01_EB, 3.612236E-01_EB, 1.378153E-01_EB, 2.338225E-01_EB, &
    2.388521E-02_EB,  &
    1.567158E-01_EB, 1.099319E-01_EB, 9.557276E-02_EB, 1.143061E-01_EB, 4.174081E-02_EB, 2.111631E-01_EB, &
    7.558020E-03_EB,  &
    6.430236E-02_EB, 6.060440E-02_EB, 4.527944E-02_EB, 2.075547E-02_EB, 9.412989E-03_EB, 6.013544E-02_EB, &
    1.342467E-02_EB,  &
    7.277826E-03_EB, 5.135216E-02_EB, 8.619195E-03_EB, 3.860951E-03_EB, 6.994989E-04_EB, 1.503898E-02_EB, &
    8.591091E-03_EB,  &
    5.170900E-05_EB, 5.298799E-03_EB, 1.358628E-03_EB, 3.588424E-05_EB, 1.106705E-04_EB, 6.962133E-05_EB, &
    1.316189E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_CH3OH(N_TEMP_CH3OH,14)) 

! BAND #4: 3525 cm-1 - 3850 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 8.4009 % 
! GAMMA_D: 31.2432 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_CH3OH(1:7,1:8) = RESHAPE((/ &  ! 3525-3700 cm-1
    3.375941E-10_EB, 9.634153E-11_EB, 1.640669E-10_EB, 2.848862E-10_EB, 2.102381E-10_EB, 4.134052E-10_EB, &
    1.811656E-10_EB,  &
    1.095814E-09_EB, 1.143046E-07_EB, 9.990985E-09_EB, 7.987331E-08_EB, 2.292736E-09_EB, 1.192244E-09_EB, &
    1.244202E-06_EB,  &
    4.065907E-07_EB, 1.859718E-06_EB, 1.297388E-06_EB, 1.387595E-06_EB, 9.928953E-07_EB, 7.690790E-07_EB, &
    1.276701E-06_EB,  &
    4.444007E-06_EB, 6.092877E-06_EB, 5.810652E-06_EB, 5.712834E-06_EB, 6.498219E-06_EB, 3.452436E-06_EB, &
    8.416439E-06_EB,  &
    9.072061E-05_EB, 8.278037E-05_EB, 6.474707E-05_EB, 7.434282E-05_EB, 6.699863E-05_EB, 4.303852E-05_EB, &
    1.375198E-05_EB,  &
    1.051459E-03_EB, 5.482154E-04_EB, 3.706041E-04_EB, 3.269895E-04_EB, 2.306138E-04_EB, 9.066623E-05_EB, &
    6.841886E-06_EB,  &
    1.996091E-03_EB, 7.041694E-04_EB, 4.280474E-04_EB, 3.317207E-04_EB, 2.074392E-04_EB, 6.887229E-05_EB, &
    3.665001E-06_EB,  &
    2.198081E-03_EB, 7.644876E-04_EB, 4.303094E-04_EB, 3.461098E-04_EB, 2.158438E-04_EB, 8.166676E-05_EB, &
    1.319686E-05_EB/),(/7,8/))

GAMMAD4_CH3OH(1:7,9:14) = RESHAPE((/ &  ! 3725-3850 cm-1
    8.155113E-04_EB, 4.902572E-04_EB, 3.242887E-04_EB, 2.812119E-04_EB, 2.042089E-04_EB, 1.022909E-04_EB, &
    3.065092E-05_EB,  &
    4.155704E-05_EB, 2.769167E-05_EB, 2.319474E-05_EB, 2.483828E-05_EB, 1.984770E-05_EB, 6.177502E-06_EB, &
    3.045721E-06_EB,  &
    2.418019E-06_EB, 8.683982E-06_EB, 5.237283E-06_EB, 1.384776E-06_EB, 1.627842E-06_EB, 4.640915E-06_EB, &
    1.864854E-06_EB,  &
    5.813641E-08_EB, 1.687768E-06_EB, 4.922783E-07_EB, 4.140965E-09_EB, 7.458301E-09_EB, 4.591636E-07_EB, &
    4.086338E-07_EB,  &
    4.449005E-10_EB, 1.949027E-08_EB, 1.197429E-08_EB, 1.888048E-10_EB, 2.697931E-10_EB, 2.470335E-10_EB, &
    6.048009E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!-------------------------Propylene DATA-------------------


! THERE ARE 3 BANDS FOR Propylene

! BAND #1: 775 cm-1 - 1150 cm-1 
! BAND #2: 1225 cm-1 - 1975 cm-1 
! BAND #3: 2650 cm-1 - 3275 cm-1 

N_TEMP_C3H6 = 7
N_BAND_C3H6 = 3
I_MODEL_C3H6 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C3H6_TEMP(N_TEMP_C3H6)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Propylene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C3H6(N_BAND_C3H6,3)) 
ALLOCATE(Be_C3H6(N_BAND_C3H6)) 

OM_BND_C3H6 = RESHAPE((/ &
    775._EB, 1225._EB, 2650._EB, &
    1150._EB, 1975._EB, 3275._EB, &
     25._EB, 25._EB, 25._EB/),(/N_BAND_C3H6,3/)) 

SD_C3H6_TEMP = (/ &
    296._EB, 390._EB, 444._EB, 491._EB, 594._EB, 793._EB,&
    1003._EB/)

Be_C3H6 = (/ &
    0.100_EB, 0.100_EB, 3.000_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C3H6(N_TEMP_C3H6,16)) 

! BAND #1: 775 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 2.5057 % 
! GAMMA_D: 28.7708 % 

SD1_C3H6(1:7,1:8) = RESHAPE((/ &  ! 775-950 cm-1
    1.056295E-04_EB, 0.000000E+00_EB, 1.764299E-05_EB, 0.000000E+00_EB, 7.082143E-05_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    4.887510E-03_EB, 4.296639E-03_EB, 3.286482E-03_EB, 4.832033E-02_EB, 2.041421E-02_EB, 1.134284E-03_EB, &
    0.000000E+00_EB,  &
    1.354215E-01_EB, 5.571905E-02_EB, 2.940229E-02_EB, 8.005389E-02_EB, 1.538990E-01_EB, 6.686531E-02_EB, &
    3.915453E-03_EB,  &
    3.052457E-01_EB, 3.116249E-01_EB, 2.668749E-01_EB, 2.877923E-01_EB, 3.446763E-01_EB, 2.047249E-01_EB, &
    1.010898E-01_EB,  &
    1.112889E+00_EB, 8.450760E-01_EB, 6.810604E-01_EB, 6.766826E-01_EB, 6.370458E-01_EB, 3.904064E-01_EB, &
    1.873521E-01_EB,  &
    2.477056E+00_EB, 1.719044E+00_EB, 1.399558E+00_EB, 1.257890E+00_EB, 1.078521E+00_EB, 6.930191E-01_EB, &
    5.050796E-01_EB,  &
    2.607120E+00_EB, 1.786832E+00_EB, 1.473590E+00_EB, 1.340248E+00_EB, 1.161226E+00_EB, 7.642752E-01_EB, &
    4.267078E-01_EB,  &
    1.939265E+00_EB, 1.505653E+00_EB, 1.298297E+00_EB, 1.157815E+00_EB, 1.016260E+00_EB, 6.905688E-01_EB, &
    3.961726E-01_EB/),(/7,8/))

SD1_C3H6(1:7,9:16) = RESHAPE((/ &  ! 975-1150 cm-1
    1.156342E+00_EB, 9.379664E-01_EB, 8.267360E-01_EB, 7.955839E-01_EB, 7.902406E-01_EB, 6.076031E-01_EB, &
    3.933136E-01_EB,  &
    1.124976E+00_EB, 8.166715E-01_EB, 7.147821E-01_EB, 6.322279E-01_EB, 5.787489E-01_EB, 4.121470E-01_EB, &
    2.808484E-01_EB,  &
    5.655768E-01_EB, 4.213983E-01_EB, 3.609152E-01_EB, 3.316834E-01_EB, 3.245606E-01_EB, 2.298703E-01_EB, &
    1.468637E-01_EB,  &
    2.707420E-01_EB, 2.019663E-01_EB, 2.109277E-01_EB, 1.668047E-01_EB, 1.765172E-01_EB, 1.234592E-01_EB, &
    7.061813E-02_EB,  &
    1.025547E-01_EB, 7.285495E-02_EB, 6.126040E-02_EB, 4.382119E-02_EB, 7.188834E-02_EB, 4.494723E-02_EB, &
    6.601131E-03_EB,  &
    3.625058E-02_EB, 1.169259E-02_EB, 7.162550E-03_EB, 6.634588E-03_EB, 1.046246E-02_EB, 4.464870E-02_EB, &
    2.684472E-05_EB,  &
    6.809310E-05_EB, 1.882549E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    1.078035E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,8/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C3H6(N_TEMP_C3H6,16)) 

! BAND #1: 775 cm-1 - 1150 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 2.5057 % 
! GAMMA_D: 28.7708 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C3H6(1:7,1:8) = RESHAPE((/ &  ! 775-950 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.450451E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.423625E-04_EB, 1.362543E-04_EB, 0.000000E+00_EB, 1.907902E-05_EB, 5.492805E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    3.658834E-03_EB, 1.366553E-02_EB, 0.000000E+00_EB, 1.340223E-02_EB, 1.307566E-02_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    6.584528E-02_EB, 1.213946E-01_EB, 1.975603E-01_EB, 3.093303E-01_EB, 5.908566E-02_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    3.192282E-01_EB, 4.128584E-01_EB, 3.187308E-01_EB, 3.160303E-01_EB, 1.462507E-01_EB, 7.663150E-02_EB, &
    9.853266E-03_EB,  &
    5.092780E-01_EB, 3.631953E-01_EB, 4.376851E-01_EB, 3.462834E-01_EB, 2.399555E-01_EB, 9.817071E-01_EB, &
    8.246598E-02_EB,  &
    9.008924E-01_EB, 5.460185E-01_EB, 7.094343E-01_EB, 4.571736E-01_EB, 2.927754E-01_EB, 8.900048E-01_EB, &
    0.000000E+00_EB,  &
    8.210431E-01_EB, 5.905877E-01_EB, 8.224695E-01_EB, 5.239321E-01_EB, 3.017632E-01_EB, 6.039684E-01_EB, &
    0.000000E+00_EB/),(/7,8/))

GAMMAD1_C3H6(1:7,9:16) = RESHAPE((/ &  ! 975-1150 cm-1
    4.712256E-01_EB, 4.057271E-01_EB, 2.282533E-01_EB, 3.838168E-01_EB, 1.953505E-01_EB, 3.713739E-01_EB, &
    2.718324E+00_EB,  &
    2.798944E-01_EB, 2.663847E-01_EB, 4.927251E-01_EB, 2.661049E-01_EB, 1.556483E-01_EB, 5.344804E-01_EB, &
    3.137949E-01_EB,  &
    1.866021E-01_EB, 1.980836E-01_EB, 9.965600E-02_EB, 2.092561E-01_EB, 8.818032E-02_EB, 4.285993E-02_EB, &
    1.658763E-02_EB,  &
    7.567300E-02_EB, 2.382709E-01_EB, 2.146719E-02_EB, 1.309926E-01_EB, 3.885831E-02_EB, 5.316695E-02_EB, &
    3.235963E-03_EB,  &
    2.221033E-02_EB, 5.537710E-02_EB, 1.283444E-02_EB, 0.000000E+00_EB, 4.774082E-03_EB, 1.359751E-03_EB, &
    0.000000E+00_EB,  &
    1.025993E-03_EB, 4.447411E-04_EB, 6.752033E-04_EB, 0.000000E+00_EB, 1.231543E-03_EB, 1.086238E-03_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 5.575473E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    5.150530E-06_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,8/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C3H6(N_TEMP_C3H6,31)) 

! BAND #2: 1225 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 4.238 % 
! GAMMA_D: 37.3447 % 

SD2_C3H6(1:7,1:8) = RESHAPE((/ &  ! 1225-1400 cm-1
    2.360164E-04_EB, 6.269300E-05_EB, 0.000000E+00_EB, 1.260271E-04_EB, 1.971116E-05_EB, 4.361180E-05_EB, &
    0.000000E+00_EB,  &
    7.466542E-04_EB, 0.000000E+00_EB, 1.291182E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    6.516672E-04_EB,  &
    2.123010E-04_EB, 4.278021E-03_EB, 0.000000E+00_EB, 2.712369E-03_EB, 2.818269E-03_EB, 0.000000E+00_EB, &
    3.349143E-02_EB,  &
    4.012349E-04_EB, 1.681589E-02_EB, 2.902042E-02_EB, 1.960532E-02_EB, 1.638604E-02_EB, 0.000000E+00_EB, &
    7.107280E-02_EB,  &
    1.806634E-03_EB, 3.076359E-02_EB, 6.294341E-02_EB, 3.835506E-02_EB, 4.128930E-02_EB, 2.958790E-01_EB, &
    2.704416E-02_EB,  &
    5.817535E-02_EB, 7.334141E-02_EB, 9.875896E-02_EB, 8.410636E-02_EB, 8.119729E-02_EB, 1.058865E-01_EB, &
    5.812279E-02_EB,  &
    2.722080E-01_EB, 2.015540E-01_EB, 2.177853E-01_EB, 1.889529E-01_EB, 1.700019E-01_EB, 1.818375E-01_EB, &
    9.466300E-02_EB,  &
    5.379875E-01_EB, 3.952984E-01_EB, 3.617157E-01_EB, 3.166689E-01_EB, 2.627306E-01_EB, 2.214020E-01_EB, &
    1.120211E-01_EB/),(/7,8/))

SD2_C3H6(1:7,9:16) = RESHAPE((/ &  ! 1425-1600 cm-1
    7.210526E-01_EB, 4.843527E-01_EB, 4.361844E-01_EB, 3.798323E-01_EB, 3.207397E-01_EB, 2.506141E-01_EB, &
    1.432428E-01_EB,  &
    1.211233E+00_EB, 7.173143E-01_EB, 5.782035E-01_EB, 4.850302E-01_EB, 3.522553E-01_EB, 2.424886E-01_EB, &
    1.495777E-01_EB,  &
    1.059936E+00_EB, 6.247237E-01_EB, 5.187671E-01_EB, 4.230436E-01_EB, 3.135417E-01_EB, 2.381842E-01_EB, &
    1.356455E-01_EB,  &
    4.911393E-01_EB, 3.260847E-01_EB, 2.665276E-01_EB, 2.496638E-01_EB, 2.108804E-01_EB, 1.684065E-01_EB, &
    1.018032E-01_EB,  &
    1.281468E-01_EB, 1.550050E-01_EB, 1.474424E-01_EB, 1.407786E-01_EB, 1.274556E-01_EB, 1.149013E-01_EB, &
    1.167568E-01_EB,  &
    8.392489E-02_EB, 1.007473E-01_EB, 6.716682E-02_EB, 9.743382E-02_EB, 9.893463E-02_EB, 8.132623E-02_EB, &
    9.154479E-02_EB,  &
    4.698677E-02_EB, 1.082904E-01_EB, 1.174579E-01_EB, 1.007790E-01_EB, 1.010066E-01_EB, 1.342846E-01_EB, &
    1.232027E-01_EB,  &
    6.210609E-02_EB, 1.346353E-01_EB, 1.853220E-01_EB, 1.683609E-01_EB, 1.926158E-01_EB, 2.425532E-01_EB, &
    1.739243E-01_EB/),(/7,8/))

SD2_C3H6(1:7,17:24) = RESHAPE((/ &  ! 1625-1800 cm-1
    7.411654E-01_EB, 5.257860E-01_EB, 4.919822E-01_EB, 4.417304E-01_EB, 3.759789E-01_EB, 2.877231E-01_EB, &
    1.993745E-01_EB,  &
    1.151532E+00_EB, 6.713058E-01_EB, 5.439255E-01_EB, 4.760486E-01_EB, 3.805348E-01_EB, 2.621703E-01_EB, &
    1.838587E-01_EB,  &
    7.345120E-01_EB, 4.636866E-01_EB, 4.166856E-01_EB, 3.267320E-01_EB, 2.460455E-01_EB, 1.531683E-01_EB, &
    1.031331E-01_EB,  &
    2.138866E-03_EB, 2.198917E-03_EB, 9.385036E-03_EB, 8.731173E-03_EB, 0.000000E+00_EB, 7.268534E-03_EB, &
    9.752739E-03_EB,  &
    1.433676E-03_EB, 0.000000E+00_EB, 2.917317E-04_EB, 1.139819E-03_EB, 1.161165E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    5.284431E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.412894E-04_EB, 0.000000E+00_EB, 4.109845E-03_EB, &
    8.231426E-04_EB,  &
    4.557723E-03_EB, 1.014344E-02_EB, 8.382680E-03_EB, 1.001383E-02_EB, 2.173539E-02_EB, 1.708541E-02_EB, &
    1.815982E-02_EB,  &
    1.509782E-01_EB, 1.081407E-01_EB, 1.089642E-01_EB, 8.502092E-02_EB, 7.196739E-02_EB, 5.427257E-02_EB, &
    2.256560E-02_EB/),(/7,8/))

SD2_C3H6(1:7,25:31) = RESHAPE((/ &  ! 1825-1975 cm-1
    2.620754E-01_EB, 1.514517E-01_EB, 1.346598E-01_EB, 1.113043E-01_EB, 9.245114E-02_EB, 7.458220E-02_EB, &
    3.068079E-02_EB,  &
    1.844761E-01_EB, 1.336190E-01_EB, 1.315726E-01_EB, 9.916210E-02_EB, 8.105488E-02_EB, 7.197315E-02_EB, &
    3.073972E-02_EB,  &
    5.644622E-02_EB, 3.303405E-02_EB, 3.773622E-02_EB, 2.710835E-02_EB, 2.437935E-02_EB, 3.781856E-02_EB, &
    9.660715E-03_EB,  &
    4.442170E-03_EB, 1.501806E-02_EB, 0.000000E+00_EB, 4.595573E-03_EB, 4.688908E-03_EB, 8.257523E-04_EB, &
    3.609042E-04_EB,  &
    7.439990E-04_EB, 7.880076E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 8.607756E-05_EB, 0.000000E+00_EB, &
    9.283975E-05_EB,  &
    2.556540E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 8.552246E-06_EB, 2.460224E-04_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C3H6(N_TEMP_C3H6,31)) 

! BAND #2: 1225 cm-1 - 1975 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 4.238 % 
! GAMMA_D: 37.3447 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C3H6(1:7,1:8) = RESHAPE((/ &  ! 1225-1400 cm-1
    2.935784E-06_EB, 2.415900E-05_EB, 0.000000E+00_EB, 1.770463E-06_EB, 3.640571E-06_EB, 1.965507E-05_EB, &
    0.000000E+00_EB,  &
    7.537040E-05_EB, 0.000000E+00_EB, 2.199215E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.063048E-02_EB, 0.000000E+00_EB, &
    1.630430E-03_EB,  &
    2.553273E-05_EB, 5.515072E-02_EB, 1.893681E-04_EB, 6.885726E-03_EB, 8.494780E-04_EB, 0.000000E+00_EB, &
    3.148024E-03_EB,  &
    0.000000E+00_EB, 5.525348E-01_EB, 2.496969E-03_EB, 7.229811E-03_EB, 1.747319E-02_EB, 4.358637E-03_EB, &
    1.342118E-02_EB,  &
    1.019103E-02_EB, 7.862902E-02_EB, 1.338479E-02_EB, 4.921304E-02_EB, 1.005242E-01_EB, 5.560369E-02_EB, &
    0.000000E+00_EB,  &
    5.815702E-02_EB, 1.452765E-01_EB, 4.996929E-02_EB, 9.670608E-02_EB, 1.598049E-01_EB, 4.332675E-02_EB, &
    0.000000E+00_EB,  &
    1.357790E-01_EB, 1.921724E-01_EB, 1.251560E-01_EB, 1.627290E-01_EB, 1.523632E-01_EB, 6.986864E-02_EB, &
    0.000000E+00_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,9:16) = RESHAPE((/ &  ! 1425-1600 cm-1
    1.892731E-01_EB, 2.449123E-01_EB, 1.567581E-01_EB, 1.908844E-01_EB, 1.545658E-01_EB, 1.227552E-01_EB, &
    0.000000E+00_EB,  &
    2.973301E-01_EB, 2.781677E-01_EB, 2.300125E-01_EB, 2.135240E-01_EB, 2.034224E-01_EB, 1.012851E-01_EB, &
    0.000000E+00_EB,  &
    2.835681E-01_EB, 2.679548E-01_EB, 1.935637E-01_EB, 2.161997E-01_EB, 1.989986E-01_EB, 8.125746E-02_EB, &
    3.914910E-02_EB,  &
    1.286287E-01_EB, 1.669360E-01_EB, 1.012989E+00_EB, 2.092338E-01_EB, 1.328261E-01_EB, 1.769728E-01_EB, &
    0.000000E+00_EB,  &
    9.072991E-02_EB, 1.003606E-01_EB, 4.743472E-02_EB, 1.947055E-01_EB, 1.271274E-01_EB, 1.058880E+00_EB, &
    1.108253E-01_EB,  &
    1.766273E-03_EB, 2.938917E-01_EB, 0.000000E+00_EB, 2.625294E-02_EB, 3.398634E-01_EB, 0.000000E+00_EB, &
    2.400640E-01_EB,  &
    8.874209E-03_EB, 3.108447E-02_EB, 4.795147E-02_EB, 4.549603E-02_EB, 1.004367E-01_EB, 4.769853E-02_EB, &
    3.483151E-02_EB,  &
    5.243128E-03_EB, 6.289848E-02_EB, 3.828707E-02_EB, 6.309962E-02_EB, 1.075334E-01_EB, 6.627025E-02_EB, &
    3.733830E-01_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,17:24) = RESHAPE((/ &  ! 1625-1800 cm-1
    8.983850E-02_EB, 2.185072E-01_EB, 1.895074E-01_EB, 2.229883E-01_EB, 2.167762E-01_EB, 1.808837E-01_EB, &
    0.000000E+00_EB,  &
    2.564369E-01_EB, 2.836846E-01_EB, 3.306636E-01_EB, 2.476879E-01_EB, 1.872233E-01_EB, 3.573316E-01_EB, &
    1.376143E-01_EB,  &
    9.482404E-02_EB, 1.263844E-01_EB, 9.509965E-02_EB, 1.558396E-01_EB, 1.330587E-01_EB, 2.643404E-01_EB, &
    9.653773E-02_EB,  &
    1.796306E-04_EB, 0.000000E+00_EB, 1.397846E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.296981E-05_EB, 0.000000E+00_EB, 5.632037E-06_EB, 0.000000E+00_EB, 2.058058E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    8.150940E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.255240E-04_EB, &
    1.830332E-04_EB,  &
    3.474384E-05_EB, 1.079274E-03_EB, 1.813750E-04_EB, 2.219098E-03_EB, 5.071858E-04_EB, 4.887974E-03_EB, &
    2.144247E-03_EB,  &
    1.798616E-02_EB, 2.857737E-02_EB, 7.070030E-02_EB, 5.716379E-02_EB, 7.030989E-02_EB, 8.332090E-01_EB, &
    0.000000E+00_EB/),(/7,8/))

GAMMAD2_C3H6(1:7,25:31) = RESHAPE((/ &  ! 1825-1975 cm-1
    7.088676E-02_EB, 6.889516E-02_EB, 1.200167E-01_EB, 5.600643E-02_EB, 3.459742E-02_EB, 2.167102E-02_EB, &
    0.000000E+00_EB,  &
    5.743833E-02_EB, 3.766426E-02_EB, 3.379733E-02_EB, 5.607277E-02_EB, 5.172316E-02_EB, 1.718329E-02_EB, &
    0.000000E+00_EB,  &
    9.986404E-03_EB, 7.057857E-03_EB, 2.256685E-03_EB, 3.000073E-02_EB, 1.304095E-02_EB, 2.427730E-03_EB, &
    0.000000E+00_EB,  &
    8.232171E-04_EB, 1.581979E-04_EB, 0.000000E+00_EB, 1.687679E-03_EB, 8.685456E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    4.459817E-05_EB, 5.028441E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.401512E-06_EB, 0.000000E+00_EB, &
    2.885845E-05_EB,  &
    1.585023E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 5.633415E-07_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C3H6(N_TEMP_C3H6,26)) 

! BAND #3: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 1.4852 % 
! GAMMA_D: 16.5472 % 

SD3_C3H6(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    2.612385E-04_EB, 5.046958E-04_EB, 2.749326E-04_EB, 0.000000E+00_EB, 8.031951E-05_EB, 9.030202E-05_EB, &
    0.000000E+00_EB,  &
    1.319116E-03_EB, 1.033067E-03_EB, 1.793275E-03_EB, 1.250881E-03_EB, 3.356346E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.478160E-02_EB, 5.899926E-03_EB, 1.154077E-02_EB, 1.230591E-02_EB, 5.740466E-03_EB, 1.475392E-02_EB, &
    3.586877E-02_EB,  &
    6.326169E-02_EB, 3.723599E-02_EB, 3.696103E-02_EB, 3.988389E-02_EB, 2.136151E-02_EB, 4.073089E-02_EB, &
    6.515728E-02_EB,  &
    7.834727E-02_EB, 5.409456E-02_EB, 5.528704E-02_EB, 5.703107E-02_EB, 3.784697E-02_EB, 4.967094E-02_EB, &
    5.809475E-02_EB,  &
    6.027123E-02_EB, 4.525102E-02_EB, 5.211982E-02_EB, 6.058969E-02_EB, 4.412684E-02_EB, 6.369204E-02_EB, &
    9.366400E-02_EB,  &
    9.873930E-02_EB, 7.672208E-02_EB, 8.351420E-02_EB, 8.728730E-02_EB, 7.234081E-02_EB, 9.124020E-02_EB, &
    1.482238E-01_EB,  &
    1.211847E-01_EB, 1.131380E-01_EB, 1.317310E-01_EB, 1.449158E-01_EB, 1.324179E-01_EB, 1.557630E-01_EB, &
    1.751337E-01_EB/),(/7,8/))

SD3_C3H6(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    4.918413E-01_EB, 3.735319E-01_EB, 3.612134E-01_EB, 3.436737E-01_EB, 2.908881E-01_EB, 2.692502E-01_EB, &
    2.635260E-01_EB,  &
    9.534683E-01_EB, 7.046855E-01_EB, 6.461712E-01_EB, 5.969668E-01_EB, 5.058464E-01_EB, 4.352270E-01_EB, &
    4.209978E-01_EB,  &
    1.391361E+00_EB, 1.088309E+00_EB, 1.009282E+00_EB, 9.358414E-01_EB, 8.078814E-01_EB, 6.611190E-01_EB, &
    5.858476E-01_EB,  &
    2.169989E+00_EB, 1.565541E+00_EB, 1.381351E+00_EB, 1.240496E+00_EB, 1.015982E+00_EB, 7.867338E-01_EB, &
    6.659045E-01_EB,  &
    2.966872E+00_EB, 2.091402E+00_EB, 1.823879E+00_EB, 1.605039E+00_EB, 1.289641E+00_EB, 9.608778E-01_EB, &
    7.637209E-01_EB,  &
    2.771091E+00_EB, 1.819502E+00_EB, 1.551408E+00_EB, 1.340457E+00_EB, 1.048185E+00_EB, 7.992822E-01_EB, &
    6.341455E-01_EB,  &
    2.506271E+00_EB, 1.767860E+00_EB, 1.532503E+00_EB, 1.332724E+00_EB, 1.052501E+00_EB, 7.906226E-01_EB, &
    6.298468E-01_EB,  &
    1.489470E+00_EB, 1.173923E+00_EB, 1.099214E+00_EB, 9.934088E-01_EB, 8.524273E-01_EB, 7.164632E-01_EB, &
    6.231782E-01_EB/),(/7,8/))

SD3_C3H6(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    1.165662E+00_EB, 1.000903E+00_EB, 9.761455E-01_EB, 9.066025E-01_EB, 8.117190E-01_EB, 6.927088E-01_EB, &
    5.784290E-01_EB,  &
    1.625342E+00_EB, 1.164821E+00_EB, 1.061822E+00_EB, 9.419411E-01_EB, 7.818562E-01_EB, 6.179509E-01_EB, &
    4.991615E-01_EB,  &
    1.681811E+00_EB, 1.157198E+00_EB, 1.033628E+00_EB, 8.957726E-01_EB, 7.223734E-01_EB, 5.585901E-01_EB, &
    4.199798E-01_EB,  &
    6.725383E-01_EB, 5.518346E-01_EB, 5.434851E-01_EB, 4.785582E-01_EB, 4.069551E-01_EB, 3.465454E-01_EB, &
    2.469084E-01_EB,  &
    2.033862E-01_EB, 1.820026E-01_EB, 2.005474E-01_EB, 1.762463E-01_EB, 1.576472E-01_EB, 1.651118E-01_EB, &
    1.086242E-01_EB,  &
    4.840663E-02_EB, 4.609824E-02_EB, 8.839653E-02_EB, 7.317976E-02_EB, 6.564416E-02_EB, 7.440779E-02_EB, &
    5.884548E-02_EB,  &
    1.555096E-03_EB, 7.433712E-03_EB, 1.185430E-01_EB, 7.735301E-02_EB, 2.453885E-02_EB, 1.787533E-02_EB, &
    9.263441E-03_EB,  &
    3.725551E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 3.117566E-03_EB, 1.271015E-02_EB, 7.147830E-03_EB, &
    2.101775E-03_EB/),(/7,8/))

SD3_C3H6(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    2.834093E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.295675E-04_EB, 4.269900E-03_EB, 1.346285E-03_EB, &
    7.389077E-06_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C3H6(N_TEMP_C3H6,26)) 

! BAND #3: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 1.4852 % 
! GAMMA_D: 16.5472 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C3H6(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    0.000000E+00_EB, 3.783799E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.110356E-06_EB, 7.716854E-07_EB, &
    0.000000E+00_EB,  &
    4.631052E-05_EB, 8.681693E-05_EB, 5.538460E-05_EB, 1.887315E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.657140E-03_EB, 0.000000E+00_EB, 2.958156E-03_EB, 5.331959E-03_EB, 0.000000E+00_EB, 9.625962E-04_EB, &
    8.971782E-04_EB,  &
    1.341105E-02_EB, 4.865012E-02_EB, 9.919584E-03_EB, 7.433797E-03_EB, 0.000000E+00_EB, 3.349268E-03_EB, &
    3.554615E-03_EB,  &
    2.899308E-02_EB, 3.444724E-02_EB, 1.739552E-02_EB, 1.356301E-02_EB, 3.837339E-02_EB, 5.174256E-03_EB, &
    3.313200E-02_EB,  &
    1.608472E-02_EB, 5.538111E-02_EB, 1.360484E-02_EB, 1.022059E-02_EB, 2.721484E-02_EB, 1.047272E-02_EB, &
    1.380241E-02_EB,  &
    3.092793E-02_EB, 5.678932E-02_EB, 2.019655E-02_EB, 2.722010E-02_EB, 4.862008E-02_EB, 2.700498E-02_EB, &
    2.545903E-02_EB,  &
    3.076686E-02_EB, 8.188813E-02_EB, 3.142893E-02_EB, 4.070902E-02_EB, 1.080871E-01_EB, 6.056197E-02_EB, &
    2.038125E-01_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    1.277476E-01_EB, 1.720283E-01_EB, 9.334611E-02_EB, 1.142778E-01_EB, 1.788112E-01_EB, 1.234282E-01_EB, &
    4.175169E-01_EB,  &
    2.785114E-01_EB, 2.986523E-01_EB, 1.963797E-01_EB, 2.296630E-01_EB, 2.709810E-01_EB, 2.070393E-01_EB, &
    3.191344E-01_EB,  &
    4.492768E-01_EB, 4.637891E-01_EB, 3.240127E-01_EB, 3.641452E-01_EB, 3.741274E-01_EB, 3.217441E-01_EB, &
    4.274759E-01_EB,  &
    7.635993E-01_EB, 6.968677E-01_EB, 5.003049E-01_EB, 5.134602E-01_EB, 4.743768E-01_EB, 3.733634E-01_EB, &
    5.279906E-01_EB,  &
    1.091690E+00_EB, 8.243808E-01_EB, 6.324711E-01_EB, 6.423876E-01_EB, 5.670358E-01_EB, 4.557292E-01_EB, &
    6.625530E-01_EB,  &
    1.504134E+00_EB, 8.490499E-01_EB, 6.299214E-01_EB, 5.835945E-01_EB, 5.080013E-01_EB, 3.580525E-01_EB, &
    1.051683E+00_EB,  &
    1.404823E+00_EB, 7.599811E-01_EB, 6.157989E-01_EB, 5.612408E-01_EB, 5.010112E-01_EB, 3.581126E-01_EB, &
    8.516534E-01_EB,  &
    7.090172E-01_EB, 5.168158E-01_EB, 4.327465E-01_EB, 4.261602E-01_EB, 4.151584E-01_EB, 3.465752E-01_EB, &
    5.279562E-01_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    4.393736E-01_EB, 4.632451E-01_EB, 3.754650E-01_EB, 3.835171E-01_EB, 3.774393E-01_EB, 3.420636E-01_EB, &
    7.040847E-01_EB,  &
    6.213742E-01_EB, 5.199929E-01_EB, 3.824740E-01_EB, 3.774738E-01_EB, 3.479356E-01_EB, 3.046537E-01_EB, &
    6.297768E-01_EB,  &
    8.021422E-01_EB, 4.784154E-01_EB, 3.730764E-01_EB, 3.485428E-01_EB, 2.994119E-01_EB, 2.565890E-01_EB, &
    2.384896E+00_EB,  &
    3.997827E-01_EB, 1.986866E-01_EB, 1.779238E-01_EB, 1.724191E-01_EB, 1.464834E-01_EB, 1.484473E-01_EB, &
    7.688854E-01_EB,  &
    2.518280E-02_EB, 5.662613E-02_EB, 6.723649E-02_EB, 7.884321E-02_EB, 6.349534E-02_EB, 8.105115E-02_EB, &
    0.000000E+00_EB,  &
    2.360160E-03_EB, 1.393900E-02_EB, 8.427397E-03_EB, 1.941381E-02_EB, 2.729194E-02_EB, 9.734848E-03_EB, &
    2.619051E-01_EB,  &
    2.097624E-04_EB, 6.622127E-04_EB, 3.825191E-04_EB, 1.370987E-03_EB, 1.177755E-02_EB, 1.548437E-03_EB, &
    0.000000E+00_EB,  &
    2.611657E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 5.183604E-04_EB, 1.877149E-03_EB, 2.987770E-04_EB, &
    0.000000E+00_EB/),(/7,8/))

GAMMAD3_C3H6(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    1.703449E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 3.698381E-04_EB, 1.086691E-04_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!-------------------------MMA DATA-------------------


! THERE ARE 6 BANDS FOR MMA

! BAND #1: 750 cm-1 - 900 cm-1 
! BAND #2: 875 cm-1 - 1075 cm-1 
! BAND #3: 1050 cm-1 - 1275 cm-1 
! BAND #4: 1250 cm-1 - 1575 cm-1 
! BAND #5: 1550 cm-1 - 1975 cm-1 
! BAND #6: 2650 cm-1 - 3275 cm-1 

N_TEMP_C5H8O2 = 7
N_BAND_C5H8O2 = 6
I_MODEL_C5H8O2 = 2 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C5H8O2_TEMP(N_TEMP_C5H8O2)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR MMA ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C5H8O2(N_BAND_C5H8O2,3)) 
ALLOCATE(Be_C5H8O2(N_BAND_C5H8O2)) 

OM_BND_C5H8O2 = RESHAPE((/ &
    750._EB,  875._EB, 1050._EB, 1250._EB, 1550._EB, 2650._EB, &
    900._EB, 1075._EB, 1275._EB, 1575._EB, 1975._EB, 3275._EB, &
     25._EB, 25._EB, 25._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C5H8O2,3/)) 

SD_C5H8O2_TEMP = (/ &
    297._EB, 396._EB, 441._EB, 483._EB, 597._EB, 803._EB,&
    1014._EB/)

Be_C5H8O2 = (/ &
    0.100_EB, 0.100_EB, 0.100_EB, 0.100_EB, 0.100_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C5H8O2(N_TEMP_C5H8O2,7)) 

! BAND #1: 750 cm-1 - 900 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 25.7305 % 
! GAMMA_D: 42.7726 % 

SD1_C5H8O2(1:7,1:7) = RESHAPE((/ &  ! 750-900 cm-1
    1.201298E-04_EB, 8.049126E-05_EB, 7.281318E-05_EB, 1.338238E-05_EB, 1.736035E-04_EB, 2.940983E-04_EB, &
    3.199493E-03_EB,  &
    5.567134E-04_EB, 2.892277E-04_EB, 2.381969E-03_EB, 3.577856E-03_EB, 1.415656E-02_EB, 1.559278E-01_EB, &
    9.531087E-05_EB,  &
    7.192847E-01_EB, 4.411220E-01_EB, 3.974826E-01_EB, 4.606846E-01_EB, 3.349077E-01_EB, 3.545202E-01_EB, &
    1.281274E-04_EB,  &
    2.462278E+00_EB, 9.999304E-01_EB, 9.239941E-01_EB, 8.658905E-01_EB, 7.006867E-01_EB, 8.551293E-01_EB, &
    4.348797E-04_EB,  &
    2.163603E-01_EB, 8.543285E-02_EB, 1.106646E-01_EB, 7.284299E-02_EB, 4.015452E-02_EB, 1.167066E-01_EB, &
    5.002021E-04_EB,  &
    6.258634E-03_EB, 1.160569E-06_EB, 1.962348E-04_EB, 3.951157E-04_EB, 3.887835E-04_EB, 8.225887E-05_EB, &
    4.172720E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C5H8O2(N_TEMP_C5H8O2,7)) 

! BAND #1: 750 cm-1 - 900 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 25.7305 % 
! GAMMA_D: 42.7726 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C5H8O2(1:7,1:7) = RESHAPE((/ &  ! 750-900 cm-1
    5.022737E-10_EB, 3.668340E-10_EB, 3.844533E-10_EB, 2.636210E-10_EB, 4.969940E-10_EB, 1.857499E-10_EB, &
    2.166967E-10_EB,  &
    8.380753E-09_EB, 1.553926E-09_EB, 7.818845E-09_EB, 4.137264E-08_EB, 7.487966E-06_EB, 1.305801E-05_EB, &
    6.432315E-10_EB,  &
    1.437117E-03_EB, 4.030000E-04_EB, 3.120300E-04_EB, 4.058318E-04_EB, 2.072125E-04_EB, 2.203152E-04_EB, &
    9.894301E-10_EB,  &
    1.840295E-02_EB, 2.040641E-03_EB, 1.483369E-03_EB, 1.292391E-03_EB, 6.231135E-04_EB, 4.213765E-04_EB, &
    1.094100E-09_EB,  &
    1.913583E-04_EB, 1.810809E-05_EB, 1.504462E-05_EB, 1.318234E-05_EB, 9.096601E-05_EB, 1.037383E-05_EB, &
    4.342675E-08_EB,  &
    6.801692E-07_EB, 1.996981E-10_EB, 3.171892E-10_EB, 4.238371E-10_EB, 6.045415E-10_EB, 3.543213E-10_EB, &
    6.942322E-08_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C5H8O2(N_TEMP_C5H8O2,9)) 

! BAND #2: 875 cm-1 - 1075 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 15.7886 % 
! GAMMA_D: 31.6555 % 

SD2_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 875-1050 cm-1
    1.187136E-02_EB, 4.853407E-05_EB, 1.253542E-04_EB, 1.858164E-04_EB, 4.902038E-04_EB, 1.677532E-02_EB, &
    2.926441E-01_EB,  &
    5.978490E-02_EB, 6.723244E-02_EB, 1.412238E-01_EB, 1.135530E-01_EB, 1.322379E-02_EB, 2.242282E-01_EB, &
    2.162917E-01_EB,  &
    2.727527E+00_EB, 1.406105E+00_EB, 1.227995E+00_EB, 1.201216E+00_EB, 2.043823E+00_EB, 9.268086E-01_EB, &
    3.877341E-01_EB,  &
    3.629106E+00_EB, 1.510117E+00_EB, 1.206283E+00_EB, 1.112139E+00_EB, 8.111110E-01_EB, 5.581671E-01_EB, &
    6.018685E-01_EB,  &
    3.888868E-01_EB, 2.586678E-01_EB, 2.132276E-01_EB, 1.953830E-01_EB, 0.000000E+00_EB, 2.404523E-01_EB, &
    1.025196E+00_EB,  &
    1.104011E+00_EB, 6.157314E-01_EB, 6.134693E-01_EB, 6.191194E-01_EB, 5.915041E-01_EB, 4.237241E-01_EB, &
    5.200260E-01_EB,  &
    2.295176E+00_EB, 9.478389E-01_EB, 7.516276E-01_EB, 6.540011E-01_EB, 6.066615E-01_EB, 1.467301E-01_EB, &
    7.184493E-02_EB,  &
    1.213398E-01_EB, 5.104482E-02_EB, 6.141216E-02_EB, 3.159463E-02_EB, 1.646159E-04_EB, 1.283666E-04_EB, &
    1.979059E-02_EB/),(/7,8/))

SD2_C5H8O2(1:7,9:9) = RESHAPE((/ &  ! 1075-1075 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C5H8O2(N_TEMP_C5H8O2,9)) 

! BAND #2: 875 cm-1 - 1075 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 15.7886 % 
! GAMMA_D: 31.6555 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 875-1050 cm-1
    1.235289E-06_EB, 2.779272E-10_EB, 4.273035E-10_EB, 4.877586E-10_EB, 3.802062E-08_EB, 6.285575E-07_EB, &
    1.468912E-05_EB,  &
    1.116310E-05_EB, 7.951295E-06_EB, 1.763615E-05_EB, 2.338734E-05_EB, 4.263141E-05_EB, 9.514544E-05_EB, &
    1.583787E-04_EB,  &
    1.850103E-02_EB, 3.371684E-03_EB, 2.697322E-03_EB, 2.481772E-03_EB, 1.674583E-03_EB, 1.117130E-03_EB, &
    3.019050E-04_EB,  &
    3.603363E-02_EB, 3.903054E-03_EB, 2.710808E-03_EB, 2.135394E-03_EB, 9.434035E-04_EB, 5.828763E-04_EB, &
    3.853668E-04_EB,  &
    4.860902E-04_EB, 8.954682E-05_EB, 9.152176E-05_EB, 9.009913E-05_EB, 0.000000E+00_EB, 1.357353E-04_EB, &
    3.546707E-04_EB,  &
    3.393221E-03_EB, 6.989788E-04_EB, 6.496707E-04_EB, 6.295283E-04_EB, 4.512582E-04_EB, 3.137885E-04_EB, &
    1.302891E-04_EB,  &
    1.517748E-02_EB, 1.577086E-03_EB, 1.060887E-03_EB, 7.763248E-04_EB, 3.203287E-04_EB, 6.615707E-05_EB, &
    3.239516E-05_EB,  &
    5.816017E-05_EB, 6.219514E-06_EB, 5.324047E-06_EB, 3.389853E-06_EB, 1.043431E-06_EB, 3.083657E-10_EB, &
    7.645223E-06_EB/),(/7,8/))

GAMMAD2_C5H8O2(1:7,9:9) = RESHAPE((/ &  ! 1075-1075 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,1/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C5H8O2(N_TEMP_C5H8O2,10)) 

! BAND #3: 1050 cm-1 - 1275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 14.5414 % 
! GAMMA_D: 39.4014 % 

SD3_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1050-1225 cm-1
    1.971529E-03_EB, 2.087310E-06_EB, 1.750936E-03_EB, 1.446318E-03_EB, 2.181373E-04_EB, 2.065614E-04_EB, &
    3.325441E-01_EB,  &
    1.079223E-02_EB, 2.605532E-02_EB, 2.791128E-02_EB, 2.940146E-02_EB, 9.956365E-03_EB, 1.072942E-01_EB, &
    6.306567E-02_EB,  &
    1.608532E-01_EB, 1.737991E-01_EB, 1.978200E-01_EB, 2.084267E-01_EB, 4.889226E-01_EB, 4.927537E-01_EB, &
    6.795905E-01_EB,  &
    6.204266E-01_EB, 6.647815E-01_EB, 8.379434E-01_EB, 9.906961E-01_EB, 1.529273E+00_EB, 2.583409E+00_EB, &
    2.279062E+00_EB,  &
    1.570120E+01_EB, 7.651687E+00_EB, 7.337205E+00_EB, 7.684701E+00_EB, 7.133546E+00_EB, 6.371259E+00_EB, &
    3.243300E+00_EB,  &
    2.602677E+01_EB, 1.172587E+01_EB, 1.017551E+01_EB, 9.629290E+00_EB, 7.556649E+00_EB, 4.744310E+00_EB, &
    2.016874E+00_EB,  &
    1.583311E+01_EB, 6.499033E+00_EB, 5.416572E+00_EB, 4.878605E+00_EB, 3.379808E+00_EB, 1.934699E+00_EB, &
    8.390250E-01_EB,  &
    3.924057E+00_EB, 1.923537E+00_EB, 1.684706E+00_EB, 1.530665E+00_EB, 1.399037E+00_EB, 6.527681E-01_EB, &
    2.108557E+01_EB/),(/7,8/))

SD3_C5H8O2(1:7,9:10) = RESHAPE((/ &  ! 1250-1275 cm-1
    4.635734E-01_EB, 2.656998E-01_EB, 2.696971E-01_EB, 2.429593E-01_EB, 8.649154E-01_EB, 1.579276E-01_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C5H8O2(N_TEMP_C5H8O2,10)) 

! BAND #3: 1050 cm-1 - 1275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 14.5414 % 
! GAMMA_D: 39.4014 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1050-1225 cm-1
    1.878115E-07_EB, 5.788959E-13_EB, 1.476592E-08_EB, 2.728067E-08_EB, 5.624313E-10_EB, 3.764393E-10_EB, &
    1.040397E-05_EB,  &
    1.691085E-06_EB, 1.226526E-06_EB, 2.524421E-06_EB, 3.992894E-06_EB, 1.195149E-06_EB, 3.702383E-05_EB, &
    6.340525E-05_EB,  &
    1.006373E-04_EB, 6.542824E-05_EB, 8.689742E-05_EB, 1.028682E-04_EB, 1.808392E-04_EB, 6.364423E-04_EB, &
    8.071753E-04_EB,  &
    1.050946E-03_EB, 8.608036E-04_EB, 1.292753E-03_EB, 1.855734E-03_EB, 3.510320E-03_EB, 1.293617E-02_EB, &
    7.059672E-03_EB,  &
    4.855918E-01_EB, 1.301852E-01_EB, 1.310912E-01_EB, 1.438726E-01_EB, 1.061574E-01_EB, 1.105694E-01_EB, &
    1.609337E-02_EB,  &
    0.000000E+00_EB, 1.069750E+00_EB, 5.078643E-01_EB, 3.478476E-01_EB, 1.110017E-01_EB, 5.073931E-02_EB, &
    5.494710E-03_EB,  &
    1.262617E+00_EB, 1.164033E-01_EB, 7.175805E-02_EB, 5.145033E-02_EB, 1.877688E-02_EB, 7.823810E-03_EB, &
    1.095611E-03_EB,  &
    3.893671E-02_EB, 6.595195E-03_EB, 5.151045E-03_EB, 4.181796E-03_EB, 2.043378E-03_EB, 9.541520E-04_EB, &
    1.620508E-04_EB/),(/7,8/))

GAMMAD3_C5H8O2(1:7,9:10) = RESHAPE((/ &  ! 1250-1275 cm-1
    5.264026E-04_EB, 1.387833E-04_EB, 1.337621E-04_EB, 1.159984E-04_EB, 8.477874E-05_EB, 6.195854E-05_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C5H8O2(N_TEMP_C5H8O2,14)) 

! BAND #4: 1250 cm-1 - 1575 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 12.8062 % 
! GAMMA_D: 33.6176 % 

SD4_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    2.288879E-01_EB, 1.681591E-01_EB, 1.600105E-01_EB, 1.528947E-01_EB, 2.072021E-01_EB, 2.198741E-01_EB, &
    7.538644E-01_EB,  &
    9.201976E-01_EB, 8.456566E-01_EB, 9.335418E-01_EB, 1.031134E+00_EB, 1.374450E+00_EB, 1.433420E+00_EB, &
    1.037116E+00_EB,  &
    8.167029E+00_EB, 4.334333E+00_EB, 3.961366E+00_EB, 3.840758E+00_EB, 3.638575E+00_EB, 2.259466E+00_EB, &
    1.106806E+00_EB,  &
    1.110547E+01_EB, 4.714056E+00_EB, 3.919531E+00_EB, 3.444990E+00_EB, 2.569718E+00_EB, 1.239625E+00_EB, &
    1.722874E+00_EB,  &
    3.393975E+00_EB, 1.182741E+00_EB, 9.817711E-01_EB, 7.870130E-01_EB, 1.401768E+00_EB, 2.246085E-01_EB, &
    2.262008E-02_EB,  &
    1.092936E+00_EB, 5.082657E-01_EB, 4.726361E-01_EB, 4.013963E-01_EB, 1.522916E+00_EB, 2.512906E-01_EB, &
    4.779698E-02_EB,  &
    1.710152E+00_EB, 8.076434E-01_EB, 7.589686E-01_EB, 6.829207E-01_EB, 1.551907E+00_EB, 5.837564E-01_EB, &
    1.110437E-01_EB,  &
    2.302174E+00_EB, 1.219789E+00_EB, 1.157568E+00_EB, 1.111094E+00_EB, 1.425301E+00_EB, 7.925683E-01_EB, &
    1.398304E-01_EB/),(/7,8/))

SD4_C5H8O2(1:7,9:14) = RESHAPE((/ &  ! 1450-1575 cm-1
    6.305086E+00_EB, 2.526407E+00_EB, 2.094763E+00_EB, 1.867954E+00_EB, 1.692056E+00_EB, 8.380597E-01_EB, &
    1.446264E-01_EB,  &
    2.890809E+00_EB, 1.142430E+00_EB, 9.897383E-01_EB, 8.531219E-01_EB, 8.051106E-01_EB, 4.077786E-01_EB, &
    3.208892E-02_EB,  &
    3.654897E-01_EB, 2.042739E-01_EB, 2.010502E-01_EB, 9.909678E-02_EB, 0.000000E+00_EB, 7.933619E-02_EB, &
    5.066570E-05_EB,  &
    2.739369E-01_EB, 1.230897E-01_EB, 9.996546E-02_EB, 4.990339E-02_EB, 6.753971E-03_EB, 1.823009E-03_EB, &
    2.071436E-04_EB,  &
    1.075167E-01_EB, 5.590857E-02_EB, 4.045234E-02_EB, 2.393757E-02_EB, 1.547129E-03_EB, 6.828624E-04_EB, &
    2.361720E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C5H8O2(N_TEMP_C5H8O2,14)) 

! BAND #4: 1250 cm-1 - 1575 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 12.8062 % 
! GAMMA_D: 33.6176 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    1.378373E-04_EB, 5.032614E-05_EB, 5.078931E-05_EB, 4.915153E-05_EB, 5.831596E-05_EB, 1.110649E-04_EB, &
    7.974421E-05_EB,  &
    1.955908E-03_EB, 1.278282E-03_EB, 1.606116E-03_EB, 1.979784E-03_EB, 2.310828E-03_EB, 3.718494E-03_EB, &
    1.137538E-03_EB,  &
    5.152430E-01_EB, 4.107468E-02_EB, 3.376590E-02_EB, 2.997449E-02_EB, 1.626647E-02_EB, 9.715465E-03_EB, &
    1.291008E-03_EB,  &
    1.885536E-01_EB, 5.051162E-02_EB, 3.282980E-02_EB, 2.361716E-02_EB, 8.205793E-03_EB, 2.511635E-03_EB, &
    1.676651E-04_EB,  &
    2.319948E-02_EB, 2.439092E-03_EB, 1.638857E-03_EB, 1.127353E-03_EB, 2.475465E-04_EB, 9.873439E-05_EB, &
    4.802311E-06_EB,  &
    2.741937E-03_EB, 4.932900E-04_EB, 4.097271E-04_EB, 3.123770E-04_EB, 6.770312E-05_EB, 9.225675E-05_EB, &
    2.208467E-05_EB,  &
    7.211524E-03_EB, 1.248050E-03_EB, 1.056529E-03_EB, 8.673759E-04_EB, 2.878228E-04_EB, 3.576333E-04_EB, &
    4.214483E-05_EB,  &
    1.314090E-02_EB, 2.786709E-03_EB, 2.430931E-03_EB, 2.164829E-03_EB, 1.318834E-03_EB, 8.978011E-04_EB, &
    9.467730E-05_EB/),(/7,8/))

GAMMAD4_C5H8O2(1:7,9:14) = RESHAPE((/ &  ! 1450-1575 cm-1
    1.998934E-01_EB, 1.252245E-02_EB, 8.523886E-03_EB, 6.362393E-03_EB, 2.541918E-03_EB, 1.077977E-03_EB, &
    8.473119E-05_EB,  &
    2.099418E-02_EB, 2.439114E-03_EB, 1.754467E-03_EB, 1.260635E-03_EB, 3.049351E-04_EB, 2.010209E-04_EB, &
    1.466016E-05_EB,  &
    3.426245E-04_EB, 9.584436E-05_EB, 8.671389E-05_EB, 4.300699E-05_EB, 0.000000E+00_EB, 9.798754E-06_EB, &
    5.382072E-09_EB,  &
    2.034377E-04_EB, 3.503045E-05_EB, 2.887982E-05_EB, 1.676860E-05_EB, 1.377588E-06_EB, 2.608128E-08_EB, &
    1.498889E-09_EB,  &
    4.018469E-05_EB, 7.117818E-06_EB, 4.849463E-06_EB, 2.678847E-06_EB, 6.265079E-08_EB, 3.836567E-08_EB, &
    7.193215E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(SD5_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #5: 1550 cm-1 - 1975 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 10.3492 % 
! GAMMA_D: 35.6877 % 

SD5_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1550-1725 cm-1
    9.495684E-02_EB, 4.992033E-02_EB, 3.372047E-02_EB, 1.913649E-02_EB, 9.109060E-04_EB, 2.365315E-02_EB, &
    1.662640E-04_EB,  &
    3.910141E-01_EB, 1.224558E-01_EB, 1.680856E-01_EB, 5.716395E-02_EB, 3.841272E-02_EB, 1.228924E-03_EB, &
    3.841266E-04_EB,  &
    7.294382E-01_EB, 1.986464E-01_EB, 4.113417E-01_EB, 1.251796E-01_EB, 3.684466E-02_EB, 2.015649E+00_EB, &
    1.547235E-02_EB,  &
    1.543570E+00_EB, 7.191721E-01_EB, 6.772484E-01_EB, 6.268076E-01_EB, 1.117436E+00_EB, 2.872616E-01_EB, &
    2.653906E-02_EB,  &
    2.470312E+00_EB, 8.933924E-01_EB, 7.118818E-01_EB, 6.289376E-01_EB, 3.753247E-01_EB, 1.273797E-01_EB, &
    7.160828E-03_EB,  &
    5.367469E-01_EB, 2.241452E-01_EB, 2.642865E-01_EB, 2.989880E-01_EB, 2.017169E-01_EB, 1.810668E-01_EB, &
    9.994596E-02_EB,  &
    1.161877E+00_EB, 5.832122E-01_EB, 6.022030E-01_EB, 6.722074E-01_EB, 7.078757E-01_EB, 8.884418E-01_EB, &
    6.119571E-01_EB,  &
    1.194042E+01_EB, 5.165952E+00_EB, 4.759403E+00_EB, 4.809863E+00_EB, 4.070370E+00_EB, 3.300519E+00_EB, &
    1.562756E+00_EB/),(/7,8/))

SD5_C5H8O2(1:7,9:16) = RESHAPE((/ &  ! 1750-1925 cm-1
    2.405192E+01_EB, 9.831705E+00_EB, 8.302909E+00_EB, 7.663321E+00_EB, 5.424763E+00_EB, 3.444252E+00_EB, &
    1.516170E+00_EB,  &
    1.874053E+00_EB, 1.172687E+00_EB, 1.149399E+00_EB, 1.146408E+00_EB, 1.010467E+00_EB, 7.712622E-01_EB, &
    4.780637E-01_EB,  &
    6.102740E-01_EB, 2.968618E-01_EB, 3.187844E-01_EB, 2.787604E-01_EB, 2.627627E-01_EB, 1.147310E-01_EB, &
    1.826453E-01_EB,  &
    7.979265E-02_EB, 1.505492E-01_EB, 3.947243E-02_EB, 4.280752E-02_EB, 3.872365E-02_EB, 1.032246E-02_EB, &
    3.458017E-02_EB,  &
    1.361286E-05_EB, 8.417500E-03_EB, 1.715052E-03_EB, 1.224245E-02_EB, 3.240145E-02_EB, 4.286411E-04_EB, &
    2.817912E-02_EB,  &
    3.276454E-01_EB, 1.456155E-01_EB, 1.524223E-01_EB, 1.023937E-01_EB, 5.055863E-02_EB, 2.746818E-03_EB, &
    2.920186E-03_EB,  &
    1.973486E-01_EB, 6.522418E-02_EB, 1.633622E-01_EB, 5.875859E-02_EB, 1.960148E-02_EB, 4.410152E-05_EB, &
    3.957468E-04_EB,  &
    2.122952E-02_EB, 4.720651E-03_EB, 8.756893E-05_EB, 1.263465E-03_EB, 1.224206E-04_EB, 1.526855E-04_EB, &
    1.453396E-04_EB/),(/7,8/))

SD5_C5H8O2(1:7,17:18) = RESHAPE((/ &  ! 1950-1975 cm-1
    3.078787E-04_EB, 1.561081E-04_EB, 1.161746E-04_EB, 2.440354E-04_EB, 1.069884E-04_EB, 3.659970E-04_EB, &
    1.162645E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD5_C5H8O2(N_TEMP_C5H8O2,18)) 

! BAND #5: 1550 cm-1 - 1975 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 10.3492 % 
! GAMMA_D: 35.6877 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD5_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 1550-1725 cm-1
    3.521809E-05_EB, 6.326507E-06_EB, 4.007340E-06_EB, 2.286421E-06_EB, 2.362683E-08_EB, 2.335384E-08_EB, &
    3.840049E-10_EB,  &
    1.996277E-04_EB, 3.288807E-05_EB, 3.130519E-05_EB, 2.041201E-05_EB, 4.006272E-05_EB, 9.336084E-06_EB, &
    7.243559E-08_EB,  &
    3.429268E-04_EB, 8.006728E-05_EB, 9.287852E-05_EB, 5.279171E-05_EB, 1.147298E-04_EB, 4.790980E-05_EB, &
    1.003452E-05_EB,  &
    5.082888E-03_EB, 1.002676E-03_EB, 8.192579E-04_EB, 6.906077E-04_EB, 2.139828E-04_EB, 1.819635E-04_EB, &
    1.825821E-05_EB,  &
    1.588094E-02_EB, 1.529399E-03_EB, 9.884269E-04_EB, 7.099635E-04_EB, 2.119837E-04_EB, 8.015795E-05_EB, &
    9.686893E-06_EB,  &
    5.455176E-04_EB, 1.181041E-04_EB, 1.215654E-04_EB, 1.049300E-04_EB, 4.372816E-05_EB, 1.034396E-04_EB, &
    9.606914E-05_EB,  &
    2.590191E-03_EB, 6.569692E-04_EB, 6.762454E-04_EB, 7.629887E-04_EB, 7.653743E-04_EB, 1.802141E-03_EB, &
    1.038233E-03_EB,  &
    1.938295E-01_EB, 4.890023E-02_EB, 4.401938E-02_EB, 4.351923E-02_EB, 2.694000E-02_EB, 2.449479E-02_EB, &
    4.973055E-03_EB/),(/7,8/))

GAMMAD5_C5H8O2(1:7,9:16) = RESHAPE((/ &  ! 1750-1925 cm-1
    0.000000E+00_EB, 4.197090E-01_EB, 2.326063E-01_EB, 1.634279E-01_EB, 5.395610E-02_EB, 2.713366E-02_EB, &
    4.222062E-03_EB,  &
    6.313414E-03_EB, 2.282240E-03_EB, 2.225194E-03_EB, 2.232566E-03_EB, 1.525098E-03_EB, 1.382891E-03_EB, &
    5.247268E-04_EB,  &
    6.845709E-04_EB, 1.639355E-04_EB, 1.517992E-04_EB, 1.429409E-04_EB, 9.267009E-05_EB, 5.553627E-05_EB, &
    7.275037E-05_EB,  &
    1.938637E-05_EB, 4.760623E-06_EB, 1.565002E-06_EB, 2.944128E-06_EB, 8.606299E-07_EB, 6.469713E-07_EB, &
    5.281219E-06_EB,  &
    1.656320E-06_EB, 5.969306E-07_EB, 8.779851E-07_EB, 5.045861E-07_EB, 8.070822E-07_EB, 6.056302E-08_EB, &
    2.128035E-06_EB,  &
    2.190341E-04_EB, 3.183827E-05_EB, 2.376671E-05_EB, 1.888372E-05_EB, 7.455720E-06_EB, 6.510419E-07_EB, &
    4.142784E-07_EB,  &
    8.738899E-05_EB, 9.276412E-06_EB, 3.496393E-06_EB, 4.918904E-06_EB, 1.149566E-06_EB, 3.939434E-09_EB, &
    1.346005E-08_EB,  &
    7.134034E-07_EB, 4.561915E-08_EB, 2.544639E-09_EB, 1.084193E-08_EB, 7.110688E-10_EB, 7.257667E-10_EB, &
    7.884790E-10_EB/),(/7,8/))

GAMMAD5_C5H8O2(1:7,17:18) = RESHAPE((/ &  ! 1950-1975 cm-1
    1.616882E-09_EB, 4.962975E-10_EB, 6.541988E-10_EB, 1.872050E-10_EB, 3.700812E-10_EB, 3.489335E-10_EB, &
    3.082507E-10_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(SD6_C5H8O2(N_TEMP_C5H8O2,26)) 

! BAND #6: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 9.2863 % 
! GAMMA_D: 33.5156 % 

SD6_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    4.859249E-04_EB, 2.893467E-04_EB, 1.260014E-04_EB, 1.271235E-04_EB, 6.415878E-05_EB, 7.269820E-04_EB, &
    1.575858E-02_EB,  &
    2.179019E-04_EB, 1.488268E-04_EB, 2.568290E-03_EB, 2.058040E-03_EB, 1.167173E-04_EB, 2.998876E-04_EB, &
    2.040442E-02_EB,  &
    2.412606E-03_EB, 6.597483E-04_EB, 6.513249E-03_EB, 1.637918E-03_EB, 4.079701E-04_EB, 2.161906E-03_EB, &
    6.066887E-02_EB,  &
    8.734337E-03_EB, 5.166268E-03_EB, 1.013717E-02_EB, 7.336731E-03_EB, 4.153087E-03_EB, 2.096261E-03_EB, &
    8.805094E-02_EB,  &
    4.751414E-02_EB, 1.235864E-02_EB, 2.494906E-02_EB, 2.730510E-02_EB, 6.209962E-03_EB, 1.668069E-04_EB, &
    1.219689E-01_EB,  &
    1.614437E-01_EB, 3.486259E-02_EB, 1.771425E-02_EB, 1.840567E-02_EB, 4.232635E-03_EB, 1.959919E-02_EB, &
    1.549509E-01_EB,  &
    6.295472E-02_EB, 6.930347E-02_EB, 3.187678E-02_EB, 5.323038E-02_EB, 3.019657E-02_EB, 6.179763E-02_EB, &
    1.832061E-01_EB,  &
    1.153147E-01_EB, 1.274932E-01_EB, 1.008675E-01_EB, 1.082420E-01_EB, 1.362057E-01_EB, 1.382342E-01_EB, &
    2.397997E-01_EB/),(/7,8/))

SD6_C5H8O2(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    1.175355E+00_EB, 4.319024E-01_EB, 3.579307E-01_EB, 3.325439E-01_EB, 3.120948E-01_EB, 2.194665E-01_EB, &
    2.410118E-01_EB,  &
    9.282327E-01_EB, 3.843986E-01_EB, 3.147372E-01_EB, 3.043711E-01_EB, 2.596003E-01_EB, 2.673980E-01_EB, &
    3.293548E-01_EB,  &
    1.148398E+00_EB, 4.794639E-01_EB, 4.353992E-01_EB, 4.228674E-01_EB, 3.615199E-01_EB, 3.771014E-01_EB, &
    4.095856E-01_EB,  &
    1.965878E+00_EB, 9.091131E-01_EB, 7.857040E-01_EB, 7.761328E-01_EB, 6.306061E-01_EB, 6.179847E-01_EB, &
    5.737475E-01_EB,  &
    4.267944E+00_EB, 2.022840E+00_EB, 1.827067E+00_EB, 1.779633E+00_EB, 1.414729E+00_EB, 1.123019E+00_EB, &
    7.266567E-01_EB,  &
    5.087836E+00_EB, 2.227586E+00_EB, 1.903393E+00_EB, 1.763115E+00_EB, 1.341413E+00_EB, 9.438544E-01_EB, &
    6.198895E-01_EB,  &
    4.139618E+00_EB, 1.607417E+00_EB, 1.347180E+00_EB, 1.219262E+00_EB, 8.678509E-01_EB, 6.102448E-01_EB, &
    4.753326E-01_EB,  &
    2.575223E+00_EB, 9.971160E-01_EB, 8.485039E-01_EB, 7.696713E-01_EB, 5.315054E-01_EB, 4.292569E-01_EB, &
    3.109333E-01_EB/),(/7,8/))

SD6_C5H8O2(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    1.205094E+00_EB, 4.952703E-01_EB, 4.129830E-01_EB, 3.803770E-01_EB, 3.192346E-01_EB, 2.538990E-01_EB, &
    2.424320E-01_EB,  &
    3.521345E+00_EB, 2.102148E-01_EB, 2.138711E-01_EB, 2.024917E-01_EB, 1.845786E-01_EB, 2.015450E-01_EB, &
    2.477166E-01_EB,  &
    1.253513E+00_EB, 3.135144E-01_EB, 2.916153E-01_EB, 2.599885E-01_EB, 2.484937E-01_EB, 2.276533E-01_EB, &
    2.453837E-01_EB,  &
    7.655755E-01_EB, 2.227926E-01_EB, 2.381585E-01_EB, 1.658192E-01_EB, 2.037999E-01_EB, 1.500789E-01_EB, &
    1.297049E-01_EB,  &
    1.031555E-01_EB, 6.522791E-02_EB, 4.616716E-02_EB, 5.827455E-02_EB, 6.454466E-02_EB, 9.755125E-02_EB, &
    5.385385E-02_EB,  &
    8.081941E-02_EB, 2.636201E-01_EB, 3.000012E-02_EB, 4.080629E-02_EB, 1.289660E-02_EB, 5.981565E-02_EB, &
    3.056164E-02_EB,  &
    1.000701E-01_EB, 9.196931E-03_EB, 7.832481E-03_EB, 3.505039E-03_EB, 4.590482E-04_EB, 1.787859E-02_EB, &
    2.460293E-02_EB,  &
    1.834256E-02_EB, 9.029495E-04_EB, 7.276446E-04_EB, 1.373197E-03_EB, 1.347242E-04_EB, 5.623253E-03_EB, &
    1.357193E-03_EB/),(/7,8/))

SD6_C5H8O2(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    2.468985E-04_EB, 9.740984E-04_EB, 9.131436E-05_EB, 1.840562E-04_EB, 1.532638E-05_EB, 1.188173E-04_EB, &
    2.252466E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD6_C5H8O2(N_TEMP_C5H8O2,26)) 

! BAND #6: 2650 cm-1 - 3275 cm-1 

! SNB FIT WITH MALKMUS MODEL 

! ERROR ASSOCIATED WITH MALKMUS FIT: 
! KAPPA_D: 9.2863 % 
! GAMMA_D: 33.5156 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD6_C5H8O2(1:7,1:8) = RESHAPE((/ &  ! 2650-2825 cm-1
    1.763861E-10_EB, 2.510911E-10_EB, 1.535312E-10_EB, 2.740300E-10_EB, 1.976220E-10_EB, 4.328068E-10_EB, &
    2.174287E-06_EB,  &
    1.423138E-09_EB, 1.002090E-09_EB, 1.473563E-09_EB, 9.904162E-10_EB, 8.217145E-10_EB, 5.184123E-10_EB, &
    3.825362E-06_EB,  &
    2.430823E-07_EB, 4.105307E-08_EB, 2.945802E-08_EB, 2.931990E-08_EB, 9.046012E-10_EB, 7.470900E-08_EB, &
    1.471781E-05_EB,  &
    1.196530E-06_EB, 2.892845E-07_EB, 5.256007E-07_EB, 4.231739E-07_EB, 1.379385E-07_EB, 8.218151E-07_EB, &
    3.851155E-05_EB,  &
    1.028209E-05_EB, 2.103043E-06_EB, 2.249357E-06_EB, 2.044530E-06_EB, 3.438325E-07_EB, 5.428467E-07_EB, &
    4.748807E-05_EB,  &
    6.560001E-06_EB, 9.644569E-07_EB, 1.976341E-06_EB, 1.466278E-06_EB, 1.220654E-07_EB, 8.448182E-07_EB, &
    6.672219E-05_EB,  &
    1.656806E-05_EB, 4.976934E-06_EB, 3.581568E-06_EB, 4.189662E-06_EB, 1.925167E-06_EB, 9.596906E-06_EB, &
    9.390298E-05_EB,  &
    7.541211E-05_EB, 3.236925E-05_EB, 2.771523E-05_EB, 2.835092E-05_EB, 2.120343E-05_EB, 4.790025E-05_EB, &
    1.502502E-04_EB/),(/7,8/))

GAMMAD6_C5H8O2(1:7,9:16) = RESHAPE((/ &  ! 2850-3025 cm-1
    2.402992E-03_EB, 3.918392E-04_EB, 2.903184E-04_EB, 2.398657E-04_EB, 1.248707E-04_EB, 1.075889E-04_EB, &
    1.756178E-04_EB,  &
    1.389815E-03_EB, 2.832912E-04_EB, 2.247489E-04_EB, 1.982137E-04_EB, 1.020244E-04_EB, 1.411683E-04_EB, &
    2.527718E-04_EB,  &
    2.460937E-03_EB, 4.980579E-04_EB, 4.071882E-04_EB, 3.729734E-04_EB, 2.102850E-04_EB, 2.672227E-04_EB, &
    3.854209E-04_EB,  &
    8.206643E-03_EB, 1.581681E-03_EB, 1.273908E-03_EB, 1.159439E-03_EB, 6.455666E-04_EB, 7.962194E-04_EB, &
    6.519312E-04_EB,  &
    5.166325E-02_EB, 8.142089E-03_EB, 6.566028E-03_EB, 5.855561E-03_EB, 3.164624E-03_EB, 2.664291E-03_EB, &
    1.105893E-03_EB,  &
    8.901227E-02_EB, 9.770915E-03_EB, 7.307557E-03_EB, 6.003664E-03_EB, 2.756326E-03_EB, 1.913176E-03_EB, &
    8.064833E-04_EB,  &
    5.173660E-02_EB, 5.126382E-03_EB, 3.647514E-03_EB, 2.878837E-03_EB, 1.206131E-03_EB, 7.836525E-04_EB, &
    5.225329E-04_EB,  &
    1.630195E-02_EB, 1.987167E-03_EB, 1.490672E-03_EB, 1.179921E-03_EB, 4.980732E-04_EB, 3.771982E-04_EB, &
    2.910202E-04_EB/),(/7,8/))

GAMMAD6_C5H8O2(1:7,17:24) = RESHAPE((/ &  ! 3050-3225 cm-1
    2.626107E-03_EB, 5.042786E-04_EB, 3.870993E-04_EB, 3.248469E-04_EB, 1.667392E-04_EB, 1.579526E-04_EB, &
    1.696358E-04_EB,  &
    3.995251E-04_EB, 1.160528E-04_EB, 1.061575E-04_EB, 9.775797E-05_EB, 6.222656E-05_EB, 1.056153E-04_EB, &
    1.640040E-04_EB,  &
    6.683739E-04_EB, 1.982642E-04_EB, 1.739166E-04_EB, 1.625723E-04_EB, 1.020712E-04_EB, 1.285898E-04_EB, &
    9.931302E-05_EB,  &
    6.486273E-04_EB, 1.090978E-04_EB, 8.960110E-05_EB, 7.346785E-05_EB, 4.006737E-05_EB, 5.847617E-05_EB, &
    6.003109E-05_EB,  &
    4.345333E-05_EB, 1.094376E-05_EB, 5.986082E-06_EB, 8.028461E-06_EB, 2.198281E-06_EB, 1.602627E-05_EB, &
    2.033322E-05_EB,  &
    1.575891E-05_EB, 4.089396E-06_EB, 2.297556E-06_EB, 1.609373E-06_EB, 1.037565E-07_EB, 8.179706E-06_EB, &
    8.284289E-06_EB,  &
    4.874618E-06_EB, 9.051493E-07_EB, 7.620556E-07_EB, 1.706654E-07_EB, 1.672674E-09_EB, 1.866831E-06_EB, &
    4.940897E-06_EB,  &
    5.773046E-07_EB, 1.053746E-07_EB, 5.722365E-09_EB, 1.279296E-08_EB, 8.157749E-10_EB, 6.473877E-08_EB, &
    2.731624E-08_EB/),(/7,8/))

GAMMAD6_C5H8O2(1:7,25:26) = RESHAPE((/ &  ! 3250-3275 cm-1
    2.520872E-09_EB, 1.431823E-08_EB, 1.731780E-09_EB, 3.690367E-10_EB, 1.503502E-10_EB, 3.359450E-10_EB, &
    9.963536E-11_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!-------------------------Ethane DATA-------------------


! THERE ARE 3 BANDS FOR Ethane

! BAND #1: 750 cm-1 - 1100 cm-1 
! BAND #2: 1250 cm-1 - 1700 cm-1 
! BAND #3: 2550 cm-1 - 3375 cm-1 

N_TEMP_C2H6 = 7
N_BAND_C2H6 = 3
I_MODEL_C2H6 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C2H6_TEMP(N_TEMP_C2H6)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Ethane ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C2H6(N_BAND_C2H6,3)) 
ALLOCATE(Be_C2H6(N_BAND_C2H6)) 

OM_BND_C2H6 = RESHAPE((/ &
    750._EB, 1250._EB, 2550._EB, &
    1100._EB, 1700._EB, 3375._EB, &
     25._EB, 25._EB, 25._EB/),(/N_BAND_C2H6,3/)) 

SD_C2H6_TEMP = (/ &
    296._EB, 400._EB, 450._EB, 500._EB, 600._EB, 800._EB,&
    1000._EB/)

Be_C2H6 = (/ &
    0.100_EB, 0.100_EB, 0.782_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C2H6(N_TEMP_C2H6,15)) 

! BAND #1: 750 cm-1 - 1100 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 22.1451 % 
! GAMMA_D: 38.7289 % 

SD1_C2H6(1:7,1:8) = RESHAPE((/ &  ! 750-925 cm-1
    1.805918E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.028590E-02_EB, 0.000000E+00_EB, 7.607733E-03_EB, &
    0.000000E+00_EB,  &
    9.586296E-02_EB, 0.000000E+00_EB, 1.686129E-01_EB, 7.959350E-02_EB, 0.000000E+00_EB, 6.420464E-03_EB, &
    4.160566E-05_EB,  &
    2.503879E-01_EB, 2.573338E-01_EB, 1.478133E-01_EB, 1.745246E-01_EB, 2.726406E-01_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    3.521965E-01_EB, 2.471512E-01_EB, 2.152521E-01_EB, 2.250054E-01_EB, 3.134238E-01_EB, 3.406955E-01_EB, &
    3.318584E-05_EB,  &
    2.721751E-01_EB, 2.234849E-01_EB, 1.854384E-01_EB, 1.670344E-01_EB, 2.037252E-01_EB, 1.137459E-01_EB, &
    6.185954E-03_EB,  &
    1.484232E-01_EB, 1.223604E-01_EB, 1.715098E-01_EB, 1.390203E-01_EB, 1.628668E-01_EB, 7.109419E-02_EB, &
    1.358743E-02_EB,  &
    5.336187E-02_EB, 6.215590E-02_EB, 6.681701E-02_EB, 1.320859E-01_EB, 1.531144E-01_EB, 0.000000E+00_EB, &
    7.095994E-02_EB,  &
    4.305086E-03_EB, 0.000000E+00_EB, 1.484933E-03_EB, 0.000000E+00_EB, 4.513357E-03_EB, 0.000000E+00_EB, &
    4.125466E-02_EB/),(/7,8/))

SD1_C2H6(1:7,9:15) = RESHAPE((/ &  ! 950-1100 cm-1
    0.000000E+00_EB, 2.365028E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 7.757483E-04_EB, 0.000000E+00_EB, &
    8.941256E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    5.043395E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.700065E-04_EB, &
    1.168360E-02_EB,  &
    0.000000E+00_EB, 1.702677E-04_EB, 4.973627E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    6.505553E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    4.345193E-02_EB,  &
    0.000000E+00_EB, 1.833171E-04_EB, 1.914133E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    1.009767E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C2H6(N_TEMP_C2H6,15)) 

! BAND #1: 750 cm-1 - 1100 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 22.1451 % 
! GAMMA_D: 38.7289 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C2H6(1:7,1:8) = RESHAPE((/ &  ! 750-925 cm-1
    6.073772E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 5.103764E-04_EB, 0.000000E+00_EB, 6.892441E-05_EB, &
    0.000000E+00_EB,  &
    2.813159E-02_EB, 0.000000E+00_EB, 2.449353E-03_EB, 1.133735E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    5.535614E-02_EB, 5.215855E-03_EB, 2.485666E-02_EB, 1.543616E-02_EB, 1.323833E-03_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.248165E-01_EB, 2.084625E-02_EB, 2.455118E-02_EB, 2.747146E-02_EB, 4.626923E-03_EB, 1.965707E-03_EB, &
    0.000000E+00_EB,  &
    1.115187E-01_EB, 1.766559E-02_EB, 3.256681E-02_EB, 2.527352E-02_EB, 8.441899E-03_EB, 1.310099E-02_EB, &
    0.000000E+00_EB,  &
    2.084914E-02_EB, 8.880623E-03_EB, 1.028117E-02_EB, 8.154061E-03_EB, 5.845337E-03_EB, 7.544085E-03_EB, &
    0.000000E+00_EB,  &
    1.895351E-03_EB, 4.407736E-04_EB, 9.766113E-04_EB, 1.607744E-03_EB, 2.344172E-03_EB, 0.000000E+00_EB, &
    6.203639E-03_EB,  &
    2.572094E-02_EB, 0.000000E+00_EB, 2.733473E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    3.036179E-03_EB/),(/7,8/))

GAMMAD1_C2H6(1:7,9:15) = RESHAPE((/ &  ! 950-1100 cm-1
    0.000000E+00_EB, 3.467159E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 9.396735E-07_EB, 0.000000E+00_EB, &
    3.642908E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    9.323736E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.072474E-06_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 3.224782E-06_EB, 5.470756E-07_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    4.643362E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    2.308487E-04_EB,  &
    0.000000E+00_EB, 8.371768E-07_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,7/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C2H6(N_TEMP_C2H6,19)) 

! BAND #2: 1250 cm-1 - 1700 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 13.0404 % 
! GAMMA_D: 42.9171 % 

SD2_C2H6(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    1.471257E-04_EB, 1.148044E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.125517E-05_EB, 3.714320E-04_EB, &
    2.737396E-05_EB,  &
    1.861993E-04_EB, 4.499176E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 3.177630E-03_EB, 0.000000E+00_EB, &
    2.241691E-03_EB,  &
    5.151854E-03_EB, 1.534472E-04_EB, 3.225070E-04_EB, 0.000000E+00_EB, 6.422863E-03_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    2.311983E-03_EB, 8.144965E-03_EB, 1.942756E-03_EB, 0.000000E+00_EB, 2.386645E-02_EB, 1.162530E-01_EB, &
    2.512605E-02_EB,  &
    1.639179E-02_EB, 5.338232E-02_EB, 4.548727E-02_EB, 5.988052E-02_EB, 5.272913E-02_EB, 7.998443E-02_EB, &
    6.315888E-02_EB,  &
    8.816007E-02_EB, 1.243881E-01_EB, 1.147766E-01_EB, 1.191547E-01_EB, 9.357529E-02_EB, 1.035455E-01_EB, &
    5.097916E-02_EB,  &
    2.114677E-01_EB, 2.309115E-01_EB, 2.020012E-01_EB, 1.651329E-01_EB, 1.428388E-01_EB, 1.634387E-01_EB, &
    1.362306E-01_EB,  &
    2.540801E-01_EB, 2.725105E-01_EB, 2.347985E-01_EB, 1.795978E-01_EB, 1.704240E-01_EB, 1.459281E-01_EB, &
    9.935386E-02_EB/),(/7,8/))

SD2_C2H6(1:7,9:16) = RESHAPE((/ &  ! 1450-1625 cm-1
    4.120164E-01_EB, 3.702323E-01_EB, 2.969742E-01_EB, 2.382351E-01_EB, 2.045007E-01_EB, 1.616022E-01_EB, &
    1.790477E-01_EB,  &
    4.784088E-01_EB, 3.854515E-01_EB, 3.154936E-01_EB, 2.501935E-01_EB, 2.028095E-01_EB, 1.438876E-01_EB, &
    5.228374E-01_EB,  &
    2.858259E-01_EB, 3.215648E-01_EB, 2.791398E-01_EB, 1.595759E-01_EB, 1.846573E-01_EB, 1.507541E-01_EB, &
    9.035599E-02_EB,  &
    1.342899E-01_EB, 2.631717E-01_EB, 2.260252E-01_EB, 1.160095E-01_EB, 1.418269E-01_EB, 1.229156E-01_EB, &
    8.244197E-02_EB,  &
    2.251222E-02_EB, 1.658924E-01_EB, 1.718056E-01_EB, 4.480271E-02_EB, 1.125876E-01_EB, 1.006287E-01_EB, &
    1.508971E-01_EB,  &
    8.040246E-03_EB, 9.490048E-02_EB, 6.003266E-02_EB, 7.688202E-02_EB, 4.375298E-02_EB, 7.562778E-02_EB, &
    5.720946E-02_EB,  &
    2.115913E-03_EB, 3.608645E-02_EB, 1.210445E-02_EB, 0.000000E+00_EB, 1.807831E-02_EB, 5.245576E-02_EB, &
    4.984973E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 6.534392E-04_EB, 8.489054E-03_EB, 4.493318E-03_EB, 3.173909E-01_EB, &
    6.378003E-02_EB/),(/7,8/))

SD2_C2H6(1:7,17:19) = RESHAPE((/ &  ! 1650-1700 cm-1
    5.360270E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.477352E-03_EB, 2.299356E-02_EB, &
    5.788673E-03_EB,  &
    0.000000E+00_EB, 2.170544E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.438604E-04_EB, 0.000000E+00_EB, &
    1.104354E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C2H6(N_TEMP_C2H6,19)) 

! BAND #2: 1250 cm-1 - 1700 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 13.0404 % 
! GAMMA_D: 42.9171 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C2H6(1:7,1:8) = RESHAPE((/ &  ! 1250-1425 cm-1
    1.884977E-06_EB, 1.405048E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.857332E-05_EB, &
    0.000000E+00_EB,  &
    8.301358E-07_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 4.466913E-05_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 4.294495E-06_EB, 2.561889E-06_EB, 0.000000E+00_EB, 4.741031E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.189483E-03_EB, 1.006029E-04_EB, 2.771993E-04_EB, 0.000000E+00_EB, 2.551354E-03_EB, 6.093895E-05_EB, &
    5.469724E-04_EB,  &
    0.000000E+00_EB, 3.388459E-03_EB, 9.701531E-03_EB, 3.990758E-03_EB, 5.809309E-02_EB, 9.544131E-03_EB, &
    3.077677E-03_EB,  &
    0.000000E+00_EB, 3.189522E-02_EB, 4.548104E-02_EB, 1.890161E-02_EB, 4.870795E-02_EB, 1.430989E-02_EB, &
    1.879404E-03_EB,  &
    1.283338E+00_EB, 5.984637E-02_EB, 5.340705E-02_EB, 2.295770E-01_EB, 3.351662E-01_EB, 1.074109E-02_EB, &
    6.008494E-03_EB,  &
    0.000000E+00_EB, 6.611155E-02_EB, 6.304810E-02_EB, 2.032038E-01_EB, 1.600547E-01_EB, 2.235207E-02_EB, &
    2.577859E-02_EB/),(/7,8/))

GAMMAD2_C2H6(1:7,9:16) = RESHAPE((/ &  ! 1450-1625 cm-1
    0.000000E+00_EB, 8.202055E-02_EB, 9.756294E-02_EB, 1.753243E-01_EB, 1.445322E-01_EB, 2.176591E-02_EB, &
    1.072129E-02_EB,  &
    4.927997E-01_EB, 9.654376E-02_EB, 9.326906E-02_EB, 1.336681E-01_EB, 1.194199E-01_EB, 2.673184E-02_EB, &
    4.247256E-03_EB,  &
    0.000000E+00_EB, 8.453798E-02_EB, 6.652859E-02_EB, 0.000000E+00_EB, 6.824234E-02_EB, 1.261914E-02_EB, &
    1.301579E-03_EB,  &
    0.000000E+00_EB, 4.262980E-02_EB, 4.097013E-02_EB, 0.000000E+00_EB, 1.606150E-01_EB, 1.515776E-02_EB, &
    2.192025E-02_EB,  &
    0.000000E+00_EB, 1.592575E-02_EB, 1.559930E-02_EB, 0.000000E+00_EB, 4.535171E-02_EB, 1.473975E-02_EB, &
    1.695984E-03_EB,  &
    0.000000E+00_EB, 3.103551E-03_EB, 1.915177E-02_EB, 7.846211E-03_EB, 0.000000E+00_EB, 7.386004E-03_EB, &
    5.143522E-04_EB,  &
    1.118572E-03_EB, 3.137632E-04_EB, 4.661112E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.985061E-03_EB, &
    1.244966E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 6.110266E-06_EB, 3.101441E-05_EB, 0.000000E+00_EB, 8.796483E-06_EB, &
    3.397660E-05_EB/),(/7,8/))

GAMMAD2_C2H6(1:7,17:19) = RESHAPE((/ &  ! 1650-1700 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 8.967875E-04_EB, 5.435401E-05_EB, &
    7.314663E-04_EB,  &
    0.000000E+00_EB, 1.804268E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.134930E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C2H6(N_TEMP_C2H6,34)) 

! BAND #3: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 2.9752 % 
! GAMMA_D: 33.8386 % 

SD3_C2H6(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    3.183505E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.168748E-05_EB, 1.567038E-04_EB, 2.870498E-03_EB, &
    0.000000E+00_EB,  &
    2.532481E-03_EB, 2.223657E-03_EB, 6.947422E-04_EB, 2.837738E-03_EB, 3.616955E-04_EB, 3.810843E-02_EB, &
    0.000000E+00_EB,  &
    4.167383E-02_EB, 3.707653E-03_EB, 8.086980E-03_EB, 1.030406E-02_EB, 5.748382E-03_EB, 2.020191E-02_EB, &
    0.000000E+00_EB,  &
    3.044450E-02_EB, 1.601594E-02_EB, 1.400502E-02_EB, 3.757477E-02_EB, 6.389611E-03_EB, 2.217229E-02_EB, &
    5.143991E-02_EB,  &
    4.284468E-02_EB, 2.601333E-02_EB, 1.988442E-02_EB, 2.639193E-02_EB, 9.509272E-03_EB, 2.000414E-02_EB, &
    6.773347E-03_EB,  &
    4.341030E-02_EB, 3.819722E-02_EB, 3.055069E-02_EB, 2.131461E-02_EB, 1.478768E-02_EB, 1.959326E-02_EB, &
    1.706901E-02_EB,  &
    3.551935E-02_EB, 3.401619E-02_EB, 3.270118E-02_EB, 2.765089E-02_EB, 2.034163E-02_EB, 2.473185E-02_EB, &
    2.427618E-02_EB,  &
    5.642882E-02_EB, 5.561833E-02_EB, 4.546614E-02_EB, 5.384219E-02_EB, 3.404336E-02_EB, 4.812102E-02_EB, &
    4.509395E-02_EB/),(/7,8/))

SD3_C2H6(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    9.670305E-02_EB, 7.853594E-02_EB, 6.676214E-02_EB, 7.700938E-02_EB, 5.943281E-02_EB, 7.735958E-02_EB, &
    9.220041E-02_EB,  &
    1.500482E-01_EB, 1.118924E-01_EB, 9.995134E-02_EB, 1.172735E-01_EB, 8.642768E-02_EB, 1.037395E-01_EB, &
    1.313421E-01_EB,  &
    1.038947E-01_EB, 9.052266E-02_EB, 9.322208E-02_EB, 1.160347E-01_EB, 9.928119E-02_EB, 1.491040E-01_EB, &
    2.167849E-01_EB,  &
    1.809985E-01_EB, 1.595484E-01_EB, 1.740402E-01_EB, 1.954290E-01_EB, 2.088257E-01_EB, 2.805121E-01_EB, &
    3.340373E-01_EB,  &
    4.533528E-01_EB, 4.817298E-01_EB, 5.087004E-01_EB, 5.265620E-01_EB, 5.372579E-01_EB, 5.633673E-01_EB, &
    5.313482E-01_EB,  &
    1.969104E+00_EB, 1.506647E+00_EB, 1.341209E+00_EB, 1.210183E+00_EB, 1.042085E+00_EB, 8.789459E-01_EB, &
    7.776906E-01_EB,  &
    2.624463E+00_EB, 1.958079E+00_EB, 1.753242E+00_EB, 1.617000E+00_EB, 1.401473E+00_EB, 1.167600E+00_EB, &
    9.481872E-01_EB,  &
    4.438503E+00_EB, 3.381247E+00_EB, 2.942199E+00_EB, 2.616656E+00_EB, 2.123002E+00_EB, 1.544967E+00_EB, &
    1.149735E+00_EB/),(/7,8/))

SD3_C2H6(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    4.767947E+00_EB, 3.522915E+00_EB, 3.046836E+00_EB, 2.703703E+00_EB, 2.201207E+00_EB, 1.607523E+00_EB, &
    1.181066E+00_EB,  &
    5.747734E+00_EB, 4.075771E+00_EB, 3.463706E+00_EB, 3.021820E+00_EB, 2.423487E+00_EB, 1.713991E+00_EB, &
    1.263748E+00_EB,  &
    4.959958E+00_EB, 3.480625E+00_EB, 2.945726E+00_EB, 2.564986E+00_EB, 2.047814E+00_EB, 1.448145E+00_EB, &
    1.065508E+00_EB,  &
    3.392179E+00_EB, 2.463100E+00_EB, 2.100687E+00_EB, 1.822553E+00_EB, 1.475576E+00_EB, 1.056534E+00_EB, &
    8.148824E-01_EB,  &
    1.310492E+00_EB, 1.271233E+00_EB, 1.177050E+00_EB, 1.066132E+00_EB, 9.499321E-01_EB, 7.554783E-01_EB, &
    5.836100E-01_EB,  &
    3.002561E-01_EB, 4.538750E-01_EB, 4.867833E-01_EB, 4.776438E-01_EB, 5.047833E-01_EB, 4.716675E-01_EB, &
    3.975490E-01_EB,  &
    6.980109E-02_EB, 1.275689E-01_EB, 1.599285E-01_EB, 1.669042E-01_EB, 2.260784E-01_EB, 2.713380E-01_EB, &
    2.428649E-01_EB,  &
    4.809281E-02_EB, 5.937216E-02_EB, 6.859467E-02_EB, 7.525809E-02_EB, 1.131148E-01_EB, 1.484532E-01_EB, &
    1.639487E-01_EB/),(/7,8/))

SD3_C2H6(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    4.918518E-02_EB, 1.120601E-01_EB, 4.167184E-02_EB, 1.044151E-01_EB, 8.924228E-02_EB, 9.946079E-02_EB, &
    1.425871E-01_EB,  &
    5.812614E-02_EB, 0.000000E+00_EB, 7.161033E-02_EB, 3.460352E-02_EB, 1.019807E-01_EB, 8.903954E-02_EB, &
    1.325201E-01_EB,  &
    1.021185E-01_EB, 0.000000E+00_EB, 8.251694E-02_EB, 1.354981E-02_EB, 3.321756E-02_EB, 7.979905E-02_EB, &
    0.000000E+00_EB,  &
    5.485973E-02_EB, 0.000000E+00_EB, 9.676531E-02_EB, 1.420529E-01_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    6.776771E-02_EB, 0.000000E+00_EB, 5.853773E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    5.109059E-02_EB, 0.000000E+00_EB, 4.947428E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 5.180697E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 4.021456E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    3.991137E-04_EB/),(/7,8/))

SD3_C2H6(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    0.000000E+00_EB, 3.771741E-02_EB, 0.000000E+00_EB, 7.712750E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C2H6(N_TEMP_C2H6,34)) 

! BAND #3: 2550 cm-1 - 3375 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 2.9752 % 
! GAMMA_D: 33.8386 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C2H6(1:7,1:8) = RESHAPE((/ &  ! 2550-2725 cm-1
    5.617056E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 3.884843E-06_EB, 1.924118E-04_EB, &
    0.000000E+00_EB,  &
    3.201812E-04_EB, 5.654477E-05_EB, 4.765034E-05_EB, 6.019573E-05_EB, 0.000000E+00_EB, 1.225648E-04_EB, &
    0.000000E+00_EB,  &
    1.906630E-03_EB, 0.000000E+00_EB, 3.195937E-04_EB, 4.856207E-04_EB, 0.000000E+00_EB, 6.291254E-04_EB, &
    0.000000E+00_EB,  &
    2.384266E-03_EB, 2.762925E-03_EB, 1.433819E-02_EB, 1.574010E-03_EB, 0.000000E+00_EB, 5.973447E-04_EB, &
    5.177203E-05_EB,  &
    5.473457E-03_EB, 6.820077E-03_EB, 1.585262E-03_EB, 1.486126E-03_EB, 3.145346E-03_EB, 1.398848E-03_EB, &
    0.000000E+00_EB,  &
    2.584124E-02_EB, 2.720919E-03_EB, 4.837309E-03_EB, 2.086593E-03_EB, 0.000000E+00_EB, 7.040651E-04_EB, &
    7.187316E-03_EB,  &
    9.418028E-02_EB, 4.224906E-03_EB, 3.338245E-03_EB, 3.611334E-03_EB, 0.000000E+00_EB, 5.817473E-03_EB, &
    0.000000E+00_EB,  &
    4.059906E-02_EB, 7.217920E-03_EB, 1.502808E-02_EB, 7.300171E-03_EB, 0.000000E+00_EB, 4.840466E-02_EB, &
    7.910772E-03_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,9:16) = RESHAPE((/ &  ! 2750-2925 cm-1
    3.683253E-02_EB, 1.894184E-02_EB, 1.367984E-02_EB, 1.361170E-02_EB, 2.337610E-01_EB, 1.628991E-01_EB, &
    3.217784E-02_EB,  &
    6.380892E-02_EB, 4.470699E-02_EB, 1.780130E-02_EB, 1.662435E-02_EB, 9.103579E-02_EB, 5.761437E-02_EB, &
    1.882744E-02_EB,  &
    2.794167E-02_EB, 5.625808E-02_EB, 1.679752E-01_EB, 1.350788E-02_EB, 4.656023E-02_EB, 9.820979E-02_EB, &
    2.560315E-02_EB,  &
    4.835867E-02_EB, 1.354136E-01_EB, 9.352196E-02_EB, 6.140328E-02_EB, 1.879745E-01_EB, 1.385578E-01_EB, &
    6.805019E-02_EB,  &
    1.581108E-01_EB, 2.881296E-01_EB, 1.966540E-01_EB, 1.997590E-01_EB, 3.496187E-01_EB, 2.264834E-01_EB, &
    1.897263E-01_EB,  &
    5.569808E-01_EB, 5.852292E-01_EB, 5.418883E-01_EB, 5.263112E-01_EB, 6.740810E-01_EB, 3.471012E-01_EB, &
    2.418469E-01_EB,  &
    7.620609E-01_EB, 7.109156E-01_EB, 6.764364E-01_EB, 6.553510E-01_EB, 7.558475E-01_EB, 4.695840E-01_EB, &
    3.862749E-01_EB,  &
    2.286312E+00_EB, 1.528989E+00_EB, 1.432169E+00_EB, 1.217197E+00_EB, 1.338275E+00_EB, 5.910173E-01_EB, &
    4.359980E-01_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,17:24) = RESHAPE((/ &  ! 2950-3125 cm-1
    1.675223E+00_EB, 1.309979E+00_EB, 1.395852E+00_EB, 1.327914E+00_EB, 1.356043E+00_EB, 6.525331E-01_EB, &
    4.665485E-01_EB,  &
    8.329335E-01_EB, 6.655904E-01_EB, 7.203359E-01_EB, 7.747127E-01_EB, 8.592213E-01_EB, 6.327340E-01_EB, &
    4.393241E-01_EB,  &
    6.239455E-01_EB, 5.527817E-01_EB, 6.229376E-01_EB, 6.632520E-01_EB, 7.318044E-01_EB, 5.332796E-01_EB, &
    3.583488E-01_EB,  &
    9.021967E-01_EB, 7.145805E-01_EB, 7.826891E-01_EB, 8.736109E-01_EB, 7.122962E-01_EB, 4.798678E-01_EB, &
    2.457193E-01_EB,  &
    4.068506E-01_EB, 3.885861E-01_EB, 4.575764E-01_EB, 7.046409E-01_EB, 5.594283E-01_EB, 3.400046E-01_EB, &
    2.484514E-01_EB,  &
    1.073547E-01_EB, 1.495499E-01_EB, 1.916581E-01_EB, 4.143922E+00_EB, 2.781666E-01_EB, 2.867072E-01_EB, &
    3.575621E-01_EB,  &
    1.612146E-02_EB, 4.349108E-02_EB, 6.947955E-02_EB, 1.687461E-01_EB, 1.220582E-01_EB, 1.222948E-01_EB, &
    9.495102E-02_EB,  &
    4.979521E-03_EB, 5.718370E-03_EB, 1.472224E-02_EB, 5.639079E-03_EB, 2.009137E-02_EB, 3.791013E-02_EB, &
    2.589853E-02_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,25:32) = RESHAPE((/ &  ! 3150-3325 cm-1
    1.555929E-03_EB, 6.914714E-04_EB, 5.433000E-03_EB, 7.152165E-04_EB, 3.658507E-03_EB, 7.857846E-03_EB, &
    1.011164E-02_EB,  &
    1.831250E-03_EB, 0.000000E+00_EB, 1.306872E-03_EB, 3.312903E-03_EB, 7.129004E-04_EB, 1.674625E-03_EB, &
    1.947765E-04_EB,  &
    1.497423E-03_EB, 0.000000E+00_EB, 9.939444E-04_EB, 6.354788E-04_EB, 2.746286E-04_EB, 4.000274E-04_EB, &
    0.000000E+00_EB,  &
    5.698346E-03_EB, 0.000000E+00_EB, 9.938150E-04_EB, 6.338535E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    3.676229E-03_EB, 0.000000E+00_EB, 6.104391E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    2.708266E-03_EB, 0.000000E+00_EB, 4.464895E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.406311E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.237587E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,8/))

GAMMAD3_C2H6(1:7,33:34) = RESHAPE((/ &  ! 3350-3375 cm-1
    0.000000E+00_EB, 2.166344E-06_EB, 0.000000E+00_EB, 3.144164E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,2/))

!-------------------------Ethylene DATA-------------------


! THERE ARE 4 BANDS FOR Ethylene

! BAND #1: 800 cm-1 - 1250 cm-1 
! BAND #2: 1325 cm-1 - 1575 cm-1 
! BAND #3: 1775 cm-1 - 2050 cm-1 
! BAND #4: 2825 cm-1 - 3350 cm-1 

N_TEMP_C2H4 = 7
N_BAND_C2H4 = 4
I_MODEL_C2H4 = 1 ! 1: GOODY, 2: MALKMUS, 3: ELSASSER 

ALLOCATE(SD_C2H4_TEMP(N_TEMP_C2H4)) 

! INITIALIZE BANDS WAVENUMBER BOUNDS FOR Ethylene ABSOPTION COEFFICIENTS.
! BANDS ARE ORGANIZED BY ROW: 
! 1ST COLUMN IS THE LOWER BOUND BAND LIMIT IN cm-1. 
! 2ND COLUMN IS THE UPPER BOUND BAND LIMIT IN cm-1. 
! 3RD COLUMN IS THE STRIDE BETWEEN WAVENUMBERS IN BAND.
! IF 3RD COLUMN = 0., BAND IS CALCULATED, NOT TABULATED.

ALLOCATE(OM_BND_C2H4(N_BAND_C2H4,3)) 
ALLOCATE(Be_C2H4(N_BAND_C2H4)) 

OM_BND_C2H4 = RESHAPE((/ &
    800._EB, 1325._EB, 1775._EB, 2825._EB, &
    1250._EB, 1575._EB, 2050._EB, 3350._EB, &
     25._EB, 25._EB, 25._EB, 25._EB/),(/N_BAND_C2H4,3/)) 

SD_C2H4_TEMP = (/ &
    296._EB, 400._EB, 450._EB, 500._EB, 601._EB, 801._EB,&
    1000._EB/)

Be_C2H4 = (/ &
    0.100_EB, 0.100_EB, 0.444_EB, 0.100_EB/)

!---------------------------------------------------------------------------
ALLOCATE(SD1_C2H4(N_TEMP_C2H4,19)) 

! BAND #1: 800 cm-1 - 1250 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 5.3235 % 
! GAMMA_D: 30.7038 % 

SD1_C2H4(1:7,1:8) = RESHAPE((/ &  ! 800-975 cm-1
    3.199987E-04_EB, 7.392927E-03_EB, 1.482358E-03_EB, 6.750655E-03_EB, 2.771926E-02_EB, 2.678183E-02_EB, &
    8.534578E-03_EB,  &
    5.526675E-02_EB, 8.701320E-02_EB, 7.663498E-02_EB, 1.349739E-01_EB, 1.300101E-01_EB, 3.151915E-01_EB, &
    5.197272E-01_EB,  &
    3.044725E-01_EB, 3.385247E-01_EB, 3.366419E-01_EB, 3.982760E-01_EB, 3.630903E-01_EB, 3.876159E-01_EB, &
    1.257575E+00_EB,  &
    8.851045E-01_EB, 7.775902E-01_EB, 7.225594E-01_EB, 7.315245E-01_EB, 6.496151E-01_EB, 5.416699E-01_EB, &
    1.544930E+00_EB,  &
    1.612647E+00_EB, 1.151065E+00_EB, 1.029346E+00_EB, 9.294545E-01_EB, 7.648019E-01_EB, 6.162892E-01_EB, &
    3.586272E+00_EB,  &
    1.757499E+00_EB, 1.146059E+00_EB, 9.985689E-01_EB, 9.175031E-01_EB, 7.515044E-01_EB, 6.414584E-01_EB, &
    2.136444E+00_EB,  &
    3.898693E+00_EB, 2.865166E+00_EB, 2.604575E+00_EB, 2.450181E+00_EB, 2.125813E+00_EB, 1.737296E+00_EB, &
    4.955010E+00_EB,  &
    1.982751E+00_EB, 1.250900E+00_EB, 1.073027E+00_EB, 9.724268E-01_EB, 7.348834E-01_EB, 6.454081E-01_EB, &
    2.300794E+00_EB/),(/7,8/))

SD1_C2H4(1:7,9:16) = RESHAPE((/ &  ! 1000-1175 cm-1
    1.868606E+00_EB, 1.246191E+00_EB, 1.091260E+00_EB, 9.827518E-01_EB, 7.836496E-01_EB, 6.086925E-01_EB, &
    1.895517E+00_EB,  &
    1.212159E+00_EB, 9.639972E-01_EB, 8.767873E-01_EB, 8.330163E-01_EB, 7.095879E-01_EB, 5.835405E-01_EB, &
    1.819163E+00_EB,  &
    5.943869E-01_EB, 5.661199E-01_EB, 5.580481E-01_EB, 5.558287E-01_EB, 5.030813E-01_EB, 4.583171E-01_EB, &
    1.965892E+00_EB,  &
    2.503904E-01_EB, 2.924458E-01_EB, 2.996189E-01_EB, 3.243139E-01_EB, 3.501011E-01_EB, 3.238872E-01_EB, &
    1.182318E+00_EB,  &
    9.589987E-02_EB, 1.256261E-01_EB, 1.462269E-01_EB, 1.701282E-01_EB, 1.949476E-01_EB, 2.372427E-01_EB, &
    6.983182E-01_EB,  &
    3.933808E-02_EB, 4.397114E-02_EB, 5.697215E-02_EB, 7.540490E-02_EB, 9.633804E-02_EB, 1.292341E-01_EB, &
    6.214724E-01_EB,  &
    2.231947E-03_EB, 5.917670E-03_EB, 2.446527E-02_EB, 2.967285E-02_EB, 2.189199E-02_EB, 6.672362E-02_EB, &
    1.177869E-01_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 4.242548E-03_EB, 1.422634E-02_EB, 1.201400E-02_EB, 3.772615E-02_EB, &
    1.029485E+00_EB/),(/7,8/))

SD1_C2H4(1:7,17:19) = RESHAPE((/ &  ! 1200-1250 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 2.265967E-04_EB, 0.000000E+00_EB, 1.059250E-03_EB, 8.591487E-03_EB, &
    0.000000E+00_EB,  &
    2.464956E-04_EB, 0.000000E+00_EB, 1.038227E-04_EB, 0.000000E+00_EB, 1.411501E-04_EB, 3.617664E-05_EB, &
    2.578283E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD1_C2H4(N_TEMP_C2H4,19)) 

! BAND #1: 800 cm-1 - 1250 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 5.3235 % 
! GAMMA_D: 30.7038 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD1_C2H4(1:7,1:8) = RESHAPE((/ &  ! 800-975 cm-1
    5.650206E-06_EB, 1.955964E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 4.019457E-04_EB, 6.496145E-04_EB, &
    9.494054E-04_EB,  &
    6.607383E-03_EB, 3.408076E-02_EB, 0.000000E+00_EB, 2.608814E-02_EB, 1.006161E-01_EB, 5.261101E-03_EB, &
    7.224765E-03_EB,  &
    8.676632E-02_EB, 4.613659E-01_EB, 1.000722E-01_EB, 1.129568E-01_EB, 1.658273E-01_EB, 3.173977E-02_EB, &
    9.859382E-03_EB,  &
    3.505279E-01_EB, 6.774525E-01_EB, 6.995121E-01_EB, 3.093552E-01_EB, 2.012012E-01_EB, 1.049147E-01_EB, &
    3.334540E-02_EB,  &
    4.063407E-01_EB, 4.568966E-01_EB, 3.555193E-01_EB, 4.185995E-01_EB, 3.044465E-01_EB, 6.476397E-02_EB, &
    2.795051E-02_EB,  &
    3.899884E-01_EB, 4.658607E-01_EB, 4.076691E-01_EB, 3.540270E-01_EB, 6.530092E-01_EB, 1.184522E+00_EB, &
    1.316753E-02_EB,  &
    3.394628E-01_EB, 2.641295E-01_EB, 2.454273E-01_EB, 2.470285E-01_EB, 2.862701E-01_EB, 3.885408E-01_EB, &
    7.175615E-02_EB,  &
    5.071859E-01_EB, 6.197725E-01_EB, 5.891074E-01_EB, 4.367226E-01_EB, 1.968987E-01_EB, 3.135990E-01_EB, &
    3.822243E-02_EB/),(/7,8/))

GAMMAD1_C2H4(1:7,9:16) = RESHAPE((/ &  ! 1000-1175 cm-1
    4.118881E-01_EB, 5.137518E-01_EB, 4.494804E-01_EB, 4.374711E-01_EB, 5.657710E-01_EB, 1.364386E-01_EB, &
    7.229969E-02_EB,  &
    4.505159E-01_EB, 5.969974E-01_EB, 7.230941E-01_EB, 3.974499E-01_EB, 6.444913E-01_EB, 2.179633E-01_EB, &
    3.295158E-02_EB,  &
    2.481636E-01_EB, 2.579636E-01_EB, 2.617525E-01_EB, 4.292876E-01_EB, 6.737702E-01_EB, 3.063354E-01_EB, &
    1.968459E-02_EB,  &
    1.130839E-01_EB, 1.432363E-01_EB, 6.693189E-02_EB, 6.632187E-01_EB, 1.512972E-01_EB, 2.927086E-01_EB, &
    2.410819E-02_EB,  &
    3.082566E-02_EB, 2.688856E-02_EB, 5.923189E-02_EB, 6.005303E-01_EB, 1.527762E-01_EB, 1.310251E-01_EB, &
    3.586218E-02_EB,  &
    9.470499E-04_EB, 6.358993E-03_EB, 3.193401E-02_EB, 0.000000E+00_EB, 1.102661E-02_EB, 2.390899E-02_EB, &
    1.335935E-02_EB,  &
    4.784269E-04_EB, 0.000000E+00_EB, 1.753314E-03_EB, 5.214208E-03_EB, 0.000000E+00_EB, 4.635503E-01_EB, &
    2.976941E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.135282E-03_EB, 5.113457E-04_EB, 1.070357E-03_EB, 6.565410E-03_EB, &
    1.934026E-04_EB/),(/7,8/))

GAMMAD1_C2H4(1:7,17:19) = RESHAPE((/ &  ! 1200-1250 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 2.113971E-05_EB, 0.000000E+00_EB, 1.087540E-04_EB, 7.140101E-04_EB, &
    0.000000E+00_EB,  &
    1.143426E-06_EB, 0.000000E+00_EB, 1.779625E-06_EB, 0.000000E+00_EB, 1.673585E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(SD2_C2H4(N_TEMP_C2H4,11)) 

! BAND #2: 1325 cm-1 - 1575 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 10.4668 % 
! GAMMA_D: 37.4876 % 

SD2_C2H4(1:7,1:8) = RESHAPE((/ &  ! 1325-1500 cm-1
    0.000000E+00_EB, 8.783218E-05_EB, 0.000000E+00_EB, 0.000000E+00_EB, 4.023531E-04_EB, 9.596157E-05_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.593069E-03_EB, 3.875738E-03_EB, 1.307927E-02_EB, 2.723323E-02_EB, &
    0.000000E+00_EB,  &
    1.175173E-02_EB, 2.626664E-02_EB, 5.160338E-02_EB, 6.181426E-02_EB, 7.636729E-02_EB, 1.092191E-01_EB, &
    4.463938E-01_EB,  &
    2.554987E-01_EB, 2.626977E-01_EB, 2.777488E-01_EB, 2.571653E-01_EB, 2.541426E-01_EB, 2.242156E-01_EB, &
    3.777656E-01_EB,  &
    5.137291E-01_EB, 3.183165E-01_EB, 2.748886E-01_EB, 2.236523E-01_EB, 1.754118E-01_EB, 1.133663E-01_EB, &
    2.202746E-01_EB,  &
    4.591693E-01_EB, 3.027881E-01_EB, 2.704812E-01_EB, 2.377090E-01_EB, 2.018624E-01_EB, 1.779949E-01_EB, &
    3.155331E-01_EB,  &
    3.856166E-01_EB, 2.666654E-01_EB, 2.419264E-01_EB, 2.201088E-01_EB, 1.818116E-01_EB, 1.294375E-01_EB, &
    6.753864E-01_EB,  &
    5.757493E-02_EB, 7.011984E-02_EB, 8.112160E-02_EB, 7.649711E-02_EB, 1.025157E-01_EB, 1.026114E-01_EB, &
    1.560947E-01_EB/),(/7,8/))

SD2_C2H4(1:7,9:11) = RESHAPE((/ &  ! 1525-1575 cm-1
    5.087314E-04_EB, 9.170252E-04_EB, 8.021281E-03_EB, 5.096670E-03_EB, 3.941048E-02_EB, 3.282590E-02_EB, &
    1.071147E-01_EB,  &
    0.000000E+00_EB, 6.914838E-05_EB, 8.070546E-05_EB, 0.000000E+00_EB, 3.816240E-05_EB, 0.000000E+00_EB, &
    2.016701E-05_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD2_C2H4(N_TEMP_C2H4,11)) 

! BAND #2: 1325 cm-1 - 1575 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 10.4668 % 
! GAMMA_D: 37.4876 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD2_C2H4(1:7,1:8) = RESHAPE((/ &  ! 1325-1500 cm-1
    0.000000E+00_EB, 1.513472E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 5.422912E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.254909E-04_EB, 2.105331E-05_EB, 4.308850E-05_EB, 7.464662E-04_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 2.346615E-02_EB, 1.369984E-02_EB, 1.494451E-02_EB, 1.036309E-01_EB, 3.609101E-02_EB, &
    5.527523E-03_EB,  &
    6.029411E-01_EB, 2.748521E-01_EB, 1.105957E-01_EB, 2.439369E-01_EB, 1.526099E-01_EB, 1.864381E-01_EB, &
    1.242173E-02_EB,  &
    7.472879E-01_EB, 3.142137E-01_EB, 1.277319E-01_EB, 4.288739E-01_EB, 4.852329E-01_EB, 1.300866E-01_EB, &
    1.042902E-02_EB,  &
    3.094278E-01_EB, 2.133460E-01_EB, 1.292356E-01_EB, 1.845631E-01_EB, 2.436428E-01_EB, 7.095184E-02_EB, &
    1.069686E-02_EB,  &
    2.854862E-01_EB, 2.509945E-01_EB, 1.152213E-01_EB, 8.190954E-02_EB, 9.058315E-02_EB, 3.916286E-02_EB, &
    3.998569E-03_EB,  &
    2.141042E-01_EB, 0.000000E+00_EB, 5.744478E-02_EB, 5.384066E-02_EB, 2.038130E-02_EB, 4.367553E-03_EB, &
    6.602115E-03_EB/),(/7,8/))

GAMMAD2_C2H4(1:7,9:11) = RESHAPE((/ &  ! 1525-1575 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 6.509812E-04_EB, 0.000000E+00_EB, 2.959942E-03_EB, 1.924918E-04_EB, &
    1.602860E-04_EB,  &
    0.000000E+00_EB, 1.770144E-06_EB, 3.099754E-05_EB, 0.000000E+00_EB, 1.330114E-05_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,3/))

!---------------------------------------------------------------------------
ALLOCATE(SD3_C2H4(N_TEMP_C2H4,12)) 

! BAND #3: 1775 cm-1 - 2050 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 14.4727 % 
! GAMMA_D: 46.1813 % 

SD3_C2H4(1:7,1:8) = RESHAPE((/ &  ! 1775-1950 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.063481E-03_EB, &
    0.000000E+00_EB,  &
    2.721439E-04_EB, 0.000000E+00_EB, 2.004105E-03_EB, 6.012458E-04_EB, 1.064615E-02_EB, 2.146804E-02_EB, &
    0.000000E+00_EB,  &
    1.704703E-02_EB, 1.129709E-02_EB, 2.666335E-02_EB, 2.522404E-02_EB, 4.370875E-02_EB, 4.177165E-02_EB, &
    0.000000E+00_EB,  &
    1.364919E-01_EB, 9.914956E-02_EB, 1.050503E-01_EB, 9.175500E-02_EB, 1.000682E-01_EB, 6.832217E-02_EB, &
    0.000000E+00_EB,  &
    1.889933E-01_EB, 1.018181E-01_EB, 9.891595E-02_EB, 8.345629E-02_EB, 7.049222E-02_EB, 5.430716E-02_EB, &
    0.000000E+00_EB,  &
    2.524536E-01_EB, 1.414883E-01_EB, 1.295281E-01_EB, 1.068875E-01_EB, 9.197309E-02_EB, 7.814684E-02_EB, &
    1.601573E-01_EB,  &
    1.928576E-01_EB, 1.541782E-01_EB, 1.513415E-01_EB, 1.313788E-01_EB, 1.221401E-01_EB, 9.688002E-02_EB, &
    8.755640E-02_EB,  &
    1.466788E-02_EB, 2.232482E-02_EB, 3.232438E-02_EB, 2.914328E-02_EB, 4.122262E-02_EB, 5.658004E-02_EB, &
    9.741281E-02_EB/),(/7,8/))

SD3_C2H4(1:7,9:12) = RESHAPE((/ &  ! 1975-2050 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 2.239048E-04_EB, 3.431520E-04_EB, 2.292244E-03_EB, 1.335929E-02_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.782742E-04_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.680274E-04_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.676221E-05_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,4/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD3_C2H4(N_TEMP_C2H4,12)) 

! BAND #3: 1775 cm-1 - 2050 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 14.4727 % 
! GAMMA_D: 46.1813 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD3_C2H4(1:7,1:8) = RESHAPE((/ &  ! 1775-1950 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 3.007595E-05_EB, &
    0.000000E+00_EB,  &
    1.188212E-06_EB, 0.000000E+00_EB, 1.528371E-05_EB, 1.956415E-05_EB, 3.317825E-05_EB, 6.767522E-04_EB, &
    0.000000E+00_EB,  &
    3.283553E-03_EB, 0.000000E+00_EB, 1.746825E-02_EB, 0.000000E+00_EB, 6.660279E-03_EB, 2.043455E-02_EB, &
    0.000000E+00_EB,  &
    2.763825E-01_EB, 0.000000E+00_EB, 7.008755E-02_EB, 3.836294E-02_EB, 2.911609E-02_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    9.797546E-02_EB, 0.000000E+00_EB, 4.815524E-02_EB, 9.785598E-02_EB, 8.502899E-02_EB, 4.962441E-03_EB, &
    0.000000E+00_EB,  &
    1.159963E-01_EB, 3.178560E-01_EB, 5.775889E-02_EB, 9.319895E-02_EB, 1.224033E-01_EB, 1.173882E-02_EB, &
    5.646754E-04_EB,  &
    1.644422E-01_EB, 1.439276E-01_EB, 6.124800E-02_EB, 1.974546E-01_EB, 8.564029E-02_EB, 9.464038E-02_EB, &
    2.335830E-03_EB,  &
    3.598990E-03_EB, 1.475275E-02_EB, 1.155641E-02_EB, 4.022695E-03_EB, 3.203523E-02_EB, 5.785051E-03_EB, &
    7.461199E-04_EB/),(/7,8/))

GAMMAD3_C2H4(1:7,9:12) = RESHAPE((/ &  ! 1975-2050 cm-1
    0.000000E+00_EB, 0.000000E+00_EB, 6.078318E-06_EB, 4.945156E-06_EB, 6.581774E-05_EB, 2.261829E-04_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 8.142316E-07_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    1.668566E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 4.225809E-06_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,4/))

!---------------------------------------------------------------------------
ALLOCATE(SD4_C2H4(N_TEMP_C2H4,22)) 

! BAND #4: 2825 cm-1 - 3350 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 5.2808 % 
! GAMMA_D: 49.7277 % 

SD4_C2H4(1:7,1:8) = RESHAPE((/ &  ! 2825-3000 cm-1
    1.434385E-03_EB, 7.583071E-05_EB, 0.000000E+00_EB, 9.060664E-05_EB, 5.289256E-05_EB, 0.000000E+00_EB, &
    1.549906E-04_EB,  &
    2.532331E-03_EB, 4.509764E-04_EB, 8.162930E-04_EB, 0.000000E+00_EB, 3.455428E-03_EB, 1.502835E-02_EB, &
    8.241908E-03_EB,  &
    1.471538E-02_EB, 7.025767E-05_EB, 5.447703E-03_EB, 4.370719E-03_EB, 1.198098E-02_EB, 2.037492E-02_EB, &
    8.002498E-02_EB,  &
    1.742811E-02_EB, 6.828398E-03_EB, 9.749102E-03_EB, 1.154192E-02_EB, 4.048794E-02_EB, 6.342833E-02_EB, &
    2.449985E-01_EB,  &
    7.219598E-02_EB, 7.897959E-02_EB, 9.108787E-02_EB, 9.768912E-02_EB, 1.308691E-01_EB, 1.289367E-01_EB, &
    4.121736E-01_EB,  &
    4.303765E-01_EB, 3.399415E-01_EB, 3.021346E-01_EB, 2.727696E-01_EB, 2.449711E-01_EB, 1.864766E-01_EB, &
    4.356527E-01_EB,  &
    6.011409E-01_EB, 3.759787E-01_EB, 3.190396E-01_EB, 2.729711E-01_EB, 2.706391E-01_EB, 2.107559E-01_EB, &
    5.541124E-01_EB,  &
    7.765638E-01_EB, 4.717196E-01_EB, 3.808028E-01_EB, 3.303178E-01_EB, 3.028334E-01_EB, 2.365579E-01_EB, &
    6.602328E-01_EB/),(/7,8/))

SD4_C2H4(1:7,9:16) = RESHAPE((/ &  ! 3025-3200 cm-1
    7.155919E-01_EB, 5.778147E-01_EB, 5.137677E-01_EB, 4.637147E-01_EB, 4.404948E-01_EB, 3.578571E-01_EB, &
    9.775929E-01_EB,  &
    5.307913E-01_EB, 4.598425E-01_EB, 4.347931E-01_EB, 3.981860E-01_EB, 3.960297E-01_EB, 3.336116E-01_EB, &
    8.583989E-01_EB,  &
    8.642074E-01_EB, 5.812895E-01_EB, 4.841053E-01_EB, 4.056938E-01_EB, 3.549519E-01_EB, 2.334779E-01_EB, &
    5.449506E-01_EB,  &
    7.501141E-01_EB, 4.562948E-01_EB, 3.673464E-01_EB, 3.087369E-01_EB, 2.778321E-01_EB, 1.989530E-01_EB, &
    5.671845E-01_EB,  &
    1.080082E+00_EB, 6.845165E-01_EB, 5.785255E-01_EB, 4.888039E-01_EB, 4.166917E-01_EB, 3.122123E-01_EB, &
    8.073356E-01_EB,  &
    7.673923E-01_EB, 5.663915E-01_EB, 5.063835E-01_EB, 4.269636E-01_EB, 3.909398E-01_EB, 3.169142E-01_EB, &
    7.801074E-01_EB,  &
    3.912553E-01_EB, 3.018766E-01_EB, 2.788129E-01_EB, 2.355129E-01_EB, 2.412768E-01_EB, 2.083181E-01_EB, &
    5.181013E-01_EB,  &
    2.203000E-01_EB, 1.796493E-01_EB, 1.744273E-01_EB, 1.440570E-01_EB, 1.675819E-01_EB, 1.625568E-01_EB, &
    4.698681E-01_EB/),(/7,8/))

SD4_C2H4(1:7,17:22) = RESHAPE((/ &  ! 3225-3350 cm-1
    1.877466E-01_EB, 9.821361E-02_EB, 9.987563E-02_EB, 8.202185E-02_EB, 1.246035E-01_EB, 4.204656E-01_EB, &
    1.673710E-01_EB,  &
    1.123231E-02_EB, 3.420313E-02_EB, 7.118926E-02_EB, 2.919655E-02_EB, 1.119918E-01_EB, 6.839351E-02_EB, &
    1.077345E-01_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 5.022801E-03_EB, 3.628446E-03_EB, 0.000000E+00_EB, 3.847417E-02_EB, &
    2.254676E-01_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    1.745680E-02_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 4.557977E-04_EB, 5.944395E-05_EB, 2.463483E-05_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!---------------------------------------------------------------------------
ALLOCATE(GAMMAD4_C2H4(N_TEMP_C2H4,22)) 

! BAND #4: 2825 cm-1 - 3350 cm-1 

! SNB FIT WITH GOODY MODEL 

! ERROR ASSOCIATED WITH GOODY FIT: 
! KAPPA_D: 5.2808 % 
! GAMMA_D: 49.7277 % 

! PRINT FINE STRUCTURE ARRAY GAMMA_D 

GAMMAD4_C2H4(1:7,1:8) = RESHAPE((/ &  ! 2825-3000 cm-1
    3.878234E-05_EB, 1.779914E-06_EB, 0.000000E+00_EB, 1.295288E-06_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    6.473220E-07_EB,  &
    1.024149E-04_EB, 1.328638E-06_EB, 1.855867E-05_EB, 0.000000E+00_EB, 4.865552E-04_EB, 7.507761E-06_EB, &
    0.000000E+00_EB,  &
    1.129494E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 8.480976E-04_EB, 1.142228E-03_EB, 2.467049E-03_EB, &
    1.112212E-02_EB,  &
    0.000000E+00_EB, 2.939848E-03_EB, 0.000000E+00_EB, 0.000000E+00_EB, 2.893256E-03_EB, 6.005470E-03_EB, &
    8.306253E-03_EB,  &
    7.149813E-02_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.520227E-01_EB, 0.000000E+00_EB, &
    1.302195E-02_EB,  &
    2.497959E-01_EB, 1.854956E-01_EB, 0.000000E+00_EB, 0.000000E+00_EB, 1.287626E-01_EB, 2.525410E-01_EB, &
    1.810034E-02_EB,  &
    2.591346E-01_EB, 1.066559E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.699543E-02_EB, 5.562660E-01_EB, &
    2.346260E-02_EB,  &
    1.846818E-01_EB, 4.416904E-01_EB, 0.000000E+00_EB, 1.977739E-01_EB, 1.294048E+00_EB, 5.241459E-01_EB, &
    2.732023E-02_EB/),(/7,8/))

GAMMAD4_C2H4(1:7,9:16) = RESHAPE((/ &  ! 3025-3200 cm-1
    9.175918E-01_EB, 3.317369E+00_EB, 0.000000E+00_EB, 4.573944E-01_EB, 2.315680E+00_EB, 5.125666E-01_EB, &
    3.343235E-02_EB,  &
    4.644359E-01_EB, 9.338035E-01_EB, 1.336958E-01_EB, 1.814919E-01_EB, 6.808872E-01_EB, 3.613305E-01_EB, &
    3.109446E-02_EB,  &
    6.347518E-01_EB, 1.548887E+00_EB, 1.180495E+00_EB, 1.104041E-01_EB, 2.002772E-01_EB, 6.890466E-01_EB, &
    3.145327E-02_EB,  &
    5.598596E-01_EB, 2.409567E-01_EB, 6.333075E-02_EB, 6.273769E-02_EB, 7.488066E-02_EB, 1.350692E-01_EB, &
    2.097130E-02_EB,  &
    5.241386E-01_EB, 6.159550E-01_EB, 3.212829E+00_EB, 3.437326E-01_EB, 4.575401E-01_EB, 1.163405E-01_EB, &
    2.199426E-02_EB,  &
    2.533652E-01_EB, 3.233227E-01_EB, 3.058263E-01_EB, 4.461221E-01_EB, 3.250611E-01_EB, 8.986106E-02_EB, &
    2.200410E-02_EB,  &
    1.079506E-01_EB, 1.176617E-01_EB, 8.861263E-02_EB, 9.165348E-02_EB, 7.600982E-02_EB, 4.038237E-02_EB, &
    1.664957E-02_EB,  &
    3.270209E-02_EB, 4.897982E-02_EB, 3.355676E-02_EB, 4.061035E-02_EB, 4.013635E-02_EB, 1.655015E-02_EB, &
    8.040771E-03_EB/),(/7,8/))

GAMMAD4_C2H4(1:7,17:22) = RESHAPE((/ &  ! 3225-3350 cm-1
    5.138625E-03_EB, 9.101746E-03_EB, 8.678336E-03_EB, 2.045416E-02_EB, 1.003316E-02_EB, 8.318256E-03_EB, &
    7.592956E-03_EB,  &
    2.150918E-04_EB, 8.941451E-04_EB, 1.297738E-03_EB, 9.135919E-03_EB, 2.289669E-03_EB, 5.416509E-03_EB, &
    7.908695E-03_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 1.327432E-04_EB, 3.306475E-05_EB, 0.000000E+00_EB, 1.004398E-03_EB, &
    2.875127E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    1.610695E-04_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 6.068541E-07_EB, 2.608027E-06_EB, 0.000000E+00_EB, &
    0.000000E+00_EB,  &
    0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, 0.000000E+00_EB, &
    0.000000E+00_EB/),(/7,6/))

!--------------------------------OLD RADCAL DATA----------------------------------------
!  Initialize SD Array

! TEMP,K= 300     600      1000      1500      2000      2500       

SD(1:6,1:8) = RESHAPE ((/  & ! 50-225
.950E+00_EB, .103E+00_EB, .420E-01_EB, .114E-01_EB, .450E-02_EB, .300E-02_EB, &
.208E+01_EB, .365E+00_EB, .113E+00_EB, .375E-01_EB, .195E-01_EB, .134E-01_EB, &
.368E+01_EB, .990E+00_EB, .300E+00_EB, .104E+00_EB, .577E-01_EB, .365E-01_EB,  & 
.650E+01_EB, .201E+01_EB, .650E+00_EB, .214E+00_EB, .128E+00_EB, .845E-01_EB, &   
.825E+01_EB, .325E+01_EB, .121E+01_EB, .415E+00_EB, .260E+00_EB, .168E+00_EB, &  
.870E+01_EB, .452E+01_EB, .189E+01_EB, .765E+00_EB, .450E+00_EB, .289E+00_EB, &  
.810E+01_EB, .540E+01_EB, .261E+01_EB, .126E+01_EB, .695E+00_EB, .460E+00_EB, &  
.682E+01_EB, .600E+01_EB, .337E+01_EB, .179E+01_EB, .101E+01_EB, .679E+00_EB/), &
(/6,8/))
SD(1:6,9:16) = RESHAPE ((/ &  ! 250-425
.493E+01_EB, .622E+01_EB, .407E+01_EB, .230E+01_EB, .135E+01_EB, .935E+00_EB,  &   
.316E+01_EB, .592E+01_EB, .456E+01_EB, .281E+01_EB, .172E+01_EB, .122E+01_EB,  &  
.199E+01_EB, .528E+01_EB, .479E+01_EB, .328E+01_EB, .213E+01_EB, .149E+01_EB,  &   
.113E+01_EB, .450E+01_EB, .484E+01_EB, .361E+01_EB, .249E+01_EB, .179E+01_EB,  &   
.585E+00_EB, .370E+01_EB, .471E+01_EB, .383E+01_EB, .284E+01_EB, .208E+01_EB, &    
.293E+00_EB, .289E+01_EB, .443E+01_EB, .394E+01_EB, .312E+01_EB, .237E+01_EB, &    
.138E+00_EB, .205E+01_EB, .400E+01_EB, .396E+01_EB, .330E+01_EB, .260E+01_EB, &    
.620E-01_EB, .143E+01_EB, .347E+01_EB, .388E+01_EB, .341E+01_EB, .280E+01_EB/), &  
(/6,8/))
SD(1:6,17:24) = RESHAPE ((/ & ! 450-625
.255E-01_EB, .950E+00_EB, .292E+01_EB, .370E+01_EB, .345E+01_EB, .295E+01_EB,   &  
.940E-02_EB, .610E+00_EB, .236E+01_EB, .343E+01_EB, .342E+01_EB, .304E+01_EB,  &   
.340E-02_EB, .386E+00_EB, .188E+01_EB, .310E+01_EB, .334E+01_EB, .309E+01_EB,   &  
.105E-02_EB, .236E+00_EB, .145E+01_EB, .274E+01_EB, .319E+01_EB, .307E+01_EB,   &  
.350E-03_EB, .144E+00_EB, .110E+01_EB, .238E+01_EB, .300E+01_EB, .301E+01_EB,   & 
.126E-03_EB, .820E-01_EB, .818E+00_EB, .204E+01_EB, .276E+01_EB, .289E+01_EB,   &  
.430E-04_EB, .445E-01_EB, .598E+00_EB, .174E+01_EB, .248E+01_EB, .275E+01_EB,  &  
.150E-04_EB, .242E-01_EB, .427E+00_EB, .145E+01_EB, .222E+01_EB, .260E+01_EB/), & 
(/6,8/))
SD(1:6,25:32) = RESHAPE ((/  &! 650-825
.510E-05_EB, .127E-01_EB, .294E+00_EB, .118E+01_EB, .195E+01_EB, .241E+01_EB,   &  
.170E-05_EB, .630E-02_EB, .200E+00_EB, .950E+00_EB, .169E+01_EB, .221E+01_EB,   &  
.570E-06_EB, .300E-02_EB, .134E+00_EB, .748E+00_EB, .146E+01_EB, .200E+01_EB,   &  
.195E-06_EB, .140E-02_EB, .902E-01_EB, .580E+00_EB, .124E+01_EB, .178E+01_EB,   &  
.680E-07_EB, .620E-03_EB, .590E-01_EB, .443E+00_EB, .103E+01_EB, .156E+01_EB,   &  
.385E-07_EB, .275E-03_EB, .450E-01_EB, .330E+00_EB, .845E+00_EB, .136E+01_EB,   &  
.670E-07_EB, .113E-03_EB, .355E-01_EB, .242E+00_EB, .695E+00_EB, .117E+01_EB,   &  
.113E-06_EB, .500E-04_EB, .289E-01_EB, .174E+00_EB, .560E+00_EB, .100E+01_EB/),  & 
(/6,8/))
SD(1:6,33:40) = RESHAPE ((/ & ! 850-1025
.195E-06_EB, .230E-04_EB, .245E-01_EB, .123E+00_EB, .450E+00_EB, .855E+00_EB,   &  
.328E-06_EB, .103E-04_EB, .214E-01_EB, .100E+00_EB, .357E+00_EB, .718E+00_EB,  &   
.560E-06_EB, .460E-05_EB, .189E-01_EB, .830E-01_EB, .278E+00_EB, .595E+00_EB,  &   
.950E-06_EB, .205E-05_EB, .174E-01_EB, .730E-01_EB, .239E+00_EB, .492E+00_EB,  &   
.160E-05_EB, .140E-05_EB, .166E-01_EB, .665E-01_EB, .211E+00_EB, .405E+00_EB, &    
.275E-05_EB, .350E-05_EB, .165E-01_EB, .630E-01_EB, .195E+00_EB, .352E+00_EB, &    
.470E-05_EB, .850E-05_EB, .167E-01_EB, .620E-01_EB, .190E+00_EB, .312E+00_EB, &   
.810E-05_EB, .215E-04_EB, .175E-01_EB, .630E-01_EB, .191E+00_EB, .289E+00_EB/), &  
(/6,8/))
SD(1:6,41:48) = RESHAPE ((/ & ! 1050-1225
.136E-04_EB, .570E-04_EB, .188E-01_EB, .675E-01_EB, .194E+00_EB, .281E+00_EB,   &  
.235E-04_EB, .150E-03_EB, .208E-01_EB, .745E-01_EB, .202E+00_EB, .283E+00_EB,   &  
.400E-04_EB, .380E-03_EB, .233E-01_EB, .865E-01_EB, .223E+00_EB, .314E+00_EB,  &   
.680E-04_EB, .950E-03_EB, .268E-01_EB, .122E+00_EB, .260E+00_EB, .380E+00_EB,  &   
.120E-03_EB, .245E-02_EB, .343E-01_EB, .176E+00_EB, .328E+00_EB, .461E+00_EB,  &   
.200E-03_EB, .620E-02_EB, .638E-01_EB, .251E+00_EB, .411E+00_EB, .511E+00_EB,  &   
.365E-03_EB, .140E-01_EB, .107E+00_EB, .330E+00_EB, .458E+00_EB, .542E+00_EB,  &   
.680E-03_EB, .330E-01_EB, .166E+00_EB, .405E+00_EB, .487E+00_EB, .571E+00_EB/),&   
(/6,8/))
SD(1:6,49:56) = RESHAPE ((/ & ! 1250-1425
.130E-02_EB, .635E-01_EB, .244E+00_EB, .459E+00_EB, .535E+00_EB, .557E+00_EB,  &   
.250E-02_EB, .123E+00_EB, .341E+00_EB, .477E+00_EB, .502E+00_EB, .562E+00_EB,  &   
.500E-02_EB, .212E+00_EB, .407E+00_EB, .547E+00_EB, .531E+00_EB, .514E+00_EB,  &   
.103E-01_EB, .285E+00_EB, .489E+00_EB, .592E+00_EB, .497E+00_EB, .486E+00_EB,  &   
.219E-01_EB, .328E+00_EB, .491E+00_EB, .558E+00_EB, .489E+00_EB, .485E+00_EB,  &   
.485E-01_EB, .345E+00_EB, .505E+00_EB, .521E+00_EB, .477E+00_EB, .484E+00_EB,  &   
.114E+00_EB, .361E+00_EB, .538E+00_EB, .563E+00_EB, .503E+00_EB, .502E+00_EB,  &   
.249E+00_EB, .460E+00_EB, .621E+00_EB, .624E+00_EB, .538E+00_EB, .538E+00_EB/), &  
(/6,8/))
SD(1:6,57:64) = RESHAPE ((/ & ! 1450-1625
.397E+00_EB, .569E+00_EB, .749E+00_EB, .768E+00_EB, .581E+00_EB, .565E+00_EB,  &   
.418E+00_EB, .627E+00_EB, .824E+00_EB, .849E+00_EB, .640E+00_EB, .594E+00_EB,  &   
.108E+01_EB, .125E+01_EB, .113E+01_EB, .940E+00_EB, .807E+00_EB, .663E+00_EB,  &   
.165E+01_EB, .155E+01_EB, .118E+01_EB, .670E+00_EB, .562E+00_EB, .483E+00_EB,  &   
.142E+01_EB, .675E+00_EB, .557E+00_EB, .349E+00_EB, .276E+00_EB, .263E+00_EB,  &   
.451E+00_EB, .202E+00_EB, .132E+00_EB, .118E+00_EB, .134E+00_EB, .156E+00_EB,  &   
.603E-01_EB, .538E-01_EB, .863E-01_EB, .112E+00_EB, .120E+00_EB, .125E+00_EB,  &   
.501E+00_EB, .252E+00_EB, .118E+00_EB, .112E+00_EB, .131E+00_EB, .140E+00_EB/), &  
(/6,8/))
SD(1:6,65:72) = RESHAPE ((/ & ! 1650-1825
.730E+00_EB, .430E+00_EB, .237E+00_EB, .191E+00_EB, .171E+00_EB, .170E+00_EB,   &  
.149E+01_EB, .506E+00_EB, .294E+00_EB, .238E+00_EB, .210E+00_EB, .201E+00_EB,  &   
.100E+01_EB, .553E+00_EB, .434E+00_EB, .340E+00_EB, .260E+00_EB, .220E+00_EB,   &  
.802E+00_EB, .658E+00_EB, .528E+00_EB, .411E+00_EB, .300E+00_EB, .240E+00_EB,    & 
.580E+00_EB, .527E+00_EB, .460E+00_EB, .378E+00_EB, .322E+00_EB, .283E+00_EB,  &   
.330E+00_EB, .403E+00_EB, .430E+00_EB, .356E+00_EB, .318E+00_EB, .270E+00_EB,  &   
.250E+00_EB, .393E+00_EB, .405E+00_EB, .342E+00_EB, .301E+00_EB, .275E+00_EB,  &   
.147E+00_EB, .249E+00_EB, .313E+00_EB, .318E+00_EB, .291E+00_EB, .268E+00_EB/), &  
(/6,8/))
SD(1:6,73:80) = RESHAPE ((/ & ! 1850-2025
.910E-01_EB, .252E+00_EB, .298E+00_EB, .295E+00_EB, .269E+00_EB, .253E+00_EB,   &  
.580E-01_EB, .158E+00_EB, .214E+00_EB, .244E+00_EB, .244E+00_EB, .245E+00_EB,   &  
.370E-01_EB, .113E+00_EB, .184E+00_EB, .218E+00_EB, .214E+00_EB, .218E+00_EB,   &  
.244E-01_EB, .118E+00_EB, .156E+00_EB, .188E+00_EB, .195E+00_EB, .200E+00_EB,   & 
.162E-01_EB, .606E-01_EB, .976E-01_EB, .141E+00_EB, .166E+00_EB, .179E+00_EB,   & 
.112E-01_EB, .425E-01_EB, .903E-01_EB, .133E+00_EB, .148E+00_EB, .156E+00_EB,   & 
.780E-02_EB, .400E-01_EB, .765E-01_EB, .112E+00_EB, .129E+00_EB, .137E+00_EB,   & 
.540E-02_EB, .352E-01_EB, .647E-01_EB, .876E-01_EB, .110E+00_EB, .118E+00_EB/),  &
(/6,8/))
SD(1:6,81:88) = RESHAPE ((/ & ! 2050-2225
.380E-02_EB, .252E-01_EB, .507E-01_EB, .705E-01_EB, .888E-01_EB, .100E+00_EB,  &   
.260E-02_EB, .179E-01_EB, .377E-01_EB, .546E-01_EB, .724E-01_EB, .828E-01_EB,  &   
.180E-02_EB, .123E-01_EB, .294E-01_EB, .443E-01_EB, .608E-01_EB, .686E-01_EB,  &   
.127E-02_EB, .850E-02_EB, .212E-01_EB, .378E-01_EB, .579E-01_EB, .640E-01_EB,   &  
.880E-03_EB, .680E-02_EB, .152E-01_EB, .275E-01_EB, .449E-01_EB, .521E-01_EB,  &   
.620E-02_EB, .400E-02_EB, .107E-01_EB, .214E-01_EB, .374E-01_EB, .453E-01_EB,  &   
.480E-03_EB, .298E-02_EB, .931E-02_EB, .189E-01_EB, .329E-01_EB, .403E-01_EB,  &   
.405E-03_EB, .175E-02_EB, .696E-02_EB, .152E-01_EB, .295E-01_EB, .365E-01_EB/), &  
(/6,8/))
SD(1:6,89:96) = RESHAPE ((/ & ! 2250-2425 
.321E-03_EB, .120E-02_EB, .452E-02_EB, .101E-01_EB, .252E-01_EB, .331E-01_EB, &    
.229E-03_EB, .721E-03_EB, .364E-02_EB, .930E-02_EB, .225E-01_EB, .305E-01_EB,  &   
.195E-03_EB, .544E-03_EB, .318E-02_EB, .750E-02_EB, .202E-01_EB, .284E-01_EB, &    
.154E-03_EB, .375E-03_EB, .185E-02_EB, .603E-02_EB, .175E-01_EB, .269E-01_EB, &    
.101E-03_EB, .263E-03_EB, .119E-02_EB, .480E-02_EB, .156E-01_EB, .253E-01_EB, &    
.852E-04_EB, .185E-03_EB, .909E-03_EB, .360E-02_EB, .133E-01_EB, .241E-01_EB,  &   
.763E-04_EB, .137E-03_EB, .711E-03_EB, .316E-02_EB, .122E-01_EB, .237E-01_EB,  &   
.615E-04_EB, .126E-03_EB, .610E-03_EB, .257E-02_EB, .101E-01_EB, .218E-01_EB/), &  
(/6,8/))
SD(1:6,97:104) = RESHAPE ((/ & ! 2450-2625 
.480E-04_EB, .113E-03_EB, .518E-03_EB, .201E-02_EB, .920E-02_EB, .200E-01_EB, &    
.372E-04_EB, .106E-03_EB, .435E-03_EB, .168E-02_EB, .785E-02_EB, .183E-01_EB,  &   
.355E-04_EB, .101E-03_EB, .376E-03_EB, .168E-02_EB, .669E-02_EB, .166E-01_EB, &    
.358E-04_EB, .990E-04_EB, .366E-03_EB, .167E-02_EB, .651E-02_EB, .156E-01_EB,  &   
.389E-04_EB, .102E-03_EB, .376E-03_EB, .167E-02_EB, .641E-02_EB, .152E-01_EB,  &   
.422E-04_EB, .106E-03_EB, .373E-03_EB, .168E-02_EB, .656E-02_EB, .150E-01_EB,  &   
.521E-04_EB, .111E-03_EB, .371E-03_EB, .170E-02_EB, .673E-02_EB, .152E-01_EB,  &   
.646E-04_EB, .121E-03_EB, .384E-03_EB, .179E-02_EB, .798E-02_EB, .179E-01_EB/), &  
(/6,8/)) 
SD(1:6,105:112) = RESHAPE ((/ & ! 2650-2825 
.742E-04_EB, .129E-03_EB, .479E-03_EB, .201E-02_EB, .788E-02_EB, .175E-01_EB,   &  
.953E-04_EB, .165E-03_EB, .544E-03_EB, .249E-02_EB, .945E-02_EB, .204E-01_EB,   &  
.101E-03_EB, .190E-03_EB, .761E-03_EB, .324E-02_EB, .106E-01_EB, .231E-01_EB,   &  
.147E-03_EB, .272E-03_EB, .892E-03_EB, .441E-02_EB, .125E-01_EB, .257E-01_EB,    & 
.195E-03_EB, .326E-03_EB, .100E-02_EB, .499E-02_EB, .147E-01_EB, .295E-01_EB,    & 
.261E-03_EB, .421E-03_EB, .145E-02_EB, .568E-02_EB, .161E-01_EB, .306E-01_EB,   &  
.305E-03_EB, .515E-03_EB, .195E-02_EB, .754E-02_EB, .185E-01_EB, .363E-01_EB,   &  
.362E-03_EB, .645E-03_EB, .237E-02_EB, .830E-02_EB, .205E-01_EB, .373E-01_EB/), &  
(/6,8/))
SD(1:6,113:120) = RESHAPE ((/ & ! 2850-3025 
.507E-03_EB, .850E-03_EB, .274E-02_EB, .888E-02_EB, .234E-01_EB, .431E-01_EB,     &
.799E-03_EB, .118E-02_EB, .322E-02_EB, .110E-01_EB, .262E-01_EB, .451E-01_EB,     &
.935E-03_EB, .160E-02_EB, .386E-02_EB, .126E-01_EB, .292E-01_EB, .530E-01_EB,     &
.108E-02_EB, .231E-02_EB, .451E-02_EB, .140E-01_EB, .306E-01_EB, .536E-01_EB,     &
.192E-02_EB, .271E-02_EB, .563E-02_EB, .159E-01_EB, .357E-01_EB, .629E-01_EB,     &
.263E-02_EB, .300E-02_EB, .625E-02_EB, .179E-01_EB, .385E-01_EB, .666E-01_EB,    & 
.295E-02_EB, .330E-02_EB, .701E-02_EB, .203E-01_EB, .460E-01_EB, .782E-01_EB,   &  
.310E-02_EB, .370E-02_EB, .846E-02_EB, .220E-01_EB, .519E-01_EB, .889E-01_EB/),  & 
(/6,8/))
SD(1:6,121:128) = RESHAPE ((/ & ! 3050-3225
.340E-02_EB, .400E-02_EB, .969E-02_EB, .279E-01_EB, .662E-01_EB, .109E+00_EB,     &
.730E-02_EB, .450E-02_EB, .111E-01_EB, .272E-01_EB, .676E-01_EB, .109E+00_EB,     &
.900E-02_EB, .480E-02_EB, .137E-01_EB, .372E-01_EB, .864E-01_EB, .133E+00_EB,     &
.100E-02_EB, .510E-02_EB, .162E-01_EB, .471E-01_EB, .100E+00_EB, .142E+00_EB,     &
.640E-03_EB, .550E-02_EB, .205E-01_EB, .530E-01_EB, .122E+00_EB, .168E+00_EB,     &
.160E-02_EB, .600E-02_EB, .247E-01_EB, .633E-01_EB, .135E+00_EB, .177E+00_EB,    & 
.330E-02_EB, .700E-02_EB, .283E-01_EB, .770E-01_EB, .153E+00_EB, .185E+00_EB,   &  
.410E-02_EB, .860E-02_EB, .376E-01_EB, .914E-01_EB, .166E+00_EB, .206E+00_EB/),&   
(/6,8/))
SD(1:6,129:136) = RESHAPE ((/ & ! 3250-3425
.410E-02_EB, .103E-01_EB, .514E-01_EB, .117E+00_EB, .194E+00_EB, .228E+00_EB,     &
.290E-02_EB, .129E-01_EB, .664E-01_EB, .147E+00_EB, .220E+00_EB, .254E+00_EB,     &
.220E-02_EB, .161E-01_EB, .834E-01_EB, .171E+00_EB, .237E+00_EB, .263E+00_EB,     &
.220E-02_EB, .212E-01_EB, .103E+00_EB, .201E+00_EB, .268E+00_EB, .283E+00_EB,     &
.250E-02_EB, .285E-01_EB, .135E+00_EB, .240E+00_EB, .295E+00_EB, .295E+00_EB,     &
.310E-02_EB, .385E-01_EB, .169E+00_EB, .272E+00_EB, .312E+00_EB, .301E+00_EB,     &
.420E-02_EB, .540E-01_EB, .214E+00_EB, .309E+00_EB, .329E+00_EB, .307E+00_EB,     &
.600E-02_EB, .770E-01_EB, .267E+00_EB, .343E+00_EB, .332E+00_EB, .314E+00_EB/),  & 
(/6,8/))
SD(1:6,137:144) = RESHAPE ((/ & ! 3450-3625
.940E-02_EB, .117E+00_EB, .333E+00_EB, .372E+00_EB, .344E+00_EB, .303E+00_EB,     &
.165E-01_EB, .173E+00_EB, .365E+00_EB, .385E+00_EB, .353E+00_EB, .300E+00_EB,     &
.360E-01_EB, .258E+00_EB, .438E+00_EB, .393E+00_EB, .315E+00_EB, .288E+00_EB,     &
.720E-01_EB, .375E+00_EB, .510E+00_EB, .409E+00_EB, .294E+00_EB, .271E+00_EB,     &
.133E+00_EB, .401E+00_EB, .499E+00_EB, .390E+00_EB, .281E+00_EB, .257E+00_EB,     &
.215E+00_EB, .500E+00_EB, .443E+00_EB, .341E+00_EB, .254E+00_EB, .230E+00_EB,     &
.318E+00_EB, .450E+00_EB, .346E+00_EB, .286E+00_EB, .245E+00_EB, .219E+00_EB,     &
.442E+00_EB, .400E+00_EB, .354E+00_EB, .279E+00_EB, .233E+00_EB, .216E+00_EB/),   &
(/6,8/))
SD(1:6,145:152) = RESHAPE ((/ & ! 3650-3825
.473E+00_EB, .405E+00_EB, .347E+00_EB, .281E+00_EB, .238E+00_EB, .219E+00_EB,     &
.568E+00_EB, .501E+00_EB, .423E+00_EB, .315E+00_EB, .243E+00_EB, .218E+00_EB,     &
.690E+00_EB, .708E+00_EB, .673E+00_EB, .432E+00_EB, .268E+00_EB, .189E+00_EB,     &
.617E+00_EB, .831E+00_EB, .566E+00_EB, .320E+00_EB, .194E+00_EB, .123E+00_EB,     &
.181E+01_EB, .520E+00_EB, .200E+00_EB, .131E+00_EB, .124E+00_EB, .107E+00_EB,     &
.136E+00_EB, .124E+00_EB, .120E+00_EB, .119E+00_EB, .115E+00_EB, .115E+00_EB,     &
.455E+00_EB, .298E+00_EB, .167E+00_EB, .129E+00_EB, .123E+00_EB, .112E+00_EB,     &
.760E+00_EB, .503E+00_EB, .242E+00_EB, .154E+00_EB, .129E+00_EB, .127E+00_EB/),   &
(/6,8/))
SD(1:6,153:160) = RESHAPE ((/ & ! 3850-4025
.836E+00_EB, .584E+00_EB, .277E+00_EB, .184E+00_EB, .161E+00_EB, .145E+00_EB,     &
.840E+00_EB, .728E+00_EB, .422E+00_EB, .236E+00_EB, .197E+00_EB, .167E+00_EB,     &
.505E+00_EB, .500E+00_EB, .379E+00_EB, .276E+00_EB, .227E+00_EB, .192E+00_EB,     &
.117E+00_EB, .400E+00_EB, .423E+00_EB, .315E+00_EB, .243E+00_EB, .202E+00_EB,     &
.460E-01_EB, .300E+00_EB, .358E+00_EB, .290E+00_EB, .230E+00_EB, .202E+00_EB,     &
.183E-01_EB, .205E+00_EB, .269E+00_EB, .235E+00_EB, .195E+00_EB, .192E+00_EB,     &
.730E-02_EB, .135E+00_EB, .186E+00_EB, .179E+00_EB, .159E+00_EB, .168E+00_EB,     &
.557E-02_EB, .790E-01_EB, .113E+00_EB, .124E+00_EB, .124E+00_EB, .134E+00_EB/),  & 
(/6,8/))
SD(1:6,161:168) = RESHAPE ((/ & ! 4050-4225
.283E-02_EB, .415E-01_EB, .662E-01_EB, .886E-01_EB, .103E+00_EB, .106E+00_EB,     &
.226E-02_EB, .197E-01_EB, .367E-01_EB, .594E-01_EB, .801E-01_EB, .879E-01_EB,     &
.155E-02_EB, .860E-02_EB, .211E-01_EB, .395E-01_EB, .503E-01_EB, .610E-01_EB,     &
.103E-02_EB, .521E-02_EB, .119E-01_EB, .246E-01_EB, .354E-01_EB, .480E-01_EB,     &
.821E-03_EB, .365E-02_EB, .759E-02_EB, .166E-01_EB, .258E-01_EB, .370E-01_EB,     &
.752E-03_EB, .183E-02_EB, .445E-02_EB, .100E-01_EB, .179E-01_EB, .268E-01_EB,     &
.429E-03_EB, .141E-02_EB, .354E-02_EB, .821E-02_EB, .142E-01_EB, .212E-01_EB,     &
.327E-03_EB, .902E-03_EB, .209E-02_EB, .588E-02_EB, .112E-01_EB, .172E-01_EB/),   &
(/6,8/))
SD(1:6,169:176) = RESHAPE ((/ & ! 4250-4425
.225E-03_EB, .685E-03_EB, .189E-02_EB, .512E-02_EB, .101E-01_EB, .164E-01_EB,     &
.186E-03_EB, .551E-03_EB, .156E-02_EB, .366E-02_EB, .812E-02_EB, .136E-01_EB,     &
.173E-03_EB, .472E-03_EB, .139E-02_EB, .306E-02_EB, .661E-02_EB, .115E-01_EB,     &
.138E-03_EB, .395E-03_EB, .110E-02_EB, .272E-02_EB, .587E-02_EB, .104E-01_EB,     &
.900E-04_EB, .270E-03_EB, .968E-03_EB, .222E-02_EB, .497E-02_EB, .921E-02_EB,     &
.752E-04_EB, .233E-03_EB, .744E-03_EB, .208E-02_EB, .466E-02_EB, .876E-02_EB,     &
.618E-04_EB, .175E-03_EB, .638E-03_EB, .185E-02_EB, .465E-02_EB, .914E-02_EB,     &
.504E-04_EB, .134E-03_EB, .499E-03_EB, .174E-02_EB, .455E-02_EB, .935E-02_EB/),   &
(/6,8/))
SD(1:6,177:184) = RESHAPE ((/ & ! 4450-4625
.375E-04_EB, .123E-03_EB, .485E-03_EB, .182E-02_EB, .456E-02_EB, .971E-02_EB,     &
.305E-04_EB, .892E-04_EB, .338E-03_EB, .134E-02_EB, .460E-02_EB, .104E-01_EB,     &
.257E-04_EB, .790E-04_EB, .329E-03_EB, .154E-02_EB, .477E-02_EB, .112E-01_EB,     &
.242E-04_EB, .740E-04_EB, .308E-03_EB, .135E-02_EB, .497E-02_EB, .122E-01_EB,     &
.215E-04_EB, .653E-04_EB, .282E-03_EB, .131E-02_EB, .521E-02_EB, .133E-01_EB,     &
.218E-04_EB, .660E-04_EB, .272E-03_EB, .152E-02_EB, .573E-02_EB, .148E-01_EB,     &
.215E-04_EB, .671E-04_EB, .268E-03_EB, .134E-02_EB, .607E-02_EB, .159E-01_EB,     &
.217E-04_EB, .695E-04_EB, .285E-03_EB, .161E-02_EB, .677E-02_EB, .173E-01_EB/),  & 
(/6,8/))
SD(1:6,185:192) = RESHAPE ((/ & ! 4650-4825
.219E-04_EB, .722E-04_EB, .297E-03_EB, .169E-02_EB, .783E-02_EB, .197E-01_EB,     &
.226E-04_EB, .771E-04_EB, .341E-03_EB, .236E-02_EB, .925E-02_EB, .226E-01_EB,     &
.250E-04_EB, .815E-04_EB, .387E-03_EB, .286E-02_EB, .106E-01_EB, .250E-01_EB,    &
.280E-04_EB, .845E-04_EB, .420E-03_EB, .357E-02_EB, .124E-01_EB, .276E-01_EB,     &
.351E-04_EB, .192E-03_EB, .470E-03_EB, .467E-02_EB, .166E-01_EB, .313E-01_EB,     &
.435E-04_EB, .200E-03_EB, .105E-02_EB, .566E-02_EB, .185E-01_EB, .341E-01_EB,     &
.522E-04_EB, .233E-03_EB, .129E-02_EB, .736E-02_EB, .229E-01_EB, .378E-01_EB,     &
.673E-04_EB, .306E-03_EB, .183E-02_EB, .982E-02_EB, .258E-01_EB, .404E-01_EB/),   &
(/6,8/))
SD(1:6,193:200) = RESHAPE ((/ & ! 4850-5025
.886E-04_EB, .399E-03_EB, .246E-02_EB, .128E-01_EB, .302E-01_EB, .430E-01_EB,     &
.113E-03_EB, .618E-03_EB, .346E-02_EB, .161E-01_EB, .358E-01_EB, .459E-01_EB,     &
.174E-03_EB, .825E-03_EB, .441E-02_EB, .200E-01_EB, .417E-01_EB, .493E-01_EB,     &
.265E-03_EB, .163E-02_EB, .777E-02_EB, .245E-01_EB, .450E-01_EB, .507E-01_EB,     &
.355E-03_EB, .200E-02_EB, .978E-02_EB, .317E-01_EB, .492E-01_EB, .527E-01_EB,     &
.538E-03_EB, .271E-02_EB, .167E-01_EB, .401E-01_EB, .503E-01_EB, .523E-01_EB,     &
.651E-03_EB, .301E-02_EB, .264E-01_EB, .467E-01_EB, .520E-01_EB, .526E-01_EB,     &
.987E-03_EB, .530E-02_EB, .321E-01_EB, .499E-01_EB, .523E-01_EB, .510E-01_EB/),   &
(/6,8/))
SD(1:6,201:208) = RESHAPE ((/ & ! 5050-5225
.135E-02_EB, .860E-02_EB, .389E-01_EB, .528E-01_EB, .513E-01_EB, .492E-01_EB,    &
.226E-02_EB, .130E-01_EB, .472E-01_EB, .559E-01_EB, .500E-01_EB, .469E-01_EB,     &
.431E-02_EB, .198E-01_EB, .526E-01_EB, .557E-01_EB, .480E-01_EB, .452E-01_EB,     &
.628E-02_EB, .282E-01_EB, .488E-01_EB, .495E-01_EB, .451E-01_EB, .430E-01_EB,     &
.900E-02_EB, .390E-01_EB, .471E-01_EB, .449E-01_EB, .430E-01_EB, .423E-01_EB,     &
.180E-01_EB, .462E-01_EB, .412E-01_EB, .391E-01_EB, .403E-01_EB, .415E-01_EB,     &
.348E-01_EB, .710E-01_EB, .402E-01_EB, .360E-01_EB, .384E-01_EB, .414E-01_EB,     &
.718E-01_EB, .590E-01_EB, .399E-01_EB, .360E-01_EB, .376E-01_EB, .420E-01_EB/),   &
(/6,8/))
SD(1:6,209:216) = RESHAPE ((/ & ! 5250-5425
.111E+00_EB, .368E-01_EB, .340E-01_EB, .369E-01_EB, .409E-01_EB, .454E-01_EB,     &
.329E-01_EB, .285E-01_EB, .365E-01_EB, .423E-01_EB, .461E-01_EB, .482E-01_EB,     &
.281E-01_EB, .270E-01_EB, .432E-01_EB, .505E-01_EB, .529E-01_EB, .511E-01_EB,     &
.121E+00_EB, .422E-01_EB, .589E-01_EB, .598E-01_EB, .572E-01_EB, .544E-01_EB,     &
.139E+00_EB, .105E+00_EB, .844E-01_EB, .687E-01_EB, .593E-01_EB, .560E-01_EB,     &
.774E-01_EB, .710E-01_EB, .683E-01_EB, .618E-01_EB, .556E-01_EB, .534E-01_EB,     &
.858E-01_EB, .483E-01_EB, .579E-01_EB, .547E-01_EB, .503E-01_EB, .495E-01_EB,     &
.985E-01_EB, .575E-01_EB, .589E-01_EB, .510E-01_EB, .451E-01_EB, .449E-01_EB/),   &
(/6,8/))
SD(1:6,217:224) = RESHAPE ((/ & ! 5450-5625
.996E-01_EB, .682E-01_EB, .539E-01_EB, .489E-01_EB, .454E-01_EB, .446E-01_EB,     &
.680E-01_EB, .680E-01_EB, .548E-01_EB, .495E-01_EB, .460E-01_EB, .458E-01_EB,     &
.325E-01_EB, .520E-01_EB, .515E-01_EB, .483E-01_EB, .449E-01_EB, .454E-01_EB,     &
.150E-01_EB, .350E-01_EB, .451E-01_EB, .464E-01_EB, .452E-01_EB, .449E-01_EB,     &
.620E-02_EB, .238E-01_EB, .369E-01_EB, .408E-01_EB, .414E-01_EB, .417E-01_EB,     &
.270E-02_EB, .158E-01_EB, .282E-01_EB, .339E-01_EB, .366E-01_EB, .384E-01_EB,     &
.113E-02_EB, .101E-01_EB, .203E-01_EB, .263E-01_EB, .303E-01_EB, .333E-01_EB,     &
.829E-03_EB, .590E-02_EB, .148E-01_EB, .206E-01_EB, .247E-01_EB, .295E-01_EB/),  & 
(/6,8/))
SD(1:6,225:232) = RESHAPE ((/ & ! 5650-5825
.365E-03_EB, .310E-02_EB, .969E-02_EB, .154E-01_EB, .203E-01_EB, .258E-01_EB,     &
.240E-03_EB, .130E-02_EB, .589E-02_EB, .112E-01_EB, .164E-01_EB, .222E-01_EB,     &
.158E-03_EB, .400E-03_EB, .417E-02_EB, .850E-02_EB, .134E-01_EB, .190E-01_EB,     &
.103E-03_EB, .262E-03_EB, .208E-02_EB, .594E-02_EB, .109E-01_EB, .162E-01_EB,     &
.741E-04_EB, .181E-03_EB, .142E-02_EB, .455E-02_EB, .907E-02_EB, .141E-01_EB,     &
.625E-04_EB, .135E-03_EB, .816E-03_EB, .316E-02_EB, .698E-02_EB, .121E-01_EB,     &
.499E-04_EB, .111E-03_EB, .624E-03_EB, .230E-02_EB, .551E-02_EB, .102E-01_EB,     &
.325E-04_EB, .677E-04_EB, .425E-03_EB, .124E-02_EB, .385E-02_EB, .818E-02_EB/),   &
(/6,8/))
SD(1:6,233:240) = RESHAPE ((/ & ! 5850-6025
.231E-04_EB, .563E-04_EB, .278E-03_EB, .986E-03_EB, .290E-02_EB, .672E-02_EB,    &
.165E-04_EB, .481E-04_EB, .247E-03_EB, .944E-03_EB, .253E-02_EB, .612E-02_EB,           &
.126E-04_EB, .432E-04_EB, .241E-03_EB, .886E-03_EB, .220E-02_EB, .582E-02_EB,          &
.118E-04_EB, .420E-04_EB, .235E-03_EB, .847E-03_EB, .209E-02_EB, .571E-02_EB,          &
.110E-04_EB, .408E-04_EB, .226E-03_EB, .812E-03_EB, .221E-02_EB, .604E-02_EB,         &
.101E-04_EB, .400E-04_EB, .213E-03_EB, .805E-03_EB, .239E-02_EB, .641E-02_EB,        &
.983E-05_EB, .395E-04_EB, .186E-03_EB, .801E-03_EB, .247E-02_EB, .691E-02_EB,       &
.979E-05_EB, .401E-04_EB, .193E-03_EB, .805E-03_EB, .260E-02_EB, .732E-02_EB/),    &
(/6,8/))
SD(1:6,241:248) = RESHAPE ((/ & ! 6050-6225
.976E-05_EB, .410E-04_EB, .201E-03_EB, .814E-03_EB, .285E-02_EB, .776E-02_EB,     &
.988E-05_EB, .420E-04_EB, .210E-03_EB, .832E-03_EB, .317E-02_EB, .842E-02_EB,    &
.991E-05_EB, .425E-04_EB, .219E-03_EB, .877E-03_EB, .340E-02_EB, .888E-02_EB,        &
.102E-04_EB, .435E-04_EB, .231E-03_EB, .937E-03_EB, .361E-02_EB, .929E-02_EB,       &
.110E-04_EB, .486E-04_EB, .244E-03_EB, .971E-03_EB, .402E-02_EB, .994E-02_EB,      &
.127E-04_EB, .579E-04_EB, .257E-03_EB, .111E-02_EB, .437E-02_EB, .104E-01_EB,     &
.131E-04_EB, .612E-04_EB, .277E-03_EB, .113E-02_EB, .465E-02_EB, .110E-01_EB,        &
.150E-04_EB, .783E-04_EB, .353E-03_EB, .116E-02_EB, .510E-02_EB, .116E-01_EB/),     &
(/6,8/))
SD(1:6,249:256) = RESHAPE ((/ & ! 6250-6425
.178E-04_EB, .922E-04_EB, .394E-03_EB, .157E-02_EB, .555E-02_EB, .123E-01_EB,      &
.203E-04_EB, .115E-03_EB, .481E-03_EB, .188E-02_EB, .601E-02_EB, .131E-01_EB,     &
.230E-04_EB, .145E-03_EB, .617E-03_EB, .183E-02_EB, .644E-02_EB, .139E-01_EB,      & 
.280E-04_EB, .187E-03_EB, .723E-03_EB, .202E-02_EB, .686E-02_EB, .146E-01_EB,     & 
.305E-04_EB, .209E-03_EB, .811E-03_EB, .243E-02_EB, .779E-02_EB, .157E-01_EB,     &
.455E-04_EB, .244E-03_EB, .935E-03_EB, .243E-02_EB, .844E-02_EB, .166E-01_EB,    &
.661E-04_EB, .320E-03_EB, .989E-03_EB, .288E-02_EB, .902E-02_EB, .173E-01_EB,       & 
.723E-04_EB, .397E-03_EB, .122E-02_EB, .359E-02_EB, .100E-01_EB, .184E-01_EB/),    &
(/6,8/))
SD(1:6,257:264) = RESHAPE ((/ & ! 6450-6625
.847E-04_EB, .481E-03_EB, .143E-02_EB, .429E-02_EB, .108E-01_EB, .192E-01_EB,     &
.103E-03_EB, .591E-03_EB, .174E-02_EB, .488E-02_EB, .116E-01_EB, .200E-01_EB,           &
.131E-03_EB, .703E-03_EB, .247E-02_EB, .549E-02_EB, .124E-01_EB, .205E-01_EB,          &
.165E-03_EB, .872E-03_EB, .265E-02_EB, .641E-02_EB, .131E-01_EB, .211E-01_EB,         &
.205E-03_EB, .110E-02_EB, .298E-02_EB, .749E-02_EB, .140E-01_EB, .218E-01_EB,         &
.253E-03_EB, .130E-02_EB, .346E-02_EB, .811E-02_EB, .150E-01_EB, .230E-01_EB,         &
.338E-03_EB, .150E-02_EB, .445E-02_EB, .890E-02_EB, .159E-01_EB, .237E-01_EB,        &
.437E-03_EB, .170E-02_EB, .491E-02_EB, .107E-01_EB, .170E-01_EB, .245E-01_EB/),     &
(/6,8/))
SD(1:6,265:272) = RESHAPE ((/ & ! 6650-6825
.581E-03_EB, .190E-02_EB, .537E-02_EB, .116E-01_EB, .179E-01_EB, .254E-01_EB,         &
.685E-03_EB, .220E-02_EB, .578E-02_EB, .128E-01_EB, .189E-01_EB, .263E-01_EB,        &
.900E-03_EB, .250E-02_EB, .649E-02_EB, .134E-01_EB, .195E-01_EB, .275E-01_EB,       &
.121E-02_EB, .280E-02_EB, .722E-02_EB, .142E-01_EB, .202E-01_EB, .281E-01_EB,      &
.152E-02_EB, .330E-02_EB, .813E-02_EB, .161E-01_EB, .212E-01_EB, .288E-01_EB,     &
.185E-02_EB, .370E-02_EB, .907E-02_EB, .168E-01_EB, .222E-01_EB, .292E-01_EB,    &
.220E-02_EB, .430E-02_EB, .929E-02_EB, .183E-01_EB, .233E-01_EB, .294E-01_EB,       &
.255E-02_EB, .500E-02_EB, .114E-01_EB, .195E-01_EB, .245E-01_EB, .289E-01_EB/),       &
(/6,8/))
SD(1:6,273:280) = RESHAPE ((/ & ! 6850-7025
.290E-02_EB, .580E-02_EB, .167E-01_EB, .215E-01_EB, .260E-01_EB, .291E-01_EB,        &
.320E-02_EB, .670E-02_EB, .208E-01_EB, .237E-01_EB, .274E-01_EB, .293E-01_EB,        &
.360E-02_EB, .880E-02_EB, .220E-01_EB, .253E-01_EB, .282E-01_EB, .300E-01_EB,       &
.400E-02_EB, .920E-02_EB, .238E-01_EB, .273E-01_EB, .290E-01_EB, .304E-01_EB,        &
.460E-02_EB, .108E-01_EB, .272E-01_EB, .279E-01_EB, .298E-01_EB, .310E-01_EB,       &
.530E-02_EB, .128E-01_EB, .304E-01_EB, .292E-01_EB, .297E-01_EB, .312E-01_EB,        &
.620E-02_EB, .152E-01_EB, .344E-01_EB, .303E-01_EB, .293E-01_EB, .310E-01_EB,       &
.760E-02_EB, .182E-01_EB, .341E-01_EB, .297E-01_EB, .290E-01_EB, .300E-01_EB/),    &
(/6,8/))
SD(1:6,281:288) = RESHAPE ((/ & ! 7050-7225
.980E-02_EB, .222E-01_EB, .398E-01_EB, .318E-01_EB, .291E-01_EB, .294E-01_EB,       & 
.132E-01_EB, .271E-01_EB, .402E-01_EB, .294E-01_EB, .274E-01_EB, .282E-01_EB,      & 
.190E-01_EB, .335E-01_EB, .421E-01_EB, .286E-01_EB, .262E-01_EB, .269E-01_EB,     & 
.240E-01_EB, .432E-01_EB, .431E-01_EB, .276E-01_EB, .245E-01_EB, .257E-01_EB,    & 
.288E-01_EB, .570E-01_EB, .458E-01_EB, .270E-01_EB, .228E-01_EB, .243E-01_EB,   &
.323E-01_EB, .740E-01_EB, .449E-01_EB, .261E-01_EB, .214E-01_EB, .221E-01_EB,        &
.570E-01_EB, .890E-01_EB, .435E-01_EB, .225E-01_EB, .199E-01_EB, .196E-01_EB,       &
.216E-01_EB, .680E-01_EB, .378E-01_EB, .239E-01_EB, .195E-01_EB, .192E-01_EB/),    &
(/6,8/))
SD(1:6,289:296) = RESHAPE ((/ & ! 7250-7425
.126E-01_EB, .475E-01_EB, .364E-01_EB, .238E-01_EB, .197E-01_EB, .192E-01_EB,      & 
.117E-01_EB, .369E-01_EB, .385E-01_EB, .249E-01_EB, .212E-01_EB, .204E-01_EB,     & 
.140E-01_EB, .370E-01_EB, .419E-01_EB, .272E-01_EB, .228E-01_EB, .213E-01_EB,    & 
.425E-01_EB, .418E-01_EB, .440E-01_EB, .280E-01_EB, .248E-01_EB, .229E-01_EB,   &
.640E-01_EB, .460E-01_EB, .427E-01_EB, .290E-01_EB, .263E-01_EB, .238E-01_EB,   &
.385E-01_EB, .385E-01_EB, .374E-01_EB, .259E-01_EB, .235E-01_EB, .224E-01_EB,        &
.182E-01_EB, .179E-01_EB, .282E-01_EB, .231E-01_EB, .211E-01_EB, .214E-01_EB,       &
.170E-01_EB, .810E-02_EB, .191E-01_EB, .175E-01_EB, .181E-01_EB, .194E-01_EB/),     & 
(/6,8/))
SD(1:6,297:304) = RESHAPE ((/ & ! 7450-7625
.161E-01_EB, .370E-02_EB, .105E-01_EB, .127E-01_EB, .152E-01_EB, .171E-01_EB,      & 
.145E-01_EB, .170E-02_EB, .554E-02_EB, .855E-02_EB, .113E-01_EB, .131E-01_EB,     & 
.175E-02_EB, .140E-02_EB, .385E-02_EB, .595E-02_EB, .803E-02_EB, .945E-02_EB,    &
.772E-03_EB, .751E-03_EB, .384E-02_EB, .575E-02_EB, .537E-02_EB, .594E-02_EB,       &
.491E-03_EB, .600E-03_EB, .301E-02_EB, .453E-02_EB, .380E-02_EB, .434E-02_EB,      &
.275E-03_EB, .410E-03_EB, .193E-02_EB, .366E-02_EB, .319E-02_EB, .332E-02_EB,     &
.185E-01_EB, .280E-03_EB, .131E-02_EB, .232E-02_EB, .247E-02_EB, .256E-02_EB,      &
.101E-03_EB, .160E-03_EB, .915E-03_EB, .150E-02_EB, .186E-02_EB, .197E-02_EB/),   &
(/6,8/))
SD(1:6,305:312) = RESHAPE ((/ & ! 7650-7825
.691E-04_EB, .110E-03_EB, .565E-03_EB, .114E-02_EB, .205E-02_EB, .192E-02_EB,        &  
.476E-04_EB, .750E-04_EB, .114E-02_EB, .124E-02_EB, .175E-02_EB, .187E-02_EB,         &
.305E-04_EB, .590E-04_EB, .529E-03_EB, .114E-02_EB, .160E-02_EB, .185E-02_EB,       &
.240E-04_EB, .480E-04_EB, .293E-03_EB, .842E-03_EB, .141E-02_EB, .184E-02_EB,       &
.170E-04_EB, .360E-04_EB, .122E-03_EB, .435E-03_EB, .124E-02_EB, .182E-02_EB,      &
.120E-04_EB, .240E-04_EB, .121E-03_EB, .435E-03_EB, .118E-02_EB, .187E-02_EB,     &
.810E-05_EB, .170E-04_EB, .103E-03_EB, .439E-03_EB, .126E-02_EB, .192E-02_EB,    &
.550E-05_EB, .120E-04_EB, .866E-04_EB, .367E-03_EB, .119E-02_EB, .193E-02_EB/),    &
(/6,8/))
SD(1:6,313:320) = RESHAPE ((/&  ! 7850-8025
.390E-05_EB, .900E-05_EB, .716E-04_EB, .351E-03_EB, .116E-02_EB, .194E-02_EB,        & 
.295E-05_EB, .830E-05_EB, .373E-04_EB, .254E-03_EB, .114E-02_EB, .196E-02_EB,       & 
.230E-05_EB, .800E-05_EB, .465E-04_EB, .298E-03_EB, .117E-02_EB, .201E-02_EB,      & 
.225E-05_EB, .820E-05_EB, .367E-04_EB, .252E-03_EB, .116E-02_EB, .205E-02_EB,     & 
.220E-05_EB, .840E-05_EB, .371E-04_EB, .268E-03_EB, .127E-02_EB, .211E-02_EB,    & 
.223E-05_EB, .920E-05_EB, .396E-04_EB, .273E-03_EB, .128E-02_EB, .216E-02_EB,   &
.235E-05_EB, .103E-04_EB, .415E-04_EB, .263E-03_EB, .121E-02_EB, .221E-02_EB,      &
.280E-05_EB, .125E-04_EB, .633E-04_EB, .363E-03_EB, .136E-02_EB, .231E-02_EB/),   &
(/6,8/))
SD(1:6,321:328) = RESHAPE ((/ & ! 8050-8225
.310E-05_EB, .150E-04_EB, .979E-04_EB, .492E-03_EB, .150E-02_EB, .241E-02_EB,           &
.370E-05_EB, .180E-04_EB, .120E-03_EB, .580E-03_EB, .167E-02_EB, .251E-02_EB,           &
.420E-05_EB, .200E-04_EB, .987E-04_EB, .509E-03_EB, .171E-02_EB, .257E-02_EB,           &
.510E-05_EB, .240E-04_EB, .134E-03_EB, .547E-03_EB, .173E-02_EB, .267E-02_EB,           &
.600E-05_EB, .270E-04_EB, .121E-03_EB, .534E-03_EB, .172E-02_EB, .274E-02_EB,           &
.720E-05_EB, .300E-04_EB, .204E-03_EB, .684E-03_EB, .184E-02_EB, .285E-02_EB,           &
.820E-05_EB, .330E-04_EB, .276E-03_EB, .819E-03_EB, .199E-02_EB, .297E-02_EB,           &
.100E-04_EB, .380E-04_EB, .317E-03_EB, .859E-03_EB, .214E-02_EB, .308E-02_EB/),         &
(/6,8/))
SD(1:6,329:336) = RESHAPE ((/ & ! 8250-8425
.125E-04_EB, .420E-04_EB, .240E-03_EB, .818E-03_EB, .220E-02_EB, .317E-02_EB,           &
.145E-04_EB, .500E-04_EB, .452E-03_EB, .109E-02_EB, .238E-02_EB, .293E-02_EB,           &
.175E-04_EB, .560E-04_EB, .301E-03_EB, .941E-03_EB, .243E-02_EB, .342E-02_EB,           &
.198E-04_EB, .630E-04_EB, .280E-03_EB, .107E-02_EB, .260E-02_EB, .353E-02_EB,           &
.230E-04_EB, .710E-04_EB, .276E-03_EB, .109E-02_EB, .272E-02_EB, .365E-02_EB,           &
.280E-04_EB, .830E-04_EB, .369E-03_EB, .127E-02_EB, .295E-02_EB, .377E-02_EB,           &
.330E-04_EB, .890E-04_EB, .430E-03_EB, .139E-02_EB, .306E-02_EB, .385E-02_EB,           &
.360E-04_EB, .950E-04_EB, .371E-03_EB, .135E-02_EB, .306E-02_EB, .384E-02_EB/),         &
(/6,8/))
SD(1:6,337:344) = RESHAPE ((/ & ! 8450-8625
.390E-04_EB, .980E-04_EB, .434E-03_EB, .147E-02_EB, .316E-02_EB, .385E-02_EB,           &
.400E-04_EB, .990E-04_EB, .397E-03_EB, .143E-02_EB, .318E-02_EB, .384E-02_EB,           &
.400E-04_EB, .980E-04_EB, .364E-03_EB, .141E-02_EB, .317E-02_EB, .381E-02_EB,           &
.390E-04_EB, .940E-04_EB, .390E-03_EB, .142E-02_EB, .314E-02_EB, .376E-02_EB,          &
.380E-04_EB, .900E-04_EB, .380E-03_EB, .145E-02_EB, .318E-02_EB, .375E-02_EB,         &
.380E-04_EB, .900E-04_EB, .380E-03_EB, .145E-02_EB, .318E-02_EB, .375E-02_EB,        &
.330E-04_EB, .750E-04_EB, .358E-03_EB, .138E-02_EB, .310E-02_EB, .372E-02_EB,       &
.270E-04_EB, .580E-04_EB, .382E-03_EB, .143E-02_EB, .315E-02_EB, .369E-02_EB/),    &
(/6,8/))
SD(1:6,345:352) = RESHAPE ((/ & ! 8650-8825
.240E-04_EB, .500E-04_EB, .343E-03_EB, .136E-02_EB, .306E-02_EB, .363E-02_EB,          &
.200E-04_EB, .450E-04_EB, .309E-03_EB, .134E-02_EB, .306E-02_EB, .359E-02_EB,         & 
.180E-04_EB, .400E-04_EB, .281E-03_EB, .127E-02_EB, .294E-02_EB, .341E-02_EB,        &
.170E-04_EB, .360E-04_EB, .276E-03_EB, .124E-02_EB, .290E-02_EB, .336E-02_EB,       & 
.160E-04_EB, .310E-04_EB, .272E-03_EB, .122E-02_EB, .283E-02_EB, .323E-02_EB,      &  
.140E-04_EB, .280E-04_EB, .241E-03_EB, .117E-02_EB, .273E-02_EB, .309E-02_EB,       &
.120E-04_EB, .250E-04_EB, .237E-03_EB, .115E-02_EB, .269E-02_EB, .297E-02_EB,      &
.100E-04_EB, .220E-04_EB, .218E-03_EB, .111E-02_EB, .259E-02_EB, .284E-02_EB/),   &
(/6,8/))
SD(1:6,353:360) = RESHAPE ((/ & ! 8850-9025
.920E-05_EB, .198E-04_EB, .206E-03_EB, .105E-02_EB, .246E-02_EB, .269E-02_EB,       &
.810E-05_EB, .170E-04_EB, .205E-03_EB, .100E-02_EB, .235E-02_EB, .257E-02_EB,       & 
.720E-05_EB, .160E-04_EB, .177E-03_EB, .921E-03_EB, .220E-02_EB, .245E-02_EB,      &
.650E-05_EB, .150E-04_EB, .172E-03_EB, .834E-03_EB, .205E-02_EB, .232E-02_EB,     &
.590E-05_EB, .130E-04_EB, .147E-03_EB, .735E-03_EB, .194E-02_EB, .218E-02_EB,    &
.510E-05_EB, .110E-04_EB, .120E-03_EB, .629E-03_EB, .177E-02_EB, .203E-02_EB,     &
.460E-05_EB, .950E-05_EB, .960E-04_EB, .513E-03_EB, .154E-02_EB, .180E-02_EB,      &
.420E-05_EB, .800E-05_EB, .578E-04_EB, .314E-03_EB, .123E-02_EB, .154E-02_EB/),     &
(/6,8/))
SD(1:6,361:368) = RESHAPE ((/ & ! 9050-9225
.380E-05_EB, .720E-05_EB, .529E-04_EB, .292E-03_EB, .114E-02_EB, .137E-02_EB,      &
.330E-05_EB, .660E-05_EB, .485E-04_EB, .269E-03_EB, .102E-02_EB, .122E-02_EB,      &
.290E-05_EB, .580E-05_EB, .430E-04_EB, .239E-03_EB, .896E-03_EB, .107E-02_EB,      &
.270E-05_EB, .520E-05_EB, .259E-04_EB, .193E-03_EB, .748E-03_EB, .944E-03_EB,     &
.240E-05_EB, .450E-05_EB, .316E-04_EB, .207E-03_EB, .671E-02_EB, .848E-03_EB,      &
.220E-05_EB, .400E-05_EB, .444E-05_EB, .602E-04_EB, .516E-03_EB, .750E-03_EB,     &
.190E-05_EB, .360E-05_EB, .324E-05_EB, .460E-04_EB, .439E-03_EB, .688E-03_EB,     & 
.170E-05_EB, .320E-05_EB, .180E-05_EB, .321E-04_EB, .384E-03_EB, .653E-03_EB/),  & 
(/6,8/))
SD(1:6,369:376) = RESHAPE ((/ & ! 9250-9300
.140E-05_EB, .280E-05_EB, .171E-05_EB, .344E-04_EB, .340E-03_EB, .616E-03_EB,   & 
.130E-05_EB, .250E-05_EB, .299E-05_EB, .600E-04_EB, .343E-03_EB, .619E-03_EB,  &  
.120E-05_EB, .220E-05_EB, .299E-05_EB, .600E-04_EB, .343E-03_EB, .619E-03_EB, &  
1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB,&
1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB, 1._EB/),&
(/6,8/))

! Intialize GAMMA Array

GAMMA = RESHAPE((/ &
!     LINE BROADENING PARAMETERS,GAMMA(I,J),
!     J=CO2,H2O,CH4,CO,O2,N2,SELF RESONANT.
!   I=     CO2  H2O  CH4   CO
!    J
.09_EB , .12_EB, .0_EB , .07_EB,&
.07_EB , .09_EB, .0_EB , .06_EB,&
!.0_EB  , .0_EB , .16_EB, .0_EB ,&
.0_EB  , .0_EB , .12_EB, .0_EB ,&
.06_EB , .10_EB, .0_EB , .06_EB,&
.055_EB, .04_EB, .0_EB , .05_EB,&
.07_EB , .09_EB, .0_EB , .06_EB, &
.01_EB , .44_EB, .0_EB , .0_EB /),(/4,7/))

! Initialize SD15 Array

!  THE FOLLOWING ARE DATA FOR THE 15.0 MICRON BAND OF CO2
!  TEMP, K=300     600      1200      1500  1800    2400    

SD15(1:6,1:8) = RESHAPE ((/  &! 500-535
.000E+00_EB, .000E+00_EB, .000E+00_EB, .105E-01_EB, .300E-01_EB, .880E-01_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .180E-01_EB, .490E-01_EB, .880E-01_EB,         & 
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .540E-01_EB, .740E-01_EB,        &  
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .560E-01_EB, .890E-01_EB,       &   
.000E+00_EB, .000E+00_EB, .000E+00_EB, .330E-01_EB, .690E-01_EB, .990E-01_EB,      &    
.000E+00_EB, .000E+00_EB, .880E-02_EB, .380E-01_EB, .720E-01_EB, .970E-01_EB,     &     
.000E+00_EB, .000E+00_EB, .110E-01_EB, .530E-01_EB, .950E-01_EB, .124E+00_EB,    &      
.000E+00_EB, .000E+00_EB, .285E-01_EB, .630E-01_EB, .990E-01_EB, .140E+00_EB/), &       
(/6,8/))
SD15(1:6,9:16) = RESHAPE ((/  &! 540-575
.000E+00_EB, .000E+00_EB, .330E-01_EB, .680E-01_EB, .103E+00_EB, .134E+00_EB,          &
.000E+00_EB, .000E+00_EB, .450E-01_EB, .920E-01_EB, .138E+00_EB, .176E+00_EB,          &
.000E+00_EB, .000E+00_EB, .490E-01_EB, .970E-01_EB, .148E+00_EB, .191E+00_EB,         & 
.000E+00_EB, .000E+00_EB, .490E-01_EB, .120E-01_EB, .188E+00_EB, .247E+00_EB,        &  
.000E+00_EB, .000E+00_EB, .480E-01_EB, .126E+00_EB, .201E+00_EB, .241E+00_EB,       &   
.000E+00_EB, .000E+00_EB, .820E-01_EB, .198E+00_EB, .270E+00_EB, .265E+00_EB,      &    
.000E+00_EB, .750E-02_EB, .690E-01_EB, .140E+00_EB, .225E+00_EB, .340E+00_EB,     &     
.000E+00_EB, .205E-01_EB, .820E-01_EB, .145E+00_EB, .236E+00_EB, .530E+00_EB/),  &      
(/6,8/))
SD15(1:6,17:24) = RESHAPE ((/ & ! 580-615
.000E+00_EB, .355E-01_EB, .117E+00_EB, .193E+00_EB, .295E+00_EB, .550E+00_EB,          &
.157E-01_EB, .520E-01_EB, .170E+00_EB, .235E+00_EB, .305E+00_EB, .410E+00_EB,          &
.150E-01_EB, .880E-01_EB, .270E+00_EB, .330E+00_EB, .440E+00_EB, .520E+00_EB,          &
.510E-01_EB, .130E+00_EB, .400E+00_EB, .530E+00_EB, .560E+00_EB, .540E+00_EB,         & 
.120E+00_EB, .165E+00_EB, .275E+00_EB, .320E+00_EB, .420E+00_EB, .560E+00_EB,        &  
.880E-01_EB, .190E+00_EB, .430E+00_EB, .540E+00_EB, .620E+00_EB, .680E+00_EB,       &   
.110E+00_EB, .350E+00_EB, .710E+00_EB, .760E+00_EB, .760E+00_EB, .690E+00_EB,      &    
.180E+00_EB, .470E+00_EB, .920E+00_EB, .970E+00_EB, .910E+00_EB, .670E+00_EB/),   &     
(/6,8/))
SD15(1:6,25:32) = RESHAPE ((/ & ! 620-655
.970E-01_EB, .265E+00_EB, .610E+00_EB, .720E+00_EB, .780E+00_EB, .730E+00_EB,          &
.175E+00_EB, .380E+00_EB, .720E+00_EB, .790E+00_EB, .830E+00_EB, .840E+00_EB,          &
.370E+00_EB, .640E+00_EB, .920E+00_EB, .960E+00_EB, .980E+00_EB, .940E+00_EB,          &
.590E+00_EB, .840E+00_EB, .107E+01_EB, .110E+01_EB, .111E+01_EB, .106E+01_EB,         & 
.940E+00_EB, .103E+01_EB, .115E+01_EB, .115E+01_EB, .115E+01_EB, .118E+01_EB,        &  
.196E+01_EB, .177E+01_EB, .146E+01_EB, .136E+01_EB, .132E+01_EB, .139E+01_EB,       &   
.345E+01_EB, .282E+01_EB, .198E+01_EB, .172E+01_EB, .156E+01_EB, .148E+01_EB,      &    
.282E+01_EB, .248E+01_EB, .200E+01_EB, .190E+01_EB, .186E+01_EB, .205E+01_EB/),   &     
(/6,8/))
SD15(1:6,33:40) = RESHAPE ((/  &! 660-695
.254E+01_EB, .234E+01_EB, .184E+01_EB, .176E+01_EB, .174E+01_EB, .203E+01_EB,          &
.142E+02_EB, .860E+01_EB, .370E+01_EB, .260E+01_EB, .196E+01_EB, .142E+01_EB,          &
.450E+01_EB, .570E+01_EB, .580E+01_EB, .520E+01_EB, .350E+01_EB, .420E+01_EB,         & 
.360E+01_EB, .310E+01_EB, .330E+01_EB, .290E+01_EB, .205E+01_EB, .200E+01_EB,        &  
.310E+01_EB, .260E+01_EB, .200E+01_EB, .196E+01_EB, .180E+01_EB, .210E+01_EB,       &   
.240E+01_EB, .250E+01_EB, .230E+01_EB, .220E+01_EB, .170E+01_EB, .194E+01_EB,      &    
.182E+01_EB, .200E+01_EB, .218E+01_EB, .205E+01_EB, .184E+01_EB, .130E+01_EB,     &     
.104E+01_EB, .135E+01_EB, .172E+01_EB, .172E+01_EB, .165E+01_EB, .130E+01_EB/),  &      
(/6,8/))
SD15(1:6,41:48) = RESHAPE ((/  &! 700-735
.550E+00_EB, .120E+01_EB, .143E+01_EB, .147E+01_EB, .148E+01_EB, .125E+01_EB,          &
.136E+01_EB, .128E+01_EB, .128E+01_EB, .135E+01_EB, .138E+01_EB, .134E+01_EB,          &
.210E+00_EB, .780E+00_EB, .127E+01_EB, .133E+01_EB, .137E+01_EB, .132E+01_EB,          &
.190E+00_EB, .780E+00_EB, .140E+01_EB, .146E+01_EB, .147E+01_EB, .142E+01_EB,         & 
.900E+00_EB, .106E+01_EB, .140E+01_EB, .150E+01_EB, .155E+01_EB, .134E+01_EB,        &  
.720E-01_EB, .300E+00_EB, .800E+00_EB, .100E+01_EB, .115E+01_EB, .126E+01_EB,       &   
.640E-01_EB, .210E+00_EB, .560E+00_EB, .720E+00_EB, .860E+00_EB, .102E+01_EB,      &    
.680E-01_EB, .210E+00_EB, .530E+00_EB, .670E+00_EB, .790E+00_EB, .101E+01_EB/),   &     
(/6,8/))
SD15(1:6,49:56) = RESHAPE ((/ & ! 740-775
.690E-01_EB, .210E+00_EB, .540E+00_EB, .690E+00_EB, .820E+00_EB, .910E+00_EB,          &
.330E-01_EB, .140E+00_EB, .390E+00_EB, .530E+00_EB, .690E+00_EB, .770E+00_EB,          &
.230E-01_EB, .780E-01_EB, .270E+00_EB, .410E+00_EB, .560E+00_EB, .890E+00_EB,          &
.300E-01_EB, .860E-01_EB, .280E+00_EB, .400E+00_EB, .520E+00_EB, .710E+00_EB,         & 
.175E-01_EB, .620E-01_EB, .225E+00_EB, .335E+00_EB, .450E+00_EB, .660E+00_EB,       &   
.105E-01_EB, .450E-01_EB, .180E+00_EB, .280E+00_EB, .380E+00_EB, .600E+00_EB,      &    
.450E-02_EB, .300E-01_EB, .148E+00_EB, .240E+00_EB, .345E+00_EB, .570E+00_EB,     &     
.000E+00_EB, .140E-01_EB, .124E+00_EB, .205E+00_EB, .285E+00_EB, .430E+00_EB/),  &      
(/6,8/))
SD15(1:6,57:64) = RESHAPE ((/ & ! 780-815
.000E+00_EB, .115E-01_EB, .110E+00_EB, .185E+00_EB, .260E+00_EB, .375E+00_EB,          &
.000E+00_EB, .135E-01_EB, .840E-01_EB, .140E+00_EB, .205E+00_EB, .335E+00_EB,         & 
.000E+00_EB, .430E-02_EB, .650E-01_EB, .120E+00_EB, .185E+00_EB, .325E+00_EB,        &  
.000E+00_EB, .000E+00_EB, .540E-01_EB, .115E+00_EB, .180E+00_EB, .315E+00_EB,       &   
.000E+00_EB, .000E+00_EB, .440E-01_EB, .950E-01_EB, .150E+00_EB, .270E+00_EB,      &    
.000E+00_EB, .000E+00_EB, .360E-01_EB, .790E-01_EB, .125E+00_EB, .205E+00_EB,     &     
.000E+00_EB, .000E+00_EB, .250E-01_EB, .650E-01_EB, .110E+00_EB, .178E+00_EB,    &      
.000E+00_EB, .000E+00_EB, .180E-01_EB, .620E-01_EB, .103E+00_EB, .153E+00_EB/), &       
(/6,8/))
SD15(1:6,65:72) = RESHAPE ((/ & ! 820-855
.000E+00_EB, .000E+00_EB, .320E-01_EB, .580E-01_EB, .860E-01_EB, .147E+00_EB,          &
.000E+00_EB, .000E+00_EB, .800E-02_EB, .510E-01_EB, .870E-01_EB, .134E+00_EB,          &
.000E+00_EB, .000E+00_EB, .600E-02_EB, .480E-01_EB, .830E-01_EB, .133E+00_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .430E-01_EB, .780E-01_EB, .118E+00_EB,          &
.000E+00_EB, .000E+00_EB, .000E+00_EB, .420E-01_EB, .700E-01_EB, .108E+00_EB,         & 
.000E+00_EB, .000E+00_EB, .000E+00_EB, .360E-01_EB, .640E-01_EB, .980E-01_EB,        &  
.000E+00_EB, .000E+00_EB, .000E+00_EB, .350E-01_EB, .610E-01_EB, .870E-01_EB,       &   
.000E+00_EB, .000E+00_EB, .000E+00_EB, .320E-01_EB, .580E-01_EB, .860E-01_EB/),    &    
(/6,8/))
SD15(1:6,73:80) = RESHAPE ((/ & ! 860-880
.000E+00_EB, .000E+00_EB, .000E+00_EB, .330E-01_EB, .560E-01_EB, .750E-01_EB,     &     
.000E+00_EB, .000E+00_EB, .000E+00_EB, .300E-01_EB, .530E-01_EB, .750E-01_EB,    &      
.000E+00_EB, .000E+00_EB, .000E+00_EB, .290E-01_EB, .530E-01_EB, .850E-01_EB,   &       
.000E+00_EB, .000E+00_EB, .000E+00_EB, .240E-01_EB, .470E-01_EB, .900E-01_EB,  &        
.000E+00_EB, .000E+00_EB, .000E+00_EB, .220E-01_EB, .450E-01_EB, .860E-01_EB, &         
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB,&
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB,&
.000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB, .000E+00_EB/), &
(/6,8/))

! Initialize SD7 Array

!   THE FOLLOWING DATA ARE FOR THE 7.7 MICRON BAND OF CH4
! TEMP,K= 290 600   850

SD7(1:3,1:8) = RESHAPE ((/ &
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.22_EB,&
0.16_EB, 0.20_EB, 0.47_EB,&
0.34_EB, 0.34_EB, 0.62_EB,&
0.69_EB, 0.53_EB, 0.65_EB,&
1.27_EB, 0.88_EB, 1.09_EB,&
1.68_EB, 1.38_EB, 0.87_EB/),(/3,8/))
SD7(1:3,9:16) = RESHAPE ((/&
0.55_EB, 0.28_EB, 0.40_EB,&
1.25_EB, 0.86_EB, 0.93_EB,&
0.34_EB, 0.59_EB, 0.75_EB,&
0._EB, 0.13_EB, 0.25_EB,&
0._EB, 0._EB, 0.06_EB,&
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0._EB,&
0._EB, 0._EB, 0._EB/),(/3,8/))

! Initialize SD3 Array

!  THE FOLLOWING DATA ARE FOR THE 3.3 MICRON BAND OF CH4
! TEMP, K= 290  600   850
SD3(1:3,1:8) = RESHAPE ((/&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0.06_EB,&
0.03_EB, 0.03_EB, 0.09_EB,&
0.07_EB, 0.07_EB, 0.12_EB,&
0.09_EB, 0.09_EB, 0.12_EB,&
0.14_EB, 0.15_EB, 0.22_EB/),(/3,8/))
SD3(1:3,9:16) = RESHAPE ((/&
0.18_EB, 0.22_EB, 0.28_EB,&
0.24_EB, 0.31_EB, 0.37_EB,&
0.33_EB, 0.44_EB, 0.47_EB,&
0.45_EB, 0.50_EB, 0.53_EB,&
0.59_EB, 0.62_EB, 0.62_EB,&
0.74_EB, 0.70_EB, 0.68_EB,&
0.91_EB, 0.77_EB, 0.72_EB,&
1.00_EB, 0.81_EB, 0.75_EB/),(/3,8/))
SD3(1:3,17:24) = RESHAPE ((/&
1.03_EB, 0.84_EB, 0.78_EB,&
1.03_EB, 0.84_EB, 0.78_EB,&
1.00_EB, 0.81_EB, 0.75_EB,&
0.94_EB, 0.77_EB, 0.72_EB,&
0.72_EB, 0.68_EB, 0.68_EB,&
0.52_EB, 0.63_EB, 0.63_EB,&
0.33_EB, 0.50_EB, 0.56_EB,&
0.25_EB, 0.42_EB, 0.50_EB/),(/3,8/))
SD3(1:3,25:32) = RESHAPE ((/&
0.17_EB, 0.26_EB, 0.37_EB,&
0.08_EB, 0.18_EB, 0.31_EB,&
0.04_EB, 0.11_EB, 0.22_EB,&
0._EB, 0.06_EB, 0.16_EB,&
0._EB, 0.02_EB, 0.12_EB,&
0._EB, 0._EB, 0.06_EB,&
0._EB, 0._EB, 0.03_EB,&
0._EB, 0._EB, 0._EB/),(/3,8/))
!------------------------------------------------------------------------------
END SUBROUTINE RCALLOC

!==============================================================================
SUBROUTINE RCDEALLOC
!==============================================================================   
DEALLOCATE(P)
DEALLOCATE(SPECIE)
DEALLOCATE(QW)
DEALLOCATE(TTAU)
DEALLOCATE(XT)
DEALLOCATE(X)
DEALLOCATE(GC)
DEALLOCATE(LAMBDA)
DEALLOCATE(OPTICAL_THICKNESS)
DEALLOCATE(AB)
DEALLOCATE(ATOT)
DEALLOCATE(BCNT)
DEALLOCATE(GAMMA)
DEALLOCATE(SD15)
DEALLOCATE(SD)
DEALLOCATE(SD7)
DEALLOCATE(SD3)

!-------------------------DEALLOCATION Methane VARIABLES-------------------
DEALLOCATE(SD_CH4_TEMP)
DEALLOCATE(OM_BND_CH4)
DEALLOCATE(SD1_CH4)
DEALLOCATE(SD2_CH4)

!-------------------------DEALLOCATION Propane VARIABLES-------------------
DEALLOCATE(SD_C3H8_TEMP)
DEALLOCATE(Be_C3H8)
DEALLOCATE(OM_BND_C3H8)
DEALLOCATE(SD1_C3H8)
DEALLOCATE(SD2_C3H8)
DEALLOCATE(GAMMAD1_C3H8)
DEALLOCATE(GAMMAD2_C3H8)

!-------------------------DEALLOCATION Methanol VARIABLES-------------------
DEALLOCATE(SD_CH3OH_TEMP)
DEALLOCATE(Be_CH3OH)
DEALLOCATE(OM_BND_CH3OH)
DEALLOCATE(SD1_CH3OH)
DEALLOCATE(SD2_CH3OH)
DEALLOCATE(SD3_CH3OH)
DEALLOCATE(SD4_CH3OH)
DEALLOCATE(GAMMAD1_CH3OH)
DEALLOCATE(GAMMAD2_CH3OH)
DEALLOCATE(GAMMAD3_CH3OH)
DEALLOCATE(GAMMAD4_CH3OH)

!-------------------------DEALLOCATION Heptane VARIABLES-------------------
DEALLOCATE(SD_C7H16_TEMP)
DEALLOCATE(Be_C7H16)
DEALLOCATE(OM_BND_C7H16)
DEALLOCATE(SD1_C7H16)
DEALLOCATE(SD2_C7H16)
DEALLOCATE(GAMMAD1_C7H16)
DEALLOCATE(GAMMAD2_C7H16)

!-------------------------DEALLOCATION Toluene VARIABLES-------------------
DEALLOCATE(SD_C7H8_TEMP)
DEALLOCATE(Be_C7H8)
DEALLOCATE(OM_BND_C7H8)
DEALLOCATE(SD1_C7H8)
DEALLOCATE(SD2_C7H8)
DEALLOCATE(SD3_C7H8)
DEALLOCATE(SD4_C7H8)
DEALLOCATE(SD5_C7H8)
DEALLOCATE(GAMMAD1_C7H8)
DEALLOCATE(GAMMAD2_C7H8)
DEALLOCATE(GAMMAD3_C7H8)
DEALLOCATE(GAMMAD4_C7H8)
DEALLOCATE(GAMMAD5_C7H8)

!-------------------------DEALLOCATION Propylene VARIABLES-------------------
DEALLOCATE(SD_C3H6_TEMP)
DEALLOCATE(Be_C3H6)
DEALLOCATE(OM_BND_C3H6)
DEALLOCATE(SD1_C3H6)
DEALLOCATE(SD2_C3H6)
DEALLOCATE(SD3_C3H6)
DEALLOCATE(GAMMAD1_C3H6)
DEALLOCATE(GAMMAD2_C3H6)
DEALLOCATE(GAMMAD3_C3H6)

!-------------------------DEALLOCATION MMA VARIABLES-------------------
DEALLOCATE(SD_C5H8O2_TEMP)
DEALLOCATE(Be_C5H8O2)
DEALLOCATE(OM_BND_C5H8O2)
DEALLOCATE(SD1_C5H8O2)
DEALLOCATE(SD2_C5H8O2)
DEALLOCATE(SD3_C5H8O2)
DEALLOCATE(SD4_C5H8O2)
DEALLOCATE(SD5_C5H8O2)
DEALLOCATE(SD6_C5H8O2)
DEALLOCATE(GAMMAD1_C5H8O2)
DEALLOCATE(GAMMAD2_C5H8O2)
DEALLOCATE(GAMMAD3_C5H8O2)
DEALLOCATE(GAMMAD4_C5H8O2)
DEALLOCATE(GAMMAD5_C5H8O2)
DEALLOCATE(GAMMAD6_C5H8O2)

!-------------------------DEALLOCATION Ethane VARIABLES-------------------
DEALLOCATE(SD_C2H6_TEMP)
DEALLOCATE(Be_C2H6)
DEALLOCATE(OM_BND_C2H6)
DEALLOCATE(SD1_C2H6)
DEALLOCATE(SD2_C2H6)
DEALLOCATE(SD3_C2H6)
DEALLOCATE(GAMMAD1_C2H6)
DEALLOCATE(GAMMAD2_C2H6)
DEALLOCATE(GAMMAD3_C2H6)

!-------------------------DEALLOCATION Ethylene VARIABLES-------------------
DEALLOCATE(SD_C2H4_TEMP)
DEALLOCATE(Be_C2H4)
DEALLOCATE(OM_BND_C2H4)
DEALLOCATE(SD1_C2H4)
DEALLOCATE(SD2_C2H4)
DEALLOCATE(SD3_C2H4)
DEALLOCATE(SD4_C2H4)
DEALLOCATE(GAMMAD1_C2H4)
DEALLOCATE(GAMMAD2_C2H4)
DEALLOCATE(GAMMAD3_C2H4)
DEALLOCATE(GAMMAD4_C2H4)

!------------------------------------------------------------------------------   
END SUBROUTINE RCDEALLOC

!------------------------------------------------------------------------------
END MODULE RADCALV



MODULE SPECDATA

USE PRECISION_PARAMETERS
IMPLICIT NONE
INTEGER ::  I,J
INTEGER, PARAMETER :: NWATERK=183
REAL(EB) :: CPLXREF_WATER(NWATERK,2)
INTEGER, PARAMETER :: NFUELK=94
REAL(EB) :: CPLXREF_FUEL(NFUELK,3)

! Hale, G.M. and Querry, M.R., "Optical Constants of Water in the 200-nm to 200-\mu m Wavelength Region", 
! Applied Optics, 12(3), 555-63 (1973)

DATA ((CPLXREF_WATER(I,J), J = 1,2), I = 1,10)  &
/ 1.0000000E-6_EB,  2.8647890E-6_EB,&
1.0200000E-6_EB,  2.1915636E-6_EB,&
1.0400000E-6_EB,  1.3241691E-6_EB,&
1.0600000E-6_EB,  1.0122254E-6_EB,&
1.0800000E-6_EB,  1.1172677E-6_EB,&
1.1000000E-6_EB,  1.4880987E-6_EB,&
1.1200000E-6_EB,  4.6345919E-6_EB,&
1.1400000E-6_EB,  5.9874090E-6_EB,&
1.1600000E-6_EB,  8.2155782E-6_EB,&
1.1800000E-6_EB,  9.7657473E-6_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =11,20)  &
/ 1.2000000E-6_EB,  9.9312684E-6_EB,&
1.2200000E-6_EB,  9.2230290E-6_EB,&
1.2400000E-6_EB,  8.6834937E-6_EB,&
1.2600000E-6_EB,  8.9238177E-6_EB,&
1.2800000E-6_EB,  9.9821980E-6_EB,&
1.3000000E-6_EB,  1.1483029E-5_EB,&
1.3200000E-6_EB,  1.1953809E-5_EB,&
1.3400000E-6_EB,  1.2614780E-5_EB,&
1.3600000E-6_EB,  2.9978533E-5_EB,&
1.3800000E-6_EB,  6.6988316E-5_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =21,30)  &
/ 1.4000000E-6_EB,  1.3803508E-4_EB,&
1.4200000E-6_EB,  2.4995602E-4_EB,&
1.4400000E-6_EB,  3.3002369E-4_EB,&
1.4600000E-6_EB,  3.2996003E-4_EB,&
1.4800000E-6_EB,  2.5003560E-4_EB,&
1.5000000E-6_EB,  2.0996516E-4_EB,&
1.5200000E-6_EB,  1.6994565E-4_EB,&
1.5400000E-6_EB,  1.4497583E-4_EB,&
1.5600000E-6_EB,  1.2004433E-4_EB,&
1.5800000E-6_EB,  9.9957388E-5_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =31,40)  &
/ 1.6000000E-6_EB,  8.5561825E-5_EB,&
1.6200000E-6_EB,  7.5028952E-5_EB,&
1.6400000E-6_EB,  6.4992643E-5_EB,&
1.6600000E-6_EB,  5.9972898E-5_EB,&
1.6800000E-6_EB,  6.0027012E-5_EB,&
1.7000000E-6_EB,  6.0065211E-5_EB,&
1.7200000E-6_EB,  6.9942231E-5_EB,&
1.7400000E-6_EB,  8.5017388E-5_EB,&
1.7600000E-6_EB,  1.0000023E-4_EB,&
1.7800000E-6_EB,  1.1501809E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =41,50)  &
/ 1.8000000E-6_EB,  1.1502128E-4_EB,&
1.8200000E-6_EB,  1.3005838E-4_EB,&
1.8400000E-6_EB,  1.4993669E-4_EB,&
1.8600000E-6_EB,  2.1003200E-4_EB,&
1.8800000E-6_EB,  4.6497435E-4_EB,&
1.9000000E-6_EB,  1.0000183E-3_EB,&
1.9200000E-6_EB,  1.7500423E-3_EB,&
1.9400000E-6_EB,  1.8499391E-3_EB,&
1.9600000E-6_EB,  1.6500261E-3_EB,&
1.9800000E-6_EB,  1.4500559E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =51,60)  &
/ 2.0000000E-6_EB,  1.1000790E-3_EB,&
2.0200000E-6_EB,  9.0001961E-4_EB,&
2.0400000E-6_EB,  7.3003417E-4_EB,&
2.0600000E-6_EB,  6.3998112E-4_EB,&
2.0800000E-6_EB,  5.2006742E-4_EB,&
2.1000000E-6_EB,  4.5003447E-4_EB,&
2.1200000E-6_EB,  4.0505888E-4_EB,&
2.1400000E-6_EB,  3.4995785E-4_EB,&
2.1600000E-6_EB,  3.2005422E-4_EB,&
2.1800000E-6_EB,  2.9994500E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =61,70)  &
/ 2.2000000E-6_EB,  2.8904129E-4_EB,&
2.2200000E-6_EB,  2.8495578E-4_EB,&
2.2400000E-6_EB,  2.9500960E-4_EB,&
2.2600000E-6_EB,  3.1005293E-4_EB,&
2.2800000E-6_EB,  3.5997028E-4_EB,&
2.3000000E-6_EB,  4.0998313E-4_EB,&
2.3200000E-6_EB,  4.9496551E-4_EB,&
2.3400000E-6_EB,  5.9494505E-4_EB,&
2.3600000E-6_EB,  6.9994116E-4_EB,&
2.3800000E-6_EB,  8.2007768E-4_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =71,80)  &
/ 2.4000000E-6_EB,  9.5607557E-4_EB,&
2.4200000E-6_EB,  1.1500727E-3_EB,&
2.4400000E-6_EB,  1.2999617E-3_EB,&
2.4600000E-6_EB,  1.4999176E-3_EB,&
2.4800000E-6_EB,  1.6999912E-3_EB,&
2.5000000E-6_EB,  1.8000424E-3_EB,&
2.5200000E-6_EB,  2.0500716E-3_EB,&
2.5400000E-6_EB,  2.1999478E-3_EB,&
2.5600000E-6_EB,  2.3500946E-3_EB,&
2.5800000E-6_EB,  2.7000302E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =81,90)  &
/ 2.6000000E-6_EB,  3.1699367E-3_EB,&
2.6500000E-6_EB,  6.7000889E-3_EB,&
2.7000000E-6_EB,  1.8999997E-2_EB,&
2.7500000E-6_EB,  5.9000926E-2_EB,&
2.8000000E-6_EB,  1.1500027E-1_EB,&
2.8500000E-6_EB,  1.8499960E-1_EB,&
2.9000000E-6_EB,  2.6769861E-1_EB,&
2.9500000E-6_EB,  2.9813700E-1_EB,&
3.0000000E-6_EB,  2.7215495E-1_EB,&
3.0500000E-6_EB,  2.4000020E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =91,100)  &
/ 3.1000000E-6_EB,  1.9200142E-1_EB,&
3.1500000E-6_EB,  1.3500032E-1_EB,&
3.2000000E-6_EB,  9.2401540E-2_EB,&
3.2500000E-6_EB,  6.0999713E-2_EB,&
3.3000000E-6_EB,  3.6798931E-2_EB,&
3.3500000E-6_EB,  2.6099958E-2_EB,&
3.4000000E-6_EB,  1.9500046E-2_EB,&
3.4500000E-6_EB,  1.3199993E-2_EB,&
3.5000000E-6_EB,  9.4000888E-3_EB,&
3.6000000E-6_EB,  5.1500311E-3_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =101,110)  &
/ 3.7000000E-6_EB,  3.6000769E-3_EB,&
3.8000000E-6_EB,  3.4001225E-3_EB,&
3.9000000E-6_EB,  3.7999516E-3_EB,&
4.0000000E-6_EB,  4.5998962E-3_EB,&
4.1000000E-6_EB,  5.6118033E-3_EB,&
4.2000000E-6_EB,  6.8850428E-3_EB,&
4.3000000E-6_EB,  8.4519233E-3_EB,&
4.4000000E-6_EB,  1.0294142E-2_EB,&
4.5000000E-6_EB,  1.3392888E-2_EB,&
4.6000000E-6_EB,  1.4715466E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =111,120)  &
/ 4.7000000E-6_EB,  1.5708593E-2_EB,&
4.8000000E-6_EB,  1.5011494E-2_EB,&
4.9000000E-6_EB,  1.3686529E-2_EB,&
5.0000000E-6_EB,  1.2414086E-2_EB,&
5.1000000E-6_EB,  1.1120156E-2_EB,&
5.2000000E-6_EB,  1.0096790E-2_EB,&
5.3000000E-6_EB,  9.7848459E-3_EB,&
5.4000000E-6_EB,  1.0313240E-2_EB,&
5.5000000E-6_EB,  1.1598416E-2_EB,&
5.6000000E-6_EB,  1.4215720E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =121,130)  &
/ 5.7000000E-6_EB,  2.0320903E-2_EB,&
5.8000000E-6_EB,  3.3000777E-2_EB,&
5.9000000E-6_EB,  6.2209688E-2_EB,&
6.0000000E-6_EB,  1.0699987E-1_EB,&
6.1000000E-6_EB,  1.3101555E-1_EB,&
6.2000000E-6_EB,  8.8019050E-2_EB,&
6.3000000E-6_EB,  5.7002139E-2_EB,&
6.4000000E-6_EB,  4.4868962E-2_EB,&
6.5000000E-6_EB,  3.9207820E-2_EB,&
6.6000000E-6_EB,  3.5609327E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =131,140)  &
/ 6.7000000E-6_EB,  3.3696285E-2_EB,&
6.8000000E-6_EB,  3.2684059E-2_EB,&
6.9000000E-6_EB,  3.2176355E-2_EB,&
7.0000000E-6_EB,  3.1974228E-2_EB,&
7.1000000E-6_EB,  3.1979003E-2_EB,&
7.2000000E-6_EB,  3.2085637E-2_EB,&
7.3000000E-6_EB,  3.2182721E-2_EB,&
7.4000000E-6_EB,  3.2388031E-2_EB,&
7.5000000E-6_EB,  3.2586975E-2_EB,&
7.6000000E-6_EB,  3.2779552E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =141,150)  &
/ 7.7000000E-6_EB,  3.3088313E-2_EB,&
7.8000000E-6_EB,  3.3518031E-2_EB,&
7.9000000E-6_EB,  3.3884883E-2_EB,&
8.0000000E-6_EB,  3.4313806E-2_EB,&
8.2000000E-6_EB,  3.5106397E-2_EB,&
8.4000000E-6_EB,  3.6096341E-2_EB,&
8.6000000E-6_EB,  3.1001791E-2_EB,&
8.8000000E-6_EB,  3.8515496E-2_EB,&
9.0000000E-6_EB,  3.9892186E-2_EB,&
9.2000000E-6_EB,  4.1510792E-2_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =151,160)  &
/ 9.4000000E-6_EB,  4.3310835E-2_EB,&
9.6000000E-6_EB,  4.5378257E-2_EB,&
9.8000000E-6_EB,  4.7883356E-2_EB,&
1.0000000E-5_EB,  5.0770427E-2_EB,&
1.0500000E-5_EB,  6.6176625E-2_EB,&
1.1000000E-5_EB,  9.6813952E-2_EB,&
1.1500000E-5_EB,  1.4202987E-1_EB,&
1.2000000E-5_EB,  1.9900734E-1_EB,&
1.2500000E-5_EB,  2.5902467E-1_EB,&
1.3000000E-5_EB,  3.0497270E-1_EB / 
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =161,170)  &
/ 1.3500000E-5_EB,  3.4302267E-1_EB,&
1.4000000E-5_EB,  3.6998750E-1_EB,&
1.4500000E-5_EB,  3.8804760E-1_EB,&
1.5000000E-5_EB,  4.0202539E-1_EB,&
1.5500000E-5_EB,  4.1394609E-1_EB,&
1.6000000E-5_EB,  4.2195159E-1_EB,&
1.6500000E-5_EB,  4.2804722E-1_EB,&
1.7000000E-5_EB,  4.2897828E-1_EB,&
1.7500000E-5_EB,  4.2906183E-1_EB,&
1.8000000E-5_EB,  4.2599412E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =171,180)  &
/ 1.8500000E-5_EB,  4.2104440E-1_EB,&
1.9000000E-5_EB,  4.1397792E-1_EB,&
1.9500000E-5_EB,  4.0407849E-1_EB,&
2.0000000E-5_EB,  3.9295355E-1_EB,&
3.0000000E-5_EB,  3.2801834E-1_EB,&
3.8000000E-5_EB,  3.6105890E-1_EB,&
5.0000000E-5_EB,  5.1407047E-1_EB,&
6.0000000E-5_EB,  5.8680428E-1_EB,&
7.0000000E-5_EB,  5.7598174E-1_EB,&
8.0000000E-5_EB,  5.4685638E-1_EB /
DATA ((CPLXREF_WATER(I,J), J = 1,2), I =181,NWATERK)  &
/ 9.0000000E-5_EB,  5.3571554E-1_EB,&
1.0000000E-4_EB,  5.3237328E-1_EB,&
2.0000000E-4_EB,  5.0452117E-1_EB /

! Heptane properties from
! L.A. Dombrovsky, S.S. Sazhin, S.V. Mikhalovsky, R. Wood, M.R. Heikal
! Spectral properties of diesel fuel PARTICLEs
! Fuel, Vol. 82, No. 1 (2003) pp. 15-22
DATA (CPLXREF_FUEL( 1,J), J=1,3) / 0.7_EB,   1.47_EB, 1.55E-07_EB /
DATA (CPLXREF_FUEL( 2,J), J=1,3) / 0.8_EB,   1.47_EB, 4.33E-07_EB /
DATA (CPLXREF_FUEL( 3,J), J=1,3) / 0.9_EB,   1.47_EB, 9.39E-07_EB /
DATA (CPLXREF_FUEL( 4,J), J=1,3) / 1.0_EB,   1.47_EB, 8.81E-07_EB /
DATA (CPLXREF_FUEL( 5,J), J=1,3) / 1.1_EB,   1.47_EB, 1.19E-06_EB /
DATA (CPLXREF_FUEL( 6,J), J=1,3) / 1.2_EB,   1.47_EB, 2.63E-06_EB /
DATA (CPLXREF_FUEL( 7,J), J=1,3) / 1.3_EB,   1.47_EB, 1.08E-05_EB /
DATA (CPLXREF_FUEL( 8,J), J=1,3) / 1.4_EB,   1.47_EB, 2.24E-05_EB /
DATA (CPLXREF_FUEL( 9,J), J=1,3) / 1.5_EB,   1.46_EB, 3.41E-05_EB /
DATA (CPLXREF_FUEL( 10,J), J=1,3) / 1.6_EB,  1.46_EB, 4.57E-05_EB /
DATA (CPLXREF_FUEL( 11,J), J=1,3) / 1.7_EB,  1.46_EB, 5.73E-05_EB /
DATA (CPLXREF_FUEL( 12,J), J=1,3) / 1.8_EB,  1.46_EB, 6.90E-05_EB /
DATA (CPLXREF_FUEL( 13,J), J=1,3) / 1.9_EB,  1.46_EB, 8.06E-05_EB /
DATA (CPLXREF_FUEL( 14,J), J=1,3) / 2.0_EB,  1.46_EB, 9.22E-05_EB /
DATA (CPLXREF_FUEL( 15,J), J=1,3) / 2.1_EB,  1.46_EB, 1.04E-04_EB /
DATA (CPLXREF_FUEL( 16,J), J=1,3) / 2.2_EB,  1.46_EB, 1.15E-04_EB /
DATA (CPLXREF_FUEL( 17,J), J=1,3) / 2.3_EB,  1.46_EB, 1.27E-04_EB /
DATA (CPLXREF_FUEL( 18,J), J=1,3) / 2.4_EB,  1.45_EB, 1.39E-04_EB /
DATA (CPLXREF_FUEL( 19,J), J=1,3) / 2.5_EB,  1.45_EB, 1.50E-04_EB /
DATA (CPLXREF_FUEL( 20,J), J=1,3) / 2.6_EB,  1.45_EB, 1.62E-04_EB /
DATA (CPLXREF_FUEL( 21,J), J=1,3) / 2.7_EB,  1.45_EB, 1.11E-04_EB /
DATA (CPLXREF_FUEL( 22,J), J=1,3) / 2.8_EB,  1.44_EB, 5.92E-05_EB /
DATA (CPLXREF_FUEL( 23,J), J=1,3) / 2.9_EB,  1.44_EB, 7.45E-05_EB /
DATA (CPLXREF_FUEL( 24,J), J=1,3) / 3.0_EB,  1.43_EB, 9.72E-05_EB /
DATA (CPLXREF_FUEL( 25,J), J=1,3) / 3.1_EB,  1.42_EB, 3.12E-04_EB /
DATA (CPLXREF_FUEL( 26,J), J=1,3) / 3.2_EB,  1.40_EB, 6.09E-04_EB /
DATA (CPLXREF_FUEL( 27,J), J=1,3) / 3.3_EB,  1.17_EB, 5.72E-02_EB /
DATA (CPLXREF_FUEL( 28,J), J=1,3) / 3.4_EB,  1.39_EB, 1.20E-01_EB /
DATA (CPLXREF_FUEL( 29,J), J=1,3) / 3.5_EB,  1.45_EB, 8.24E-02_EB /
DATA (CPLXREF_FUEL( 30,J), J=1,3) / 3.6_EB,  1.51_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 31,J), J=1,3) / 3.7_EB,  1.64_EB, 1.33E-03_EB /
DATA (CPLXREF_FUEL( 32,J), J=1,3) / 3.8_EB,  1.56_EB, 1.02E-03_EB /
DATA (CPLXREF_FUEL( 33,J), J=1,3) / 3.9_EB,  1.52_EB, 6.36E-04_EB /
DATA (CPLXREF_FUEL( 34,J), J=1,3) / 4.0_EB,  1.50_EB, 2.51E-04_EB /
DATA (CPLXREF_FUEL( 35,J), J=1,3) / 4.1_EB,  1.50_EB, 2.59E-04_EB /
DATA (CPLXREF_FUEL( 36,J), J=1,3) / 4.2_EB,  1.49_EB, 3.10E-04_EB /
DATA (CPLXREF_FUEL( 37,J), J=1,3) / 4.3_EB,  1.49_EB, 2.60E-04_EB /
DATA (CPLXREF_FUEL( 38,J), J=1,3) / 4.4_EB,  1.48_EB, 2.11E-04_EB /
DATA (CPLXREF_FUEL( 39,J), J=1,3) / 4.5_EB,  1.48_EB, 1.98E-04_EB /
DATA (CPLXREF_FUEL( 40,J), J=1,3) / 4.6_EB,  1.47_EB, 1.90E-04_EB /
DATA (CPLXREF_FUEL( 41,J), J=1,3) / 4.7_EB,  1.47_EB, 1.58E-04_EB /
DATA (CPLXREF_FUEL( 42,J), J=1,3) / 4.8_EB,  1.47_EB, 1.21E-04_EB /
DATA (CPLXREF_FUEL( 43,J), J=1,3) / 4.9_EB,  1.47_EB, 8.32E-05_EB /
DATA (CPLXREF_FUEL( 44,J), J=1,3) / 5.0_EB,  1.46_EB, 4.58E-05_EB /
DATA (CPLXREF_FUEL( 45,J), J=1,3) / 5.1_EB,  1.46_EB, 6.37E-05_EB /
DATA (CPLXREF_FUEL( 46,J), J=1,3) / 5.2_EB,  1.46_EB, 7.78E-05_EB /
DATA (CPLXREF_FUEL( 47,J), J=1,3) / 5.3_EB,  1.46_EB, 7.66E-05_EB /
DATA (CPLXREF_FUEL( 48,J), J=1,3) / 5.4_EB,  1.45_EB, 7.55E-05_EB /
DATA (CPLXREF_FUEL( 49,J), J=1,3) / 5.5_EB,  1.45_EB, 9.62E-05_EB /
DATA (CPLXREF_FUEL( 50,J), J=1,3) / 5.6_EB,  1.45_EB, 1.17E-04_EB /
DATA (CPLXREF_FUEL( 51,J), J=1,3) / 5.7_EB,  1.45_EB, 1.63E-04_EB /
DATA (CPLXREF_FUEL( 52,J), J=1,3) / 5.8_EB,  1.45_EB, 2.16E-04_EB /
DATA (CPLXREF_FUEL( 53,J), J=1,3) / 5.9_EB,  1.44_EB, 2.68E-04_EB /
DATA (CPLXREF_FUEL( 54,J), J=1,3) / 6.0_EB,  1.44_EB, 3.21E-04_EB /
DATA (CPLXREF_FUEL( 55,J), J=1,3) / 6.1_EB,  1.44_EB, 3.74E-04_EB /
DATA (CPLXREF_FUEL( 56,J), J=1,3) / 6.2_EB,  1.44_EB, 4.36E-04_EB /
DATA (CPLXREF_FUEL( 57,J), J=1,3) / 6.3_EB,  1.43_EB, 5.87E-04_EB /
DATA (CPLXREF_FUEL( 58,J), J=1,3) / 6.4_EB,  1.43_EB, 7.38E-04_EB /
DATA (CPLXREF_FUEL( 59,J), J=1,3) / 6.5_EB,  1.42_EB, 1.35E-03_EB /
DATA (CPLXREF_FUEL( 60,J), J=1,3) / 6.6_EB,  1.41_EB, 6.12E-03_EB /
DATA (CPLXREF_FUEL( 61,J), J=1,3) / 6.7_EB,  1.39_EB, 2.06E-02_EB /
DATA (CPLXREF_FUEL( 62,J), J=1,3) / 6.8_EB,  1.35_EB, 3.51E-02_EB /
DATA (CPLXREF_FUEL( 63,J), J=1,3) / 6.9_EB,  1.37_EB, 2.29E-02_EB /
DATA (CPLXREF_FUEL( 64,J), J=1,3) / 7.0_EB,  1.48_EB, 3.99E-03_EB /
DATA (CPLXREF_FUEL( 65,J), J=1,3) / 7.1_EB,  1.53_EB, 3.24E-03_EB /
DATA (CPLXREF_FUEL( 66,J), J=1,3) / 7.2_EB,  1.48_EB, 2.61E-03_EB /
DATA (CPLXREF_FUEL( 67,J), J=1,3) / 7.3_EB,  1.43_EB, 2.97E-03_EB /
DATA (CPLXREF_FUEL( 68,J), J=1,3) / 7.4_EB,  1.47_EB, 3.33E-03_EB /
DATA (CPLXREF_FUEL( 69,J), J=1,3) / 7.5_EB,  1.50_EB, 2.80E-03_EB /
DATA (CPLXREF_FUEL( 70,J), J=1,3) / 7.6_EB,  1.49_EB, 2.14E-03_EB /
DATA (CPLXREF_FUEL( 71,J), J=1,3) / 7.7_EB,  1.48_EB, 2.28E-03_EB /
DATA (CPLXREF_FUEL( 72,J), J=1,3) / 7.8_EB,  1.47_EB, 2.41E-03_EB /
DATA (CPLXREF_FUEL( 73,J), J=1,3) / 7.9_EB,  1.47_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 74,J), J=1,3) / 8.0_EB,  1.47_EB, 9.84E-04_EB /
DATA (CPLXREF_FUEL( 75,J), J=1,3) / 8.1_EB,  1.46_EB, 9.03E-04_EB /
DATA (CPLXREF_FUEL( 76,J), J=1,3) / 8.2_EB,  1.46_EB, 8.19E-04_EB /
DATA (CPLXREF_FUEL( 77,J), J=1,3) / 8.3_EB,  1.46_EB, 7.13E-04_EB /
DATA (CPLXREF_FUEL( 78,J), J=1,3) / 8.4_EB,  1.46_EB, 6.07E-04_EB /
DATA (CPLXREF_FUEL( 79,J), J=1,3) / 8.5_EB,  1.45_EB, 8.54E-04_EB /
DATA (CPLXREF_FUEL( 80,J), J=1,3) / 8.6_EB,  1.45_EB, 1.10E-03_EB /
DATA (CPLXREF_FUEL( 81,J), J=1,3) / 8.7_EB,  1.45_EB, 1.76E-03_EB /
DATA (CPLXREF_FUEL( 82,J), J=1,3) / 8.8_EB,  1.45_EB, 2.41E-03_EB /
DATA (CPLXREF_FUEL( 83,J), J=1,3) / 8.9_EB,  1.45_EB, 1.58E-03_EB /
DATA (CPLXREF_FUEL( 84,J), J=1,3) / 9.0_EB,  1.45_EB, 5.71E-04_EB /
DATA (CPLXREF_FUEL( 85,J), J=1,3) / 9.1_EB,  1.45_EB, 8.53E-04_EB /
DATA (CPLXREF_FUEL( 86,J), J=1,3) / 9.2_EB,  1.45_EB, 1.28E-03_EB /
DATA (CPLXREF_FUEL( 87,J), J=1,3) / 9.3_EB,  1.45_EB, 1.63E-03_EB /
DATA (CPLXREF_FUEL( 88,J), J=1,3) / 9.4_EB,  1.45_EB, 1.98E-03_EB /
DATA (CPLXREF_FUEL( 89,J), J=1,3) / 9.5_EB,  1.45_EB, 1.69E-03_EB /
DATA (CPLXREF_FUEL( 90,J), J=1,3) / 9.6_EB,  1.45_EB, 1.24E-03_EB /
DATA (CPLXREF_FUEL( 91,J), J=1,3) / 9.7_EB,  1.45_EB, 1.43E-03_EB /
DATA (CPLXREF_FUEL( 92,J), J=1,3) / 9.8_EB,  1.45_EB, 1.69E-03_EB /
DATA (CPLXREF_FUEL( 93,J), J=1,3) / 9.9_EB,  1.45_EB, 1.26E-03_EB /
DATA (CPLXREF_FUEL( 94,J), J=1,3) / 10.0_EB, 1.45_EB, 8.24E-04_EB /

END MODULE SPECDATA



MODULE MIEV

USE PRECISION_PARAMETERS
USE GLOBAL_CONSTANTS, ONLY: NUMBER_SPECTRAL_BANDS,NUMBER_RADIATION_ANGLES,LU_ERR
USE SPECDATA, ONLY: CPLXREF_WATER, NWATERK, CPLXREF_FUEL, NFUELK
USE RADCALV, ONLY: PLANCK
USE RADCONS
USE MEMORY_FUNCTIONS, ONLY : CHKMEMERR
USE MATH_FUNCTIONS, ONLY : INTERPOLATE1D

IMPLICIT NONE
REAL(EB), ALLOCATABLE :: RDMIE(:),  LMBDMIE(:),LMBDWGHT(:),REAL_REF_INDX(:),CMPLX_REF_INDX(:)
REAL(EB), ALLOCATABLE :: QSCA(:,:), QABS(:,:),  CHI_F(:,:)

PRIVATE 
PUBLIC MEAN_CROSS_SECTIONS

CONTAINS


SUBROUTINE MEAN_CROSS_SECTIONS(CLASS_NUMBER)

! This subroutine calculates the mean scattering and absorption
! coefficients for each radiation band and PARTICLE size group.

USE TYPES, ONLY: LAGRANGIAN_PARTICLE_CLASS_TYPE, LAGRANGIAN_PARTICLE_CLASS, TABLES_TYPE, TABLES
USE GLOBAL_CONSTANTS, ONLY: H2O_INDEX
USE MATH_FUNCTIONS, ONLY : INTERPOLATE1D
INTEGER  :: NSB,I,J,IBND,IZERO,NX,NLAMBDALOW(1),NLAMBDAHIGH(1),ND,CLASS_NUMBER,NL_DATA
REAL(EB) :: RMMAX,RMMIN,RDTMP,IB,IBSUM,AVAL,BVAL,ASUM,BSUM,B_WIEN
TYPE (LAGRANGIAN_PARTICLE_CLASS_TYPE), POINTER :: LPC=>NULL()
TYPE (TABLES_TYPE),  POINTER :: TA=>NULL()
 
LPC => LAGRANGIAN_PARTICLE_CLASS(CLASS_NUMBER) 
NSB = NUMBER_SPECTRAL_BANDS

! Physical parameters
! minimum mean radius (m)
RMMIN = 0.5_EB*1.E-6*MIE_MINIMUM_DIAMETER
IF (RMMIN < EPSILON_EB) RMMIN = 0.5E-6_EB   

! maximum mean radius (m)
RMMAX = 0.5_EB*1.E-6*MIE_MAXIMUM_DIAMETER
IF (RMMAX < EPSILON_EB) THEN  
   RMMAX = 0.5_EB*LPC%DIAMETER
   ! Allow increase of the mean radius
   RMMAX = 1.5_EB*RMMAX
ENDIF

! Other constants

B_WIEN = 2.8977685E-3_EB
 
! Calculate parameters of the PARTICLE group lookup table
 
DGROUP_A = (LOG(RMMAX)-LOG(RMMIN))/(MIE_NDG-1)
DGROUP_B = LOG(RMMAX)-DGROUP_A*MIE_NDG

! Generate the PARTICLE radii for mie table (microns)
 
RDTMP = 0.5_EB*RMMIN
NX = 0
DO WHILE (RDTMP < 2._EB*RMMAX) 
   NX = NX + 1
   RDTMP = RDTMP + MIN(1.0E6_EB,0.2_EB*RDTMP**(1._EB))
ENDDO
NRDMIE = NX 

ALLOCATE(RDMIE(1:NRDMIE),STAT=IZERO)
CALL ChkMemErr('MIEV','RDMIE',IZERO)

RDTMP = 0.5_EB*RMMIN
RDMIE(1) = RDTMP
DO NX = 2, NRDMIE
   RDTMP = RDTMP + MIN(3.0E6_EB,0.2_EB*RDTMP**(1.0_EB))
   RDMIE(NX) = RDTMP
ENDDO

! Radiative properties

NLMBDMIE = NWATERK
IF (LPC%RADIATIVE_PROPERTY_INDEX>0) THEN
   TA => TABLES(LPC%RADIATIVE_PROPERTY_INDEX)
   NL_DATA = TA%NUMBER_ROWS
ELSEIF (LPC%Y_INDEX==H2O_INDEX) THEN
   NL_DATA = NLMBDMIE
ELSEIF (LPC%FUEL) THEN
   NL_DATA = NFUELK
ELSE
   NL_DATA = 1
ENDIF

!     Allocate arrays

ALLOCATE(QSCA(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','QSCA',IZERO)
ALLOCATE(QABS(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','QABS',IZERO)
ALLOCATE(CHI_F(1:NRDMIE,1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','CHI_F',IZERO)
!
ALLOCATE(LMBDMIE(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','LMBDMIE',IZERO)
ALLOCATE(LMBDWGHT(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','LMBDWGHT',IZERO)
ALLOCATE(REAL_REF_INDX(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','REAL_REF_INDX',IZERO)
ALLOCATE(CMPLX_REF_INDX(1:NLMBDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','CMPLX_REF_INDX',IZERO)

! Radiative properties

LMBDMIE(1:NLMBDMIE) = CPLXREF_WATER(1:NLMBDMIE,1)
IF (LPC%RADIATIVE_PROPERTY_INDEX > 0) THEN
   DO NX = 1,NLMBDMIE
      CALL INTERPOLATE1D(TA%TABLE_DATA(:,1)*1.0E-6_EB,TA%TABLE_DATA(:,2),LMBDMIE(NX),REAL_REF_INDX(NX))
      CALL INTERPOLATE1D(TA%TABLE_DATA(:,1)*1.0E-6_EB,TA%TABLE_DATA(:,3),LMBDMIE(NX),CMPLX_REF_INDX(NX))
   ENDDO
ELSEIF (LPC%Y_INDEX==H2O_INDEX) THEN
   REAL_REF_INDX              = 1.33_EB
   CMPLX_REF_INDX(1:NLMBDMIE) = CPLXREF_WATER(1:NLMBDMIE,2)
ELSEIF (LPC%FUEL) THEN
   DO NX = 1,NLMBDMIE
      CALL INTERPOLATE1D(CPLXREF_FUEL(:,1)*1.0E-6_EB,CPLXREF_FUEL(:,2),LMBDMIE(NX),REAL_REF_INDX(NX))
      CALL INTERPOLATE1D(CPLXREF_FUEL(:,1)*1.0E-6_EB,CPLXREF_FUEL(:,3),LMBDMIE(NX),CMPLX_REF_INDX(NX))
   ENDDO
ELSE
   REAL_REF_INDX              = LPC%REAL_REFRACTIVE_INDEX
   CMPLX_REF_INDX             = LPC%COMPLEX_REFRACTIVE_INDEX
ENDIF

CALL MIE_SCATTERING

!     Generate integration weights for lambda

IF (NLMBDMIE == 1) THEN
   LMBDWGHT(1) = 1._EB
ELSE
   LMBDWGHT(1) = 0.5_EB*(LMBDMIE(2)-LMBDMIE(1))
   DO I = 2, NLMBDMIE-1
      LMBDWGHT(I) = 0.5_EB*(LMBDMIE(I+1) - LMBDMIE(I-1))
   ENDDO
   LMBDWGHT(NLMBDMIE) = 0.5_EB*(LMBDMIE(NLMBDMIE)-LMBDMIE(NLMBDMIE-1))
ENDIF


!     Loop over all radiation bands

BANDLOOP: DO IBND = 1,NSB
   !
   IF (NSB == 1) THEN
      NLAMBDALOW = 1
      NLAMBDAHIGH = NLMBDMIE
   ELSE
      NLAMBDALOW  = MINLOC(LMBDMIE,MASK=LMBDMIE>=WL_LOW(IBND)*1.E-6)
      NLAMBDAHIGH = MAXLOC(LMBDMIE,MASK=LMBDMIE<=WL_HIGH(IBND)*1.0E-6)
   ENDIF

   !     Loop over all PARTICLE size groups


   DRGROUPLOOP: DO ND = 1, MIE_NDG

      LPC%R50(ND) = EXP(DGROUP_A*REAL(ND,EB) + DGROUP_B)

      !     Loop over wavelengths

      IBSUM = 0._EB

      DO J = NLAMBDALOW(1),NLAMBDAHIGH(1)
         IB = PLANCK(RADTMP, LMBDMIE(J)*1.0E6_EB)
         IBSUM = IBSUM + LMBDWGHT(J)*IB

         ASUM = 0._EB
         BSUM = 0._EB

         !     Loop over PARTICLE size distribution

!         DO I = 0,NRDINT
!
!            !     Integrate effective scattering cross section 
!            !     = scattering cross section * (1-forward fraction)
!
!            CALL INTERPOLATE1D(RDMIE,QSCA(:,J),RDDIST(I),AVAL)
!            CALL INTERPOLATE1D(RDMIE,CHI_F(:,J),RDDIST(I),BVAL)
!            BVAL = (1._EB-BVAL)
!            AVAL = AVAL*BVAL*PI*RDDIST(I)**2
!            ASUM = ASUM + RDWGHT(I)*AVAL
!
!            !     Integrate absorption cross sections
!
!            CALL INTERPOLATE1D(RDMIE,QABS(:,J),RDDIST(I),BVAL)
!            BVAL = BVAL*PI*RDDIST(I)**2
!            BSUM = BSUM + RDWGHT(I)*BVAL
!         ENDDO
  
         ! Properties simply at d32 - Elizabeth's idea

         CALL INTERPOLATE1D(RDMIE,QSCA(:,J),LPC%R50(ND),AVAL)
         CALL INTERPOLATE1D(RDMIE,CHI_F(:,J),LPC%R50(ND),BVAL)
         BVAL = (1._EB-BVAL)
         ASUM = AVAL*BVAL
         CALL INTERPOLATE1D(RDMIE,QABS(:,J),LPC%R50(ND),BVAL)
         BSUM = BVAL
         ! End Elizabeth's 

         LPC%WQSCA(ND,IBND) = LPC%WQSCA(ND,IBND) + ASUM*LMBDWGHT(J)*IB
         LPC%WQABS(ND,IBND) = LPC%WQABS(ND,IBND) + BSUM*LMBDWGHT(J)*IB
      ENDDO

      !     Normalize with blackbody radiation

      LPC%WQSCA(ND,IBND)  = LPC%WQSCA(ND,IBND)/IBSUM
      LPC%WQABS(ND,IBND)  = LPC%WQABS(ND,IBND)/IBSUM

      !     Transform cross sections back to efficiency factors

!      LPC%WQSCA(ND,IBND)  = LPC%WQSCA(ND,IBND)/(PI*LPC%R50(ND)**2)
!      LPC%WQABS(ND,IBND)  = LPC%WQABS(ND,IBND)/(PI*LPC%R50(ND)**2)
!     For d32-based properties, no need to divide by drop area
!      LPC%WQSCA(ND,IBND)  = LPC%WQSCA(ND,IBND)/(PI*(LPC%DMN(ND)/2._EB)**2)
!      LPC%WQABS(ND,IBND)  = LPC%WQABS(ND,IBND)/(PI*(LPC%DMN(ND)/2._EB)**2)

ENDDO DRGROUPLOOP
ENDDO BANDLOOP

DEALLOCATE(RDMIE)
DEALLOCATE(QSCA)
DEALLOCATE(QABS)
DEALLOCATE(CHI_F)
DEALLOCATE(LMBDMIE)
DEALLOCATE(LMBDWGHT)
DEALLOCATE(REAL_REF_INDX)
DEALLOCATE(CMPLX_REF_INDX)

END SUBROUTINE MEAN_CROSS_SECTIONS



SUBROUTINE MIE_SCATTERING
!
!     Calculates the scattering and absorption cross sections
!     and calculates forward scattering fraction by integrating 
!     the scattering phase function.
!
! ----------------------------------------------------------------------
! -----------  SPECIFICATIONS FOR SUBROUTINE  MIEV0  ---------------
! ----------------------------------------------------------------------
INTEGER   MOMDIM
PARAMETER  ( MOMDIM = 200)
LOGICAL   ANYANG, PERFCT, PRNT( 2 )
INTEGER   IPOLZN, NMOM
REAL(EB)  GQSC, MIMCUT, PMOM( 0:MOMDIM, 4 ), SPIKE, QE, QS
REAL(EB), ALLOCATABLE :: XXX(:)
COMPLEX(EB) SFORW, SBACK, TFORW( 2 ), TBACK( 2 ), CREFIN
COMPLEX(EB), ALLOCATABLE :: S1(:), S2(:) 

! --------------- LOCAL VARIABLES --------------------------------------

INTEGER   I, J, K, NX, IZERO
INTEGER   NLAMBDA, NRA, NMIEANG2
REAL(EB)  STMP, AIJ, FTMP, XX_MAX
REAL(EB)  MUMIN1, MUMIN2,THETALIM1, THETALIM2, mudloc
REAL(EB)  mu1, mu2, nu1, nu2, mud0loc, mudPiloc, mud1, mud2, dmud 
REAL(EB),ALLOCATABLE :: XMU1(:), XNU1(:),XMU2(:), &
          ANGLE1(:), ANGLE2(:), MUD(:), MUDX(:),PWGHT(:), &
          PHSFUN(:), PFOR(:,:), MUD0(:,:), MUDPI(:,:)
! ----------------------------------------------------------------------

NRA    = NUMBER_RADIATION_ANGLES

!     MIEV-code variables

MIMCUT = 1.E-6_EB
PERFCT = .FALSE.
ANYANG = .TRUE.
!      IPOLZN = +1234
IPOLZN = 0
NMOM   = 0
PRNT   = .FALSE.

!     Limit for XX

XX_MAX = 15000.0_EB

!     Integration limits

THETALIM1 = ACOS(1._EB - 2._EB/REAL(NRA))
MUMIN1 = COS(THETALIM1)
MUMIN2 = MUMIN1**2-(1._EB-MUMIN1**2)
THETALIM2 = ACOS(MUMIN2)
NMIEANG2 = NMIEANG*2

!     Allocate local arrays

ALLOCATE(XXX(1:NRDMIE),STAT=IZERO)
CALL ChkMemErr('INIT','XXX',IZERO)
ALLOCATE(S1(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','S1',IZERO)
ALLOCATE(S2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','S2',IZERO)
ALLOCATE(XMU1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','XMU1',IZERO)
ALLOCATE(XNU1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','XNU1',IZERO)
ALLOCATE(XMU2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','XMU2',IZERO)
ALLOCATE(MUD(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','MUD',IZERO)
ALLOCATE(MUDX(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','MUDX',IZERO)
ALLOCATE(PWGHT(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','PWGHT',IZERO)
ALLOCATE(ANGLE1(1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','ANGLE1',IZERO)
ALLOCATE(ANGLE2(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','ANGLE2',IZERO)
ALLOCATE(PHSFUN(1:NMIEANG2),STAT=IZERO)
CALL ChkMemErr('INIT','PHSFUN',IZERO)
ALLOCATE(PFOR(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','PFOR',IZERO)
ALLOCATE(MUD0(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','MUD0',IZERO)
ALLOCATE(MUDPI(1:NMIEANG,1:NMIEANG),STAT=IZERO)
CALL ChkMemErr('INIT','MUDPI',IZERO)

!     Create solid angle integration arrays

DO I = 1,NMIEANG
   ANGLE1(I) = THETALIM1*REAL(I-1)/REAL(NMIEANG-1)
   ANGLE1(I) = ANGLE1(I)*(1._EB-0.99*REAL(NMIEANG-I)/REAL(NMIEANG))
ENDDO
DO I = 1,NMIEANG
   XMU1(NMIEANG-I+1) = COS(ANGLE1(I))
   XNU1(NMIEANG-I+1) = SIN(ANGLE1(I))
ENDDO

!    Create phase function ingtegration arrays

DO I = 1,NMIEANG2
   ANGLE2(I) = THETALIM2*REAL(I-1)/REAL(NMIEANG2-1)
   ANGLE2(I) = ANGLE2(I)*(1._EB-0.99*REAL(NMIEANG2-I)/REAL(NMIEANG2))
ENDDO
DO I = 1,NMIEANG2
   XMU2(NMIEANG2-I+1) = COS(ANGLE2(I))
ENDDO

!    Calculate phase function ingetration limits

DO J = 1,NMIEANG
   DO I = 1,NMIEANG
      MUD0(I,J)  = XMU1(I)*XMU1(J) + XNU1(I)*XNU1(J)
      MUDPI(I,J) = XMU1(I)*XMU1(J) - XNU1(I)*XNU1(J)
   ENDDO
ENDDO

!     Calculate phase function integration weights

mu1 = 0.7_EB
mu2 = 0.9_EB
nu1 = SQRT(1-mu1**2)
nu2 = SQRT(1-mu2**2)
mud0loc  = mu1*mu2 + nu1*nu2
mudPiloc = mu1*mu2 - nu1*nu2
mud1 = mudPiloc
mud2 = mud0loc
dmud = (mud2-mud1)/(NMIEANG2-1)
DO I = 1,NMIEANG2
   mud(I) = mud1+REAL(I-1)*dmud
ENDDO
mud(1)       = mud(1)       + 0.25_EB*dmud !empirical
mud(NMIEANG2) = mud(NMIEANG2) - 0.25_EB*dmud !empirical
DO I = 1,NMIEANG2
   MUDX(I) = (mud(I)-mud1)/(mud2-mud1)
ENDDO
DO I = 1,NMIEANG2
   PWGHT(I) = dmud/sqrt((nu1*nu2)**2-(mud(I)-mu1*mu2)**2)
ENDDO
PWGHT(2)         = 0.5_EB*PWGHT(2)
PWGHT(NMIEANG2-1) = 0.5_EB*PWGHT(NMIEANG2-1)

!     Loop over wavelength

LAMBDALOOP: DO NLAMBDA = 1, NLMBDMIE
!
   CREFIN = CMPLX( REAL_REF_INDX(NLAMBDA), CMPLX_REF_INDX(NLAMBDA) )

! Choose Perfectly reflecting sphere, if large real index is given.

   IF (REAL_REF_INDX(NLAMBDA) > 10._EB) PERFCT = .TRUE.

!     Loop over PARTICLE radius

   RADIUSLOOP: DO NX = 1, NRDMIE

      XXX(NX) = MIN(XX_MAX,2._EB*PI*RDMIE(NX)/LMBDMIE(NLAMBDA))
      CALL MIEV0( XXX(NX), CREFIN, PERFCT, MIMCUT, ANYANG,   &
                  NMIEANG2, XMU2, NMOM, IPOLZN, MOMDIM, PRNT,  &
                  QE, QS, GQSC, &
                  PMOM, SFORW, SBACK, S1, S2, TFORW, TBACK, SPIKE )

      QSCA(NX,NLAMBDA) = QS
      QABS(NX,NLAMBDA) = QE-QS

!     Calculate single drop phase function

      IF (ABS(QS)>TWO_EPSILON_EB) THEN
         DO I = 1,NMIEANG2
            PHSFUN(I) = 2._EB*(abs(S1(I))**2 + abs(S2(I))**2 )
         ENDDO
         PHSFUN = PHSFUN/(QS*XXX(NX)**2)
      ELSE
         PHSFUN = 1.0_EB
      ENDIF

!     Calculate the innermost integral of the forward scattering fraction

      PFOR = 0._EB
      DO J = 1,NMIEANG
         DO I = J,NMIEANG
            IF (ABS(MUD0(I,J)-MUDPI(I,J))<=TWO_EPSILON_EB) THEN
               CALL INTERPOLATE1D(XMU2,PHSFUN,MUD0(I,J),FTMP)
               PFOR(I,J) = PI*FTMP
            ELSE
               mud1 = MUDPI(I,J) 
               mud2 = MUD0(I,J)
               STMP = 0.0_EB
               DO K = 1,NMIEANG2
                  mudloc = mud1+MUDX(K)*(mud2-mud1)
                  CALL INTERPOLATE1D(XMU2,PHSFUN,mudloc,FTMP)
                  STMP = STMP + PWGHT(K)*FTMP
               ENDDO
               PFOR(I,J) = STMP 
            ENDIF
         ENDDO
      ENDDO

!     Calculate the two outer integrals of the forward fraction

      STMP = 0._EB
      DO J = 1,NMIEANG-1
         DO I = J+1,NMIEANG-1
            AIJ = (XMU1(I+1)-XMU1(I))*(XMU1(J+1)-XMU1(J))/2._EB
            STMP = STMP +   (2._EB*PFOR(I,J)+PFOR(I+1,J)+PFOR(I,J+1)+2._EB*PFOR(I+1,J+1))*AIJ/3._EB
         ENDDO
      ENDDO
      DO I = 1,NMIEANG-1
         AIJ = ((XMU1(I+1)-XMU1(I))**2)/2._EB
         STMP = STMP + (PFOR(I,I)+PFOR(I+1,I)+PFOR(I+1,I+1))*AIJ/3._EB
      ENDDO
      CHI_F(NX,NLAMBDA) = 2._EB*STMP/(4._EB*PI/NRA)      
   ENDDO RADIUSLOOP
ENDDO LAMBDALOOP

DEALLOCATE(XXX)
DEALLOCATE(S1)
DEALLOCATE(S2)
DEALLOCATE(XMU1)
DEALLOCATE(XNU1)
DEALLOCATE(XMU2)
DEALLOCATE(MUD)
DEALLOCATE(MUDX)
DEALLOCATE(PWGHT)
DEALLOCATE(ANGLE1)
DEALLOCATE(ANGLE2)
DEALLOCATE(PHSFUN)
DEALLOCATE(PFOR)
DEALLOCATE(MUD0)
DEALLOCATE(MUDPI)

END SUBROUTINE MIE_SCATTERING

SUBROUTINE MIEV0( XX, CREFIN, PERFCT, MIMCUT, ANYANG, NUMANG, XMU, &
                  NMOM, IPOLZN, MOMDIM, PRNT, QEXT, QSCA, GQSC, &
                  PMOM, SFORW, SBACK, S1, S2, TFORW, TBACK, &
                  SPIKE )

!     Mie scattering for a single PARTICLE and wavelength.
!     Author:  Dr. Warren J. Wiscombe (wiscombe@climate.gsfc.nasa.gov)
!         NASA Goddard Space Flight Center
!         Code 913
!         Greenbelt, MD 20771

!     REFERENCES
!     ----------
!
!     (1) Wiscombe, W., 1979: Mie Scattering Calculations--Advances
!         in Technique And Fast, Vector-Speed Computer Codes,
!         Ncar Tech Note TN-140+STR, National Center For
!         Atmospheric Research, Boulder, Colorado (out of print
!         but an updated electronic version available)
!
!     (2) Wiscombe, W., 1980: Improved Mie scattering algorithms,
!         Appl. Opt. 19, 1505-1509
!

!    Computes Mie scattering and extinction efficiencies; asymmetry
!    factor;  forward- and backscatter amplitude;  scattering
!    amplitudes vs. scattering angle for incident polarization parallel
!    and perpendicular to the plane of scattering;
!    coefficients in the Legendre polynomial expansions of either the
!    unpolarized phase function or the polarized phase matrix;
!    some quantities needed in polarized radiative transfer;  and
!    information about whether or not a resonance has been hit.
!
!    Input and output variables are described in file MIEV.doc. 
!    Many statements are accompanied by comments referring to 
!    references in MIEV.doc, notably the NCAR Mie report which is now
!    available electronically and which is referred to using the
!    shorthand (Rn), meaning Eq. (n) of the report.

!    CALLING TREE:
!
!        MIEV0
!            TESTMI
!                TSTBAD
!                MIPRNT
!                ERRMSG
!            CKINMI
!                WRTBAD
!                WRTDIM
!                ERRMSG
!            SMALL1
!            SMALL2
!            ERRMSG
!            BIGA
!                CONFRA
!                    ERRMSG
!            LPCOEF
!                LPCO1T
!                LPCO2T
!                ERRMSG
!            MIPRNT
!
!   I N P U T   V A R I A B L E S
!   -----------------------------
!
!  ( Even if an input variable is not needed for a particular
!    application, make sure it has a legitimate value that can
!    be written out and read in -- no indefinites, etc. )
!
!  XX        Mie size parameter ( 2 * pi * radius / wavelength )
!
!  CREFIN    Complex refractive index ( imag part can be + or -,
!            but internally a negative imaginary index is assumed ).
!            If imag part is - ,  scattering amplitudes as in Van
!            de Hulst are returned;  if imag part is + , complex
!            conjugates of those scattering amplitudes are returned
!            (the latter is the convention in physics).
!            ** NOTE ** In the 'PERFECT' case, scattering amplitudes
!            in the Van de Hulst (Ref. 6 above) convention will
!            automatically be returned unless  Im(CREFIN)  is
!            positive;  otherwise, CREFIN plays no role.
!
!  PERFCT    TRUE, assume refractive index is infinite and use
!            special case formulas for Mie coefficients  'a'
!            and  'b'  ( see Kerker, M., The Scattering of
!            Light and Other Electromagnetic Radiation, p. 90 ).
!            This is sometimes called the 'totally reflecting',
!            sometimes the 'perfectly conducting' case.
!            ( see CREFIN for additional information )
!
!  MIMCUT    (positive) value below which imaginary refractive
!            index is regarded as zero (computation proceeds
!            faster for zero imaginary index)
!
!  ANYANG    TRUE, any angles whatsoever may be input through
!            XMU.  FALSE, the angles are monotone increasing
!            and mirror symmetric about 90 degrees (this option
!            is advantageous because the scattering amplitudes
!            S1,S2 for the angles between 90 and 180 degrees
!            are evaluable from symmetry relations, and hence
!            are obtained with little added computational cost.)
!
!  NUMANG    No. of angles at which scattering amplitudes
!            S1,S2 are to be evaluated  ( set = 0 to skip
!            calculation of S1,S2 ).  Make sure NUMANG does
!            not exceed the parameter MAXANG in the program.
!
!  XMU(N)    Cosines of angles ( N = 1 TO NUMANG ) at which S1,S2
!            are to be evaluated.  If ANYANG = FALSE, then
!
!             (a) the angles must be monotone increasing and
!                 mirror symmetric about 90 degrees (if 90-A is
!                 an angle, then 90+A must be also)
!
!             (b) if NUMANG is odd, 90 degrees must be among
!                 the angles
!
!  NMOM       Highest Legendre moment PMOM to calculate,
!             numbering from zero ( NMOM = 0 prevents
!             calculation of PMOM )
!
!  IPOLZN     POSITIVE, Compute Legendre moments PMOM for the
!                       Mueller matrix elements determined by the
!                       digits of IPOLZN, with 1 referring to M1,
!                       2 to M2, 3 to S21, and 4 to D21 (Ref. 3).
!                       E.g., if IPOLZN = 14 then only moments for
!                       M1 and D21 will be returned.
!
!             0,        Compute Legendre moments PMOM for the
!                       unpolarized unnormalized phase function.
!
!             NEGATIVE, Compute Legendre moments PMOM for the
!                       Sekera phase quantities determined by the
!                       digits of ABS(IPOLZN), with 1 referring to
!                       R1, 2 to R2, 3 to R3, and 4 to R4 (REF. 4).
!                       E.g., if IPOLZN = -14 then only moments for
!                       R1 and R4 will be returned.
!
!             ( NOT USED IF  NMOM = 0 )
!
!  MOMDIM     Determines first dimension of PMOM, which is dimensioned
!             internally as PMOM( 0:MOMDIM, * ) (second dimension must
!             be the larger of unity and the highest digit in
!             IPOLZN; if not, serious errors will occur).
!             Must be given a value, even if  NMOM = 0.  Minimum: 1.
!
!  PRT(L)     Print flags (LOGICAL).  L = 1  prints  S1,S2, their
!             squared absolute values, and degree of polarization,
!             provided NUMANG is non-zero.   L = 2  prints all
!             output variables other than  S1,S2.
!
!
! O U T P U T   V A R I A B L E S
! -------------------------------
!
!  QEXT      (REAL) extinction efficiency factor  ( Ref. 2, Eq. 1A )
!
!  QSCA      (REAL) scattering efficiency factor  ( Ref. 2, Eq. 1B )
!
!  GQSC      (REAL) asymmetry factor times scattering efficiency
!            ( Ref. 2, Eq. 1C )  ( allows calculation of radiation
!            pressure efficiency factor  QPR = QEXT - GQSC )
!
!  =====================================================================
!  ==== NOTE --  S1, S2, SFORW, SBACK, TFORW, AND TBACK are calculated
!  ====          internally for negative imaginary refractive index;
!  ====          for positive imaginary index, their complex conjugates
!  ====          are taken before they are returned, to correspond to
!  ====          customary usage in some parts of physics ( in parti-
!  ====          cular, in papers on CAM approximations to Mie theory ).
!  =====================================================================
!
!  S1(N),    (COMPLEX) Mie scattering amplitudes at angles specified
!  S2(N)     by XMU(N) ( N=1 to NUMANG )  ( Ref. 2, Eqs. 1d-e ).
!
!  SFORW     (COMPLEX) forward-scattering amplitude S1 at
!            0 degrees.  ( S2(0 deg) = S1(0 deg) )
!
!  SBACK     (COMPLEX) backscattering amplitude S1 at
!            180 degrees.   ( S2(180 deg) = - S1(180 deg) )
!
!  TFORW(I)  (COMPLEX) values of
!
!                I=1:  T1 = ( S2 - (MU)*S1 ) / ( 1 - MU**2 )
!                I=2:  T2 = ( S1 - (MU)*S2 ) / ( 1 - MU**2 )
!
!            At angle theta = 0 ( MU = COS(theta) = 1 ), where the
!            expressions on the right-hand side are indeterminate.
!            ( these quantities are required for doing polarized
!            radiative transfer (Ref. 4, Appendix). )
!  TBACK(I)  (COMPLEX) values of  T1 (for I=1) or  T2 (for I=2) at
!            angle  theta = 180 degrees ( MU = COS(theta) = - 1 ).
!
!  SPIKE     (REAL) magnitude of the smallest denominator of
!            either Mie coefficient (a-sub-n or b-sub-n),
!            taken over all terms in the Mie series past
!            N = size parameter XX.  Values of SPIKE below
!            about 0.3 signify a ripple spike, since these
!            spikes are produced by abnormally small denominators
!            in the Mie coefficients (normal denominators are of
!            order unity or higher).  Defaults to 1.0 when not
!            on a spike.  Does not identify all resonances
!            (we are still working on that).
!
! PMOM(M,NP) (REAL) moments  M = 0 to NMOM  of unnormalized NP-th
!            phase quantity PQ  ( moments with  M > 2*NTRM  are
!            zero, where  NTRM = no. terms in Mie series =
!            XX + 4*XX**1/3 + 1 ) :
!
!              PQ( MU, NP ) = sum( M=0 to infinity ) ( (2M+1)
!                                * PMOM( M,NP ) * P-sub-M( MU ) )
!
!            WHERE  MU = COS( scattering angle )
!                   P-sub-M = M-th Legendre polynomial
!
!            and the definition of 'PQ' is as follows:
!
!            IPOLZN>0:  PQ(MU,1) = CABS( S1(MU) )**2
!                          PQ(MU,2) = CABS( S2(MU) )**2
!                          PQ(MU,3) = RE( S1(MU)*CONJG( S2(MU) ) )
!                          PQ(MU,4) = - IM( S1(MU)*CONJG( S2(MU) ) )
!                          ( called M1, M2, S21, D21 in literature )
!
!            IPOLZN=0:  PQ(MU,1) = ( CABS(S1)**2 + CABS(S2)**2 ) / 2
!                       ( the unnormalized phase function )
!
!            IPOLZN<0:  PQ(MU,1) = CABS( T1(MU) )**2
!                          PQ(MU,2) = CABS( T2(MU) )**2
!                          PQ(MU,3) = RE( T1(MU)*CONJG( T2(MU) ) )
!                          PQ(MU,4) = - IM( T1(MU)*CONJG( T2(MU) ) )
!                          ( called R1, R2, R3, R4 in literature )
!
!            The sign of the 4th phase quantity is a source of
!            confusion.  It flips if the complex conjugates of
!            S1,S2  or  T1,T2  are used, as occurs when a
!            refractive index with positive imaginary part is
!            used (see discussion below).  The definition above
!            is consistent with a negative imaginary part.
!
!            ** WARNING **  Make sure the second dimension of PMOM
!            in the calling program is at least as large as the
!            absolute value of IPOLZN.
!
!            For small enough values of XX, or large enough values
!            of M,  PMOM  will tend to underflow.  Thus, it is
!            unwise to assume the values returned are non-zero and,
!            for example, to divide some quantity by them.
!


!      I N T E R N A L   V A R I A B L E S
!      -----------------------------------

!  AN,BN           Mie coefficients a-sub-n, b-sub-n ( Ref. 1, Eq. 16 )
!  ANM1,BNM1       Mie coefficients  a-sub-(n-1),
!                     b-sub-(n-1);  used in GQSC sum
!  ANP             Coeffs. in S+ expansion ( Ref. 2, p. 1507 )
!  BNP             Coeffs. in S- expansion ( Ref. 2, p. 1507 )
!  ANPM            Coeffs. in S+ expansion ( Ref. 2, p. 1507 )
!                     when  MU  is replaced by  - MU
!  BNPM            Coeffs. in S- expansion ( Ref. 2, p. 1507 )
!                     when  MU  is replaced by  - MU
!  CALCMO(K)       TRUE, calculate moments for K-th phase quantity
!                     (derived from IPOLZN)
!  CBIGA(N)        Bessel function ratio A-sub-N (Ref. 2, Eq. 2)
!                     ( COMPLEX version )
!  CDENAN,         (COMPLEX) denominators of An,Bn
!   CDENBN
!  CIOR            Complex index of refraction with negative
!                     imaginary part (Van de Hulst convention)
!  CIORIV          1 / cIoR
!  COEFF           ( 2N + 1 ) / ( N ( N + 1 ) )
!  CSUM1,2         temporary sum variables for TFORW, TBACK
!  FN              Floating point version of loop index for
!                     Mie series summation
!  LITA,LITB(N)    Mie coefficients An, Bn, saved in arrays for
!                     use in calculating Legendre moments PMOM
!  MAXTRM          Max. possible no. of terms in Mie series
!  MM              (-1)^(n+1), where n is Mie series sum index 
!  MIM             Magnitude of imaginary refractive index
!  MRE             Real part of refractive index
!  MAXANG          Max. possible value of input variable NUMANG
!  NANGD2          (NUMANG+1)/2 ( no. of angles in 0-90 deg; ANYANG=F )
!  NOABS           TRUE, sphere non-absorbing (determined by MIMCUT)
!  NP1DN           ( N + 1 ) / N
!  NPQUAN          Highest-numbered phase quantity for which moments are
!                     to be calculated (the largest digit in IPOLZN
!                     if  IPOLZN /= 0)
!  NTRM            No. of terms in Mie series
!  PASS1           TRUE on first entry, FALSE thereafter; for self-test
!  PIN(J)          Angular function pi-sub-n ( Ref. 2, Eq. 3 )
!                     at J-th angle
!  PINM1(J)        pi-sub-(n-1) ( see PIn ) at J-th angle
!  PSINM1          Ricatti-Bessel function psi-sub-(n-1), argument XX
!  PSIN            Ricatti-Bessel function psi-sub-n of argument XX
!                     ( Ref. 1, p. 11 ff. )
!  RBIGA(N)        Bessel function ratio A-sub-N (Ref. 2, Eq. 2)
!                     ( REAL version, for when imag refrac index = 0 )
!  RIORIV          1 / Mre
!  RN              1 / N
!  RTMP            (REAL) temporary variable
!  SP(J)           S+  for J-th angle  ( Ref. 2, p. 1507 )
!  SM(J)           S-  for J-TH angle  ( Ref. 2, p. 1507 )
!  SPS(J)          S+  for (NUMANG+1-J)-th angle ( ANYANG=FALSE )
!  SMS(J)          S-  for (NUMANG+1-J)-th angle ( ANYANG=FALSE )
!  TAUN            Angular function tau-sub-n ( Ref. 2, Eq. 4 )
!                     at J-th angle
!  TCOEF           N ( N+1 ) ( 2N+1 ) (for summing TFORW,TBACK series)
!  TWONP1          2N + 1
!  YESANG          TRUE if scattering amplitudes are to be calculated
!  ZETNM1          Ricatti-Bessel function  zeta-sub-(n-1) of argument
!                     XX  ( Ref. 2, Eq. 17 )
!  ZETN            Ricatti-Bessel function  zeta-sub-n of argument XX
! ----------------------------------------------------------------------
!
IMPLICIT  NONE
!
! ----------------------------------------------------------------------
! --------  I / O SPECIFICATIONS FOR SUBROUTINE MIEV0  -----------------
! ----------------------------------------------------------------------
LOGICAL     ANYANG, PERFCT, PRNT(*)
INTEGER     IPOLZN, MOMDIM, NUMANG, NMOM
REAL(EB)    GQSC, MIMCUT, PMOM( 0:MOMDIM, * ), QEXT, QSCA, SPIKE,XMU(*), XX
COMPLEX(EB) CREFIN, SFORW, SBACK, S1(*), S2(*), TFORW(*), TBACK(*)
! ----------------------------------------------------------------------
!
!                                  ** NOTE --  MAXTRM = 10100  is neces-
!                                  ** sary to do some of the test probs,
!                                  ** but 1100 is sufficient for most
!                                  ** conceivable applications
!     .. Parameters ..

INTEGER     MAXANG
PARAMETER   ( MAXANG = 5000 )
INTEGER     MAXTRM
!      PARAMETER ( MAXTRM = 10100 )
PARAMETER   ( MAXTRM = 16000 ) ! works for FDS
REAL(EB)    ONETHR
PARAMETER   ( ONETHR = 1._EB / 3._EB )

!     .. Local Scalars ..

LOGICAL     NOABS, PASS1, YESANG, GT100
INTEGER     I, J, N, NANGD2, NPQUAN, NTRM
REAL(EB)    CHIN, CHINM1, COEFF, DENAN, DENBN, FN, MIM, MM, MRE, &
            NP1DN, PSIN, PSINM1, RATIO, RIORIV, RN, RTMP, TAUN, &
            TCOEF, TWONP1, XINV
COMPLEX(EB) AN, ANM1, ANP, ANPM, BN, BNM1, BNP, BNPM, CDENAN,&
            CDENBN, CIOR, CIORIV, CSUM1, CSUM2, ZET, ZETN, ZETNM1

!     .. Local Arrays ..

LOGICAL     CALCMO( 4 )
REAL(EB), ALLOCATABLE :: PIN(:), PINM1(:)
REAL(EB) RBIGA( MAXTRM )
COMPLEX(EB) CBIGA( MAXTRM ), LITA( MAXTRM ), LITB( MAXTRM )
COMPLEX(EB), ALLOCATABLE :: SM(:), SMS(:), SP(:), SPS(:)

SAVE      PASS1
DATA      PASS1 / .TRUE. /
!
ALLOCATE(PIN(1:NUMANG)) 
ALLOCATE(PINM1(1:NUMANG))
ALLOCATE(SM(1:NUMANG)) 
ALLOCATE(SMS(1:(NUMANG+1)/2)) 
ALLOCATE(SP(1:NUMANG)) 
ALLOCATE(SPS(1:(NUMANG+1)/2)) 

!                    ** Save some input variables and replace them
!                    ** with values needed to do the self-test

IF( PASS1 ) CALL TESTMI( .FALSE., XX, CREFIN, MIMCUT, PERFCT, &
                         ANYANG, NMOM, IPOLZN, NUMANG, XMU, QEXT, &
                         QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, &
                         TBACK, PMOM, MOMDIM )
MAIN_MIEV: DO 
!                                        ** Check input and calculate
!                                        ** certain variables from input
CALL CKINMI( NUMANG, MAXANG, XX, PERFCT, CREFIN, MOMDIM, NMOM, &
             IPOLZN, ANYANG, XMU, CALCMO, NPQUAN )

IF( PERFCT .AND. XX<=0.1_EB ) THEN
!                                            ** Use totally-reflecting
!                                            ** small-particle limit
   CALL SMALL1( XX, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, SBACK, &
                  S1, S2, TFORW, TBACK, LITA, LITB )
   NTRM = 2
ELSE
   NOABS = .TRUE.
   GT100 = .FALSE.

   IF( .NOT.PERFCT ) THEN
      CIOR = CREFIN
      IF( AIMAG(CIOR)>0.0_EB ) CIOR = CONJG( CIOR )
      MRE    = REAL( CIOR )
      MIM    = -AIMAG( CIOR )
      NOABS  = MIM<=MIMCUT
      CIORIV = 1.0_EB / CIOR
      RIORIV = 1.0_EB / MRE

      IF( XX*MAX( 1._EB, ABS(CIOR) )<=0.1_EB ) THEN
!                                    ** Use general-refractive-index
!                                    ** small-particle limit
         CALL SMALL2( XX, CIOR, MIM>MIMCUT, NUMANG, XMU, QEXT, &
                           QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, &
                           TBACK, LITA, LITB )
         NTRM = 2
         GT100 = .TRUE.
      END IF
   END IF
   GT100IF: IF (.NOT. GT100) THEN

      NANGD2 = ( NUMANG + 1 ) / 2
      YESANG = NUMANG>0
   !                             ** Number of terms in Mie series; Eq R50
      IF( XX<=8.0_EB ) THEN
      NTRM = XX + 4._EB*XX**ONETHR + 1._EB
      ELSE IF( XX<4200._EB ) THEN
      NTRM = XX + 4.05*XX**ONETHR + 2._EB
      ELSE
      NTRM = XX + 4._EB*XX**ONETHR + 2._EB
      END IF
      IF( NTRM+1 > MAXTRM )CALL ERRMSG('MIEV0--PARAMETER MaxTrm TOO SMALL',.TRUE.)
   !                            ** Calculate logarithmic derivatives of
   !                            ** J-Bessel-fcn., A-sub-(1 to NTrm)
      IF( .NOT.PERFCT ) CALL BIGA( CIOR, XX, NTRM, NOABS, YESANG, RBIGA, CBIGA )
   !                            ** Initialize Ricatti-Bessel functions
   !                            ** (psi,chi,zeta)-sub-(0,1) for upward
   !                            ** recurrence ( Eq. R19 )
      XINV   = 1.0_EB / XX
      PSINM1 = SIN( XX )
      CHINM1 = COS( XX )
      PSIN   = PSINM1*XINV - CHINM1
      CHIN   = CHINM1*XINV + PSINM1
      ZETNM1 = CMPLX( PSINM1, CHINM1 )
      ZETN   = CMPLX( PSIN, CHIN )
   !                                     ** Initialize previous coeffi-
   !                                     ** cients for GQSC series
      ANM1 = ( 0.0_EB, 0.0_EB )
      BNM1 = ( 0.0_EB, 0.0_EB )
   !                             ** Initialize angular function  pi
   !                             ** and sums for S+, S- ( Ref. 2, p. 1507 )
      IF( ANYANG ) THEN
      DO J = 1, NUMANG
   !                             ** Eq. R39
            PINM1( J ) = 0.0_EB
            PIN( J ) = 1.0_EB

               SP( J ) = ( 0.0_EB, 0.0_EB )
               SM( J ) = ( 0.0_EB, 0.0_EB )
         END DO
      ELSE
         DO J = 1, NANGD2
   !                          ** Eq. R39
            PINM1( J ) = 0.0_EB
            PIN( J ) = 1.0_EB
            SP( J ) = ( 0.0_EB, 0.0_EB )
            SM( J ) = ( 0.0_EB, 0.0_EB )
            SPS( J ) = ( 0.0_EB, 0.0_EB )
            SMS( J ) = ( 0.0_EB, 0.0_EB )
         END DO
      END IF
   !                       ** Initialize Mie sums for efficiencies, etc.
      QSCA  = 0.0_EB
      GQSC  = 0.0_EB
      SFORW = ( 0._EB, 0._EB )
      SBACK = ( 0._EB, 0._EB )
      CSUM1 = ( 0._EB, 0._EB )
      CSUM2 = ( 0._EB, 0._EB )
   !
   ! ---------  LOOP TO SUM MIE SERIES  -----------------------------------
      MM     = +1.0_EB
      SPIKE  = 1.0_EB
      DO N = 1, NTRM
   !                           ** Compute various numerical coefficients
         FN     = N
         RN     = 1.0_EB / FN
         NP1DN  = 1.0_EB + RN
         TWONP1 = 2*N + 1
         COEFF  = TWONP1 / ( FN * ( N + 1 ) )
         TCOEF  = TWONP1 * ( FN * ( N + 1 ) )
   !                          ** Calculate Mie series coefficients
         IF( PERFCT ) THEN
   !                                 ** Totally-reflecting case; Eq R/A.1,2
            AN = ( ( FN*XINV )*PSIN - PSINM1 ) / ( ( FN*XINV )*ZETN - ZETNM1 )
            BN = PSIN / ZETN
         ELSE IF( NOABS ) THEN
   !                                      ** No-absorption case; Eq (R16)
            CDENAN = ( RIORIV*RBIGA(N) + ( FN*XINV ) ) * ZETN - ZETNM1
            AN   = ( ( RIORIV*RBIGA(N) + ( FN*XINV ) ) * PSIN - PSINM1 ) / CDENAN
            CDENBN = ( MRE*RBIGA(N) + ( FN*XINV ) ) * ZETN - ZETNM1
            BN   = ( ( MRE*RBIGA(N) + ( FN*XINV ) ) * PSIN - PSINM1 ) / CDENBN
         ELSE
   !                                       ** Absorptive case; Eq (R16)
            CDENAN = ( CIORIV*CBIGA( N ) + ( FN*XINV ) )*ZETN - ZETNM1
            CDENBN =   ( CIOR*CBIGA( N ) + ( FN*XINV ) )*ZETN - ZETNM1
            AN   = ( ( CIORIV*CBIGA( N ) + ( FN*XINV ) )*PSIN - PSINM1 ) / CDENAN
            BN     = ( ( CIOR*CBIGA( N ) + ( FN*XINV ) )*PSIN - PSINM1 ) / CDENBN
   !                                         ** Eq (R7)
            QSCA   = QSCA + TWONP1*( SQ( AN ) + SQ( BN ) )
         END IF
   !                       ** Save Mie coefficients for PMOM calculation
         LITA( N ) = AN
         LITB( N ) = BN
   !
         IF( .NOT.PERFCT .AND. N>XX ) THEN
   !                                               ** Flag resonance spikes
            DENAN  = ABS( CDENAN )
            DENBN  = ABS( CDENBN )
   !                                                   ** Eq. R/B.9
            RATIO  = DENAN / DENBN
   !                                                   ** Eq. R/B.10
            IF( RATIO<=0.2_EB .OR. RATIO>=5.0_EB ) SPIKE = MIN( SPIKE, DENAN, DENBN )
         END IF
   !                                  ** Increment Mie sums for non-angle-
   !                                  ** dependent quantities
   !                                                   ** Eq. R/B.2
         SFORW = SFORW + TWONP1*( AN + BN )
   !                                                   ** Eq. R/B.5,6
         CSUM1 = CSUM1 + TCOEF *( AN - BN )
   !                                                   ** Eq. R/B.1
         SBACK = SBACK + ( MM*TWONP1 )*( AN - BN )
   !                                                   ** Eq. R/B.7,8
         CSUM2 = CSUM2 + ( MM*TCOEF ) *( AN + BN )
   !                                         ** Eq (R8)
         GQSC  = GQSC  + (FN - RN) * REAL(ANM1 * CONJG(AN) + BNM1 * CONJG(BN) ) + COEFF * REAL(AN * CONJG(BN))
         IF( YESANG ) THEN
   !                                      ** Put Mie coefficients in form
   !                                      ** needed for computing S+, S-
   !                                      ** ( Eq R10 )
         ANP = COEFF*( AN + BN )
         BNP = COEFF*( AN - BN )
   !                                      ** Increment Mie sums for S+, S-
   !                                      ** while upward recursing
   !                                      ** angular functions pi and tau
         IF( ANYANG ) THEN
   !                                         ** Arbitrary angles
   !                                              ** vectorizable loop
            DO J = 1, NUMANG
   !                                                 ** Eq. (R37b)
               RTMP = ( XMU(J) * PIN(J) ) - PINM1( J )
   !                                                 ** Eq. (R38b)
               TAUN   = FN * RTMP - PINM1( J )
   !                                                   ** Eq (R10)
               SP( J ) = SP( J ) + ANP * ( PIN( J ) + TAUN )
               SM( J ) = SM( J ) + BNP * ( PIN( J ) - TAUN )
               PINM1( J ) = PIN( J )
   !                                                 ** Eq. R37c
               PIN( J ) = ( XMU( J ) * PIN( J ) ) + NP1DN * RTMP
            END DO
         ELSE
   !                                  ** Angles symmetric about 90 degrees
            ANPM = MM*ANP
            BNPM = MM*BNP
   !                                          ** vectorizable loop
            DO J = 1, NANGD2
   !                                                 ** Eq. (R37b)
               RTMP = ( XMU(J) * PIN(J) ) - PINM1( J )
   !                                                 ** Eq. (R38b)
               TAUN = FN * RTMP - PINM1( J )
   !                                                 ** Eq (R10,12)
               SP ( J ) = SP ( J ) + ANP * ( PIN( J ) + TAUN )
               SMS( J ) = SMS( J ) + BNPM *( PIN( J ) + TAUN )
               SM ( J ) = SM ( J ) + BNP * ( PIN( J ) - TAUN )
               SPS( J ) = SPS( J ) + ANPM *( PIN( J ) - TAUN )
               PINM1( J ) = PIN( J )
         !                                                 ** Eq. R37c
               PIN( J ) = ( XMU(J) * PIN(J) ) + NP1DN * RTMP
            END DO
         END IF
         END IF
   !                          ** Update relevant quantities for next
   !                          ** pass through loop
         MM   = - MM
         ANM1 = AN
         BNM1 = BN
   !                           ** Upward recurrence for Ricatti-Bessel
   !                           ** functions ( Eq. R17 )
         ZET    = ( TWONP1*XINV ) * ZETN - ZETNM1
         ZETNM1 = ZETN
         ZETN   = ZET
         PSINM1 = PSIN
         PSIN   = REAL( ZETN )
      END DO
   ! ---------- END LOOP TO SUM MIE SERIES --------------------------------
   !
   !                                         ** Eq (R6)
      QEXT = 2._EB / XX**2*REAL( SFORW )
      IF( PERFCT .OR. NOABS ) THEN
         QSCA = QEXT
      ELSE
         QSCA = 2._EB/ XX**2 * QSCA
      END IF
      GQSC   = 4._EB/ XX**2 * GQSC
      SFORW  = 0.5_EB*SFORW
      SBACK  = 0.5_EB*SBACK
      TFORW( 1 ) =  0.5_EB*SFORW - 0.125_EB*CSUM1
      TFORW( 2 ) =  0.5_EB*SFORW + 0.125_EB*CSUM1
      TBACK( 1 ) = -0.5_EB*SBACK + 0.125_EB*CSUM2
      TBACK( 2 ) =  0.5_EB*SBACK + 0.125_EB*CSUM2
      IF( YESANG ) THEN
   !                                ** Recover scattering amplitudes
   !                                ** from S+, S- ( Eq (R11) )
         IF( ANYANG ) THEN
   !                                         ** vectorizable loop
            DO J = 1, NUMANG
   !                                                  ** Eq (R11)
               S1( J ) = 0.5_EB*( SP( J ) + SM( J ) )
               S2( J ) = 0.5_EB*( SP( J ) - SM( J ) )
            END DO
         ELSE
   !                                        ** vectorizable loop
            DO J = 1, NANGD2
   !                                                   ** Eq (R11)
               S1( J ) = 0.5_EB*( SP( J ) + SM( J ) )
               S2( J ) = 0.5_EB*( SP( J ) - SM( J ) )
            END DO
   !                                        ** vectorizable loop
            DO  J = 1, NANGD2
               S1( NUMANG + 1 - J ) = 0.5_EB*( SPS( J ) + SMS( J ) )
               S2( NUMANG + 1 - J ) = 0.5_EB*( SPS( J ) - SMS( J ) )
            END DO
         END IF
      END IF
   END IF GT100IF
   !                                 ** Calculate Legendre moments
END IF
IF( NMOM>0 ) CALL LPCOEF( NTRM, NMOM, IPOLZN, MOMDIM, CALCMO,NPQUAN, LITA, LITB, PMOM )
IF( AIMAG( CREFIN )>0.0_EB ) THEN
!                                         ** Take complex conjugates
!                                         ** of scattering amplitudes
   SFORW = CONJG( SFORW )
   SBACK = CONJG( SBACK )
   DO I = 1, 2
      TFORW( I ) = CONJG( TFORW( I ) )
      TBACK( I ) = CONJG( TBACK( I ) )
   END DO
   DO J = 1, NUMANG
      S1( J ) = CONJG( S1( J ) )
      S2( J ) = CONJG( S2( J ) )
   END DO
END IF

IF( PASS1 ) THEN
!                           ** Compare test case results with
!                           ** correct answers and abort if bad;
!                           ** otherwise restore user input and proceed
   CALL TESTMI( .TRUE., XX, CREFIN, MIMCUT, PERFCT, ANYANG, NMOM, &
                  IPOLZN, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, &
                  SBACK, S1, S2, TFORW, TBACK, PMOM, MOMDIM )
   PASS1  = .FALSE.
   CYCLE MAIN_MIEV
END IF
EXIT MAIN_MIEV
END DO MAIN_MIEV

IF( PRNT( 1 ) .OR. PRNT( 2 ) )  &
  CALL MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, &
               QSCA, GQSC, NMOM, IPOLZN, MOMDIM, CALCMO, PMOM, &
               SFORW, SBACK, TFORW, TBACK, S1, S2 )
!
DEALLOCATE(PIN)
DEALLOCATE(PINM1)
DEALLOCATE(SM) 
DEALLOCATE(SMS)
DEALLOCATE(SP) 
DEALLOCATE(SPS) 

RETURN

END SUBROUTINE MIEV0

SUBROUTINE CKINMI( NUMANG, MAXANG, XX, PERFCT, CREFIN, MOMDIM, NMOM, IPOLZN, ANYANG, XMU, CALCMO, NPQUAN )

!        Check for bad input to MIEV0 and calculate CALCMO, NPQUAN

!     Routines called :  ERRMSG, WRTBAD, WRTDIM

!     .. Scalar Arguments ..

LOGICAL     ANYANG, PERFCT
INTEGER     IPOLZN, MAXANG, MOMDIM, NMOM, NPQUAN, NUMANG
REAL(EB)    XX
COMPLEX(EB) CREFIN
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    XMU( * )
!     ..
!     .. Local Scalars ..

CHARACTER(4) :: STRING
LOGICAL     INPERR
INTEGER     I, IP, J, L

INPERR = .FALSE.

IF( NUMANG>MAXANG ) INPERR = WRTDIM( 'MaxAng', NUMANG )
IF( NUMANG<0 ) INPERR = WRTBAD( 'NUMANG' )

IF( XX<0._EB ) INPERR = WRTBAD( 'XX' )

IF( .NOT.PERFCT .AND. REAL( CREFIN )<=0._EB )INPERR = WRTBAD( 'CREFIN' )

IF( MOMDIM<0 ) INPERR = WRTBAD( 'MOMDIM' )


IF( NMOM/=0 ) THEN

   IF( NMOM<0 .OR. NMOM>MOMDIM ) INPERR = WRTBAD( 'NMOM' )
   IF( ABS( IPOLZN )>4444 ) INPERR = WRTBAD( 'IPOLZN' )

   NPQUAN = 0

   DO L = 1, 4
      CALCMO( L ) = .FALSE.
   END DO

   IF( IPOLZN/=0 ) THEN
   !                                 ** Parse out IPOLZN into its digits
   !                                 ** to find which phase quantities are
   !                                 ** to have their moments calculated
      WRITE( STRING, '(I4)' ) ABS( IPOLZN )
      DO J = 1, 4
         IP = ICHAR( STRING( J:J ) ) - ICHAR( '0' )
         IF( IP>=1 .AND. IP<=4 ) CALCMO( IP ) = .TRUE.
         IF( IP==0 .OR. ( IP>=5 .AND. IP<=9 ) ) INPERR = WRTBAD( 'IPOLZN' )
         NPQUAN = MAX( NPQUAN, IP )
      END DO
   END IF
END IF

IF( ANYANG ) THEN
!                                ** Allow for slight imperfections in
!                                ** computation of cosine
   DO I = 1, NUMANG
      IF( XMU( I )<-1.00001_EB .OR. XMU( I )>1.00001_EB ) INPERR = WRTBAD( 'XMU' )
   END DO
   ELSE
   DO I = 1, ( NUMANG + 1 ) / 2
      IF( XMU( I )<-0.00001_EB .OR. XMU( I )>1.00001_EB ) INPERR = WRTBAD( 'XMU' )
   END DO
END IF

IF( INPERR ) CALL ERRMSG( 'MIEV0--Input error(S).  Aborting...', .TRUE. )
IF( XX>20000.0_EB .OR. REAL( CREFIN )>10.0_EB .OR. ABS( AIMAG( CREFIN ) )>10.0_EB ) &
    CALL ERRMSG( 'MIEV0--XX or CREFIN outside tested range',.FALSE.)
RETURN
END SUBROUTINE CKINMI

SUBROUTINE LPCOEF( NTRM, NMOM, IPOLZN, MOMDIM, CALCMO, NPQUAN, A, B, PMOM )
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities ( Ref. 5 formulation )

!     INPUT:  NTRM                    Number terms in Mie series
!             NMOM, IPOLZN, MOMDIM    MIEV0 arguments
!             CALCMO                  Flags calculated from IPOLZN
!             NPQUAN                  Defined in MIEV0
!             A, B                    Mie series coefficients
!
!     OUTPUT: PMOM                   Legendre moments (MIEV0 argument)
!
!     Routines called :  ERRMSG, LPCO1T, LPCO2T
!
!     *** NOTES ***
!
!         (1)  Eqs. 2-5 are in error in Dave, Appl. Opt. 9,
!         1888 (1970).  Eq. 2 refers to M1, not M2;  eq. 3 refers to
!         M2, not M1.  In eqs. 4 and 5, the subscripts on the second
!         term in square brackets should be interchanged.
!
!         (2)  The general-case logic in this subroutine works correctly
!         in the two-term Mie series case, but subroutine LPCO2T
!         is called instead, for speed.
!
!         (3)  Subroutine  LPCO1T, to do the one-term case, is never
!         called within the context of MIEV0, but is included for
!         complete generality.
!
!         (4)  Some improvement in speed is obtainable by combining the
!         310- and 410-loops, if moments for both the third and fourth
!         phase quantities are desired, because the third phase quantity
!         is the real part of a complex series, while the fourth phase
!         quantity is the imaginary part of that very same series.  But
!         most users are not interested in the fourth phase quantity,
!         which is related to circular polarization, so the present
!         scheme is usually more efficient.
!
!
!           ** Definitions of local variables ***
!      AM(M)       Numerical coefficients  a-sub-m-super-l
!                     in Dave, Eqs. 1-15, as simplified in Ref. 5.
!      BI(I)       Numerical coefficients  b-sub-i-super-l
!                     in Dave, Eqs. 1-15, as simplified in Ref. 5.
!      BIDEL(I)    1/2 Bi(I) times factor capital-del in Dave
!      CM,DM()     Arrays C and D in Dave, Eqs. 16-17 (Mueller form),
!                     calculated using recurrence derived in Ref. 5
!      CS,DS()     Arrays C and D in Ref. 4, Eqs. A5-A6 (Sekera form),
!                     calculated using recurrence derived in Ref. 5
!      C,D()       Either CM,DM or CS,DS, depending on IPOLZN
!      EVENL       True for even-numbered moments;  false otherwise
!      IDEL        1 + little-del  in Dave
!      MAXTRM      Max. no. of terms in Mie series
!      MAXMOM      Max. no. of non-zero moments
!      NUMMOM      Number of non-zero moments
!      RECIP(K)    1 / K

IMPLICIT  NONE

!     .. Parameters ..

INTEGER     MAXTRM, MAXMOM, MXMOM2, MAXRCP
PARAMETER ( MAXTRM=1001, MAXMOM = 2*MAXTRM, MXMOM2 = MAXMOM / 2, MAXRCP = 4*MAXTRM + 2 )
!     ..
!     .. Scalar Arguments ..

INTEGER   IPOLZN, MOMDIM, NMOM, NPQUAN, NTRM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

LOGICAL     EVENL, PASS1
INTEGER     I, IDEL, IMAX, J, K, L, LD2, M, MMAX, NUMMOM
REAL(EB)    SUM
!     ..
!     .. Local Arrays ..

REAL(EB)    AM( 0:MAXTRM ), BI( 0:MXMOM2 ), BIDEL( 0:MXMOM2 ), RECIP( MAXRCP )
COMPLEX(EB) C( MAXTRM ), CM( MAXTRM ), CS( MAXTRM ), D( MAXTRM ), DM( MAXTRM ), DS( MAXTRM )
!     ..
!     .. Equivalences ..

EQUIVALENCE ( C, CM ), ( D, DM )
!     ..
SAVE      PASS1, RECIP
DATA      PASS1 / .TRUE. /

IF( PASS1 ) THEN
   DO  K = 1, MAXRCP
      RECIP( K ) = 1.0_EB / K
   END DO
   PASS1  = .FALSE.
END IF

DO J = 1, MAX( 1, NPQUAN )
   DO L = 0, NMOM
      PMOM( L, J ) = 0.0_EB
   END DO
END DO

IF( NTRM==1 ) THEN
   CALL LPCO1T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
   RETURN
ELSE IF( NTRM==2 ) THEN
   CALL LPCO2T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
   RETURN
END IF

IF( NTRM + 2>MAXTRM )CALL ERRMSG('LPCoef--PARAMETER MaxTrm too small',.TRUE.)
!                                     ** Calculate Mueller C, D arrays
CM( NTRM + 2 ) = ( 0._EB, 0._EB )
DM( NTRM + 2 ) = ( 0._EB, 0._EB )
CM( NTRM + 1 ) = ( 1._EB - RECIP( NTRM+1 ) ) * B( NTRM )
DM( NTRM + 1 ) = ( 1._EB - RECIP( NTRM+1 ) ) * A( NTRM )
CM( NTRM ) = ( RECIP( NTRM ) + RECIP( NTRM+1 ) ) * A( NTRM ) + ( 1._EB - RECIP( NTRM ) )*B( NTRM-1 )
DM( NTRM ) = ( RECIP( NTRM ) + RECIP( NTRM+1 ) ) * B( NTRM ) + ( 1._EB - RECIP( NTRM ) )*A( NTRM-1 )
DO K = NTRM-1, 2, -1
   CM( K ) = CM( K+2 ) - ( 1._EB + RECIP(K+1) ) * B( K+1 )+ ( RECIP(K) + RECIP(K+1) ) * A( K ) &
                        + ( 1._EB - RECIP(K) ) * B( K-1 )
   DM( K ) = DM( K+2 ) - ( 1._EB + RECIP(K+1) ) * A( K+1 )  + ( RECIP(K) + RECIP(K+1) ) * B( K ) &
                        + ( 1._EB - RECIP(K) ) * A( K-1 )
END DO

CM( 1 ) = CM( 3 ) + 1.5_EB * ( A( 1 ) - B( 2 ) )
DM( 1 ) = DM( 3 ) + 1.5_EB * ( B( 1 ) - A( 2 ) )

IF( IPOLZN>=0 ) THEN
   DO K = 1, NTRM + 2
      C( K ) = ( 2*K - 1 ) * CM( K )
      D( K ) = ( 2*K - 1 ) * DM( K )
   END DO
ELSE
!                                    ** Compute Sekera C and D arrays
   CS( NTRM + 2 ) = ( 0._EB, 0._EB )
   DS( NTRM + 2 ) = ( 0._EB, 0._EB )
   CS( NTRM + 1 ) = ( 0._EB, 0._EB )
   DS( NTRM + 1 ) = ( 0._EB, 0._EB )

   DO K = NTRM, 1, -1
      CS( K ) = CS( K+2 ) + ( 2*K + 1 ) * ( CM( K+1 ) - B( K ) )
      DS( K ) = DS( K+2 ) + ( 2*K + 1 ) * ( DM( K+1 ) - A( K ) )
   END DO

   DO K = 1, NTRM + 2
      C( K ) = ( 2*K - 1 ) * CS( K )
      D( K ) = ( 2*K - 1 ) * DS( K )
   END DO

END IF

IF( IPOLZN<0 ) NUMMOM = MIN( NMOM, 2*NTRM - 2 )
IF( IPOLZN>=0 ) NUMMOM = MIN( NMOM, 2*NTRM )

IF( NUMMOM>MAXMOM )  CALL ERRMSG('LPCoef--PARAMETER MaxTrm too small',.TRUE.)
!
!                          ** Loop over moments
L240: DO L = 0, NUMMOM
   LD2 = L / 2
   EVENL  = MOD( L, 2 )==0
!                                    ** Calculate numerical coefficients
!                                    ** a-sub-m and b-sub-i in Dave
!                                    ** double-sums for moments
   IF( L==0 ) THEN
      IDEL = 1
      DO M = 0, NTRM
         AM( M ) = 2.0_EB * RECIP( 2*M + 1 )
      END DO
      BI( 0 ) = 1.0_EB
   ELSE IF( EVENL ) THEN
      IDEL = 1
      DO M = LD2, NTRM
         AM( M ) = ( 1._EB + RECIP( 2*M - L + 1 ) ) * AM( M )
      END DO
      DO I = 0, LD2 - 1
         BI( I ) = ( 1._EB - RECIP( L - 2*I ) ) * BI( I )
      END DO
      BI( LD2 ) = ( 2._EB - RECIP( L ) ) * BI( LD2 - 1 )
   ELSE
   IDEL = 2
      DO M = LD2, NTRM
         AM( M ) = ( 1._EB - RECIP( 2*M + L + 2 ) ) * AM( M )
      END DO

      DO I = 0, LD2
         BI( I ) = ( 1._EB - RECIP( L + 2*I + 1 ) ) * BI( I )
      END DO
   END IF
!                                     ** Establish upper limits for sums
!                                     ** and incorporate factor capital-
!                                     ** del into b-sub-i
   MMAX = NTRM - IDEL
   IF( IPOLZN>=0 ) MMAX = MMAX + 1
   IMAX = MIN( LD2, MMAX - LD2 )
   IF( IMAX<0 ) EXIT L240
   DO I = 0, IMAX
      BIDEL( I ) = BI( I )
   END DO
   IF( EVENL ) BIDEL( 0 ) = 0.5_EB*BIDEL( 0 )
!                                    ** Perform double sums just for
!                                    ** phase quantities desired by user
   IF( IPOLZN==0 ) THEN
      DO I = 0, IMAX
!                                           ** vectorizable loop
         SUM = 0.0_EB
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) * ( REAL(C(M-I+1) * CONJG(C(M+I+IDEL)))+ REAL(D(M-I+1) * CONJG(D(M+I+IDEL))))
         END DO
         PMOM( L, 1 ) = PMOM( L, 1 ) + BIDEL( I ) * SUM
      END DO
      PMOM( L, 1 ) = 0.5_EB*PMOM( L, 1 )
      CYCLE L240
   END IF

   IF( CALCMO( 1 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                          ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM( M ) * REAL( C(M-I+1) * CONJG( C(M+I+IDEL) ) )
         END DO
         PMOM( L, 1 ) = PMOM( L, 1 ) + BIDEL( I ) * SUM
      END DO
   END IF

   IF( CALCMO( 2 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                           ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM( M ) * REAL( D(M-I+1) * CONJG( D(M+I+IDEL) ) )
         END DO
         PMOM( L, 2 ) = PMOM( L, 2 ) + BIDEL( I ) * SUM
      END DO
   END IF

   IF( CALCMO( 3 ) ) THEN
      DO I = 0, IMAX
         SUM = 0.0_EB
!                                           ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) *( REAL(C(M-I+1) * CONJG(D(M+I+IDEL))) + REAL(C(M+I+IDEL) * CONJG(D(M-I+1))))
         END DO
         PMOM( L, 3 ) = PMOM( L, 3 ) + BIDEL( I ) * SUM
      END DO
      PMOM( L, 3 ) = 0.5_EB*PMOM( L, 3 )
   END IF

   IF( CALCMO( 4 ) ) THEN
      DO I = 0, IMAX
         SUM= 0.0_EB
!                                         ** vectorizable loop
         DO M = LD2, MMAX - I
            SUM = SUM + AM(M) *(AIMAG(C(M-I+1) * CONJG(D(M+I+IDEL)))+ AIMAG(C(M+I+IDEL) * CONJG(D(M-I+1))))
         END DO
         PMOM( L, 4 ) = PMOM( L, 4 ) + BIDEL( I ) * SUM
      END DO

      PMOM( L, 4 ) = - 0.5_EB * PMOM( L, 4 )
   END IF

END DO L240

RETURN
END SUBROUTINE LPCOEF

SUBROUTINE LPCO1T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
!
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities in special case where
!         no. terms in Mie series = 1
!
!        INPUT:  NMOM, IPOLZN, MOMDIM     MIEV0 arguments
!                CALCMO                   Flags calculated from IPOLZN
!                A(1), B(1)               Mie series coefficients
!
!        OUTPUT: PMOM                     Legendre moments

!     .. Scalar Arguments ..

INTEGER     IPOLZN, MOMDIM, NMOM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

INTEGER     L, NUMMOM
REAL(EB)    A1SQ, B1SQ
COMPLEX(EB) A1B1C

A1SQ   = SQ( A( 1 ) )
B1SQ   = SQ( B( 1 ) )
A1B1C  = A( 1 ) * CONJG( B( 1 ) )


IF( IPOLZN<0 ) THEN
   IF( CALCMO( 1 ) ) PMOM( 0, 1 ) = 2.25_EB*B1SQ
   IF( CALCMO( 2 ) ) PMOM( 0, 2 ) = 2.25_EB*A1SQ
   IF( CALCMO( 3 ) ) PMOM( 0, 3 ) = 2.25_EB*REAL( A1B1C )
   IF( CALCMO( 4 ) ) PMOM( 0, 4 ) = 2.25_EB*AIMAG( A1B1C )
ELSE
   NUMMOM = MIN( NMOM, 2 )
   !                             ** Loop over moments
   L10: DO L = 0, NUMMOM
      IF( IPOLZN==0 ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 1.5_EB*( A1SQ + B1SQ )
         IF( L==1 ) PMOM( L, 1 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 1 ) = 0.15_EB*( A1SQ + B1SQ )
         CYCLE L10
      END IF

      IF( CALCMO( 1 ) ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 2.25_EB*( A1SQ + B1SQ / 3.)
         IF( L==1 ) PMOM( L, 1 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 1 ) = 0.3_EB*B1SQ
      END IF

      IF( CALCMO( 2 ) ) THEN
         IF( L==0 ) PMOM( L, 2 ) = 2.25_EB*( B1SQ + A1SQ / 3. )
         IF( L==1 ) PMOM( L, 2 ) = 1.5_EB*REAL( A1B1C )
         IF( L==2 ) PMOM( L, 2 ) = 0.3_EB*A1SQ
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 3.0_EB*REAL( A1B1C )
         IF( L==1 ) PMOM( L, 3 ) = 0.75_EB*( A1SQ + B1SQ )
         IF( L==2 ) PMOM( L, 3 ) = 0.3_EB*REAL( A1B1C )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = -1.5_EB*AIMAG( A1B1C )
         IF( L==1 ) PMOM( L, 4 ) = 0.0_EB
         IF( L==2 ) PMOM( L, 4 ) = 0.3_EB*AIMAG( A1B1C )
      END IF

   END DO L10
END IF

RETURN
END SUBROUTINE LPCO1T

SUBROUTINE LPCO2T( NMOM, IPOLZN, MOMDIM, CALCMO, A, B, PMOM )
!         Calculate Legendre polynomial expansion coefficients (also
!         called moments) for phase quantities in special case where
!         no. terms in Mie series = 2

!        INPUT:  NMOM, IPOLZN, MOMDIM     MIEV0 arguments
!                CALCMO                   Flags calculated from IPOLZN
!                A(1-2), B(1-2)           Mie series coefficients
!
!        OUTPUT: PMOM                     Legendre moments


!     .. Scalar Arguments ..

INTEGER     IPOLZN, MOMDIM, NMOM
!     ..
!     .. Array Arguments ..

LOGICAL     CALCMO( * )
REAL(EB)    PMOM( 0:MOMDIM, * )
COMPLEX(EB) A( * ), B( * )
!     ..
!     .. Local Scalars ..

INTEGER     L, NUMMOM
REAL(EB)    A2SQ, B2SQ, PM1, PM2
COMPLEX(EB) A2C, B2C, CA, CAC, CAT, CB, CBC, CBT, CG, CH

CA   = 3.*A( 1 ) - 5.*B( 2 )
CAT  = 3.*B( 1 ) - 5.*A( 2 )
CAC  = CONJG( CA )
A2SQ = SQ( A( 2 ) )
B2SQ = SQ( B( 2 ) )
A2C  = CONJG( A( 2 ) )
B2C  = CONJG( B( 2 ) )

IF( IPOLZN<0 ) THEN
!                                   ** Loop over Sekera moments
   NUMMOM = MIN( NMOM, 2 )
   DO L = 0, NUMMOM
      IF( CALCMO( 1 ) ) THEN
         IF( L==0 ) PMOM( L, 1 ) = 0.25_EB * ( SQ( CAT ) + (100._EB/3._EB)* B2SQ )
         IF( L==1 ) PMOM( L, 1 ) = (5._EB/3._EB)*REAL( CAT*B2C )
         IF( L==2 ) PMOM( L, 1 ) = (10._EB/3._EB)*B2SQ
      END IF

      IF( CALCMO( 2 ) ) THEN
         IF( L==0 ) PMOM( L, 2 ) = 0.25_EB * ( SQ( CA ) + (100._EB/3._EB) * A2SQ )
         IF( L==1 ) PMOM( L, 2 ) = (5._EB/3._EB)*REAL( CA*A2C )
         IF( L==2 ) PMOM( L, 2 ) = (10._EB/3._EB)*A2SQ
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 0.25_EB * REAL( CAT * CAC  + (100._EB/3._EB) * B(2) * A2C )
         IF( L==1 ) PMOM( L, 3 ) = 5._EB/6._EB* REAL( B(2)*CAC + CAT*A2C )
         IF( L==2 ) PMOM( L, 3 ) = 10._EB/3._EB* REAL( B(2)*A2C )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = -0.25_EB * AIMAG( CAT * CAC + (100._EB/3._EB)* B(2) * A2C )
         IF( L==1 ) PMOM( L, 4 ) = -5._EB/ 6._EB*  AIMAG( B(2)*CAC + CAT*A2C )
         IF( L==2 ) PMOM( L, 4 ) = -10._EB/ 3._EB* AIMAG( B(2)*A2C )
      END IF

   END DO

ELSE

   CB  = 3._EB*B( 1 ) + 5._EB*A( 2 )
   CBT = 3._EB*A( 1 ) + 5._EB*B( 2 )
   CBC = CONJG( CB )
   CG  = ( CBC*CBT + 10._EB*( CAC*A( 2 ) + B2C*CAT ) ) / 3._EB
   CH  = 2._EB*( CBC*A( 2 ) + B2C*CBT )

   !                               ** Loop over Mueller moments
   NUMMOM = MIN( NMOM, 4 )

   L20: DO L = 0, NUMMOM

      IF( IPOLZN==0 .OR. CALCMO( 1 ) ) THEN
         IF( L==0 ) PM1 = 0.25_EB*SQ( CA ) + SQ( CB ) / 12._EB + (5._EB/3._EB)*REAL( CA*B2C ) + 5._EB*B2SQ
         IF( L==1 ) PM1 = REAL( CB * ( CAC / 6._EB+ B2C ) )
         IF( L==2 ) PM1 = SQ( CB ) / 30._EB+ (20._EB/7._EB)*B2SQ + (2._EB/3._EB)*REAL( CA*B2C )
         IF( L==3 ) PM1 = (2._EB/7.) * REAL( CB*B2C )
         IF( L==4 ) PM1 = (40._EB/63._EB) * B2SQ
         IF( CALCMO( 1 ) ) PMOM( L, 1 ) = PM1
      END IF

      IF( IPOLZN==0 .OR. CALCMO( 2 ) ) THEN
         IF( L==0 ) PM2 = 0.25_EB*SQ( CAT ) + SQ( CBT ) / 12._EB + ( 5._EB/ 3._EB) * REAL( CAT*A2C ) + 5._EB*A2SQ
         IF( L==1 ) PM2 = REAL( CBT * ( CONJG( CAT ) / 6._EB+ A2C ) )
         IF( L==2 ) PM2 = SQ( CBT ) / 30._EB + ( 20._EB/7._EB) * A2SQ + ( 2._EB/3._EB) * REAL( CAT*A2C )
         IF( L==3 ) PM2 = (2._EB/7._EB) * REAL( CBT*A2C )
         IF( L==4 ) PM2 = (40._EB/63._EB) * A2SQ
         IF( CALCMO( 2 ) ) PMOM( L, 2 ) = PM2
      END IF

      IF( IPOLZN==0 ) THEN
         PMOM( L, 1 ) = 0.5_EB*( PM1 + PM2 )
         CYCLE L20
      END IF

      IF( CALCMO( 3 ) ) THEN
         IF( L==0 ) PMOM( L, 3 ) = 0.25_EB * REAL( CAC*CAT + CG + 20._EB* B2C * A(2) )
         IF( L==1 ) PMOM( L, 3 ) = REAL( CAC*CBT + CBC*CAT + 3._EB*CH ) / 12.
         IF( L==2 ) PMOM( L, 3 ) = 0.1_EB * REAL( CG + (200._EB/7._EB) * B2C * A(2) )
         IF( L==3 ) PMOM( L, 3 ) = REAL( CH ) / 14._EB
         IF( L==4 ) PMOM( L, 3 ) = 40._EB/63._EB* REAL( B2C*A(2) )
      END IF

      IF( CALCMO( 4 ) ) THEN
         IF( L==0 ) PMOM( L, 4 ) = 0.25_EB * AIMAG( CAC*CAT + CG + 20._EB* B2C * A(2) )
         IF( L==1 ) PMOM( L, 4 ) = AIMAG( CAC*CBT + CBC*CAT + 3._EB*CH ) / 12._EB
         IF( L==2 ) PMOM( L, 4 ) = 0.1_EB * AIMAG( CG + (200._EB/7._EB) * B2C * A(2) )
         IF( L==3 ) PMOM( L, 4 ) = AIMAG( CH ) / 14._EB
         IF( L==4 ) PMOM( L, 4 ) = 40._EB/63._EB* AIMAG( B2C*A(2) )
      END IF

   END DO L20

END IF

RETURN
END SUBROUTINE LPCO2T

SUBROUTINE BIGA( CIOR, XX, NTRM, NOABS, YESANG, RBIGA, CBIGA )

!        Calculate logarithmic derivatives of J-Bessel-function
!
!     Input :  CIOR, XX, NTRM, NOABS, YESANG  (defined in MIEV0)
!
!    Output :  RBIGA or CBIGA  (defined in MIEV0)
!
!    Routines called :  CONFRA
!
!
!    INTERNAL VARIABLES :
!
!       CONFRA     Value of Lentz continued fraction for CBIGA(NTRM),
!                     used to initialize downward recurrence
!
!       DOWN       = True, use down-recurrence.  False, do not.
!
!       F1,F2,F3   Arithmetic statement functions used in determining
!                     whether to use up-  or down-recurrence
!                     ( Ref. 2, Eqs. 6-8 )
!
!       MRE        Real refractive index
!       MIM        Imaginary refractive index
!
!       REZINV     1 / ( MRE * XX ); temporary variable for recurrence
!       ZINV       1 / ( CIOR * XX ); temporary variable for recurrence
!
!     .. Scalar Arguments ..

LOGICAL     NOABS, YESANG
INTEGER     NTRM
REAL(EB)    XX
COMPLEX(EB) CIOR

!     .. Array Arguments ..
REAL(EB)    RBIGA( * )
COMPLEX(EB) CBIGA( * )

!     .. Local Scalars ..
LOGICAL     DOWN
INTEGER     N
REAL(EB)    MIM, MRE, REZINV, RTMP
COMPLEX(EB) CTMP, ZINV

!                                  ** Decide whether BigA can be
!                                  ** calculated by up-recurrence
MRE = REAL( CIOR )
MIM = ABS( AIMAG( CIOR ) )
IF( MRE<1.0_EB .OR. MRE>10.0_EB .OR. MIM>10.0_EB ) THEN
   DOWN = .TRUE.
ELSE IF( YESANG ) THEN
   DOWN = .TRUE.
!                                                    ** Eq. R48
   IF( MIM*XX < F2( MRE ) ) DOWN = .FALSE.
ELSE
   DOWN = .TRUE.
!                                                    ** Eq. R48
   IF( MIM*XX < F1( MRE ) ) DOWN = .FALSE.
END IF

ZINV   = 1.0_EB / ( CIOR*XX )
REZINV = 1.0_EB / ( MRE*XX )


IF( DOWN ) THEN
!                          ** Compute initial high-order BigA using
!                          ** Lentz method ( Ref. 1, pp. 17-20 )
   CTMP = CONFRA( NTRM, ZINV )
!                                   *** Downward recurrence for BigA
   IF( NOABS ) THEN
!                                        ** No-absorption case; Eq (R23)
      RBIGA( NTRM ) = REAL( CTMP )
      DO N = NTRM, 2, -1
         RBIGA( N - 1 ) = ( N*REZINV ) - 1.0_EB / ( ( N*REZINV ) + RBIGA( N ) )
      END DO
   ELSE
!                                         ** Absorptive case; Eq (R23)
      CBIGA( NTRM ) = CTMP
      DO N = NTRM, 2, -1
         CBIGA( N-1 ) = (N*ZINV) - 1.0_EB / ( (N*ZINV) + CBIGA( N ) )
   END DO
   END IF

ELSE
!                            *** Upward recurrence for BigA
   IF( NOABS ) THEN
!                                  ** No-absorption case; Eq (R20,21)
      RTMP = SIN( MRE*XX )
      RBIGA( 1 ) = - REZINV + RTMP / ( RTMP*REZINV - COS( MRE*XX ) )

      DO N = 2, NTRM
         RBIGA( N ) = -( N*REZINV ) + 1.0_EB / ( ( N*REZINV ) - RBIGA( N - 1 ) )
      END DO

   ELSE
!                                     ** Absorptive case; Eq (R20,22)
      CTMP = EXP( - (0._EB,2._EB)*CIOR*XX )
      CBIGA( 1 ) = - ZINV + (1._EB-CTMP) /  ( ZINV * (1._EB-CTMP) - (0._EB,1._EB)*(1._EB+CTMP) )
      DO N = 2, NTRM
         CBIGA( N ) = - (N*ZINV) + 1.0_EB / ((N*ZINV) - CBIGA( N-1 ))
      END DO

END IF

END IF

CONTAINS

REAL(EB) FUNCTION F1(MRE)
REAL(EB), INTENT(IN) :: MRE
F1 = -8.0_EB + MRE**2*( 26.22_EB + MRE*( -0.4474_EB + MRE**3*( 0.00204_EB - 0.000175_EB*MRE ) ) )
END FUNCTION F1

REAL(EB) FUNCTION F2(MRE)  ! Eq. R47b
REAL(EB), INTENT(IN) :: MRE
F2 = 3.9_EB + MRE*( -10.8_EB + 13.78_EB*MRE )
END FUNCTION F2

END SUBROUTINE BIGA

COMPLEX(EB) FUNCTION CONFRA( N, ZINV )

!         Compute Bessel function ratio A-sub-N from its
!         continued fraction using Lentz method
!
!         ZINV = Reciprocal of argument of A
!
!
!    I N T E R N A L    V A R I A B L E S
!    ------------------------------------
!
!    CAK      Term in continued fraction expansion of A (Eq. R25)
!    CAPT     Factor used in Lentz iteration for A (Eq. R27)
!    CNUMER   Numerator   in capT  ( Eq. R28A )
!    CDENOM   Denominator in capT  ( Eq. R28B )
!    CDTD     Product of two successive denominators of capT factors
!                 ( Eq. R34C )
!    CNTN     Product of two successive numerators of capT factors
!                 ( Eq. R34B )
!    EPS1     Ill-conditioning criterion
!    EPS2     Convergence criterion
!    KK       Subscript k of cAk  ( Eq. R25B )
!    KOUNT    Iteration counter ( used to prevent infinite looping )
!    MAXIT    Max. allowed no. of iterations
!    MM       + 1  and - 1, alternately
! --------------------------------------------------------------------

!     .. Scalar Arguments ..

INTEGER     N
COMPLEX(EB) ZINV

!     .. Local Scalars ..

INTEGER     KK, KOUNT, MAXIT, MM
REAL(EB)    EPS1, EPS2
COMPLEX(EB) CAK, CAPT, CDENOM, CDTD, CNTN, CNUMER
!    
DATA      EPS1 / 1.E-2_EB / , EPS2 / 1.E-8_EB /
DATA      MAXIT / 10000 /
!                                 ** Eq. R25a
CONFRA = ( N + 1 ) * ZINV
MM     = - 1
KK     = 2*N + 3
!                                 ** Eq. R25b, k=2
CAK    = ( MM*KK ) * ZINV
CDENOM = CAK
CNUMER = CDENOM + 1.0_EB / CONFRA
KOUNT  = 1

L10: DO
   KOUNT = KOUNT + 1

   IF( KOUNT>MAXIT ) CALL ERRMSG('ConFra--Iteration failed to converge',.TRUE.)

   MM  = - MM
   KK  = KK + 2
   !                                 ** Eq. R25b
   CAK = ( MM*KK ) * ZINV
   !                                          ** Eq. R32
   IF( ABS( CNUMER / CAK )<=EPS1 .OR. ABS( CDENOM / CAK )<=EPS1 ) THEN

   !                                  ** Ill-conditioned case -- stride
   !                                  ** two terms instead of one

   !                                       ** Eq. R34
      CNTN   = CAK * CNUMER + 1.0_EB
      CDTD   = CAK * CDENOM + 1.0_EB
   !                                           ** Eq. R33
      CONFRA = ( CNTN / CDTD ) * CONFRA

      MM  = - MM
      KK  = KK + 2
   !                                 ** Eq. R25b
      CAK = ( MM*KK ) * ZINV
   !                                      ** Eq. R35
      CNUMER = CAK + CNUMER / CNTN
      CDENOM = CAK + CDENOM / CDTD
      KOUNT  = KOUNT + 1
      CYCLE L10

   ELSE
   !                           *** Well-conditioned case

   !                                  ** Eq. R27
      CAPT   = CNUMER / CDENOM
   !                                  ** Eq. R26
      CONFRA = CAPT * CONFRA
   !                                  ** Check for convergence; Eq. R31

      IF (      ABS( REAL (CAPT) - 1.0_EB )>=EPS2 .OR. ABS( AIMAG(CAPT) )      >=EPS2 )  THEN
   !                                        ** Eq. R30
         CNUMER = CAK + 1.0_EB / CNUMER
         CDENOM = CAK + 1.0_EB / CDENOM
         CYCLE L10
      END IF
   END IF
   EXIT L10
END DO L10

RETURN
END FUNCTION CONFRA

SUBROUTINE MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, QSCA, GQSC, NMOM, IPOLZN, MOMDIM, &
                   CALCMO, PMOM, SFORW, SBACK, TFORW, TBACK, S1, S2 )

!         Print scattering quantities of a single particle

!     .. Scalar Arguments ..
LOGICAL     PERFCT
INTEGER     IPOLZN, MOMDIM, NMOM, NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) CREFIN, SBACK, SFORW

!     .. Array Arguments ..
LOGICAL     CALCMO( * ), PRNT( * )
REAL(EB)    PMOM( 0:MOMDIM, * ), XMU( * )
COMPLEX(EB) S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..
CHARACTER   FMAT*22
INTEGER     I, J, M
REAL(EB)    FNORM, I1, I2

!     .. Intrinsic Functions ..
!     INTRINSIC AIMAG, CONJG, REAL


IF( PERFCT ) WRITE(LU_ERR, '(''1'',10X,A,1P,E11.4)' )  'Perfectly Conducting Case, size parameter =', XX

IF( .NOT.PERFCT ) WRITE(LU_ERR, '(''1'',10X,3(A,1P,E11.4))' ) &
    'Refractive Index:  Real ', REAL( CREFIN ), '  Imag ', &
    AIMAG( CREFIN ), ',   Size Parameter =', XX


IF( PRNT( 1 ) .AND. NUMANG>0 ) THEN

   WRITE(LU_ERR, '(/,A)' ) &
         '    cos(angle)  ------- S1 ---------  ------- S2 ---------' &
         // '  --- S1*conjg(S2) ---   i1=S1**2   i2=S2**2  (i1+i2)/2' &
         // '  DEG POLZN'

   DO I = 1, NUMANG
      I1 = REAL( S1( I ) )**2 + AIMAG( S1( I ) )**2
      I2 = REAL( S2( I ) )**2 + AIMAG( S2( I ) )**2
      WRITE(LU_ERR, '( I4, F10.6, 1P,10E11.3 )'   ) I, XMU(I), S1(I), S2(I), &
         S1(I)*CONJG(S2(I)),I1, I2, 0.5_EB*(I1+I2), (I2-I1)/(I2+I1)
   END DO
END IF


IF( PRNT( 2 ) ) THEN

   WRITE (LU_ERR, '(/,A,9X,A,17X,A,17X,A,/,(0P,F7.2, 1P,6E12.3) )' ) &
            '  Angle', 'S-sub-1', 'T-sub-1', 'T-sub-2', &
                  0.0_EB,     SFORW,    TFORW(1),  TFORW(2), &
               180._EB,     SBACK,    TBACK(1),  TBACK(2)
   WRITE (LU_ERR, '(/,4(A,1P,E11.4))' ) &
            ' Efficiency Factors,  extinction:', QEXT, &
                                 '   scattering:', QSCA, &
                                 '   absorption:', QEXT-QSCA, &
                              '   rad. pressure:', QEXT-GQSC
   IF( NMOM>0 ) THEN
      WRITE(LU_ERR, '(/,A)' ) ' Normalized moments of :'
      IF( IPOLZN==0 ) WRITE(LU_ERR, '(''+'',27X,A)' ) 'Phase Fcn'
      IF( IPOLZN>0 ) WRITE(LU_ERR, '(''+'',33X,A)' )  'M1           M2          S21          D21'

      IF( IPOLZN<0 ) WRITE(LU_ERR, '(''+'',33X,A)' )  'R1           R2           R3           R4'
      FNORM = 4._EB/ ( XX**2 * QSCA )
      DO M = 0, NMOM
         WRITE(LU_ERR, '(A,I4)' ) '      Moment no.', M
         DO J = 1, 4
            IF( CALCMO( J ) ) THEN
               WRITE( FMAT, '(A,I2,A)' ) '( ''+'', T', 24+(J-1)*13, ', 1P,E13.4 )'
               WRITE(LU_ERR, FMAT ) FNORM * PMOM( M, J )
            END IF
         END DO
      END DO
   END IF
END IF

RETURN
END SUBROUTINE MIPRNT

SUBROUTINE SMALL1( XX, NUMANG, XMU, QEXT, QSCA, GQSC, SFORW, SBACK, S1, S2, TFORW, TBACK, A, B )

!       Small-particle limit of Mie quantities in totally reflecting
!       limit ( Mie series truncated after 2 terms )
!
!        A,B       First two Mie coefficients, with numerator and
!                  denominator expanded in powers of XX ( a factor
!                  of XX**3 is missing but is restored before return
!                  to calling program )  ( Ref. 2, p. 1508 )

!     .. Parameters ..
REAL(EB)  TWOTHR, FIVTHR, FIVNIN
PARAMETER ( TWOTHR = 2._EB/3._EB, FIVTHR = 5._EB/3._EB, FIVNIN = 5._EB/9._EB )

!     .. Scalar Arguments ..
INTEGER     NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) SBACK, SFORW

!     .. Array Arguments ..
REAL(EB)    XMU( * )
COMPLEX(EB) A(*), B( * ), S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..
INTEGER     J
REAL(EB)    RTMP

!                                                       ** Eq. R/A.5
A( 1 ) = CMPLX( 0._EB, TWOTHR*( 1._EB - 0.2_EB*XX**2 ) ) / CMPLX( 1._EB - 0.5_EB*XX**2, TWOTHR*XX**3 )
!                                                      ** Eq. R/A.6
B( 1 ) = CMPLX( 0._EB, - ( 1._EB - 0.1_EB*XX**2 ) / 3._EB) / CMPLX( 1._EB + 0.5_EB*XX**2, - XX**3 / 3._EB)
!                                                       ** Eq. R/A.7,8
A( 2 ) = CMPLX( 0._EB,   XX**2 / 30._EB)
B( 2 ) = CMPLX( 0._EB, - XX**2 / 45._EB)
!                                                       ** Eq. R/A.9
QSCA = 6._EB* XX**4 *( SQ( A(1) ) + SQ( B(1) ) + FIVTHR*( SQ( A(2) ) + SQ( B(2) ) ) )
QEXT = QSCA
!                                                       ** Eq. R/A.10
GQSC = 6._EB* XX**4 *REAL( A(1)*CONJG( A(2) + B(1) ) + ( B(1) + FIVNIN*A(2) )*CONJG( B(2) ) )

RTMP   = 1.5_EB * XX**3
SFORW  = RTMP*( A(1) + B(1) + FIVTHR*( A(2) + B(2) ) )
SBACK  = RTMP*( A(1) - B(1) - FIVTHR*( A(2) - B(2) ) )
TFORW( 1 ) = RTMP*( B(1) + FIVTHR*( 2._EB*B(2) - A(2) ) )
TFORW( 2 ) = RTMP*( A(1) + FIVTHR*( 2._EB*A(2) - B(2) ) )
TBACK( 1 ) = RTMP*( B(1) - FIVTHR*( 2._EB*B(2) + A(2) ) )
TBACK( 2 ) = RTMP*( A(1) - FIVTHR*( 2._EB*A(2) + B(2) ) )

DO J = 1, NUMANG
!                                                    ** Eq. R/A.11,12
   S1( J ) = RTMP*( A(1) + B(1)*XMU( J ) + FIVTHR*( A(2)*XMU( J ) +  B(2)*( 2._EB*XMU( J )**2 - 1._EB) ) )
   S2( J ) = RTMP*( B(1) + A(1)*XMU( J ) + FIVTHR*( B(2)*XMU( J ) +  A(2)*( 2._EB*XMU( J )**2 - 1._EB) ) )
END DO
!                                     ** Recover actual Mie coefficients
A( 1 ) = XX**3 * A(1)
A( 2 ) = XX**3 * A(2)
B( 1 ) = XX**3 * B(1)
B( 2 ) = XX**3 * B(2)

RETURN
END SUBROUTINE SMALL1

SUBROUTINE SMALL2( XX, CIOR, CALCQE, NUMANG, XMU, QEXT, QSCA,GQSC, SFORW, SBACK, S1, S2, TFORW, TBACK,A, B )

!       Small-particle limit of Mie quantities for general refractive
!       index ( Mie series truncated after 2 terms )
!
!        A,B       First two Mie coefficients, with numerator and
!                  denominator expanded in powers of XX ( a factor
!                  of XX**3 is missing but is restored before return
!                  to calling program )

!        CIORSQ    Square of refractive index

!     .. Parameters ..
REAL(EB)    TWOTHR, FIVTHR
PARAMETER   ( TWOTHR = 2._EB/3._EB, FIVTHR = 5._EB/3._EB)

!     .. Scalar Arguments ..
LOGICAL     CALCQE
INTEGER     NUMANG
REAL(EB)    GQSC, QEXT, QSCA, XX
COMPLEX(EB) CIOR, SBACK, SFORW

!     .. Array Arguments ..
REAL(EB)    XMU( * )
COMPLEX(EB) A(*), B(*), S1(*), S2(*), TBACK(*), TFORW( * )

!     .. Local Scalars ..
INTEGER   J
REAL(EB)  RTMP
COMPLEX(EB)   CIORSQ, CTMP


CIORSQ = CIOR**2
CTMP   = CMPLX( 0._EB, TWOTHR )*( CIORSQ - 1.0_EB )

!                                           ** Eq. R42a
A( 1 ) = CTMP*( 1._EB- 0.1_EB*XX**2 +   ( CIORSQ / 350._EB + 1._EB/280._EB)*XX**4 ) / &
          ( CIORSQ + 2._EB+ ( 1._EB- 0.7_EB*CIORSQ )*XX**2 -  &
          ( CIORSQ**2 / 175._EB- 0.275_EB*CIORSQ + 0.25_EB )*XX**4 + &
          XX**3 * CTMP * ( 1._EB- 0.1_EB*XX**2 ) )

!                                           ** Eq. R42b
B( 1 ) = ( XX**2 / 30._EB )*CTMP*( 1._EB+  ( CIORSQ / 35._EB - 1._EB/ 14._EB)*XX**2 ) /  &
         ( 1._EB- ( CIORSQ / 15._EB - 1._EB/6._EB)*XX**2 )

!                                           ** Eq. R42c

A( 2 ) = ( 0.1_EB*XX**2 )*CTMP*( 1._EB- XX**2 / 14._EB ) /  ( 2._EB*CIORSQ + 3._EB- &
         ( CIORSQ / 7._EB- 0.5_EB ) * XX**2 )

!                                           ** Eq. R40a

QSCA = (6._EB*XX**4) * ( SQ( A(1) ) + SQ( B(1) ) + FIVTHR * SQ( A(2) ) )

!                                           ** Eq. R40b
QEXT = QSCA
IF( CALCQE ) QEXT = 6._EB*XX * REAL( A(1) + B(1) + FIVTHR*A(2) )

!                                           ** Eq. R40c

GQSC = (6._EB*XX**4) * REAL( A(1)*CONJG( A(2) + B(1) ) )

RTMP   = 1.5_EB * XX**3
SFORW  = RTMP*( A(1) + B(1) + FIVTHR*A(2) )
SBACK  = RTMP*( A(1) - B(1) - FIVTHR*A(2) )
TFORW( 1 ) = RTMP*( B(1) - FIVTHR*A(2) )
TFORW( 2 ) = RTMP*( A(1) + 2._EB*FIVTHR*A(2) )
TBACK( 1 ) = TFORW(1)
TBACK( 2 ) = RTMP*( A(1) - 2._EB*FIVTHR*A(2) )


DO J = 1, NUMANG
!                                      ** Eq. R40d,e

   S1( J ) = RTMP*( A(1) + ( B(1) + FIVTHR*A(2) )*XMU( J ) )
   S2( J ) = RTMP*( B(1) + A(1)*XMU( J ) + FIVTHR*A(2)*( 2._EB*XMU( J )**2 - 1._EB) )
END DO

!                                     ** Recover actual Mie coefficients
A( 1 ) = XX**3 * A(1)
A( 2 ) = XX**3 * A(2)
B( 1 ) = XX**3 * B(1)
B( 2 ) = ( 0._EB, 0._EB)

RETURN
END SUBROUTINE SMALL2

SUBROUTINE TESTMI( COMPAR, XX, CREFIN, MIMCUT, PERFCT, ANYANG, &
                   NMOM, IPOLZN, NUMANG, XMU, QEXT, QSCA, GQSC, &
                   SFORW, SBACK, S1, S2, TFORW, TBACK, PMOM, &
                   MOMDIM )

!         Set up to run test case when  COMPAR = False;  when  = True,
!         compare Mie code test case results with correct answers
!         and abort if even one result is inaccurate.

!         The test case is :  Mie size parameter = 10
!                             refractive index   = 1.5 - 0.1 i
!                             scattering angle = 140 degrees
!                             1 Sekera moment

!         Results for this case may be found among the test cases
!         at the end of reference (1).

!         *** NOTE *** When running on some computers, esp. in single
!         precision, the Accur criterion below may have to be relaxed.
!         However, if Accur must be set larger than 10**-3 for some
!         size parameters, your computer is probably not accurate
!         enough to do Mie computations for those size parameters.

!     Routines called :  ERRMSG, MIPRNT, TSTBAD

!     .. Scalar Arguments ..

LOGICAL     ANYANG, COMPAR, PERFCT
INTEGER     IPOLZN, MOMDIM, NMOM, NUMANG
REAL(EB)    GQSC, MIMCUT, QEXT, QSCA, XX
COMPLEX(EB) CREFIN, SBACK, SFORW

!     .. Array Arguments ..

REAL(EB)    PMOM( 0:MOMDIM, * ), XMU( * )
COMPLEX(EB) S1( * ), S2( * ), TBACK( * ), TFORW( * )

!     .. Local Scalars ..

LOGICAL     ANYSAV, OK, PERSAV
INTEGER     IPOSAV, M, N, NMOSAV, NUMSAV
REAL(EB)    MIMSAV, TESTGQ, TESTQE, TESTQS,XMUSAV, XXSAV
COMPLEX(EB) CRESAV, TESTS1, TESTS2, TESTSB, TESTSF

!     .. Local Arrays ..

LOGICAL     CALCMO( 4 ), PRNT( 2 )
REAL(EB)    TESTPM( 0:1 )
COMPLEX(EB) TESTTB( 2 ), TESTTF( 2 )


SAVE      XXSAV, CRESAV, MIMSAV, PERSAV, ANYSAV, NMOSAV, IPOSAV,NUMSAV, XMUSAV

DATA      TESTQE / 2.459791_EB /,&
          TESTQS / 1.235144_EB /,&
          TESTGQ / 1.139235_EB /,&
          TESTSF / ( 61.49476_EB, -3.177994_EB ) /,&
          TESTSB / ( 1.493434_EB,  0.2963657_EB ) /,&
          TESTS1 / ( -0.1548380_EB, -1.128972_EB ) /,&
          TESTS2 / ( 0.05669755_EB, 0.5425681_EB ) /,&
          TESTTF / ( 12.95238_EB, -136.6436_EB ),&
                   ( 48.54238_EB, 133.4656_EB ) /,&
          TESTTB / ( 41.88414_EB, -15.57833_EB ),&
                   ( 43.37758_EB, -15.28196_EB ) /,&
          TESTPM / 227.1975_EB, 183.6898_EB /

IF( .NOT.COMPAR ) THEN
!                                   ** Save certain user input values
   XXSAV  = XX
   CRESAV = CREFIN
   MIMSAV = MIMCUT
   PERSAV = PERFCT
   ANYSAV = ANYANG
   NMOSAV = NMOM
   IPOSAV = IPOLZN
   NUMSAV = NUMANG
   XMUSAV = XMU( 1 )
!                                   ** Reset input values for test case
   XX     = 10.0_EB
   CREFIN = ( 1.5_EB, -0.1_EB )
   MIMCUT = 0.0_EB
   PERFCT = .FALSE.
   ANYANG = .TRUE.
   NMOM   = 1
   IPOLZN = -1
   NUMANG = 1
   XMU( 1 ) = -0.7660444_EB

ELSE
!                                    ** Compare test case results with
!                                    ** correct answers and abort if bad
   OK = .TRUE.

   IF( WRONG( QEXT,TESTQE ) ) OK = TSTBAD( 'QEXT', ABS( ( QEXT - TESTQE ) / TESTQE ) )

   IF( WRONG( QSCA,TESTQS ) )OK = TSTBAD( 'QSCA', ABS( ( QSCA - TESTQS ) / TESTQS ) )

   IF( WRONG( GQSC,TESTGQ ) ) OK = TSTBAD( 'GQSC', ABS( ( GQSC - TESTGQ ) / TESTGQ ) )

   IF( WRONG( REAL( SFORW ),REAL( TESTSF ) ) .OR. WRONG( AIMAG( SFORW ),AIMAG( TESTSF ) ) ) &
         OK = TSTBAD( 'SFORW', ABS( ( SFORW - TESTSF ) / TESTSF ) )

   IF( WRONG( REAL( SBACK ),REAL( TESTSB ) ) .OR. WRONG( AIMAG( SBACK ),AIMAG( TESTSB ) ) ) &
         OK = TSTBAD( 'SBACK', ABS( ( SBACK - TESTSB ) / TESTSB ) )

   IF( WRONG( REAL( S1(1) ),REAL( TESTS1 ) ) .OR. WRONG( AIMAG( S1(1) ),AIMAG( TESTS1 ) ) ) &
         OK = TSTBAD( 'S1', ABS( ( S1(1) - TESTS1 ) / TESTS1 ) )

   IF( WRONG( REAL( S2(1) ),REAL( TESTS2 ) ) .OR. WRONG( AIMAG( S2(1) ),AIMAG( TESTS2 ) ) ) &
         OK = TSTBAD( 'S2', ABS( ( S2(1) - TESTS2 ) / TESTS2 ) )

   DO N = 1, 2
      IF( WRONG( REAL( TFORW(N) ),REAL( TESTTF(N) ) ) .OR. &
               WRONG( AIMAG( TFORW(N) ), &
               AIMAG( TESTTF(N) ) ) ) OK = TSTBAD( 'TFORW', &
               ABS( ( TFORW(N) - TESTTF(N) ) / TESTTF(N) ) ) 

      IF( WRONG( REAL( TBACK(N) ),REAL( TESTTB(N) ) ) .OR. &
               WRONG( AIMAG( TBACK(N) ), &
               AIMAG( TESTTB(N) ) ) ) OK = TSTBAD( 'TBACK', &
               ABS( ( TBACK(N) - TESTTB(N) ) / TESTTB(N) ) )
   END DO

   DO M = 0, 1
      IF ( WRONG( PMOM(M,1), TESTPM(M) ) ) OK =  TSTBAD( 'PMOM', ABS( (PMOM(M,1)-TESTPM(M)) / TESTPM(M) ) )
   END DO


   IF( .NOT.OK ) THEN
      PRNT( 1 ) = .TRUE.
      PRNT( 2 ) = .TRUE.
      CALCMO( 1 ) = .TRUE.
      CALCMO( 2 ) = .FALSE.
      CALCMO( 3 ) = .FALSE.
      CALCMO( 4 ) = .FALSE.
      CALL MIPRNT( PRNT, XX, PERFCT, CREFIN, NUMANG, XMU, QEXT, &
                        QSCA, GQSC, NMOM, IPOLZN, MOMDIM, CALCMO, PMOM, &
                        SFORW, SBACK, TFORW, TBACK, S1, S2 )
      CALL ERRMSG( 'MIEV0 -- Self-test failed',.TRUE.)
   END IF
!                                       ** Restore user input values
   XX     = XXSAV
   CREFIN = CRESAV
   MIMCUT = MIMSAV
   PERFCT = PERSAV
   ANYANG = ANYSAV
   NMOM   = NMOSAV
   IPOLZN = IPOSAV
   NUMANG = NUMSAV
   XMU( 1 ) = XMUSAV

END IF

CONTAINS

LOGICAL FUNCTION WRONG(CALC,EXACT)
REAL(EB) ACCUR
REAL(EB), INTENT(IN) :: CALC,EXACT
DATA  ACCUR / 1.E-4_EB /
WRONG = ABS( ( CALC - EXACT ) / EXACT )>ACCUR
END FUNCTION WRONG

END SUBROUTINE TESTMI


SUBROUTINE ErrMsg( MESSAG, FATAL )
! Print out a warning or error message;  abort if error after making symbolic dump (machine-specific)
USE COMP_FUNCTIONS, ONLY: SHUTDOWN
CHARACTER :: MESSAG*(*)
LOGICAL ::  FATAL,MSGLIM
INTEGER ::  MAXMSG, NUMMSG
SAVE      MAXMSG, NUMMSG, MSGLIM
DATA      NUMMSG / 0 /,  MAXMSG / 100 /,  MSGLIM /.FALSE./
IF (FATAL) CALL SHUTDOWN(MESSAG)
NUMMSG = NUMMSG + 1
IF( MSGLIM ) RETURN
IF( NUMMSG<=MAXMSG ) THEN
   WRITE(LU_ERR, '(/,2A,/)' ) ' ****** WARNING *****  ', MESSAG
ELSE
   WRITE(LU_ERR, 9000 )
   MSGLIM = .True.
END IF
RETURN
9000 FORMAT( / , / , ' ****** TOO MANY WARNING MESSAGES --  ','They will no longer be printed *******', / , / )
END SUBROUTINE ErrMsg


LOGICAL FUNCTION WrtBad( VarNam )
!          Write names of erroneous variables and return 'TRUE'
!      INPUT :   VarNam = Name of erroneous variable to be written
!                         ( CHARACTER, any length )
CHARACTER VarNam*(*)
INTEGER   MAXMSG, NUMMSG
SAVE      NUMMSG, MAXMSG
DATA      NUMMSG / 0 /, MAXMSG / 50 /
WrtBad = .TRUE.
NUMMSG = NUMMSG + 1
WRITE(LU_ERR, '(3A)' ) ' ****  Input variable  ', VarNam,'  in error  ****'
IF( NUMMSG==MAXMSG ) CALL ErrMsg( 'Too many input errors.  Aborting...',.TRUE.)
RETURN
END FUNCTION WrtBad


LOGICAL FUNCTION WrtDim( DimNam, Minval )

! Write name of too-small symbolic dimension and the value it should be increased to;  return 'TRUE'

!      INPUT :  DimNam = Name of symbolic dimension which is too small
!                        ( CHARACTER, any length )
!               Minval = Value to which that dimension should be
!                        increased (at least)
CHARACTER :: DimNam*(*)
INTEGER ::  Minval

WRITE(LU_ERR, '(3A,I7)' ) ' ****  Symbolic dimension  ', DimNam,'  should be increased to at least ', Minval
WrtDim = .TRUE.
RETURN
END FUNCTION WrtDim


LOGICAL FUNCTION TstBad( VarNam, RelErr )
! Write name (VarNam) of variable failing self-test and its percent error from the correct value; return 'FALSE'
CHARACTER :: VarNam*(*)
REAL(EB) ::  RelErr
TstBad = .FALSE.
WRITE(LU_ERR, '(/,3A,1P,E11.2,A)' ) ' *** Output variable ', VarNam, ' differed by ', &
     100.*RelErr,' per cent from correct value.  Self-test failed.'
RETURN
END FUNCTION TstBad
 

REAL(EB) FUNCTION SQ(CTMP)
COMPLEX(EB), INTENT(IN) :: CTMP
SQ = REAL( CTMP )**2 + AIMAG( CTMP )**2
END FUNCTION SQ
 
END MODULE MIEV
